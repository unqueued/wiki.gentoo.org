<languages/>
<translate>

{{InfoBox stack
| {{InfoBox github|gentoo/elivepatch-client|header=true|text=elivepatch-client}}
| {{InfoBox github|gentoo/elivepatch-server|text=elivepatch-server}}

}}
=== Introduction === <!--T:1-->

elivepatch is a distributed application for building live patch, is also supporting automatic installing of security CVE live patch for any gentoo-sources recent than 4.1

[[File:ZDzIl3CEP1L6U6XI-B43E4.png|thumbnail|elivepatch diagram]]

==== Features ====

* Distributed live patch building
** Works as client server live patch build model
* Incremental live patch
** You can build live patch over the previous one
* Automatic live patch for security CVE
** Getting kernel CVE from https://github.com/nluedtke/linux_kernel_cves

==== Implementation ====

* elivepatch-client
** Client to be run on the machine where we want to install the live patch.
* elivepatch-server
** RESTful API for building the live patch. Using kpatch for building the live patch object.

==== Usage ====

===== Elivepatch-server =====
This is for the machine that will build the live patch.

Installation:

{{RootCmd|emerge --ask elivepatch-server}}

This will install the init.d file under /etc/init.d/elivepatch and the conf.d under /etc/conf.d/elivepatch.<br>
From the conf.d file you can change the elivepatch daemon user and permission (by default is root).<br>
You can start elivepatch-server on machine startup with:<br>
{{RootCmd|rc-config add elivepatch-server default}}

===== Elivepatch-client =====
This is for the machine that will request to build the live patch.

Installation:

{{RootCmd|emerge --ask elivepatch-client}}

====== One time livepatch build ======

{{RootCmd|elivepatch  --config <file.config> --patch <example.patch> --url <elivepatch-server_url:elivepatch-server_port>}}

====== CVE livepatch ======
CVE live patch is the command for live patching the current kernel with last security cve.
{{RootCmd|elivepatch  --cve --kernel <kernel_version> --url <elivepatch-server-url:port>}}
Can also be used as a cronjob command.

==== Creating Live patch ====
Not all patch can be converted to live patch using kpatch.<br>
* [https://github.com/dynup/kpatch/blob/master/doc/patch-author-guide.md#change-the-code-which-uses-the-data-structure Patch that change data structure]
* [https://github.com/dynup/kpatch/blob/master/doc/patch-author-guide.md#use-a-kpatch-load-hook Change content of existing variable]
* [https://github.com/dynup/kpatch/blob/master/doc/patch-author-guide.md#use-a-shadow-variable Add field to existing data structure]
* Init code changes are incompatible with kpatch
* [https://github.com/dynup/kpatch/blob/master/doc/patch-author-guide.md#header-file-changes Header file changes]
* [https://github.com/dynup/kpatch/blob/master/doc/patch-author-guide.md#dealing-with-unexpected-changed-functions Dealing with unexpected changed functions]
* [https://github.com/dynup/kpatch/blob/master/doc/patch-author-guide.md#removing-references-to-static-local-variables Removing references to static local variables]
* [https://github.com/dynup/kpatch/blob/master/doc/patch-author-guide.md#code-removal Code removal]

==== GSoC 2017 ====
This project is part of GSoC 2017 and the code is written by [[User:Aliceinwire]] mentored by [[User:Gokturk]]

Written code:<br>
* [https://github.com/aliceinwire/elivepatch kpatch ebuild merged in the Gentoo official repository]
* [https://github.com/aliceinwire/elivepatch-client elivepatch client]
* [https://github.com/aliceinwire/elivepatch-server elivepatch server]
* [https://github.com/gentoo/gentoo/pull/5608 Official Gentoo repository elivepatch merge pull-request]
Reports:
* [http://dev.gentoo.org/~alicef/elivepatch.pdf half term report]
* [https://docs.google.com/presentation/d/1a4FPoBCopH0VmSZ0to73EO3eX01A4tHnpeirwylwUJ0/edit?usp=sharing half term presentation]
* [http://aliceinwire.net/tag/tags/GSoC_2017/ Some public reports]
</translate>
