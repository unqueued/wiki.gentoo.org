<languages />

{{InfoBox stack
|{{InfoBox homepage|http://www.sshguard.net/|header=true}}
|{{InfoBox ohloh}}
}}

{{Metadata|abstract=sshguard is an intrusion prevention system that parses server logs, determines malicious activity, and uses the system firewall to block the IP addresses of malicious connections.}}

'''sshguard''' is an intrusion prevention system that parses server logs, determines malicious activity, and uses the system firewall to block the IP addresses of malicious connections. sshguard is written in C so it does not tax an interpretor.

== 동작 원리 ==

sshguard is a simple daemon that continuously tracks one or more log files. It parses the log events that daemons send out in case of failed login attempts and then blocks any further attempts from those connections by updating the system's firewall.

이름에서 암시하는 의미와는 달리 sshguard는 SSH 로그만 해석하지 않습니다. 메일 시스템과 FTP 로그에 대해서도 지원합니다. 지원 서비스 전체 목록은 [http://www.sshguard.net sshguard.net 웹 사이트]에 있습니다.

== Installation ==

=== Emerge ===

{{Package|app-admin/sshguard}}를 설치하십시오:

{{Emerge|app-admin/sshguard}}

Also make sure that {{Package|net-firewall/iptables}} is installed and used as the system firewall. At the time of writing, sshguard does not yet support {{Package|net-firewall/nftables}}.

{{Emerge|net-firewall/iptables}}

More information about using and configuring IPtables can also be found on the [[Iptables|IPtables article]].

== Configuration ==

=== 방화벽 준비 ===

sshguard가 침입 사용자(IP 주소로 차단)를 차단할 때 <tt>sshguard</tt> 체인을 활용합니다.

체인을 준비하고, 새 접속을 감지하면 실행하는지 확인하십시오:

{{RootCmd|iptables -N sshguard
|iptables -A INPUT -j sshguard}}

=== 로그 파일 감시 ===

sshguard의 바탕 개념은 관리자가 프로그램에게 옵션으로 감시할 로그 파일을 전달합니다. 자체적인 sshguard 설정 파일은 없습니다.

젠투에서는 {{Path|/etc/conf.d/sshguard}} 파일에서 옵션을 잘 설정할 수 있습니다:

{{FileBox|filename=/etc/conf.d/sshguard|title=Configuring sshguard to read /var/log/messages|lang=bash|1=
PARDONTIME="3600" # Blocks last at least 1 hour (3600 seconds)
WATCHTIME="360"   # Track IP addresses for 5 minutes (360 seconds)
THRESHOLD="10"    # How many problematic attempts trigger a block
  
LOGFILES="-l /var/log/messages"                      # Watch this file...
LOGFILES="${LOGFILES} -l /var/log/auth.log"          # And this one
  
SSHGUARD_OPTS="-p ${PARDONTIME} -s ${WATCHTIME} -a ${THRESHOLD} ${LOGFILES}"
}}

sshguard 를 사용하는 실행 시간 사용자가 로그 파일에 접근할 수 있는지 확인하십시오.

=== 서비스 ===

기본 실행 레벨에 sshguard를 추가하여 자동으로 시작하도록 한 후, 서비스를 시작하십시오:

{{RootCmd|rc-update add sshguard default
|rc-service sshguard start}}


== Troubleshooting ==

=== File '/var/log/auth.log' vanished while adding! ===

When starting up, sshguard reports the following error:

{{CodeBox|title=Error message when trying to add a monitor for /var/log/auth.log|1=
Sep 23 03:39:11 foo.bar.com sshguard[64933]: File '/var/log/auth.log' vanished while adding!
}}

Such an error (the file path itself can be different) occurs when the target file is not available on the system. Make sure that it is created, or update the sshguard configuration to not add it for monitoring.

On a syslog-ng system with OpenRC, the following addition to {{Path|syslog-ng.conf}} can suffice:

{{FileBox|filename=/etc/syslog-ng/syslog-ng.conf|title=creating auth.log file|lang=bash|1=
log { source(src); destination(messages); };
log { source(src); destination(console_all); };
 
destination authlog {file("/var/log/auth.log"); };
filter f_auth { facility(auth); };
filter f_authpriv { facility(auth, authpriv); };
log { source(src);  filter(f_authpriv);  destination(authlog);  };
}}

Reload the configuration for the changes to take effect:

{{RootCmd|rc-service syslog-ng reload}}

== 추가 참조 ==

* [[Iptables]] : 젠투 <tt>iptables</tt> 설치 및 설정

== 외부 자료 ==

[http://www.sshguard.net/docs/ sshguard 문서]에는 프로그램을 더 세밀하게 설정하는데 필요한 모든 정보가 들어있습니다.


[[Category:Security]]
[[Category:Server]]
