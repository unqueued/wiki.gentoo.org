<languages />
Chroot (Cambiar el directorio raíz) es una utilidad del sistema Unix que se emplea para cambiar el directorio raíz aparente de modo que se pueda crear un nuevo entorno separado lógicamente del sistema principal. Este nuevo entorno se conoce como una "jaula chroot". Un usuario que opere dentro de la jaula no puede ver ni acceder ficheros fuera del entorno en el que se le ha confinado.

Uno de los usos principales usos del enjaulamiento es crear un sistema Linux independiente encima del actual para realizar pruebas o compatibilidad del software. A menudo se ve como una alternativa ligera a la virtualización, ya que se puede correr sin la sobrecarga de un supervisor.

== Configurar el entorno ==
Lo primero que necesita cuando realice una nueva instalación es crear el directorio en el que residirá su jaula, por ejemplo en {{Path|/mnt/mijaula}}:

{{Cmd
|mkdir /mnt/mijaula
|cd /mnt/mijaula
}}

Si quiere montar una instalación ya existente desde una partición, puede hacer lo siguiente:

{{Cmd
|mkdir /mnt/mijaula
|mount /dev/DISPOSITIVO /mnt/mijaula
}}

Reemplace DISPOSITIVO por la partición que contiene su instalación.

Si ya tiene una instalación en un subdirectorio de la raíz en la que se encuentra, no tendrá que realizar los pasos indicados arriba.

==Desempaquetar los ficheros de sistema y el árbol Portage para una instalación nueva==
Si está construyendo una nueva instalación, el siguiente paso es descargar el stage3 y los ficheros tarball de Portage para colocarlos en la localización chroot. Para obtener más información sobre este proceso, lea las secciones 5a y 5b en el [http://www.gentoo.org/doc/es/handbook/handbook-amd64.xml?part=1&chap=5 Manual de Gentoo].

{{RootCmd
|links http://distfiles.gentoo.org/releases/amd64/current-stage3/
|tar xvjpf stage3-*.tar.bz2 -C /mnt/mijaula
|links http://distfiles.gentoo.org/snapshots/
|tar xvjf portage-*.tar.bz2 -C /mnt/mijaula/usr
}}

==Configuración==
Antes de introducirse en la jaula necesitamos montar algunos directorios.

{{RootCmd
|mount -o bind /dev /mnt/mijaula/dev
|mount -t proc none /mnt/mijaula/proc
|mount -o bind /sys /mnt/mijaula/sys
|mount -o bind /tmp /mnt/mijaula/tmp
}}

Y también necesitará copiar algunos ficheros de configuración básica desde el anfitrión, no sobrescriba {{Path|make.conf}} si está utilizando una instalación ya existente.

{{Cmd
|cp /etc/portage/make.conf /mnt/mijaula/etc/portage # Si está usando una instalación ya existente, no lance esta orden.
|cp /etc/resolv.conf /mnt/mijaula/etc
}}

Una vez hecho esto, podemos introducirnos en el entorno jaula.

{{RootCmd
|chroot /mnt/mijaula /bin/bash
|env-update
|source /etc/profile
|<nowiki>export PS1="(chroot) $PS1"</nowiki>
}}

Cuándo esté realizando una instalación nueva, puede sincronizar Portage para asegurarse de que todo está actualizado.

{{RootCmd
|emerge --sync
}}

El sistema es preparado. Puedes instalar software, jugar un poco, probar paquetes y configuraciones experimentales sin que ello tenga ningún efecto en su sistema principal. Para abandonar la jaula, teclee simplemente "exit" o presione {{Key|Ctrl}} + {{Key|D}}, esto le devolverá a su entorno normal. Do olvide desmontar lo directorios que ha montado.

==Guiones de inicio==
Si necesita hacer esto a menudo, puede acelerar el montaje de los directorios que necesita la jaula usando un guión de inicio:

{{File|/etc/init.d/mijaula||
 #!/sbin/runscript
 
 depend() {
    need localmount
    need bootmisc
 }

 start() {
    ebegin "Montando directorios jaula"
    mount -o bind /dev /mnt/mijaula/dev > /dev/null &
    mount -t proc none /mnt/mijaula/proc > /dev/null &
    mount -o bind /sys /mnt/mijaula/sys > /dev/null &
    mount -o bind /tmp /mnt/mijaula/tmp > /dev/null &
    eend $? "Ocurrió un error cuando se montaban los directorios jaula"
 }

 stop() {
    ebegin "Desmontando directorios jaula"
    umount -f /mnt/mijaula/dev > /dev/null &
    umount -f /mnt/mijaula/proc > /dev/null &
    umount -f /mnt/mijaula/sys > /dev/null &
    umount -f /mnt/mijaulat/tmp > /dev/null &
    eend $? "Ocurrió un error cuando se desmontaban los directorios jaula"
 }
}}

 <!-- Translated above -->

 <!-- Translated above -->

 <!-- Translated above -->

Si utiliza un directorio o partición diferentes, añada las órdenes de montaje adecuadas en start() y cambie {{Path|/mnt/jaula}} si utiliza un nombre distinto.

==See also==
* [http://www.gentoo.org/proj/en/base/x86/chroot.xml Gentoo x86 Chroot Setup Guide]


[[Category:Core system]]
