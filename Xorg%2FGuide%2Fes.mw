<languages />

{{Metadata|abstract=Xorg es el servidor X Window que permite a los usuarios tener un entorno gráfico en sus manos. Esta guía explica lo que es Xorg, cómo instalarlo y cuáles son su distintas opciones de configuración.}}

Xorg es el servidor [[X server|servidor de X Window]] que permite a los usuarios tener un entorno gráfico a su alcance. Esta guía explica lo que es Xorg, cómo instalarlo y qué opciones de configuración existen.

== ¿Qué es el Servidor X Window? ==

=== Gráfico vs Línea de Comandos ===

El usuario medio puede estar asustado si piensa que va a tener que teclear órdenes. ¿Porqué no apuntar y hacer clic a través de la libertad que ofrece Gentoo (y Linux en general)? Bien, naturalmente, ¡Puede hacer esto! Linux ofrece una amplia variedad de interfaces de usuario y entornos que puede instalar encima de su sistema actual. 

Esta es una de las sorpresas más grandes que encuentran los nuevos usuarios: una interfaz gráfica de usuario no es más que una aplicación que corre en su sistema. ''No'' es parte del núcleo Linux o cualquier otra parte interna del sistema. Es una herramienta poderosa que permite completamente capacidades gráficas en su estación de trabajo. 

Debido a la importancia de los estándares son importantes, un estándar para dibujar y mover ventanas en una pantalla, interactuar con el usuario a través del ratón y teclado y otros aspectos básicos pero importantes se han creado bajo el nombre "Sistema X Window", generalmente abreviado ''X11'' o simplemente ''X''. Se utiliza en Unix, Linux y sistemas operativos tipo Unix en todo el mundo. 

La aplicación que ofrece a los usuarios de Linux la capacidad de ejecutar interfaces gráficas de usuario y que utiliza el estándar X11 es Xorg-X11, una bifurcación del provecto XFree86. En su momento XFree86 decidió utilizar una licencia que podría ser incompatible con la licencia GPL, por tanto, se recomienda el uso de Xorg. El árbol oficial de Portage ya no ofrece el paquete XFree86.

=== El Proyecto X.org  ===

El proyecto [http://www.x.org X.org] crea y mantiene una implementación del sistema X11 de código abierto y redistribuible libremente. Se trata, por tanto, de una infraestructura de escritorio basada en un sistema X11 de código abierto. 

Xorg ofrece una interfaz entre su hardware y el software gráfico que quiere correr. Además de esto, Xorg también trabaja en red, lo que implica que puede correr una aplicación en un sistema mientras la está viendo en otro. 

== Instalar Xorg ==

Antes de que  pueda instalar Xorg,  necesitará preparar su sistema para ello. En primer lugar, configure el núcleo para que ofrezca soporte a dispositivos de entrada y tarjetas de vídeo. A continuación, prepararemos {{Path|[[:/etc/portage/make.conf]]}} de modo que se construyan e instalen los controladores y paquetes Xorg correctos. 

=== Soporte para controladores de entrada ===

Por defecto, Xorg utiliza <code>[[evdev]]</code>, un controlador de entrada genérico. Necesitará activar el soporte para <code>evdev</code> realizando un cambio a la configuración de su núcleo. Lea la [[Kernel/Gentoo_Kernel_Configuration_Guide/es|Guía de Configuración del Núcleo]] si no sabe cómo configurar su núcleo. 

{{KernelBox|title=Habilitar evdev en el núcleo|<pre>
Device Drivers --->
 Input device support --->
  <*> Event interface
</pre>
}}

ALternativamente se puede utilizar [[Libinput]] como controlador del dispositivo de entrada.

=== Ajuste del modo del núcleo ===

Los controladores de vídeo de código abierto actuales se apoyan en el ajuste del modo del núcleo (KMS o Kernel ModeSetting). KMS proporciona un arranque gráfico mejorado con menos parpadeo, mayor velocidad en el cambio a modo usuario, una consola framebuffer integrada, cambio rápido de la consola a Xorg y otras características.

{{Important|KMS entra en conflicto con los controladores heredados, que deben permanecer '''deshabilitados''' en la configuración de su núcleo.}}

En primer lugar, prepare su núcleo para KMS.  Necesitará hacer esto independientemente del controlador de vídeo Xorg que esté utilizando. 

{{KernelBox|title=Deshabilitar el soporte de framebuffer heredado y habilitar el soporte báśico de consola FB|<pre>
Device Drivers --->
   Graphics support --->
      Frame Buffer Devices --->
         <*> Support for frame buffer devices --->
         ## (Deshabilitar todos los controladores, incluyendo VGA, Intel, nVidia y ATI, excepto para el soporte de framebuffer basado en EFI, solo si se está utilizando UEFI)
 
    ## (Más abajo, habilitar el soporte básico para la consola. KMS lo utiliza.)
    Console display driver support --->
      <*>  Framebuffer Console Support
</pre>
}}

A continuación, configure el núcleo para utilizar el controlador MS apropiado para la tarjeta de vídeo. Intel, nVidia, y AMD/ATI son las tarjetas más comunes, siga el listado de códigos para cada tarjeta mostrado abajo. 

Para tarjetas, leer la [[Intel#Kernel|sección del artículo sobre Intel]].

Para tarjetas nVidia: 

{{KernelBox|title=Ajustes para nVidia|<pre>
Device Drivers --->
   Graphics support --->
      <*>  Nouveau (nVidia) cards
</pre>
}}

Para las nuevas tarjetas AMD/ATI ([[ATI_FAQ RadeonHD 2000 y superiores]]), necesitará hacer emerge de {{Package|radeon-ucode}} o {{Package|linux-firmware}}. Una vez que haya instalado uno de estos paquetes, configure su núcleo tal y como se describe en la [[Radeon#Firmware|sección de firmware]] de [[Radeon|la página de Radeon]]: 

{{KernelBox|title=Ajustes para AMD/ATI|<pre>
## (Configurar el núcleo para que utilice el firmware radeon-ucode)
Device Drivers --->
   Generic Driver Options --->
   [*]  Include in-kernel firmware blobs in kernel binary
  ## # Específico de tarjetas ATI, (leer la página de Radeon para obtener detalles de los ficheros de firmware que se deben incluir)
   (radeon/<CARD-MODEL>.bin ...)
  ## # Especificar el directorio raíz
   (/lib/firmware/) External firmware blobs to build into the kernel binary
 
## (Habilitar el soporte KMS de Radeon)
Device Drivers --->
   Graphics support --->
   <*>    ATI Radeon
   [*]      Enable modesetting on radeon by default
   [ ]      Enable userspace modesetting on radeon (DEPRECATED)
</pre>
}}

{{Note|Las antiguas tarjetas Radeon (las series X1900 y anteriores) no necesitan el paquete {{Package|radeon-ucode}} ni ninguna configuración del firmware. Para ellas, se debe habilitar el Gestor de Renderizado Directo (Direct Rendering Manager DRM) y el ajuste del modo ATI.}}

{{Note|Los núcleos Linux >{{=}} 3.9 no tienen activado el ajuste de modo radeon por defecto (''Enable modesetting on radeon by default'' ) ya que se implica por defecto. No alarmarse si se no se encuetra esta opción en los núcleos actuales.}}

Abandonar la configuración del núcleo [[Kernel/Rebuild|reconstruir el núcleo y reiniciar]].

Ahora que ya se ha configurado KMS, continúe con la preparación de  {{Path|[[:/etc/portage/make.conf]]}} en la siguiente sección.

=== make.conf ===

Ahora que el núcleo está preparado, se deben configurar dos variables importantes en el archivo {{Path|[[:/etc/portage/make.conf]]}} antes de instalar Xorg. 

La primera variable es <var>[[:/etc/portage/make.conf#VIDEO_CARDS|VIDEO_CARDS]]</var>. Se utiliza para definir los controladores de vídeo que pretende utilizar y su valor, normalmente, está basado en el tipo de tarjeta que tiene instalada en su sistema. Los valores más comunes son <code>nouveau</code> para tarjetas nVidia o <code>radeon</code> para tarjetas ATI. Ambos son controladores de código abierto con buen soporte y desarrollados activamente. 

{{Note|Puede probar también los controladores de nVidia y AMD/ATI, <code>nvidia</code> y <code>fglrx</code> respectivamente. Sin embargo, la configuración de estos controladores está más allá del alcance de esta guía. Por favor, lea [[NVidia/nvidia-drivers|Guía nVidia de Gentoo Linux]] y [[ATI_FAQ|las Preguntas Frecuentes sobre ATI en Gentoo Linux]]. Si no sabe qué controlador elegir, eche un vistazo a estas guías para obtener información.}}

El controlador <code>intel</code> se puede utilizar en ordenadores de escritorio o portátiles con chipsets gráficos comunes de Intel. 

{{Note|La variable <var>VIDEO_CARDS</var> puede contener más de un controlador, siempre y cuando se separen los valores por un espacio.}}

La segunda variable es  [[:/etc/portage/make.conf#INPUT_DEVICES|<var>INPUT_DEVICES</var>]] y se utiliza para determinar qué controladores se construirán para gestionar los dispositivos de entrada. En la mayoría de las ocasiones, debería bastar con darle el valor <code>[[libinput]]</code> o <code>[[evdev]]</code>. Si va a utilizar dispositivos de entrada alternativos como un panel táctil Synaptics en un ordenador portátil, asegúrese de añadirlo a <var>INPUT_DEVICES</var> . 

Se debe decidir qué controladores se van a utilizar y añadir los ajustes necesarios al fichero {{Path|[[:/etc/portage/make.conf]]}}: 

{{CodeBox|title=Entradas ejemplo de make.conf|lang=bash|1=
## (Para tener soporte del ratón, el teclado y el panel táctil Synaptics)
INPUT_DEVICES="evdev synaptics"
## (Para tarjetas nVidia)
VIDEO_CARDS="nouveau"
## (Para tarjetas AMD/ATI)
VIDEO_CARDS="radeon"
}}

Si los ajustes sugeridos no funcionan en su sistema, debería correr <code>emerge -pv xorg-drivers</code>, comprobar todas las opciones disponibles y elegir aquéllas que se puedan aplicar a su sistema. Este ejemplo es para un sistema con un teclado, ratón, panel táctil Synaptics y una tarjeta de vídeo Radeon. 

{{Emerge|x11-base/xorg-drivers|params+=--verbose|output=<pre>
 
These are the packages that would be merged, in order:
 
Calculating dependencies... done!
[ebuild   R   ]  x11-base/xorg-drivers-1.9  INPUT_DEVICES="evdev synaptics
-acecad -aiptek -elographics% -fpit% -joystick -keyboard -mouse -penmount -tslib
-virtualbox -vmmouse -void -wacom"
VIDEO_CARDS="radeon -apm -ark -ast -chips -cirrus -dummy -epson -fbdev -fglrx
(-geode) -glint -i128 (-i740) (-impact) -intel -mach64 -mga -neomagic (-newport)
-nouveau -nv -nvidia -r128 -rendition -s3 -s3virge -savage -siliconmotion -sis
-sisusb (-sunbw2) (-suncg14) (-suncg3) (-suncg6) (-sunffb) (-sunleo) (-suntcx)
-tdfx -tga -trident -tseng -v4l -vesa -via -virtualbox -vmware (-voodoo) (-xgi)"
0 kB
</pre>
}}

Después de definir las variables necesarias, se puede instalar Xorg:

{{Emerge|x11-base/xorg-server}}

{{Note|Se podría instalar el metapaquete {{Package|x11-base/xorg-x11}} en lugar del paquete {{Package|x11-base/xorg-server}} que es más ligero. Funcionalmente, los paquetes {{Package|x11-base/xorg-x11}} y {{Package|x11-base/xorg-server}} son los mismos, sin embargo, el paquete {{Package|x11-base/xorg-x11}} incluye muchos más paquetes que no son necesarios en la mayoría de los sistemas. Los paquetes adicionales incluyen un amplio catálogo de [[fonts|tipografías]] en muchos idiomas. No son necesario para un entorno de trabajo X11 funcional.}}

Cuándo la instalación haya finalizado, necesitará reinicializar algunas variables de entorno antes de continuar:

{{RootCmd
|env-update
|source /etc/profile
}}

=== Usuarios de nVidia ===

Para los usuarios de NVidia podría ser adecuado lanzar {{c||nvidia-xconfig}} para generar un archivo {{Path|xorg.conf}} que funcione para la tarjeta gráfica seleccionada. Si no se realiza este paso, el fichero {{Path|xorg.conf}} se debe crear de forma manual tal y como se describe abajo. Si no se localiza el archivo  {{Path|xorg.conf}} se puede obtener el mensaje de error "No screens found" en el terminal cuando se intenta lanzar {{c|startx}}.

El controlador de NVidia funcionará únicamente después de reiniciar el sistema por lo que se debe hacer esto antes de lanzar {{c|nvidia-xconfig}}.

{{RootCmd|nvidia-xconfig}}

Es posible (y probablemente recomendado) ajustar el renderizador OpenGL al renderizador hardware en lugar del renderizado software:

{{RootCmd|eselect opengl set nvidia}}

== Configurar Xorg ==

El [[X server|servidor X]] está diseñado para funcionar automáticamente, no es necesario editar los ficheros de configuración de Xorg. Se ''deberían'' detectar y configurara sin problemas dispositivos tales como pantallas, teclados, y ratones.

Debería intentar en primer lugar [[#Using_startx|lanzar startx]] sin editar ningún fichero de configuración. Si Xorg no arranca, o existe algún otro problema, necesitará configurar Xorg manualmente como se muestra en la siguiente sección. 

{{Note|Si se han realizado cambios al núcleo, no se debe olvidar '''reiniciar el sistema''' ''antes'' de usar {{c|startx}} para utilizar el último núcleo construido. Si en el proceso se actualizó el núcleo a una nueva versión seguramente se necesitará actulizar los ficheros de configuración del cargador de arranque.}}

=== El directorio {{Path|xorg.conf.d}} ===

{{Important|La configuración de los ficheros dentro de {{Path|[[Xorg.conf#xorg.conf.d.2C_xorg.conf|xorg.conf.d]]}} se debe tomar como la última opción. Si es posible, es deseable lanzar Xorg sin ninguna configuración especial.}}

La mayoría de los archivos de configuración de Xorg se almacenan en {{Path|[[Xorg.conf#xorg.conf.d.2C_xorg.conf|/etc/X11/xorg.conf.d/]]}}. A cada archivo se le da un nombre único acabado en {{Path|.conf}}. Los nombres de los archivos dentro del directorio de configuración de Xorg se leerán en orden alfanumérico. Por ejemplo, el archivo {{Path|10-evdev.conf}} se leerá antes que {{Path|20-synaptics.conf}} y {{Path|a-evdev.conf}} se leerá antes que {{Path|b-synaptics.conf}} y así sucesivamente. No se requiere que los archivos dentro de este directorio estén numerados, pero hacer esto ayuda a mantenerlos organizados. La organización de éstos servirá dde ayuda cuando tengamos que depurar problemas con estos archivos.

{{Note|Xorg ofrece configuraciones ejemplo en {{Path|/usr/share/doc/xorg-server-${version}/xorg.conf.example.bz2}}. Éstas se pueden utilizar para crear ficheros de configuración personalizados en  {{Path|[[Xorg.conf#xorg.conf.d.2C_xorg.conf|/etc/X11/xorg.conf.d/]]}}. Los ejemplos ofrecen muchísimos comentarios. Si se necesita más información acerca de la sintaxis, siempre está disponible {{c|man xorg.conf}}. Se pueden encontrar otros ejemplos en la sección [[#Otros_recursos|Otros recursos]] al final de esta guía.}}

=== Usar startx ===

Pruebe {{c|startx}} para arrancar el [[X server|servidor X]]. {{c|startx}} es un guión (instalado por el paquete {{Package|x11-apps/xinit}}) que ejecuta una ''sesión X'', esto es, arranca el [[X server|servidor X]] y algunas aplicaciones gráficas en él. Las aplicaciones a arrancar se deciden utilizando la siguiente lógica: 

* Si hay un fichero llamado {{Path|.xinitrc}} en su directorio personal, se ejecutarán las órdenes listadas en el mismo.

* De lo contrario leerá el valor de la variable <var>XSESSION</var> desde el fichero {{Path|/etc/env.d/90xsession}} y lanzará la sesión adecuada. Los valores disponibles para <var>XSESSION</var> están en el fichero {{Path|/etc/X11/Sessions/}}. Para definir una sesión por defecto para todo el sistema, lance:

: {{RootCmd|echo XSESSION{{=}}"Xfce4" > /etc/env.d/90xsession}}

: Esto creará el archivo {{Path|90xsession}} y definirá la sesión X por defecto para que lance [[Xfce/Guide|Xfce]]. Recuerde lanzar {{c|env-update}} después de hacer cambios en {{Path|90xsession}}.

{{Cmd|startx}}

Si no ha instalado un gestor de ventanas, solo verá una pantalla negra. Ya que esto puede ser también un síntoma de que algo no va bien, puede que quiera hacer emerge de {{Package|twm}} y de {{Package|xterm}} ''solo para probar X'' . 

Una vez se hayan instalado los programas, se debe lanzar de nuevo {{c|startx}}. Deberían aparecer algunas ventanas de {{c|xterm}} lo que permite comprobar fácilmente que el [[X server|servidor X]] está funcionando correctamente. Una vez se está satisfecho con los resultados, se puede desinstalar los paquetes {{Package|x11-wm/twm}} y {{Package|x11-terms/xterm}} si se instalaron en el paso indicado más arriba con el fin de eliminar los paquetes que se utilizan para realizar pruebas. Estos paquetes no se necesitan en un entorno de escritorio actual.

Se podría también dar la sesión (programa a lanzar) como argumento a {{c|startx}}:

{{Cmd|startx /usr/bin/startfluxbox}}

Se puede también pasar opciones al servidor X11 anteponiéndolas con un doble guión:

{{Cmd|startx -- vt7}}

== Ajustando la configuración X ==

=== Definir la resolución de la pantalla ===

Si parece que la resolución de la pantalla no es la correcta, necesitará comprobar dos secciones en su configuración  {{Path|[[Xorg.conf#xorg.conf.d.2C_xorg.conf|xorg.conf.d]]}}. En primer lugar, tiene la sección ''Screen'' que muestra las resoluciones que su [[X server|servidor X]] soportará. Puede que no se liste ninguna resolución en esta sección. En este caso, Xorg estimará las resoluciones basándose en la información de la segunda sección ''Monitor''. 

Ahora cambiemos la resolución. En el siguiente ejemplo de {{Path|/etc/X11/xorg.conf.d/40-monitor.conf}} añadimos la línea <code>PreferredMode</code> para que nuestro [[X server|servidor X]] arranque con una resolución de 1440x900 por defecto. La opción (<code>Option</code>) en la sección <code>Device</code> debe corresponderse con el nombre de su monitor (<code>DVI-0</code>), el cual se puede obtener corriendo {{c|xrandr}}. Instalar {{c|xrandr}} ({{c|emerge xrandr}}) para obtener todas esta información. El argumento después del nombre del monitor (en la sección <code>Device</code>) debe corresponderse con la el identificador (<code>Identifier</code>) en la sección <code>Monitor</code>. 

{{RootCmd|nano -w /etc/X11/xorg.conf.d/40-monitor.conf|output=<pre>
Section "Device"
 Identifier "RadeonHD 4550"
 Option "Monitor-DVI-0" "DVI screen"
EndSection
Section "Monitor"
 Identifier "DVI screen"
 Option "PreferredMode" "1440x900" EndSection
</pre>
}}

Corra X ({{c|startx}}) para comprobar que se está utilizando la resolución deseada.

=== Múltiples monitores  ===

Puede establecer más de un monitor en {{Path|[[Xorg.conf#xorg.conf.d.2C_xorg.conf|/etc/X11/xorg.conf.d/]]}}. Asignar a cada monitor un identificador único e indicar su posición física, por ejemplo, "RightOf" (a la derecha) o "Above"(encima) de otro monitor. El siguiente ejemplo muestra como configurar un monitor DVI y uno VGA siendo el monitor VGA el que está a la derecha: 

{{RootCmd|nano -w /etc/X11/xorg.conf.d/40-monitor.conf|output=<pre>
Section "Device"
 Identifier "RadeonHD 4550"
 Option "Monitor-DVI-0" "DVI screen"
 Option "Monitor-VGA-0" "VGA screen"
EndSection
Section "Monitor"
 Identifier "DVI screen"
EndSection
Section "Monitor"
 Identifier "VGA screen"
 Option "RightOf" "DVI screen"
EndSection
</pre>
}}

=== Configurar el teclado ===

Para configurar X en el uso de un teclado internacional, tendrá que crear el fichero de configuración
apropiado en {{Path|[[Xorg.conf#xorg.conf.d.2C_xorg.conf|/etc/X11/xorg.conf.d/]]}}. El siguiente ejemplo muestra el uso de una disposición de teclado Checo: 

{{RootCmd|nano -w /etc/X11/xorg.conf.d/30-keyboard.conf|output=<pre>
Section "InputClass"
    Identifier "keyboard-all"
    Driver "evdev"
    Option "XkbLayout" "us,cz"
    Option "XkbModel" "logitech_g15"
    Option "XkbRules" "xorg"
    Option "XkbOptions" "grp:alt_shift_toggle,grp:switch,grp_led:scroll,compose:rwin,terminate:ctrl_alt_bksp"
    Option "XkbVariant" ",qwerty"
    MatchIsKeyboard "on"
EndSection
</pre>
}}

Para obtener ayuda sobre los métodos para conmutar la disposición de teclado leer el artículo sobre [[Keyboard_layout_switching#X11|conmutación de la disposición del teclado]].

La orden "terminate" (<code>terminate:ctrl_alt_bksp</code> ) le permite acabar con la sesión X mediante la combinación de teclas Ctrl-Alt-Supr. Esto, sin embargo, hará que X no termine de buena forma, algo que no es deseable. Puede ser de utilidad cuando los programas han congelado su pantalla completamente, o cuando está configurando o ajustando su entorno Xorg. Tenga cuidado cuando mate su escritorio con esta combinación de teclas; terminar de esta forma no le gustará a la mayoría de los programas y podría perder parte (o todo) de lo que esté realizando en ese momento.

=== Terminar ===

Lance {{c|startx}} y alégrese del resultado. ¡Enhorabuena!, ahora (seguramente) tendrá un sistema Xorg funcionando en su sistema!. El siguiente paso es instalar un gestor de ventanas funcional como [[KDE/es|KDE]], [[GNOME]], o [[Xfce]], pero eso no forma parte de esta guía. Se puede encontrar información sobre la instalación de estos entornos de escritorio en esta misma wiki.

== Véase también ==

* [[Wayland]] - La siguiente generación de gestores de ventañas para Linux.
* [[Security Handbook/Securing services#X|X (Manual de seguridad)]] - La entrada del manual de seguridad referente a asegurar el servidor X.

== Recursos externos ==

=== Crear y editar los ficheros de configuración ===

Las órdenes {{c|man xorg.conf}} y {{c|man evdev}} ofrecen referencias rápidas y completas sobre la sintaxis utilizada en estos ficheros de configuración. ¡Asegúrese de tenerlos abiertos en un terminal cuando edite los ficheros de configuración de Xorg! 

También existen muchos recursos en línea sobre la edición de ficheros de configuración en {{Path|/etc/X11/}}. Únicamente se listan aquí algunos; utilice su motor de búsqueda favorito para encontrar más.

=== Otros recursos ===

Se puede encontrar más información sobre la instalación y configuración de diversos entornos de escritorio y aplicaciones en la sección [[Category:Desktop|Gentoo desktop resources]] de nuestra documentación. 

Si se actualiza a xorg-server 1.9 o superior, asegúrese de leer la [[X_server/upgrade|guía de migración]]. 

X.org ofrece muchas [http://www.x.org/wiki/FAQ FAQs] en su sitio Web, además de su documentación.

{{Migrated|originalauthors={{Dev|SwifT}}, {{Dev|nightmorph}}}}
[[Category:X.Org]]
