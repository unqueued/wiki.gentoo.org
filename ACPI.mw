<languages />
<translate>
<!--T:1-->
{{InfoBox stack
|{{InfoBox homepage|http://www.uefi.org/acpi/specs|header=true}}
|{{InfoBox wikipedia|Advanced Configuration and Power Interface}}
}}

<!--T:2-->
'''ACPI''' ('''A'''dvanced '''C'''onfiguration and '''P'''ower Management '''I'''nterface) is [[Article description::a [[power management]] system that is part of the [[BIOS]]]].

== Installation == <!--T:3-->

=== Kernel === <!--T:4-->

<!--T:5-->
The following kernel options need to be activated for ACPI:

<!--T:6-->
{{KernelBox|1=
Power management and ACPI options  --->
    [*] Power Management support
        [*] ACPI (Advanced Configuration and Power Interface) Support  --->
}}

<!--T:7-->
{| class="table table-striped table-condensed" 
|+ '''Optional drivers'''
|-
! Option
! Module
! Recommend
! Description
|-
| Deprecated {{Path|/proc/acpi}} files
| {{ta|-}}
| {{No}}
| Creates deprecated files in the [[procfs]] filesystem, which are now replaced by files in the [[sysfs]] filesystem.
|-
| Deprecated power {{Path|/proc/acpi}} directories
| {{ta|-}}
| {{No}}
| Creates deprecated files in the procfs filesystem, which are now replaced by files in the sysfs filesystem.
|-
| EC read/write access through {{Path|/sys/kernel/debug/ec}}
| {{ta|ec-debugfs}}
| {{No}}
| Debug interface to the Embedded Controller.
|-
| Deprecated {{Path|/proc/acpi/event}} support
| {{ta|-}}
| {{No}}
| Creates deprecated files in the procfs filesystem, which are now replaced by the input layer or netlink events.
|-
| AC Adapter
| {{ta|ac}}
| {{Yes|Laptops}}
| Creates files to tell, if your system is connected to AC.
|-
| Battery
| {{ta|battery}}
| {{Yes|Laptops}}
| Creates files to tell, if your system is powered by a battery.
|-
| Button
| {{ta|button}}
| {{ta|-}}
| Handles events on the power, sleep, and lid buttons.
|-
| Video
| {{ta|video}}
| {{ta|-}}
| Supports basic operations for [[:Category:Graphics Adapters|graphics adapters]].
|-
| Fan
| {{ta|fan}}
| {{ta|-}}
| Supports ACPI fan devices, allowing user-mode applications to perform basic fan control (on, off, status).
|-
| Dock
| {{ta|dock}}
| {{ta|-}}
| Supports ACPI-controlled docking stations and removable drive bays, see the [[acpi dock]] article.
|-
| Processor
| {{ta|processor}}
| {{ta|-}}
| Installs ACPI as the idle handler for Linux and uses ACPI C2 and C3 processor states to save power.
|-
| Processor Aggregator
| {{ta|processor-aggregator}}
| {{ta|-}}
| ACPI 4.0 function to perform specific processor configuration and control.
|-
| Thermal Zone
| {{ta|thermal}}
| {{Yes}}
| Supports ACPI thermal zones to protect your processor against overheating.
|-
| NUMA support
| {{ta|-}}
| {{ta|-}}
| 
|-
| Debug Statements
| {{ta|-}}
| {{No}}
|
|-
| PCI slot detection driver
| {{ta|pci-slot}}
| {{No}}
| Helps to correlate PCI bus addresses with physical slots
|-
| Container and Module Devices
| {{ta|container}}
| {{ta|-}}
| Supports ACPI Container and Module devices to hotplug nodes, CPUs, and memory.
|-
| Smart Battery System
| {{ta|sbs, sbshc}}
| {{ta|-}}
| Supports another type of access to battery information, found on some laptops.
|-
| Hardware Error Device
| {{ta|hed}}
| {{ta|-}}
| Supports the Hardware Error Device, which is used to report some hardware errors.
|-
| Allow ACPI methods to be inserted/replaced at run time
| {{ta|custom-method}}
| {{No}}
|
|-
| ACPI Platform Error Interface (APEI)
| {{ta|-}}
| {{ta|-}}
| APEI allows to report errors (for example from the chipset) to the operating system.
|}

=== Emerge === <!--T:8-->

<!--T:9-->
[[:Category:Desktop environment|Desktop environments]] react on the common events generated by ACPI. If a desktop environment is not installed or to have the system react on special events the ACPI package can be installed. Install the {{Package|sys-power/acpid}} package:

<!--T:10-->
{{Emerge|sys-power/acpid}}

=== USE flags === <!--T:11-->

<!--T:12-->
Several packages know about the global [https://packages.gentoo.org/useflags/acpi <code>acpi</code>] USE flag.  There are no use flags available for {{Package|sys-power/acpid}} at this time.

=== SELinux === <!--T:13-->

<!--T:14-->
For acpid to be able to shutdown a SELinux system, make sure the {{Package|sec-policy/selinux-shutdown}} package is installed and the {{Path|/sbin/shutdown}} executable is re-labelled:

<!--T:15-->
{{Emerge|sec-policy/selinux-shutdown}}

== Configuration == <!--T:16-->

<!--T:17-->
The scripts found in {{Path|/etc/acpi}} define how the system reacts on ACPI events. They can be edited as necessary to meet the user's needs.

=== Services === <!--T:18-->

==== OpenRC ==== <!--T:19-->

<!--T:20-->
The acpid service can now be started. While using OpenRC run:

<!--T:21-->
{{RootCmd|/etc/init.d/acpid start}}

<!--T:22-->
To have the acpid service start at boot time add it to the default runlevel:

<!--T:23-->
{{RootCmd|rc-update add acpid default}}

==== Systemd ==== <!--T:24-->

<!--T:25-->
If systemd is being used as the [[init system]], enable the acpid service on system boot by issuing:

<!--T:26-->
{{RootCmd|systemctl enable acpid.service}}

<!--T:27-->
To start the service now:

<!--T:28-->
{{RootCmd|systemctl start acpid.service}}

=== Advanced examples === <!--T:29-->

<!--T:30-->
The default ACPI setup may be satisfactory for some users, however a little extra configuration may be required to get the acpid daemon to treat some basic ACPI events properly (AC power plug in/out, multimedia keys, etc.).

<!--T:31-->
Modifications can be make to {{Path|/etc/acpi/default.sh}} along with {{Path|/etc/acpi/events/default}} if necessary. Why not create a complicated setup that makes use of the {{Path|/etc/acpi/actions}} and {{Path|/etc/acpi/events}} capabilities? Simply put scripts and event files in those locations for advanced usage.

<!--T:32-->
A basic {{Path|default.sh}} file will probably be enough for most users, however the following is an example of what ''could'' be done using {{Path|default.sh}}:

<!--T:33-->
{{FileBox|filename=/etc/acpi/default.sh|lang=bash|1=
#!/bin/sh
#
# $Header: /etc/acpi/default.sh                          Exp $
# $Author: (c) 2012-2014 -tclover <tokiclover@dotfiles.> Exp $
# $License: MIT (or 2-clause/new/simplified BSD)         Exp $
# $Version: 2014/12/24 21:09:26                          Exp $
#

<!--T:34-->
log() { logger -p daemon "ACPI: $*"; }
uhd() { log "event unhandled: $*"; }

<!--T:35-->
set $*
group=${1%/*}
action=${1#*/}
device=$2
id=$3
value=$4

<!--T:36-->
[ -d /dev/snd ] && alsa=true <nowiki>||</nowiki> alsa=false
[ -d /dev/oss ] && oss=true <nowiki>||</nowiki> oss=false
amixer="amixer -q set Master"
ossmix="ossmix -- vmix0-outvol"

<!--T:37-->
case $group in
	ac_adapter)
		case $value in
			*0) log "switching to power.bat power profile"
				hprofile power.bat;;
			*1) log "switching to power.adp power profile"
				hprofile power.adp;;
			*) uhd $*;;
		esac
		;;
	battery)
		case $value in
			*0) log "switching to power.adp power profile"
				hprofile power.adp;;
			*1) log "switching to power.adp power profile"
				hprofile power.adp;;
			*) uhd $*;;
		esac
		;;
	button)
		case $action in
			lid)
				case "$id" in
					close) hibernate-ram;;
					open) :;;
					*) uhd $*;;
				esac
				;;
			power) shutdown -H now;;
			sleep) hibernate-ram;;
			mute) 
				$alsa && $amixer toggle;;
			volumeup) 
				$alsa && $amixer 3dB+
				$oss && $ossmix +3;;
			volumedown) 
				$alsa && $amixer 3dB-
				$oss && $ossmix -3;;
			*) uhd $*;;
		esac
		;;
	cd)
		case $action in
			play) :;;
			stop) :;;
			prev) :;;
			next) :;;
			*) uhd $*;;
		esac
		;;
	jack)
		case $id in
			*plug) :;;
			*) uhd $*;;
		esac
		;;
	video)
		case $action in
			displayoff) :;;
			*) uhd $*;;
		esac
		;;
	*) uhd $*;;
esac

<!--T:38-->
unset alsa oss amixer ossmix group action device id

<!--T:39-->
# vim:fenc=utf-8:ft=sh:ci:pi:sts=4:sw=4:ts=4:
}}

<!--T:40-->
{{Note|Notice that the above script is compatible with [[ALSA]] and [[OSS]], so no extra actions are needed when switching OSS from ALSA or the opposite. Do not hesitate to edit the script!}}

<!--T:41-->
{{Note|The above script also makes use of a power management profile using [[hprofile]]. Refer to the [[hprofile]] article for more information.}}

== See also == <!--T:42-->

<!--T:43-->
* {{See also|ACPI/ThinkPad-special-buttons|Thinkpad special buttons}}
* {{See also|Suspend and hibernate}}

<!--T:44-->
[[Category:ACPI]]
</translate>
