<languages />

{{Dated|date=12 de marzo de 2015}}

{{Metadata|abstract=Este artículo contiene instruciones acerca de cómo preparar Gentoo Linux para DVB y VDR.}}

Este artículo contiene instruciones acerca de cómo preparar Gentoo Linux para DVB y VDR.

== Información general de DVB ==

=== ¿Qué es DVB? ===

''DVB'' es el acrónimo de ''Digital Video Broadcasting'' (Difusión de Vídeo Digital). DVB describe métodos para transferir información digital de TV, radio, servicios interactivos como MHP, EPG y teletexto. Usando compresión de datos MPEG-2 o H.264 para HDTV es posible transferir varios canales en la misma frecuencia. A mayor compresión de datos, mayor número de canales que se pueden transferir, sin embargo se paga una pérdida de la calidad. 

DVB puede transferirse de varias formas. La última letra identifica el
método de transferencia, por ejemplo, DVB-''T<'' para transmisiones terrestres. Existen otros tipos: 

* DVB-S para transmisión vía satélite.
* DVB-C para transmisión por cable.
* DVB-H para transmisión a dispositivos móviles (terrestres).
* DVB-IPI para transmisión sobre redes IP, por ejemplo Internet.
* DVB-RC(S/C/T) canal de retorno para la transmisión de servicios de datos, por ejemplo Internet de banda ancha.

=== Tipos y requerimientos de tarjetas DVB ===

Además de los diferentes métodos existentes para recibir un stream DVB, las tarjetas se clasifican por el tipo de salida producida. Hay tarjetas con decodificador implementado que ofrece acceso directo al stream por medio del dispositivo {{Path|/dev/video}}. Estas tarjetas son ''tarjetas completas'' (full featured). Otras tarjetas no tienen decodificador, requieren un software instalado en el ordenador y son ''de bajo coste''. Esto implica mayores requisitos del sistema. La CPU del ordenador debe funcionar al menos a 600 MHz y disponer de al menos de 256MB de RAM. [http://linuxtv.org/wiki/index.php/DVB_Card_Vendors Esta lista] puede ser útil para identificar la tarjeta. 

== Preparar el sistema ==

=== Configurar el núcleo ===

En primer lugar, debe asegurarse de que el núcleo ofrece soporte para DVB y el dispositivo DVB instalado. Desde la versión 2.6 los controladores
necesarios están incluidos. Compruebe la configuración del núcleo y asegúrese de seleccionar las siguientes opciones como controladores
estáticos o como módulos. 

{{KernelBox|title=Opciones necesarias del núcleo|1=
Input Device Support --->
* Event Interface
Device Drivers --->
<M> Multimedia Support --->
  [*] Digital TV support
   M  [Habilitar controlador(es)]
}}

Adicionalmente seleccione el controlador adecuado para el hardware del sistema. Para encontrar el módulo adecuado para la tarjeta, se deben marcar todos los controladores como módulos. Se se utiliza una tarjeta PCI, entonces instale el paquete {{Package|sys-apps/pciutils}} si no se ha instalado aún. Esto ofrecerá una herramienta útil llamada {{c|lspci}}. Para los controladores integrados o si no se dispone de una tarjeta PCI en el sistema, se debe saltar este paso y continuar en [[VDR/es#Comprobar_la_salida_del_n.C3.BAcleo|comprobar la salida del núcleo]]. 

{{Emerge|sys-apps/pciutils}}

Después de arrancar desde el nuevo núcleo, lance  {{c|pcimodules}} para listar los módulos requeridos.

{{RootCmd|pcimodules|output=<pre>
ohci-hcd
ehci-hcd
sis900
snd-emu10k1
b2c2-flexcop-pci
nvidia nvidiafb
</pre>
}}

En este caso se necesita cargar el módulo <code>b2c2-flexcop-pci</code>. Añada el nombre del módulo al fichero {{Path|/etc/conf.d/modules}}: 

{{FileBox|filename=/etc/conf.d/modules|1=
modules="b2c2-flexcop-pci"
}}

=== Comprobar la salida del núcleo ===

Se recomienda marcar cada controlador como módulo de modo que el módulo necesario se pueda añadir dinámicamente, especialmente si no está claro que módulo se debe añadir. Si se conoce el nombre del módulo, entonces se debe seleccionar como un controlador integrado en el núcleo. A continuación se debe compilar el núcleo, instalar los módulos y reiniciar el nuevo módulo. Se puede verificar que el núcleo ha detectado correctamente la tarjeta PCI mediante la utilidad  {{c|dmesg}}. 

Si el sistema tiene una tarjeta TerraTec Cinergy T2 la salida debería parecerse en algo a la siguiente:

{{RootCmd|dmesg {{!}} grep DVB|output=<pre>
DVB: registering new adaptor (TerraTec/qanu USB2.0 Highspeed DVB-T Receiver).
input: TerraTec/qanu USB2.0 Highspeed DVB-T Receiver remote control as /class/input/input2
</pre>
}}

== Instalar VDR ==

Para instalar VDR simplemente se hace emerge:

{{Emerge|media-video/vdr}} 

== Instalar el mando a distancia ==

Hay al menos dos formas de controlar VDR usando un mando a distancia infrarrojo. Si la tarjeta de televisión tiene un receptor IR integrado entonces se puede usar <code>vdr-remote</code>. De lo contrario se debe usar LIRC. 

=== Instalar vdr-remote ===

Instalar el complemento mediante una orden  {{c|emerge}}: 

{{Emerge|media-plugins/vdr-remote}}
{{RootCmd|eselect vdr-plugin enable remote}}

Cuando use el complemento remoto para el puerto IR en una tarjeta DVB, todo debería funcionar correctamente con la configuración por defecto. Este complemento utiliza automáticamente el dispositivo de entrada que contiene "dvb" en su nombre. Para usos más avanzados, eche un vistazo al archivo {{Path|/etc/conf.d/vdr.remote}}.

=== Alternativa: instalar LIRC ===

Si la tarjeta se puede controlar de forma remota y no se desea gestionarla mediante <code>vdr-remote</code>, entonces se debe configurar LIRC. LIRC interpreta las teclas que se pulsan y devuelve un nombre para cada una de ellas. Un programa que ofrezca soporte para LIRC espera por los eventos generados por la pulsación de la tecla y realiza la acción que se ha configurado en el archivo de configuración que en la mayoría de ocasiones se encuentra en el directorio de configuración del programa que se ha ejecutado (por ejemplo  {{c|mplayer}} carga el archivo {{Path|~/.mplayer/lircrc}}). Antes de instalar LIRC, se debe añadir <code>lirc</code> como ajuste USE y añadir una variable special llamada <var>LIRC_DEVICES</var> a {{Path|/etc/portage/make.conf}}. Utilice [http://www.lirc.org/html/table.html esta lista] para averiguar los argumentos apropiados para la nueva variable de {{Path|make.conf}}. 

{{FileBox|filename=/etc/portage/make.conf|lang=bash|1=
# (Reemplace "devinput" por el controlador apropiado) LIRC_DEVICES="devinput"
USE="lirc"}}

{{Emerge|app-misc/lirc}}

Al comienzo, se debe definir cada código de tecla con un nombre. La mayoría de los mandos a distancia soportados ya están configurados, por tanto, eche un vistazo a la  [http://lirc.sourceforge.net/remotes/ lisdeberemos encontrar ta de mandos a distancia]. Descargue el fichero necesario y guárdelo como {{Path|/etc/lircd.conf}}. Ahora se debe averiguar donde está el mando a distancia. Ejecute la siguiente orden para obtener una lista de los dispositivos de entrada actuales (asegúrese de que el dispositivo está funcionando). 

{{RootCmd|cat /proc/bus/input/devices|output=<pre>
I: Bus=0000 Vendor=0000 Product=0000 Version=0000
N: Name="TerraTec/qanu USB2.0 Highspeed DVB-T Receiver remote control"
P: Phys=usb-0000:00:1d.7-1/input0
S: Sysfs=/class/input/input2
H: Handlers=kbd event1 B: EV=100003
B: KEY=108fc210 2043 0 0 0 0 8000 2080 1 9e1680 0 0 ffc
</pre>
}}

En este caso, se ha conectado un dispositivo Terratec Cinergy por lo que se puede acceder al dispositivo a través de {{Path|/dev/input/<event1>}}. Cambiar <code>event1</code> por el dispositivo correspondienteque se muestre en la salida. 

La orden {{c|lircd}} necesita saber qué dispositivo usar. Añadir la siguiente línea al fichero {{Path|/etc/conf.d/lircd}}. Recordar que se debe reemplazar <code><devinput></code> por el nombre del controlador y <code><event1></code> por el controlador en sí:

{{FileBox|filename=/etc/conf.d/lircd|lang=bash|1=
LIRCD_OPTS="-H <devinput> -d /dev/input/<event1>"
}}

It is time to start {{c|lircd}}: 

{{RootCmd|/etc/init.d/lircd start}}

Now it should be possible to watch {{c|lircd}} capturing and decoding key presses. Run the {{c|irw}} command. Stop it by pressing {{Key|Ctrl}}+{{Key|C}} when enough keys have been pressed. 

{{RootCmd|irw|output=<pre>
0000000000001aa2 00 Exit Technisat_TTS35AI.conf 
0000000000001a8d 00 Mute Technisat_TTS35AI.conf 
0000000000000a97 00 OK Technisat_TTS35AI.conf 
0000000000000a97 01 OK Technisat_TTS35AI.conf 
0000000000000a92 00 Menu Technisat_TTS35AI.conf
</pre>
}}

A continuación, añádalo al nivel de ejecución predeterminado para que comience automáticamente en el momento del arranque.

{{RootCmd|rc-update add lircd default}}

Para poder usar el mando a distancia, se debe habilitar el soporte LIRC en VDR. Añadir la siguiente línea al archivo {{Path|/etc/conf.d/vdr}}: 

{{FileBox|filename=/etc/conf.d/vdr|lang=bash|1=
IR_CTRL="lirc"
}}

== Métodos de salida de vídeo ==

Ahora se debe elegir uno (y solo uno) de los siguientes dispositivos de salida de vídeo que muestra la imagen y el On Screen Display (OSD) superpuesto. 

=== Decodificación Hardware: Tarjetas DVB completas (full featured) ===

Instalar {{Package|media-plugins/vdr-dvbhddevice}} cuando se esté utilizando un TechnoTrend Premium S2-6400 Twin HD, o  hardware de decodificación general para SDTV y HDTV (MPEG2 y MPEG4 AVC/H.264):

{{Emerge|media-plugins/vdr-dvbhddevice}}

Para Fujitsu_Siemens, Hauppage WinTV, TechnoTrend Premium S2300 y tarjetas basadas en este diseño de referencia o hardware de decodificación general para SDTV (MPEG1 y MPEG2): 

{{Emerge|vdr-dvbsddevice}}

=== Decodificación Hardware: Tarjetas DXR3/Hollywood+ ===

Para utilizar una tarjeta DXR3 para la salida VDR se necesita el complemento <code>vdr-dxr3</code>: 

{{Emerge|vdr-dxr3}}

{{FileBox|filename=/etc/conf.d/modules|lang=bash|1=
modules="em8300"
}}

El módulo em8300 necesita alguna configuración que depende de la revisión exacta de la tarjeta. 

=== Decodificación Hardware: Tarjetas PVR350 ===

Debido a que las tarjetas PVR350 incorporan un chip decodificador MPEG, éste se debería utilizar para aprovechar al máximo su potencial. Para ello, se necesita instalar el complemento <code>vdr-pvr350</code>. Si <c>ivtv-driver</c> no se ha instalado aún, emerge debería insitalarlo automáticamente. Para cargar el módulo <code>ivtv</code> al arrancar el sistema, lo añadiremos a la lista {{Path|/etc/conf.d/modules}}: 

{{Emerge|media-plugins/vdr-pvr350}}

{{FileBox|filename=/etc/conf.d/modules|lang=bash|1=
modules="ivtv"
}}

=== Decodificación Software: vdr-xineliboutput ===

Algunos usuarios prefieren usar <code>vdr-xineliboutput</code>, porque también puede funcionar de forma remota. Para configurar <code>vdr-xineliboutput</code> en el servidor y el cliente, seguiremos las siguientes instrucciones. En primer lugar, la configuración del servidor: 

{{Emerge|media-plugins/vdr-xineliboutput}}

{{RootCmd|eselect vdr-plugin enable xineliboutput}}

Adding command line options at this point is crucial for xineliboutput to work. For more options, see {{c|vdr --help}}. 

{{FileBox|filename=/etc/conf.d/vdr.xineliboutput|lang=bash|1=
_EXTRAOPTS="--local=none --remote=37890"
}}

El siguiente paso es editar {{Path|/etc/vdr/svdrphosts.conf}}. Este fichero describe un número de direcciones de servidor a las cuales está permitido conectarse al puerto SVDRP del grabador del disco de vídeo que se está ejecutando en el sistema servidor. 

{{FileBox|filename=/etc/vdr/svdrphosts.conf|lang=bash|1=
# (La sintaxis correcta es: Dirección-[/Máscara de red])
127.0.0.1 (aceptar siempre localhost)
192.168.1.0/24 (cualquier máquina de la red local)
#204.152.189.113 (una máquina específica)
#0.0.0.0/0 (cualquier máquina en cualquier red. ¡ÚSELO CON CUIDADO!)
}}

Cuando se utiliza <code>vdr-xineliboutput</code> para ver la imagen en el mismo ordenador que el que está corriendo VDR, es posible continuar con la [[#Crear_una_lista_de_canales|creación de la lista de canales]]. 

Otherwise, simply {{c|emerge}} {{Package|media-plugins/vdr-xineliboutput}} on the client: 

{{Emerge|media-plugins/vdr-xineliboutput}}

Later (after having started VDR) the {{c|vdr-sxfe xvdr://hostname}} command can be used to connect to the VDR and view its picture and OSD. 

{{Note|Existe también un complemento que simula la existencia de un dispositivo real de salida (<code>vdr-dummydevice</code>) para algunos usos imaginativos como servidores de solo grabación, pero es más avanzado que
una configuración normal VDR.}}

== Crear una lista de canales ==

Para que VDR sea realmente útil, se necesita crear una lista apropiada de canales. Hay más de una forma de conseguir una lista de canales que funcione (Aparte de descargarse una). La lista de canales que se instala por defecto es para la recepción DVB-S en Astra en 19.2°E. 

=== Usar dvbscan desde linuxtv-dvb-apps ===

{{Emerge|media-tv/linuxtv-dvb-apps}}

Encuentre la frecuencia correcta para su región y tipo de recepción su interés. Estos ficheros se almacenan en {{Path|/usr/share/dvb}}. Para recepción con DVB-T en Berlin se debería usar {{Path|/usr/share/dvb/scan/dvb-t/de-Berlin}}.

{{Cmd|dvbscan -o vdr /usr/share/dvb/scan/dvb-t/de-Berlin > /etc/vdr/channels.conf}}

=== Usar vdr-reelchannelscan ===

En primer lugar, borrar el contenido de la lista existente de canales:

{{RootCmd|rm /etc/vdr/channels.conf}}

{{Emerge|vdr-reelchannelscan}}

{{RootCmd|eselect vdr-plugin enable reelchannelscan}}

=== Canales para sistemas con vdr-analogtv ===

Es una buena idea configurar sus canales. El proyecto VDR proporciona a los usuarios algunos ejemplos que puede encontrar en {{Path|/usr/share/doc/vdr-analogtv-$version/examples/}}, siempre que se haya instalado <code>media-plugins/vdr-analogtv-1.0.00-r1</code> o una versión superior. 

== Arrancar VDR ==

Después de tener todas las partes básicas de software preparadas en el sistema, se debe configurar VDR con su OSD. 

Si se usó un decodificador hardware para salida de imagen, entonces se podría encender la televisión conectada. Cuando se utiliza salida por software, se debe arrancar el cliente después de VDR. 

En primer lugar, se debe aprender las definiciones de teclas; esto es, conectar las teclas del mando a distancia a las órdenes internas de VDR. 

{{Note|Para editar la configuración del teclado o (mejor aún) borrarlo para volver a memorizar las teclas, se puede modificar el fichero especial de configuración. VDR almacena sus definiciones de teclas en {{Path|/etc/vdr/remote.conf}}.}}

Comenzamos arrancando VDR: 

{{RootCmd|/etc/init.d/vdr start|output=<pre>
* Preparing start of vdr:
* config files ... [ ok ]
* Waiting for prerequisites (devices nodes etc.) ... [ ok ]
* Starting vdr ... [ ok ]
* First start of vdr: No check for running vdr possible
* until control device (remote/keyboard) keys are learnt!
</pre>
}}

{{Note|Los usuarios de decodificadores software deben arrancar ahora el programa cliente que abre la ventana para mostrar la imagen de TV y el OSD.}}

Para los usuarios de vdr-softdevice:

{{RootCmd|ShmClient}}

Para los usuarios de vdr-xineliboutput:

{{RootCmd|vdr-sxfe xvdr://nombre_de_máquina}}

Las teclas más útiles para VDR son: 

* Teclas del cursor (Izquierda/Derecha/Arriba/Abajo)
* Menu/Salir/Ok
* Colores (Rojo/Verde/Amarillo/Azul)
* Teclas numéricas (0-9)

{{Important|Si no existen muchas teclas en el mando a distancia, hay que asegurarse de asignarlas. (Algunos mandos tienen las teclas Play/Pause/etc. en las mismas teclas que los colores, por lo que deberá usarlas para los colores).}}

Ahora que se ha terminado con la instalación básica, es el momento de configurar VDR. Cambie a la pantalla de salida y siga las instrucciones en pantalla. VDR le pedirá al usuario que pulse varias teclas en el mando a
distancia de modo que pueda aprender los códigos correctos de las teclas. Si no se dispone de un mando a distancia se puede utilizar el teclado como alternativa. 

Ahora se debe añadir el guión de inicio al nivel de ejecución predeterminado para ejecutarlo cada vez que se arranque el ordenador:

{{RootCmd|rc-update add vdr default}}

== Solución de problemas ==

Si se necesita ayuda, se puede preguntar a alguien [http://www.gentoo.org/irc://irc.gentoo.org/gentoo-vdr #gentoo-vdr] o echar un vistazo en los [http://forums.gentoo.org/ foros de Gentoo].
{{Migrated|originalauthors=Norman Golisz, Dimitry Bradt, Matthias Schwarzott, Joshua Saddler}}
