<languages />

{{Dated|date=12 de marzo de 2015}}

{{Metadata|abstract=Este artículo contiene instruciones acerca de cómo preparar Gentoo Linux para DVB y VDR.}}

Este artículo contiene instruciones acerca de cómo preparar Gentoo Linux para DVB y VDR.

== Información general de DVB ==

=== ¿Qué es DVB? ===

''DVB'' es el acrónimo de ''Digital Video Broadcasting'' (Difusión de Vídeo Digital). DVB describe métodos para transferir información digital de TV, radio, servicios interactivos como MHP, EPG y teletexto. Usando compresión de datos MPEG-2 o H.264 para HDTV es posible transferir varios canales en la misma frecuencia. A mayor compresión de datos, mayor número de canales que se pueden transferir, sin embargo se paga una pérdida de la calidad. 

DVB puede transferirse de varias formas. La última letra identifica el
método de transferencia, por ejemplo, DVB-''T<'' para transmisiones terrestres. Existen otros tipos: 

* DVB-S para transmisión vía satélite.
* DVB-C para transmisión por cable.
* DVB-H para transmisión a dispositivos móviles (terrestres).
* DVB-IPI para transmisión sobre redes IP, por ejemplo Internet.
* DVB-RC(S/C/T) canal de retorno para la transmisión de servicios de datos, por ejemplo Internet de banda ancha.

=== Tipos y requerimientos de tarjetas DVB ===

Además de los diferentes métodos existentes para recibir un stream DVB, las tarjetas se clasifican por el tipo de salida producida. Hay tarjetas con decodificador implementado que ofrece acceso directo al stream por medio del dispositivo {{Path|/dev/video}}. Estas tarjetas son ''tarjetas completas'' (full featured). Otras tarjetas no tienen decodificador, requieren un software instalado en el ordenador y son ''de bajo coste''. Esto implica mayores requisitos del sistema. La CPU del ordenador debe funcionar al menos a 600 MHz y disponer de al menos de 256MB de RAM. [http://linuxtv.org/wiki/index.php/DVB_Card_Vendors Esta lista] puede ser útil para identificar la tarjeta. 

== Preparar el sistema ==

=== Configurar el núcleo ===

En primer lugar, debe asegurarse de que el núcleo ofrece soporte para DVB y el dispositivo DVB instalado. Desde la versión 2.6 los controladores
necesarios están incluidos. Compruebe la configuración del núcleo y asegúrese de seleccionar las siguientes opciones como controladores
estáticos o como módulos. 

{{KernelBox|title=Opciones necesarias del núcleo|1=
Input Device Support --->
* Event Interface
Device Drivers --->
<M> Multimedia Support --->
  [*] Digital TV support
   M  [Habilitar controlador(es)]
}}

Adicionalmente seleccione el controlador adecuado para el hardware del sistema. Para encontrar el módulo adecuado para la tarjeta, se deben marcar todos los controladores como módulos. Se se utiliza una tarjeta PCI, entonces instale el paquete {{Package|sys-apps/pciutils}} si no se ha instalado aún. Esto ofrecerá una herramienta útil llamada <tt>lspci</tt>. Para los controladores integrados o si no se dispone de una tarjeta PCI en el sistema, se debe saltar este paso y continuar en [[VDR/es#Comprobar_la_salida_del_n.C3.BAcleo|comprobar la salida del núcleo]]. 

{{Emerge|sys-apps/pciutils}}

Después de arrancar desde el nuevo núcleo, lance <tt>pcimodules</tt> para listar los módulos requeridos.

{{RootCmd|pcimodules|output=<pre>
ohci-hcd
ehci-hcd
sis900
snd-emu10k1
b2c2-flexcop-pci
nvidia nvidiafb
</pre>
}}

En este caso se necesita cargar el módulo <code>b2c2-flexcop-pci</code>. Añada el nombre del módulo al fichero {{Path|/etc/conf.d/modules}}: 

{{FileBox|filename=/etc/conf.d/modules|1=
modules="b2c2-flexcop-pci"
}}

=== Comprobar la salida del núcleo ===

Se recomienda marcar cada controlador como módulo de modo que el módulo necesario se pueda añadir dinámicamente, especialmente si no está claro que módulo se debe añadir. Si se conoce el nombre del módulo, entonces se debe seleccionar como un controlador integrado en el núcleo. A continuación se debe compilar el núcleo, instalar los módulos y reiniciar el nuevo módulo. Se puede verificar que el núcleo ha detectado correctamente la tarjeta PCI mediante la utilidad <tt>dmesg</tt>. 

Si el sistema tiene una tarjeta TerraTec Cinergy T2 la salida debería parecerse en algo a la siguiente:

{{RootCmd|dmesg {{!}} grep DVB|output=<pre>
DVB: registering new adaptor (TerraTec/qanu USB2.0 Highspeed DVB-T Receiver).
input: TerraTec/qanu USB2.0 Highspeed DVB-T Receiver remote control as /class/input/input2
</pre>
}}

== Instalar VDR ==

Para instalar VDR simplemente se hace emerge:

{{Emerge|media-video/vdr}} 

== Instalar el mando a distancia ==

Hay al menos dos formas de controlar VDR usando un mando a distancia infrarrojo. Si la tarjeta de televisión tiene un receptor IR integrado entonces se puede usar <code>vdr-remote</code>. De lo contrario se debe usar LIRC. 

=== Instalar vdr-remote ===

Instalar el plugin mediante una orden <tt>emerge</tt>: 

{{Emerge|media-plugins/vdr-remote}}
{{RootCmd|eselect vdr-plugin enable remote}}

Cuando use el plugin remoto para el puerto IR en una tarjeta DVB, todo debería funcionar correctamente con la configuración por defecto. Este plugin utiliza automáticamente el dispositivo de entrada que contiene "dvb" en su nombre. Para usos más avanzados, eche un vistazo al archivo {{Path|/etc/conf.d/vdr.remote}}.

=== Alternativa: instalar LIRC ===

Si la tarjeta se puede controlar de forma remota y no se desea gestionarla mediante <code>vdr-remote</code>, entonces se debe configurar LIRC. LIRC interpreta las teclas que se pulsan y devuelve un nombre para cada una de ellas. Un programa que ofrezca soporte para LIRC espera por los eventos generados por la pulsación de la tecla y realiza la acción que se ha configurado en el archivo de configuración que en la mayoría de ocasiones se encuentra en el directorio de configuración del programa que se ha ejecutado (por ejemplo <tt>mplayer</tt> carga el archivo {{Path|~/.mplayer/lircrc}}). Antes de instalar LIRC, se debe añadir <code>lirc</code> como ajuste USE y añadir una variable special llamada <code>LIRC_DEVICES</code> a {{Path|/etc/portage/make.conf}}. Utilice [http://www.lirc.org/html/table.html esta lista] para averiguar los argumentos apropiados para la nueva variable de {{Path|make.conf}}. 

{{FileBox|filename=/etc/portage/make.conf|lang=bash|1=
# (Reemplace "devinput" por el controlador apropiado) LIRC_DEVICES="devinput"
USE="lirc"}}

{{Emerge|app-misc/lirc}}

Al comienzo, se debe definir cada código de tecla con un nombre. La mayoría de los mandos a distancia soportados ya están configurados, por tanto, eche un vistazo a la  [http://lirc.sourceforge.net/remotes/ lisdeberemos encontrar ta de mandos a distancia]. Descargue el fichero necesario y guárdelo como {{Path|/etc/lircd.conf}}. Ahora se debe averiguar donde está el mando a distancia. Ejecute la siguiente orden para obtener una lista de los dispositivos de entrada actuales (asegúrese de que el dispositivo está funcionando). 

{{RootCmd|cat /proc/bus/input/devices|output=<pre>
I: Bus=0000 Vendor=0000 Product=0000 Version=0000
N: Name="TerraTec/qanu USB2.0 Highspeed DVB-T Receiver remote control"
P: Phys=usb-0000:00:1d.7-1/input0
S: Sysfs=/class/input/input2
H: Handlers=kbd event1 B: EV=100003
B: KEY=108fc210 2043 0 0 0 0 8000 2080 1 9e1680 0 0 ffc
</pre>
}}

En este caso, se ha conectado un dispositivo Terratec Cinergy por lo que se puede acceder al dispositivo a través de {{Path|/dev/input/<event1>}}. Cambiar <code>event1</code> por el dispositivo correspondienteque se muestre en la salida. 

<tt>lircd</tt> necesita saber qué dispositivo usar. Añadir la siguiente línea al fichero {{Path|/etc/conf.d/lircd}}. Recordar que se debe reemplazar <code><devinput></code> por el nombre del controlador y <code><event1></code> por el controlador en sí:

{{FileBox|filename=/etc/conf.d/lircd|lang=bash|1=
LIRCD_OPTS="-H <devinput> -d /dev/input/<event1>"
}}

Es el momento de arrancar <tt>lircd</tt>: 

{{RootCmd|/etc/init.d/lircd start}}

Ahora se debería observar <tt>lircd</tt> capturando y decodificando pulsaciones de teclas. Lance la orden <tt>irw</tt>. Párelo presionando {{Key|Ctrl}} + {{Key|C}} cuando se hayan pulsado algunas teclas. 

{{RootCmd|irw|output=<pre>
0000000000001aa2 00 Exit Technisat_TTS35AI.conf 
0000000000001a8d 00 Mute Technisat_TTS35AI.conf 
0000000000000a97 00 OK Technisat_TTS35AI.conf 
0000000000000a97 01 OK Technisat_TTS35AI.conf 
0000000000000a92 00 Menu Technisat_TTS35AI.conf
</pre>
}}

A continuación, añádalo al nivel de ejecución predeterminado para que comience automáticamente en el momento del arranque.

{{RootCmd|rc-update add lircd default}}

Para poder usar el mando a distancia, se debe habilitar el soporte LIRC en VDR. Añadir la siguiente línea al archivo {{Path|/etc/conf.d/vdr}}: 

{{FileBox|filename=/etc/conf.d/vdr|lang=bash|1=
IR_CTRL="lirc"
}}

== Video output methods ==

Now decide on one (and only one) of the following video output devices which show the picture and the overlayed On Screen Display (OSD). 

=== Decodificación Hardware: Tarjetas DVB completas (full featured) ===

Instalar {{Package|media-plugins/vdr-dvbhddevice}} cuando se esté utilizando un TechnoTrend Premium S2-6400 Twin HD, o  hardware de decodificación general para SDTV y HDTV (MPEG2 y MPEG4 AVC/H.264):

{{Emerge|media-plugins/vdr-dvbhddevice}}

Para Fujitsu_Siemens, Hauppage WinTV, TechnoTrend Premium S2300 y tarjetas basadas en este diseño de referencia o hardware de decodificación general para SDTV (MPEG1 y MPEG2): 

{{Emerge|vdr-dvbsddevice}}

=== Decodificación Hardware: Tarjetas DXR3/Hollywood+ ===

To use a DXR3 card for VDR output the <code>vdr-dxr3</code> plugin is needed: 

{{Emerge|vdr-dxr3}}

{{FileBox|filename=/etc/conf.d/modules|lang=bash|1=
modules="em8300"
}}

El módulo em8300 necesita alguna configuración que depende de la revisión exacta de la tarjeta. 

=== Decodificación Hardware: Tarjetas PVR350 ===

Since PVR350 cards have an onboard MPEG-Decoder chip it should be used to its full potential. In order for this to happen the <code>vdr-pvr350</code> plugin is needed. If <code>ivtv-driver</code> is not yet installed emerge should automatically install it. To have the <code>ivtv</code> module loaded at boot time add it to the {{Path|/etc/conf.d/modules}} list: 

{{Emerge|media-plugins/vdr-pvr350}}

{{FileBox|filename=/etc/conf.d/modules|lang=bash|1=
modules="ivtv"
}}

=== Decodificación Software: vdr-xineliboutput ===

Some people prefer to use <code>vdr-xineliboutput</code>, because it can work remotely. Follow the next set of instructions to configure <code>vdr-xineliboutput</code> on a host and client. First, the host setup: 

{{Emerge|media-plugins/vdr-xineliboutput}}

{{RootCmd|eselect vdr-plugin enable xineliboutput}}

Adding command line options at this point is crucial for xineliboutput to work. For more options, see <tt>vdr --help</tt>. 

{{FileBox|filename=/etc/conf.d/vdr.xineliboutput|lang=bash|1=
_EXTRAOPTS="--local=none --remote=37890"
}}

El siguiente paso es editar {{Path|/etc/vdr/svdrphosts.conf}}. Este fichero describe un número de direcciones de servidor a las cuales está permitido conectarse al puerto SVDRP del grabador del disco de vídeo que se está ejecutando en el sistema servidor. 

{{FileBox|filename=/etc/vdr/svdrphosts.conf|lang=bash|1=
# (La sintaxis correcta es: Dirección-[/Máscara de red])
127.0.0.1 (aceptar siempre localhost)
192.168.1.0/24 (cualquier máquina de la red local)
#204.152.189.113 (una máquina específica)
#0.0.0.0/0 (cualquier máquina en cualquier red. ¡ÚSELO CON CUIDADO!)
}}

When using <code>vdr-xineliboutput</code> to view the picture on the same computer as the one running VDR it is now possible to continue with [[#creating the channel list]]. 

Otherwise, simply <tt>emerge</tt> {{Package|media-plugins/vdr-xineliboutput}} on the client: 

{{Emerge|media-plugins/vdr-xineliboutput}}

Later (after having started VDR) the <tt>vdr-sxfe xvdr://hostname</tt> command can be used to connect to the VDR and view its picture and OSD. 

{{Note|Existe también un plugin que simula la existencia de un dispositivo real de salida (<code>vdr-dummydevice</code>) para algunos usos imaginativos como servidores de solo grabación, pero es más avanzado que
una configuración normal VDR.}}

== Crear una lista de canales ==

To make VDR really useful an appropriate channel list must be created. There is more than one way to get a working list of channels (besides downloading one). The channel list installed by default is for DVB-S reception on Astra on 19.2° E. 

=== Usar dvbscan desde linuxtv-dvb-apps ===

{{Emerge|media-tv/linuxtv-dvb-apps}}

Find the correct frequency list for region and type of reception of interest. These files are stored under {{Path|/usr/share/dvb}}. For reception with DVB-T in Germany, Berlin {{Path|/usr/share/dvb/dvb-t/de-Berlin}} should be used:

{{Cmd|dvbscan -o vdr /usr/share/dvb/scan/dvb-t/de-Berlin > /etc/vdr/channels.conf}}

=== Usar vdr-reelchannelscan ===

First, delete the contents of the existing channel list:

{{RootCmd|rm /etc/vdr/channels.conf}}

{{Emerge|vdr-reelchannelscan}}

{{RootCmd|eselect vdr-plugin enable reelchannelscan}}

=== Canales para sistemas con vdr-analogtv ===

It is a good idea to configure channels at this point. The VDR project provides users with some examples which can be found at {{Path|/usr/share/doc/vdr-analogtv-$version/examples/}}, as long as <code>media-plugins/vdr-analogtv-1.0.00-r1</code> and up has been installed. 

== Arrancar VDR ==

After having all basic software parts ready on the system the VDR with its OSD must be configured. 

If a hardware decoder for picture output is used, then the connected TV should be turned on. When using software output the client for this must be started after VDR. 

First, learn the key definitions; that is, connecting keys on the remote control to VDR's internal commands. 

{{Note|Para editar la configuración del teclado o (mejor aún) borrarlo para volver a memorizar las teclas, se puede modificar el fichero especial de configuración. VDR almacena sus definiciones de teclas en {{Path|/etc/vdr/remote.conf}}.}}

Comenzamos arrancando VDR: 

{{RootCmd|/etc/init.d/vdr start|output=<pre>
* Preparing start of vdr:
* config files ... [ ok ]
* Waiting for prerequisites (devices nodes etc.) ... [ ok ]
* Starting vdr ... [ ok ]
* First start of vdr: No check for running vdr possible
* until control device (remote/keyboard) keys are learnt!
</pre>
}}

{{Note|Los usuarios de decodificadores software deben arrancar ahora el programa cliente que abre la ventana para mostrar la imagen de TV y el OSD.}}

Para los usuarios de vdr-softdevice:

{{RootCmd|ShmClient}}

Para los usuarios de vdr-xineliboutput:

{{RootCmd|vdr-sxfe xvdr://nombre_de_máquina}}

Las teclas más útiles para VDR son: 

* Teclas del cursor (Izquierda/Derecha/Arriba/Abajo)
* Menu/Salir/Ok
* Colores (Rojo/Verde/Amarillo/Azul)
* Teclas numéricas (0-9)

{{Important|Si no existen muchas teclas en el mando a distancia, hay que asegurarse de asignarlas. (Algunos mandos tienen las teclas Play/Pause/etc. en las mismas teclas que los colores, por lo que deberá usarlas para los colores).}}

Now that the basic installation is over it is time to configure VDR. Switch to the output screen and follow the on-screen instructions. VDR asks the user to press various keys on the remote control so it can learn the correct key codes. If a remote control is not present, then the keyboard can be used as an alternative. 

Now add the VDR init script to the default runlevel to get it started each time the computer boots:

{{RootCmd|rc-update add vdr default}}

== Solución de problemas ==

Si se necesita ayuda, se puede preguntar a alguien [http://www.gentoo.org/irc://irc.gentoo.org/gentoo-vdr #gentoo-vdr] o echar un vistazo en los [http://forums.gentoo.org/ foros de Gentoo].
{{Migrated|originalauthors=Norman Golisz, Dimitry Bradt, Matthias Schwarzott, Joshua Saddler}}
