{{InfoBox stack
|{{InfoBox wikipedia|Network_Time_Protocol|header=true}}
}}
Network Time Protocol ([http://en.wikipedia.org/wiki/Network_Time_Protocol NTP]) is used to synchronize the local time with other devices over the network, this usually happens in a client-server model.

== Installation ==
You can install {{Package|net-misc/ntp}} with the following command:
{{Emerge|net-misc/ntp}}
Or alternatively, you can use {{Package|net-misc/openntpd}} instead.

=== USE Flags ===
{{USEflag
|package=net-misc/ntp
|caps
|debug++no+
|ipv6++yes+
|openntpd
|parse-clocks
|samba
|selinux++no+
|snmp
|ssl++yes+
|vim-syntax
|zeroconf
}}

=== Configuration Files ===
The only configuration file is ''/etc/ntp.conf'' which is well explained with comments. Here are some of the more important settings.

==== server ====
Here you can specify with which servers you want to synchronize your local time.
{{File|/etc/ntp.conf||<pre>
server 0.gentoo.pool.ntp.org
server 1.gentoo.pool.ntp.org
server 2.gentoo.pool.ntp.org
server 3.gentoo.pool.ntp.org</pre>}}
{{Note|timezones and location of the server do not matter, it synchronizes the [http://en.wikipedia.org/wiki/Coordinated_Universal_Time UTC] time}}
Per default the gentoo servers are listed and enabled. A list of available servers can be found here:[http://www.pool.ntp.org/en/#top ntp.org] You can also define a home or company server here, given that ntpd is running and the machine is allowed to.

==== Permissions ====
To control who is allowed to synchronize with this machine and change the configuration, you can change these options.
{{Warning|Running ntpd without any options, allows any other computer on the network/internet access to the server.}}
* access to NTP service allowed only from localhost.
{{File|/etc/ntp.conf||<pre>
# To deny other machines from changing the
# configuration but allow localhost:
restrict default nomodify nopeer
restrict 127.0.0.1
</pre>}}
* access to NTP service allowed only from the 192.168.0.0/24 network.
{{File|/etc/ntp.conf||<pre>
# To allow machines within your network to synchronize
# their clocks with your server, but ensure they are
# not allowed to configure the server or used as peers
# to synchronize against, uncomment this line.
#
restrict 192.168.0.0 mask 255.255.255.0 nomodify nopeer notrap
</pre>}}

== Usage ==
Basic tools and common usage

=== ntpd service ===
Add ntpd to the default runlevel to have the time synchronized automatically
{{RootCmd|rc-update add ntpd default
|/etc/init.d/ntp-client start}}

If ntpd is run as a service, the time will automatically synchronize as long as the difference between the local time and the time on the server is less than 1000s (~17min). So it is pretty common to adjust the time initially to whatever the server time is as a trusted source:
{{RootCmd|ntpd -g -c /etc/ntp.conf}}
{{Note|If ntpd is already running, it won't start a second time}}

=== ntpdate ===
This used to be the client, but its functionality is now moved into ntpd itself. It is purely to set the local time when started and then exits (not a service):
{{RootCmd|ntpdate pool.ntp.org}}

== See also ==
* [http://www.gentoo.org/doc/en/home-router-howto.xml#doc_chap6 Home Router Guide]

== External resources ==
* [http://www.pool.ntp.org/ ntp.org]
* [http://en.gentoo-wiki.com/wiki/NTP community wiki NTP article]

[[Category:Daemons]]
[[Category:Server]]
