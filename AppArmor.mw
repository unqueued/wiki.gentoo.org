{{InfoBox stack
|{{InfoBox homepage|http://wiki.apparmor.net|header=true}}
|{{InfoBox wikipedia}}
}}
'''AppArmor''' is a MAC (Mandatory Access Control) system, implemented upon LSM (Linux Security Modules). 

== Installation ==

=== Kernel ===
==== Patches ====
While the Linux kernel already supports AppArmor natively, the userspace utilities depend on a number of patches produced by the AppArmor developers that have not yet been accepted upstream. Depending upon the version of the kernel you are using, the patches are included in the AppArmor tarball, or can be found in version-specific [https://git.kernel.org/cgit/linux/kernel/git/jj/linux-apparmor.git/refs/heads git branches].

These patches do not apply cleanly to {{package|sys-kernel/hardened-sources}} so a [https://github.com/kensington/apparmor-grsec rebased] version for the latest kernel is provided for convenience.

==== Configuration ====
You need to activate the following kernel options:
{{Kernel||<pre>
Security options  --->
    [*] AppArmor support
    (1)   AppArmor boot parameter default value
    [*]   Enable AppArmor 2.4 compatability
          Default security module (AppArmor)  --->
</pre>}}

Note that the ''Enable AppArmor 2.4 compatability'' option will only be available if you are using the kernel patches.

=== Packages ===
A number of packages are available in the [http://git.overlays.gentoo.org/gitweb/?p=proj/hardened-dev.git;a=summary hardened-dev] [[overlay]]:

* {{package|sys-libs/libapparmor}} - the core library to support the userspace utilities
* {{package|sys-apps/apparmor}} - the profile parser and init script (required)
* {{package|sys-apps/apparmor-utils}} - additional userspace utilities to assist with profile management (recommended)
* {{package|sec-policy/apparmor-profiles}} - a collection of pre-built profiles contributed by the AppArmor community

== Configuration ==

=== Enabling AppArmor ===
If you did not select AppArmor as the default security module and set the boot parameter default value in the kernel configuration, you will need to enable AppArmor manually at boot time.

==== GRUB ====
{{File|/boot/grub/grub.conf|Example GRUB config for AppArmor with simple kernel|<pre>
title=Gentoo with AppArmor
root (hd0,0)
kernel /vmlinuz root=/dev/sda2 apparmor=1 security=apparmor
</pre>}}

==== GRUB 2 ====

{{File|/etc/default/grub|Enabling AppArmor with GRUB 2|<pre>
GRUB_CMDLINE_LINUX_DEFAULT="apparmor=1 security=apparmor"
</pre>}}
You should apply changes by running:

{{RootCmd|grub2-mkconfig -o /boot/grub2/grub.cfg}}

=== securityfs ===
securityfs is the filesystem used by Linux kernel security modules. The init script mounts it automatically if it is not already, but you may prefer to do it manually:

{{File|/etc/fstab|securityfs entry for fstab|<pre>
 none     /sys/kernel/security securityfs defaults            0      0
</pre>}}

=== Boot service ===
Adding it to boot runlevel:
{{RootCmd|rc-update add apparmor boot}}

[[Category:Security]]
