{{Stub}}
{{InfoBox stack
|{{InfoBox gdoc|Portage|header=true}}
|{{InfoBox wikipedia|Portage (software)}}
|{{InfoBox gitweb|portage.git}}
|{{InfoBox github|gentoo/portage}}
}}

Portage is the [[Wikipedia:Package management system|package management]] and [https://www.gentoo.org/get-started/about/ distribution system] for Gentoo. It essentially functions as the heart of Gentoo-based operating systems. Portage includes many commands for repository and package management, the primary of which is the [[#Emerge|{{c|emerge}}]] command.

__TOC__

== Installation ==

All Gentoo installations come with Portage. Like all data, there is a possibility Portage can become corrupted or even uninstalled, which is ''very'' bad. If this is the case there ''are'' ways Portage can be recovered, however Portage re-installation can be quite the hassle. It becomes a work of manual labor: installing a package manager without a package manager.

=== Binary package ===

Have a friend or a build server build a Portage binary package, then boot a recovery disk and transfer the binary package to the broken machine. This could be done using the <code>buildpkg</code> Portage feature on a healthy machine or by using the {{c|quickpkg}} command (see the [[binary package guide]]). Portage will be needed in to order to install the binary package, however it is possible to run something off a virtual machine:

#Boot up a LiveDVD/CD that has Portage included ([http://get.gentoo.org/ Gentoo LiveDVDs] or [http://www.sysresccd.org/ SystemRescueCD] should contain Portage). Remove the old or broken Portage and reinstall install Portage to the mounted root filesystem (potentially the fastest and easiest option in the case of a fast internet connection and available CDs/DVDs). For example, if the root file system with broken Portage was mounted at {{Path|/mnt/gentoo}} the following commands could be used from a live environment.
## Change all of Portage's relevant environment variables to be set to the Portage directory of the mounted root filesystem. If the broken Portage root directory is mounted at {{Path|/mnt/gentoo}}, the command would look like this: {{RootCmd|DISTDIR{{=}}"/mnt/gentoo/usr/portage/distfiles" PKGDIR{{=}}"/mnt/gentoo/usr/portage/packages" PORTAGE_CONFIGROOT{{=}}"/mnt/gentoo/" PORTAGE_TMPDIR{{=}}"/mnt/gentoo/var/tmp" PORTDIR{{=}}"/mnt/gentoo/usr/portage"}}
##Run the {{c|emerge}} command in order to remove any traces of the old broken Portage package: {{Emerge|params+=--unmerge|sys-apps/portage}}
##Sync the Portage Tree in case the system is a bit behind on the current Portage tree: {{RootCmd|emerge --sync}}
##Install the new version of Portage: {{Emerge|params+=--update --newuse|sys-apps/portage}}

=== Tarball ===

Manually download a copy of a [https://github.com/gentoo/portage/releases recent Portage release tarball], extract it, and manually install it:

{{Cmd
|wget https://github.com/gentoo/portage/archive/v2.2.22.tar.gz -O portage-2.2.22.tar.gz
|tar --extract --gz --verbose --file portage-2.2.22.tar.gz
|cd portage-2.2.22
}}

Install via {{Path|setup.py}}:

{{RootCmd|python setup.py install}}

If they do not exist, add the following lines into the following files:

{{RootCmd
|echo "portage:x:250:250:portage:/var/tmp/portage:/bin/false" >> /etc/passwd
|echo "portage::250:portage" >> /etc/group
}}

Create the {{Path|/usr/portage}} directory if it does not exist:

{{RootCmd|mkdir /usr/portage}}

=== Updating ===

In order for Gentoo to stay up to date, Portage must stay up to date. If the following message is visible after an {{c|emerge --sync}}, it is important to do what the text says before updating other packages.

{{CodeBox|title=Portage update message|lang=text|1=
* An update to portage is available. It is _highly_ recommended
* that you update portage now, before any other packages are updated.

* To update portage, run 'emerge --oneshot portage' now.
}}

{{Emerge|params+=--oneshot|sys-apps/portage}}

This will tell Portage to exclusively update itself. After Portage has been updated, users can then update other packages.

== Configuration ==

=== Files ===

There are many files used to configure Portage.

See [[:/etc/portage]] configuration files for an exhaustive list of configuration files.

=== Environment variables ===

Portage pays attention to some environment variables:

{{WIP|author=maffblaster}}

=== Overlays ===

In addition to the [https://gitweb.gentoo.org/repo/gentoo.git/tree/ official repository] (colloquially known as the "Portage Tree" because of its traditional placement in {{Path|[[:/usr/portage]]/}}), there are additional repositories which in Gentoo called [[overlay|overlays]].

* [[Project:Overlays/User_Guide|Users' guide to Gentoo overlays]]
* [http://layman.sourceforge.net/ Layman homepage]
* [http://gpo.zugaina.org/ Browse overlays]

It is possible to search through the ebuilds available in the overlays on http://overlays.gentoo.org/ by using the [[eix]] tool.

=== GUI front-ends ===

There are a few GUI interfaces that exist for Portage, although some of them have become unmaintained.

{| class="table"
|-
! Name !! Package !! Homepage !! Maintained? !! Description
|-
| {{c|[[kport]]}} || Unavailable || http://kport.sourceforge.net/ || No || A GUI frontend for the Portage package management system.
|-
| {{c|[[kuroo]]}} || {{Package|app-portage/kuroo4}} || http://sourceforge.net/projects/kuroo/ || Yes || Graphical Portage frontend based on KDE4/Qt4.
|-
| {{c|[[porthole]]}} || {{Package|app-portage/porthole}} || http://porthole.sourceforge.net/ || Yes || A GTK+-based frontend to Portage.
|}

== Usage ==

=== archive-conf ===

=== dispatch-conf ===

=== ebuild ===

See the [[ebuild]] article.

=== egencache ===

See the [[egencache]] article for additional information.

=== emaint ===

See [[Project:Portage/Sync#Operation]] and <kbd>man 1 emaint</kbd>.

=== emerge ===

{{c|emerge}} is the command-line interface to Portage and is how most users will interact with Portage. The {{c|emerge}} command has ''many'' possible options. For a complete list of all options see its man page:

{{Cmd|man emerge}}

Below is an exemplary invocation of {{c|emerge}}. The options (<code>-atv</code>) are shortcuts for <code>--ask</code>, <code>--tree</code> and <code>--verbose</code>. They trigger {{c|emerge}} to ask before proceeding, display the dependency tree of packages to be installed, and to be verbose with its output. While in the context of Portage, the term "package" can also be referred to as an "atom." Do not be confused if you see the term "atom" used instead of the term "package."

{{emerge-legend}}

==== Common invocations ====

Search for packages with ''proxy'' in their names:

{{Cmd|emerge --search proxy}}

Search for packages with ''proxy'' in their names or description:

{{Cmd|emerge --searchdesc proxy}}

Install the {{Package|net-proxy/tinyproxy}} package with <code>--ask</code> and <code>--verbose</code> options for precaution:

{{RootCmd|emerge --ask --verbose net-proxy/tinyproxy}}

Remove the {{Package|net-proxy/tinyproxy}} package using the dependency sensitive <code>--depclean</code> option instead of <code>--unmerge</code> which may remove important packages:

{{RootCmd|emerge --ask --verbose --depclean net-proxy/tinyproxy}}

=== emerge-webrsync ===

=== emirrordist ===

=== env-update ===

=== etc-update ===

=== fixpackages ===

=== regenworld ===

=== portageq ===

=== quickpkg ===

See the [[Binary package guide]] for more information.

=== repoman ===

See the [[repoman]] article for additional information.

== See also ==

'''Alternate package managers:'''

* [[Paludis]] - An alternative package manager written expressly for Gentoo-based systems.
* [[Pkgcore]] - A framework for package management, mostly compatible with Gentoo
* {{Package|app-arch/dpkg}} - A package manager for Debian based systems.
* {{Package|sys-apps/yum}} - The package manager for RPM systems that also can be used on Gentoo.

'''Related to Portage:'''

* [[GCC optimization]]
* [[Portage tips]]
* [[Repository format]]
* [[Package Manager Specification]]
* [[Overlay]]
* [[:Category:Portage]]
* [[Gentoolkit]]

'''Portage in the Gentoo AMD64 Handbook:'''

* [[Handbook:AMD64/Working/Portage|A Portage introduction]]
* [[Handbook:AMD64/Working/USE|USE flags]]
* [[Handbook:AMD64/Working/Features|Portage features]]
* [[Handbook:AMD64/Portage/Files|Files and directories]]
* [[Handbook:AMD64/Portage/Variables|Configuring through variables]]
* [[Handbook:AMD64/Portage/Branches|Mixing software branches]]
* [[Handbook:AMD64/Portage/Tools|Additional Portage tools]]
* [[Handbook:AMD64/Portage/CustomTree|Custom Portage tree]]
* [[Handbook:AMD64/Portage/Advanced|Advanced Portage features]]

'''Portage tools'''

* [[Useful Portage tools|Portage tool list]]

[[Category:Portage]]
