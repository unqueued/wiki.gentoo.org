<languages />


{{InfoBox stack
|{{InfoBox github|fluxbox/fluxbox|header=true}}
|{{InfoBox homepage|http://fluxbox.org/}}
|{{InfoBox wikipedia}}
}}

{{Metadata|abstract=В этой статье описаны инструкции по установке оконного менеджера Fluxbox.}}

'''Fluxbox''' is [[Article description::an open-source stacking [[window manager]] for [[X11]] that was originally forked from [[Blackbox]].]] This guide provides instructions on how to set up the Fluxbox window manager for X11.

== Введение ==

Для тех кто не знаком с концепцией графических окружений Linux, оконные менеджеры (WMs) - приложения которые запускаются графическим сервером X11 для управления другими графическими приложениями. WM контролирует следующее: где расположено каждое окно, его размеры и на каком рабочем столе оно находится. Это может быть сделано автоматически через набор пользовательских правил или же вручную с помощью мыши или же горячих клавиш на клавиатуре. 

Однако некоторые WM предоставляют больший функционал нежели простой оконный менеджер.В добавок к основному функционалу WM Fluxbox также предоставляет платформу для запуска приложений, настройки горячих клавиш и фоновых изображений. Базовый WM окружения GNOME - Metacity не обладает данным функционалом, однако это корректируется дополнительными приложениями окружения GNOME. Таким образом нельзя сказать, что Fluxbox - легковесная WM. Однако, так как Fluxbox содержит всё необходимое для базового рабочего стола, многие люди используют его вместо больших и тяжёлых [[GNOME]] или [[KDE/ru|KDE]]

Fluxbox также может быть использован как стандартный WM для GNOME или KDE. Например, некоторые люди находят, что Metacity, оконный менеджер окружения GNOME, недостаточно гибок для их нужд, однако Fluxbox не имеет всех встроенных приложений и интеграций, которыми они хотят пользоваться. Поэтому они устанавливают Fluxbox в качестве стандартного оконного менеджера GNOME. Заметим, что при наборе Fluxbox+GNOME могут происходить некоторые эксцессы в связи с перекрыванием возможностей. 

Fluxbox также может быть расширен сторонними программами. Данную методику применяют в ситуациях ограниченности "железных" ресурсов или же по желанию пользователя. 

Эта статья нацелена на новичков в Fluxbox, любопытных людей, а также просто для тех, кто хочет получить опыт в Gentoo/Fluxbox. Статья также показывает, как добиться (при желании) большего функционала при использовании сторонних программ, которые хорошо работают в Fluxbox.

== Установка ==

Сначала, убедитесь в работоспособности установленного X окружения, как показано в статье по [[Xorg/Guide/ru|конфигурации X-сервера]].

=== USE-флаги ===

{{USEflag|package=x11-wm/fluxbox}}

Перед установкой Fluxbox давайте разберёмся в некоторых доступных USE-флагах (описанных ранее). 

Если есть <code>gnome</code> или <code>kde</code> USE-флаг, то Fluxbox будет совместим с данными графическими окружениями. Если необходимы qt, gtk+ или любая другая KDE/GNOME утилита, устанавливайте и настраивайте их отдельно. Флаги <code>gnome</code> или <code>kde</code> просто добавляют поддержку  соответствующих протоколов и не зависят от внешних библиотек. Однако данные флаги увеличивают размер бинарных файлов Fluxbox 

Также есть флаг <code>vim-syntax</code>, который облегчит настройку позже. Этот флаг установит <code>fluxbox-syntax</code> - специальную цветовую схему для текстового редактора {{c|vim}}. Это сделает тексты настроек более читаемыми. Это крошечное дополнение для vim крайне рекомендуется, если вы собираетесь корректировать настройки Fluxbox. 

В конечном итоге, Fluxbox имеет три флага функционала(кастомизации): <code>slit</code>, <code>systray</code> and <code>toolbar</code>. 
Эти флаги предоставляются так, что если пользователю не нужен [http://old.fluxbox-wiki.org/index.php?title=Faqs#What_is_the_slit slit] или [http://fluxbox.org/features/ toolbar], то можно скомпилировать Fluxbox без них. Это полезно, если необходимо запустить максимально облегчённое окружение или если планируются использоваться другие приложения предоставляющие данный функционал. 

Когда определитесь с необходимым набором USE-флагов добавьте их в файл {{Path|/etc/portage/package.use}}. Например, следующая команда настроит Fluxbox для использования с <code>truetype</code> и <code>vim-syntax</code>, но не будет поддерживать GNOME или KDE.

{{RootCmd|echo "x11-wm/fluxbox -gnome -kde truetype vim-syntax" >> /etc/portage/package.use}}

=== Emerge ===

Чтобы воспользоваться Fluxbox необходимо установить его:

{{Emerge|x11-wm/fluxbox}}

Fluxbox установлен! Однако самого Fluxbox часто недостаточно для нормальной работы. Следующие разделы помогут установить другие полезные пакеты и настроить Fluxbox и сторонние приложения для лучшей работы во благо пользователя. Помните, что все эти разделы опциональны, так что не стесняйтесь использовать только те, которые наиболее подходят.

== Настройка ==

=== Подготовка X11 ===

Fluxbox - просто программа запускающаяся на X11. По желанию можно запустить X11, выполнив {{c|startx}} и потом в {{c|xterm}} набрать {{c|fluxbox}}. Однако это как минимум скучно делать при каждом запуске. Если вы желаете запускать X11 вручную, то можно добавить Fluxbox в автозагрузку X11, выполнив следующую команду от обычного пользователя. 

{{Cmd|echo "exec startfluxbox" > ~/.xinitrc}}

Данный метод не подходит для большинства пользователей. Вы может быть не хотите каждый раз вводить {{c|startx}} при загрузки системы для запуска X11. Также это небезопасно. Например, система заблокировалась с помощью {{c|xlock}}, однако X11 запущены были из консоли. Тогда тот, кто имеет физический доступ к системе, может переключиться в консоль, убить X11 и использовать любой аккаунт, который на данный момент вошел в систему. Единственный вариант предотвратить это, запускать X11 в фоне или в {{c|screen}}, отсоединять сессию {{c|screen}}, и только потом выполнять выход из системы. Что весьма утомительно и совсем не нужно этого делать. При использовании графических менеджеров входа такой проблемы не возникает. Тем не менее, графические менеджеры входа требуют запуска X11 от root, что может быть плохо. На момент написания статьи нет ни одного эксплоита, который известен автору статьи, но если кто-то знаком с таким, то не используйте X11 вообще, либо используйте вышеописанный метод с {{c|screen}}. Также обратите внимание, что это не проблема Fluxbox; это проблема с самим X11. 

Существует множество графических менеджеров входа, из которых можно выбрать любой, на предпочтение пользователя. В данной статье показан пример с использованием менеджера  [http://slim.berlios.de SLIM]. SLIM работает довольно хорошо как с Fluxbox, так и с любым другим графическим окружением. 

{{Emerge|x11-misc/slim}}

{{RootCmd|rc-update add xdm default}}

{{Important|Устанавите {{c|slim}} и добавьте '''xdm''' в скрипт загрузки, и никак иначе. Изменения здесь могут привести к ошибкам и крахам системы. Также надо изменить конфигурационный файл следующим образом:}}

{{FileBox|filename=/etc/conf.d/xdm|title=Настройка SLiM в качестве менеджера входа|lang=bash|1=
DISPLAYMANAGER="slim"
}}

=== Блокировка экрана ===

Когда работаешь с WM, необходимо иметь утилиту блокировки X для предотвращения неавторизированного доступа к системе. Для этого рекомендуется использовать утилиту {{Package|x11-misc/xlockmore}}. Она также рекомендуется для включения автоматической блокировки, когда система простаивает. Пакет {{Package|x11-misc/xautolock}} может быть использован для выполнения команды {{c|xlock}} после определенного перерыва. Вы скорее всего захотите выставить своё фоновое изображение на рабочий стол. Установленный {{Package|x11-terms/eterm}} даёт вам эту возможность. Также он предоставляет вам неплохой (с точки зрения автора статьи) терминал {{c|eterm}}. Для выставления фона можно использовать другую утилиту - {{Package|media-gfx/feh}}. Она более легковесная нежели {{c|eterm}}, однако не предоставляет терминал, и функционал {{c|feh}} более скромный.

{{Emerge|x11-misc/xlockmore x11-misc/xautolock x11-terms/eterm media-gfx/feh}}

Для включения автоблокировки в файл {{Path|~/.fluxbox/startup}} перед строкой <code>exec fluxbox</code> добавьте следующее:

{{FileBox|filename=~/.fluxbox/startup|
xautolock -time 15 -locker "xlock -mode blank" -secure &
}}

=== Темы и оформление ===

Эта секция может быть пропущена из соображений минимализма, однако почему бы не разрешить пользователю изменить внешний вид Fluxbox темами, заточеными под Fluxbox, изображениями Gentoo для любой WM и темами в любом *box окружении: 

{{Emerge|x11-themes/commonbox-styles x11-themes/commonbox-styles-extra x11-themes/fluxbox-styles-fluxmod x11-themes/gentoo-artwork}}

=== Первый запуск Fluxbox ===

Теперь Fluxbox готов для первого запуска. Он автоматически создаст директорию {{Path|~/.fluxbox/}} в каждом домашнем каталоге пользователей, где будет хранить настройки и некоторые стандартные значения. 

{{Cmd|startx}}

Если SLIM или любой другой менеджер входа установлен, запустите от рута данную команду, чтобы убедиться в работоспособности: 

{{RootCmd|/etc/init.d/xdm start}}

Выберите Fluxbox в качестве сессии и войдите обычным пользователем. 

Когда Fluxbox запущен, он выглядит очень просто. 	
Пустой рабочий стол с панелью инструментов внизу. При правом клике мыши где угодно на экране появится меню. Из него можно запускать графические приложения и терминал для запуска консольных приложений 

=== Горячие клавиши в Fluxbox ===

По умолчанию в Fluxbox очень мало горячих клавиш. Есть наборы для переключения окон, рабочих столов и не более. Перед изменением этого набора вам стоит знать следующее: В файле Fluxbox комбинаций очень странные наименования. <kbd>Mod1</kbd> - {{Key|Alt}}, <kbd>Mod4</kbd> - {{Key|Super}} (клавиша Windows). Ctrl и Shift - {{Key|Ctrl}} и {{Key|Shift}}. Однако обычно лучше создавать комбинации, основываясь на клавишах Mod1 или Mod4, так как другие программы X11 могут использовать Ctrl и Shift для своих комбинаций горячих клавиш. 

Все сочетания клавиш независимы друг от друга, так что можете их менять по собственному усмотрению. В этой статье используются (по мнению автора) наиболее популярные программы, так что не просто меняйте названия программы, если у вас другие предпочтения. Для большей информации читайте man-страницу Fluxbox:
({{c|man fluxbox}}). 

Можно также изменить горячие клавиши fluxbox. Для этого в текстовом редакторе (не от рута/суперпользователя) откройте файл {{Path|~/.fluxbox/keys}} и начинайте правки на ваш вкус. 

{{FileBox|filename=~/.fluxbox/keys|title=Изменение горячих клавиш|1=
# Блокировка экрана:
Mod4 l   :ExecCommand xlock

# Открытие приложений горячими клавишами
Mod1 f   :ExecCommand firefox
Mod1 t   :ExecCommand thunderbird
Mod1 o   :ExecCommand oowriter
Mod1 v   :ExecCommand gvim

# У Fluxbox нет регулировки громкости; сделаем хак, чтобы было
# (подразумевается что используется alsa; удачи с oss :P )
Mod1 e   :ExecCommand Eterm -name alsa -e alsamixer

# Запускает fbrun, который в свою очередь запускает другие
# программы:
Mod1 r   :ExecCommand fbrun

# Управление программами
Mod1 4   :Close
Mod1 m   :Minimize
  
# Если используется aterm (emerge x11-terms/aterm), Следующая команда открывает приятный
# прозрачный aterm без рамок, подогнанный под 1024x768
# разрешение, Оставляя комнату свободной для conky. 
Mod1 a   :ExecCommand aterm -name aterm -sl 3000 -tr +sb -sr -sk -bg black -fg \
white -fade 90 -bl -tn xterm -fn \
-misc-fixed-medium-r-normal-*-*-120-*-*-c-*-iso8859-15 -g 116x57
  
# То же самое только с рутовым терминалом.
# рутовый пароль должен быть известен для этого:
Mod1 s   :ExecCommand aterm -name aterm -sl 3000 -tr +sb -sr -sk -bg black -fg \
white -fade 90 -bl -tn xterm -fn \
-misc-fixed-medium-r-normal-*-*-120-*-*-c-*-iso8859-15 -g 116x57 -e su -
  
# Создание скриншота по нажатию на print кнопки; нужно установить media-gfx/imagemagick
None 107 :Exec tm=$(date +%F,%T) && import -window root /tmp/screenshot$tm.png \
&& display /tmp/screenshot$tm.png
Mod1 107 :Exec tm=$(date +%F,%T) && import -frame -window $(xprop _NET_ACTIVE_WINDOW \
-root {{!}} awk '{print $5}') /tmp/screenshot$tm.png && display /tmp/screenshot$tm.png
}}

=== Системный мониторинг ===

Часто приходит желание установить графический системный мониторинг. Gkrellm ({{Package|app-admin/gkrellm}})  - наиболее часто используемый монитор, однако для сохранения духа минимализма Fluxbox простой монитор будет использован. И это будут {{c|conky}}. Если пожелаете, можете установить любой другой монитор на ваш выбор; На Wiki достаточно инструкций для них. 

{{Emerge|app-admin/conky}}

Стандатный файл конфигураций для conky слабоват, однако дополнительная информация может быль найдена в man страничке или в статье [[Conky/Guide|руководства по Conky]].

=== Иконки ===

Fluxbox по умолчанию не поставляется с утилитой отрисовки иконок на рабочем столе. Всё здесь завязано на использовании горячих клавиш или же меню, вызываемого правым нажатием мыши. iDesk - программа, которая может выполнять функцию отрисовки. Оно рассчитано на пользователей минималистичных оконных менеджеров, таких как fluxbox, чтобы отрисовывать иконки на главном окне и даже поддерживать обалденные эффекты, такие как прозрачность! Не смотря на название, iDesk никак не связан с Apple или Mac. Установка iDesk крайне проста: 

{{Emerge|x11-misc/idesk}}

После установки iDesk его необходимо настроить для отображения иконок. Файл настройки может быть найден как {{Path|~/.ideskrc}}. Это достаточно длительный процесс, и он может быть не полностью раскрытым в этой статье. Следующие источники могут быть полезны для настройки iDesk: {{c|man idesk}}, [http://idesk.sourceforge.net/wiki/index.php/Idesk-usage Пользовательское руководство iDesk] и [https://forums.gentoo.org/viewtopic-t-87262.html форум Gentoo].

=== Графический файловый менеджер ===

Важно взять на заметку, что Gentoo не нужен файловый менеджер. Вполне возможно, и в самом деле просто (по скромному мнению автора), осуществлять файловые манипуляции из командной строки. Тем не менее, не все согласны...

Многих новичков в Gentoo/Fluxbox отпугивает отсутствие графического файлового менеджера, как, например, {{c|nautilus}} в GNOME. Сам Fluxbox не содержит такой программы, но, как всегда, получить такую просто. Существует богатый выбор, но эта статья представляет три:

# [[#Gentoo File Manager|Gentoo file manager]] for the minimalist who likes text only.
# [[#Rox Filer|rox]] for those who like text ''and'' graphics.
# [[#Thunar File Manager|thunar]] for those who like full graphical file managers.

For those who are not sure what they like, it is also possible to install all three file managers in order to try each one.

==== файловый менеджер gentoo  ====

Gentoo - минималистический файловый менеджер, который предоставляет преимущества графического интерфейса, но без дополнительного балласта огромных менеджеров. 

{{Emerge|app-misc/gentoo}}

{{Note|Файловый менеджер Gentoo - это отдельный проект от Gentoo Linux. Для большей информации, см. Gentoo [http://www.gentoo.org/main/en/name-logo.xml#doc_chap4 Name and Logo Usage Guidelines].}}

Файловый менеджер Gentoo стремится быть полностью настраиваемым через графический интерфейс, так что не стесняйтесь персонализировать.

==== Файловый менеджер Rox Filer ====

Rox Filer - файловый менеджер, который использует как иконки, так и текст и очень сильно похож на старый проводник из Windows 

{{Emerge|app-misc/rox-filer}}

Rox работает как "традиционный" файловый менеджер, так что его интерфейс должен быть интуитивным. Если нет, всегда есть страницы с руководствами для детальной информации.

==== Файловый менеджер thunar ====

[http://thunar.xfce.org/ Thunar] легковесный, быстрый файловый менеджер, как и Rox, работает как "традиционный". Он включает иконки и текст, прост в использовании. Хотя Thunar разработан для [http://www.xfce.org Xfce], он приятно дополнит систему на базе Fluxbox. 

{{Emerge|xfce-base/thunar}}

=== Утилиты просмотра изображений ===

Многие оконные менеджеры содержат утилиты для просмотра изображений в директории. Эти утилиты невелики и легковесны, и не позволяют редактировать (для этого предполагаются инструменты вроде {{c|gimp}}). Это необходимо при использовании командной строки, {{c|gentoo}}, или {{c|rox}}. Несмотря на то, что в {{c|thunar}} есть предпросмотр, наличие отдельного легковесного просмотрщика является хорошей идеей. 

{{Emerge|media-gfx/gqview}}

{{c|gqview}} может быть запущен в любой директории и просматривать там изображения всех поддерживаемых форматов. 

=== Выставление темы, фона и автостартовых скриптов ===

Fluxbox имеет целый ряд тем, доступных через контекстное меню. Откройте {{Path|Fluxbox menu}} → {{Path|System Styles}}. Эти темы обычно устанавливают свои собственные фоновые изображения, или монотонный цвет, или различного типа градиент. Большинство пользователей предпочтет установить свой собственный фон, но фон не сохраняется несмотря на выбранную тему. Чтобы сделать это, другой файл Fluxbox должен быть изменен, тот, который регулирует поведение Fluxbox при запуске. Снова запустите текстовый редактор, на это раз указав ему на {{Path|~/.fluxbox/startup}}.

Если этот файл существует, убедитесь в том, что он пустой. Добавьте следующую строку в только что созданный файл, удаляя по мере необходимости, и подставляя значения для CAPS:

{{FileBox|filename=~/.fluxbox/startup|title=Редактирование стартовых скриптов Fluxbox|lang=bash|1=
# Gentoo's Fluxbox startup script
  
# Программы, которым нужно быть запущенными постоянно, в противоположность единожды выполняемым программам,
# это подразумевает указание "&" (амперсанд) в конце команды.
  
# Fluxbox splash-screen
#fbsetbg -C /usr/share/fluxbox/splash.jpg
  
# Установка фонового изображения. Для этого программа должна быть настроена
# (рекомендуется x11-terms/eterm)
#fbsetbg -f PATH_TO_IMAGE
  
# Пользовательские шрифты
#xset +fp PATH_TO_FONT_DIRECTORY
  
# Запуск программы для отображения иконок
#idesk &
  
# Это ДОЛЖНА быть последняя команда!
exec /usr/bin/fluxbox -log ~/.fluxbox/log
}}

=== Enabling privileged operations through polkit ===

Fluxbox is able to communicate with core system services over [[D-Bus]] to allow privileged operations, such as shutting down the system. To handle the authorizations towards these operations, [[polkit]] (formerly known as policykit) can be used.

In order to use polkit, an agent is required. There are several polkit agents available and if a desktop profile is used, one of them will already be installed. Their respective startup files are stored in {{Path|/etc/xdg/autostart}} but are not considered by fluxbox. Instead, an additional entry should be made to fluxbox' {{Path|startup}} file:

{{FileBox|filename=~/.fluxbox/startup|title=Запуск агента аутентификации polkit во время загрузки|1=
/usr/libexec/polkit-gnome-authentication-agent-1 &
}}

=== Создание меню ===

Автор использует текстовый редактор для создания меню. Если это вам показалось интересным и умиляющим, то пропустите эту секцию и переходите сразу к [[#Редактирование меню вручную|Редактирование меню вручную]]. 

Возможно редактировать {{Path|~/.fluxbox/menu}} вручную после использования автоматического генератора (см. следующий раздел) для добавления или удаления неиспользуемых пунктов. Учтите, когда что-то удаляется из этого меню, оно не удаляет пакет из системы; только стирается ссылка из пользовательского файла. Программа все еще может быть запущена из командной строки или альтернативными методами (горячие клавиши, и т. д.). 

Если установлен Fluxbox, значит программа {{c|fluxbox-generate_menu}} должна так же быть установлена. Эта программа может быть использована для генерации меню. Запустите ее со следующими опциями из под вашего пользователя: 

{{Cmd|fluxbox-generate_menu -is -ds}}

Рекомендуется использовать {{c|fluxbox-generate_menu}} вместо выполняющих те же задачи программ. Причина заключается в возможном непонимании этими программами Gentoo-структуры каталогов файловой системы, когда {{c|fluxbox-generate_menu}} ее поддерживает.

Это также может быть выполнено из меню Fluxbox. Как правило пункт {{Path|Regen Menu}} в {{Path|Fluxbox}} повторно запускает этот скрипт, ищет новые приложения, установленные с момента его последнего запуска. 

{{Note|Возможно использовать этот метод для авто-генерации меню и сохранять некоторый контроль над ним. Создание и изменение файла {{Path|~/.fluxbox/usermenu}} вручную (см. следующий раздел для синтаксиса) дает пользователю свое меню, которое не сотрется при следующем запуске скрипта.}}

=== Редактирование меню вручную ===

Меню Fluxbox - текстовый файл, имеющий простой синтаксис, который описан в этой секции. Обычно описание меню расположено в файле {{Path|~/.fluxbox/menu}} 

Пункты меню для исполняемых приложений определены через элемент <code>[exec]</code>. Группы меню могут быть определены через <code>[begin]</code> (корневое меню), или между <code>[submenu]</code> и соответствующей строкой <code>[end]</code> (подменю). Например: 

{{FileBox|filename=~/.fluxbox/menu|title=Определение новой записи в меню|1=
# Пользовательское меню fluxbox
[begin] (Fluxbox)
  (...)
  [exec] (XTerm White on Black) {xterm -ls -fg white -bg black}
  (...)
  [submenu] (More terminals)
    [exec] (Aterm default) {aterm}
    [exec] (Rxvt default) {rxvt}
  [end]
  (...)
[end]
}}

Определение корневого меню начинается с тэга <code>[begin]</code> и заканчивается соответствующим тэгом <code>[end]</code>. Все команды меню (здесь называемые тэгами) заключены в квадратные скобки, имена меню заключены между круглыми скобками и командами в скобках. В этом файле разрешены комментарии для строк, начинающихся с <code>#</code>. 

В показанном выше примере, первая строка <code>[exec]</code> определяет новую запись, названную "XTerm White on Black", которая исполняет {{c|xterm -ls -fg white -bg black}} как будто из командной строки. Следующим идет подменю, которое определено через тэг <code>[submenu]</code>, и затем идет раздел, названный "More terminals", с еще двумя <code>[exec]</code> командами. Любое определение подменю должно иметь соответствующий тэг <code>[end]</code>. 

Могут быть использованы другие команды для меню. Для более подробной информации прочитайте [http://fluxbox.org/docbook.php официальную документацию] 

=== Выбор стандартных приложений ===

Смотрите [[DefaultApplication]].

== Использование ==

Resize a window by left clicking the tiny window-corner re-sizing tools and drag them around, or hold down the {{key|Mod1}} key and right click somewhere near a border, then drag the mouse.

== Обобщение ==

Поздравляем! Fluxbox установлен, настроен и готов к работе. Если появились некоторые вопросы или дополнительные идеи, то не стесняйтесь отредактировать эту страницу, добавить предложение в соответствующую страницу обсуждения, и/или уведомить о багах на [https://bugs.gentoo.org/ Bugzilla]

== Ссылки == 

* [http://fluxbox-wiki.org Fluxbox wiki].
* Fluxbox разработчики и пользователи в {{IRC|fluxbox}} на Freenode.net.


[[Category:Window manager]] {{Migrated|originalauthors=Jonathan Smith, Alin Dobre, Joshua Saddler, lack}}
