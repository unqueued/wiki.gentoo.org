<languages />


{{Metadata|abstract=В этой статье описаны инструкции по установке оконного менеджера Fluxbox.}}

В этой статье описаны инструкции по установке оконного менеджера Fluxbox.

== Введение ==

=== Общая информация о Fluxbox ===

Для тех кто не знаком с концепцией графических окружений Linux, оконные менеджеры (WMs) - приложения которые запускаются графическим сервером X11 для управления другими графическими приложениями. WM контролирует следующее: где расположено каждое окно, его размеры и на каком рабочем столе оно находится. Это может быть сделано автоматически через набор пользовательских правил или же вручную с помощью мыши или же горячих клавиш на клавиатуре. 

Однако некоторые WM предоставляют больший функционал нежели простой оконный менеджер.В добавок к основному функционалу WM Fluxbox также предоставляет платформу для запуска приложений, настройки горячих клавиш и фоновых изображений. Базовый WM окружения GNOME - Metacity не обладает данным функционалом, однако это корректируется дополнительными приложениями окружения GNOME. Таким образом нельзя сказать, что Fluxbox - легковесная WM. Однако, так как Fluxbox содержит всё необходимое для базового рабочего стола, многие люди используют его вместо больших и тяжёлых [[GNOME]] или [[KDE]]

Fluxbox также может быть использован как стандартный WM для GNOME или KDE. Например, некоторые люди находят, что Metacity, оконный менеджер окружения GNOME недостаточно гибок для их нужд, однако Fluxbox не имеет всех встроенных приложений и интеграций, которыми они хотят пользоваться. Поэтому они устанавливают Fluxbox в качестве стандартного оконного менеджера GNOME. Замечу, что при наборе Fluxbox+GNOME могут происходить некоторые эксцессы в связи с перекрыванием возможностей. 

Fluxbox также может быть расширен сторонними программами. Данную методику применяют в ситуациях ограниченности "железных" ресурсов или же по желанию пользователя 

Эта статья нацелена на новичков в Fluxbox, а также просто любопытных людей. Статья также показывает, как добиться (при желании) большего функционала при использовании сторонних программ в Fluxbox 

== Установка ==

Сначала, убедитесь в работоспособности установленного X окружения, как показано в данной статье [https://wiki.gentoo.org/wiki/Xorg/Guide X Server's configuration article].

=== Флаги ===

{{USEflag|package=x11-wm/fluxbox|desc=Необязательные флаги для {{Package|x11-wm/fluxbox}}:
|bidi
|imlib+yes+yes
|nls+yes
|slit+yes
|systray+yes+yes+ Добавляет системный трей в Fluxbox панель
|toolbar+yes+yes
|truetype+yes+yes
|vim-syntax++yes
|xinerama
}}

=== Специальные инструкции ===

Перед установкой Fluxbox давайте разберёмся в некоторых доступных USE флагах описанных ранее. 

Если есть <code>gnome</code> или <code>kde</code> USE флаг, то Fluxbox будет совместим с данными графическими окружениями. 
Если вам необходимы qt, gtk+ или любая другая KDE/GNOME утилита, устанавливайте и настраивайте их отдельно. 
Флаги <code>gnome</code> или <code>kde</code> просто добавляют поддержку  соответствующих протоколов и не зависят от внешних библиотек. Однако данные флаги увеличивают размер бинарных файлов Fluxbox 

Также есть флаг <code>vim-syntax</code>, который облегчит настройку позже. Этот флаг установит <code>fluxbox-syntax</code> - специальную цветовую схему для текстового редактора <tt>vim</tt>. Это сделает тексты настроек более читаемыми. Это крошечное дополнение для vim крайне рекомендуется, если вы собираетесь корректировать настройки Fluxbox 

В конечном итоге, Fluxbox имеет три флага функционала(кастомизации): <code>slit</code>, <code>systray</code> and <code>toolbar</code>. 
Эти флаги предоставляются так, что если пользователю не нужен [http://old.fluxbox-wiki.org/index.php?title=Faqs#What_is_the_slit slit] или [http://fluxbox.org/features/ toolbar], то можно скомпилировать Fluxbox без них. Это полезно, если необходимо запустить максимально облегчённое окружение или если планируются использоваться другие приложения предоставляющие данный функционал. 

Когда определитесь с необходимым набором USE флагов добавьте их в файл {{Path|/etc/portage/package.use}}. Например, следующая команда задаст флаги Fluxbox  <code>truetype</code> и <code>vim-syntax</code> но не будет поддерживать GNOME или KDE.

{{RootCmd|echo "x11-wm/fluxbox -gnome -kde truetype vim-syntax" >> /etc/portage/package.use}}

Когда работаешь с WM, необходимо иметь утилиту блокировки X для предотвращения неавторизированного доступа к системе. Для этого рекомендуется использовать утилиту {{Package|x11-misc/xlockmore}}. Вы скорее всего захотите выставить своё фоновое изображение на рабочий стол. Установленный {{Package|x11-terms/eterm}} даёт вам эту возможность. Также он предоставляет вам неплохой (с точки зрения автора статьи) терминал <tt>eterm</tt>. Для выставления фона можно использовать другую утилиту - {{Package|media-gfx/feh}}. Она более легковесная нежели <tt>eterm</tt>, однако не предоставляет терминал, и функционал <tt>feh</tt> более скромный.

{{Emerge|x11-misc/xlockmore x11-terms/eterm media-gfx/feh}}

=== Установка ===

{{Emerge|x11-wm/fluxbox}}

Fluxbox установлен! Однако самого Fluxbox часто недостаточно для нормальной работы. Следующие разделы помогут установить другие полезные пакеты и настроить Fluxbox и сторонние приложения для лучшей работы во благо пользователя =D
Помните, что все эти разделы опциональны, и вы можете спокойно их игнорировать.

== Настройка Fluxbox ==

=== Подготовка X11 ===

Fluxbox - просто программа запускающаяся на X11. По желанию можно запустить X11, выполнив <tt>startx</tt> и потом в <tt>xterm</tt> набрать <tt>fluxbox</tt>. Однако это каак минимум скучно делать при каждом запуске. Если вы желаете запускать X11 вручную, то можно добавить Fluxbox в автозагрузку X11, выполнив следующую команду от обычного пользователя. 

{{Cmd|echo "exec startfluxbox" > ~/.xinitrc}}

Данный метод не подходит для большинства пользователей. Вы может быть не хотите каждый раз вводить <tt>startx</tt> при загрузки системы для запуска X11. Также это небезопасно. Например, система заблокировалась с помощью <tt>xlock</tt>, однако X11 запущены были из консоли. Тогда тот, кто имеет физический доступ до системы, может переключиться в ту консоль, отключить X11 и запустить X11 вновь, но уже без блокировки. При использовании графических менеджеров входа такой проблемы не возникает. 

Существует множество графических менеджеров входа, из которых можно выбрать любой, на предпочтение пользователя. В данной статье показан пример с использованием менеджера SLIM. SLIM работает довольно хорошо как с Fluxbox, так и с любым другим графическим окружением. 

{{Emerge|x11-misc/slim}}

{{RootCmd|rc-update add xdm default}}

{{Important|Устанавите <tt>slim</tt> и добавьте "xdm" в скрипт загрузки, и никак иначе. Изменения здесь могут привести к ошибкам и крахам системы. Также надо изменить конфигурационный файл следующим образом:}}

{{FileBox|filename=/etc/conf.d/xdm|title=Выставление SLiM стандартным менеджером входа |lang=bash|1=
DISPLAYMANAGER="slim"
}}

=== Темы и оформление ===

Эта секция может быть пропущена из соображений минимализма, однако почему бы не разрешить пользователю изменить внешний вид Fluxbox темами, заточеными под Fluxbox, изображениями Gentoo для любой WM и темами в любом *box окружении: 

{{Emerge|x11-themes/commonbox-styles x11-themes/commonbox-styles-extra x11-themes/fluxbox-styles-fluxmod x11-themes/gentoo-artwork}}

=== Первый запуск Fluxbox ===

Теперь Fluxbox готов для первого запуска. Он автоматически создаст директорию {{Path|~/.fluxbox/}} в каждом домашнем каталоге пользователей, где будет хранить настройки и некоторые стандартные значения. 

{{Cmd|startx}}

Если SLIM или любой другой менеджер входа установлен, запустите от рута данную команду, чтобы убедиться в работоспособности: 

{{RootCmd|/etc/init.d/xdm start}}

Выберите Fluxbox в качестве сессии и войдите обычным пользователем. 

Когда Fluxbox запущен, он выглядит очень просто. 	
Пустой рабочий стол с панелью инструментов внизу. При правом клике мыши где угодно на экране появится меню. Из него можно запускать графические приложения и терминал для запуска консольных приложений 

=== Горячие клавиши ===

По умолчанию в Fluxbox очень мало горячих клавиш. Есть наборы для переключения окон, рабочих столов и не более. Перед изменением этого набора вам стоит знать следующее: В файле Fluxbox комбинаций очень странные наименования. "Mod1" - {{Key|Alt}}, "Mod4" - Win клавиша. Ctrl и Shift - {{Key|Ctrl}} и {{Key|Shift}}. Однако обычно лучше создавать комбинации, основывающиеся на Alt/Win клавишах, так как Ctrl и Shift могут быть использованы для горячих клавиш графического приложения 

Все сочетания клавиш независимы друг от друга, так что можете их менять по собственному усмотрению. Для большей информации читайте страницу справки Fluxbox:
(<kbd>man fluxbox</kbd>). 

With that out of the way, fire up a text editor (non-root user), point it to {{Path|~/.fluxbox/keys}}, and begin enhancing some shortcuts! 

{{FileBox|filename=~/.fluxbox/keys|title=Modifying keyboard shortcuts|1=
# Locks the X11 display for the current user:
Mod4 l   :ExecCommand xlock
  
# Opens a number of programs with quickkeys. These are just examples, I am sure
# you get the point...
Mod1 f   :ExecCommand firefox
Mod1 t   :ExecCommand thunderbird
Mod1 o   :ExecCommand oowriter
Mod1 v   :ExecCommand gvim
  
# Fluxbox has no sound control; do a hack to get some
# (assumes alsa is being used; good luck if using oss :P )
Mod1 e   :ExecCommand Eterm -name alsa -e alsamixer
  
# This launches fbrun, which in turn launches other programs:
Mod1 r   :ExecCommand fbrun
  
# Program Control. It just makes life simpler...
Mod1 4   :Close
Mod1 m   :Minimize
  
# If using aterm (emerge x11-terms/aterm), the following opens a really nice
# transparent aterm with no borders, fitting nicely with 1024x768
# resolution, while still leaving room for conky. Once again, feel free to
# modify.
Mod1 a   :ExecCommand aterm -name aterm -sl 3000 -tr +sb -sr -sk -bg black -fg \
white -fade 90 -bl -tn xterm -fn \
-misc-fixed-medium-r-normal-*-*-120-*-*-c-*-iso8859-15 -g 116x57
  
# Similar to the above, but opens a transparent rooted terminal.
# The root password must be known to use this:
Mod1 s   :ExecCommand aterm -name aterm -sl 3000 -tr +sb -sr -sk -bg black -fg \
white -fade 90 -bl -tn xterm -fn \
-misc-fixed-medium-r-normal-*-*-120-*-*-c-*-iso8859-15 -g 116x57 -e su -
  
# Takes a screenshot using the print button, needs media-gfx/imagemagick
None 107 :Exec tm=$(date +%F,%T) && import -window root /tmp/screenshot$tm.png \
&& display /tmp/screenshot$tm.png
Mod1 107 :Exec tm=$(date +%F,%T) && import -frame -window $(xprop _NET_ACTIVE_WINDOW \
-root {{!}} awk '{print $5}') /tmp/screenshot$tm.png && display /tmp/screenshot$tm.png
}}

=== Системный мониторинг ===

It is a common desire to setup a system monitor for X11 on desktop systems. Gkrellm ({{Package|app-admin/gkrellm}} is a commonly used monitor, but in the spirit of Fluxbox minimalism, a simpler monitor will be used. Welcome <tt>conky</tt>. If desired, use another monitor; there are plenty of instructions elsewhere on the wiki. 

{{Emerge|app-admin/conky}}

The default configuration file for Conky is rather weak, but more info can be found by reading the man page or the [[Conky/Guide|Gentoo Linux Conky Howto]].

=== Иконки ===

Fluxbox does not come with a utility or program to draw icons to the desktop; everything is handled by keyboard shortcuts, or the right-click menu. iDesk is a program that can be used to fulfill this need. It is aimed at users of minimal WMs like Fluxbox who want to display icons in the root window, and it even supports funky graphic effects like transparency! Despite its name, iDesk is not affiliated with Apple or Mac. Installing iDesk is as simple as: 

{{Emerge|x11-misc/idesk}}

Once installed, it will be necessary to configure iDesk so that it is able to display icons. Its configuration file can be found at {{Path|~/.ideskrc}}. This is a rather lengthy task, and can not be well covered in this article. The following resources might be useful in order to configure iDesk: <kbd>man idesk</kbd>, [http://idesk.sourceforge.net/wiki/index.php/Idesk-usage iDesk's Usage Guide] and this [https://forums.gentoo.org/viewtopic-t-87262.html thread in the Gentoo Forums].

=== Графический файловый менеджер ===

It is important to note that Gentoo does not need a file manager. It is perfectly possible, and indeed simpler (in the author's humble opinion), to do file manipulation by command-line. However, not everyone agrees...

Many users who are new to Gentoo/Fluxbox are put off by the lack of a graphical file manager such as <tt>nautilus</tt> in GNOME. Fluxbox itself does not provide such a program, but, as always, one is simple to acquire. There are many choices, but this article will only present three, one for the [[#Gentoo File Manager - Minimalism|gentoo]] who likes text only and two for the user who likes [[#Rox File Manager - Includes Icons|rox]] to [[#Thunar File Manager|thunar]]. It is also possible to install all three and try each one.

==== файловый менеджер gentoo  ====

Gentoo - минималистический файловый менеджер, который предоставляет преимущества графического интерфейса, но без дополнительного балласта огромных менеджеров. 

{{Emerge|app-misc/gentoo}}

{{Note|The Gentoo file manager is a separate project from the Gentoo Linux distribution. For more information on this, see the Gentoo [http://www.gentoo.org/main/en/name-logo.xml#doc_chap4 Name and Logo Usage Guidelines].}}

The Gentoo file manager aims to be fully configurable via GUI, so feel free to tweak.

==== Файловый менеджер rox ====

Rox - файловый менеджер, который использует как иконки, так и текст и очень сильно похож на старый проводник из Windows 

{{Emerge|rox-base/rox}}

Rox behaves much like "traditional" file managers, so its interface should be intuitive. If not, there always are man pages for further information.

==== Файловый менеджер thunar ====

[http://thunar.xfce.org/ Thunar] is a lightweight, fast file manager that, like Rox, behaves much like "traditional" file managers. It includes icons and text, and it is easy to use. Though originally designed for [http://www.xfce.org Xfce], it makes a nice complement to a Fluxbox-based system. 

{{Emerge|xfce-base/thunar}}

=== Утилиты просмотра изображений ===

Many WMs come with utilities to view pictures (images) in a directory. These applications are small and lightweight, and do not allow for editing (which is assumed to be done by tools such as <tt>gimp</tt>). This is necessary when using command line, <tt>gentoo</tt>, or <tt>rox</tt> as file managers. Although <tt>thunar</tt> can display image thumbnails having a separate lightweight image viewer is still a good idea. 

{{Emerge|media-gfx/gqview}}

<tt>gqview</tt> может быть запущен в любой директории и просматривать там изображения всех поддерживаемых форматов 

=== Выставление темы, фона и автостартовых скриптов ===

Fluxbox has a number of themes that can be accessed via the right click menu. Navigate to {{Path|Fluxbox menu}} → {{Path|System Styles}}. These themes usually set their own background, which is either a single color or a gradient of some type. Most users prefer to set their own backgrounds, and to have those background persist no matter what theme has been chosen. To do so, another one of Fluxbox's configuration files must be modified, this one governs Fluxbox's startup behavior. Fire up that text editor again; this time point it to the {{Path|~/.fluxbox/startup}} file.

If this file was pre-existing then be sure to clear it. Add the following to the newly created file, uncommenting as needed, and filling in values for the CAPS:

{{FileBox|filename=~/.fluxbox/startup|title=Editing startup scripts for Fluxbox|lang=bash|1=
# Gentoo's Fluxbox startup script
  
# Programs which need to run constantly, as opposed to a one time execution,
# this means they need an "&" (ampersand) at the end of the command.
  
# Show the Fluxbox splash-screen
#fbsetbg -C /usr/share/fluxbox/splash.jpg
  
# This sets a desktop background image. A program must be setup
# to do this (x11-terms/eterm is recommended)
#fbsetbg -f PATH_TO_IMAGE
  
# Custom fonts directory
#xset +fp PATH_TO_FONT_DIRECTORY
  
# Starts the icons program
#idesk &
  
# This MUST be the last command!
exec /usr/bin/fluxbox -log ~/.fluxbox/log
}}

=== Создание меню ===

The author uses a text editor to create menus. If this sounds appealing, please skip this section and proceed to [[#Editing Menus by Hand|Editing Menus by Hand]]. 

It is possible to edit {{Path|~/.fluxbox/menu}} by hand after using an automatic generator (see next section), to add packages or delete those which are not used. Note when something is deleted from this menu, it does not delete the package from the system; only a link is removed from the individual user's menu. The program can still be run by command-line or alternate methods (hotkeys, etc.). 

If Fluxbox has been installed then a program called <tt>fluxbox-generate_menu</tt> will be installed with it. This program can be used to generate menus. Run it with the following options as a non-root user to generate a menu: 

{{Cmd|fluxbox-generate_menu -is -ds}}

It is recommended <tt>fluxbox-generate_menu</tt> (listed above) is used instead of other programs that accomplish similar tasks. The reason for the recommendation is that other programs may not understand Gentoo's filesystem directory structure, where <tt>fluxbox-generate_menu</tt> does.

This can also be done from the Fluxbox menu itself. There is usually an entry in the {{Path|Fluxbox}} menu called {{Path|Regen Menu}} which will re-run this script, looking for any new applications that have been installed since the last time it was ran. 

{{Note|It is possible to use this method to auto-generate the menu and still have some manual control over it. Creating and editing a {{Path|~/.fluxbox/usermenu}} file by hand (see the next section for syntax) will give the user a personalized menu which will not be erased the next time the script has been run.}}

=== Редактирование меню вручную ===

Fluxbox's menu is a text file that follows a simple syntax that is described in this section. The default menu definition is present in the {{Path|~/.fluxbox/menu}} file. 

Menu entries for executing applications are defined by an <code>[exec]</code> element. Entries can be defined under the <code>[begin]</code> definition (the menu root), or between a <code>[submenu]</code> and its corresponding <code>[end]</code> line (submenu definitions). For example: 

{{FileBox|filename=~/.fluxbox/menu|title=Defining new menu entries|1=
# Custom fluxbox menu
[begin] (Fluxbox)
  (...)
  [exec] (XTerm White on Black) {xterm -ls -fg white -bg black}
  (...)
  [submenu] (More terminals)
    [exec] (Aterm default) {aterm}
    [exec] (Rxvt default) {rxvt}
  [end]
  (...)
[end]
}}

The root menu definition begins with the <code>[begin]</code> tag, followed by its name, between parentheses and ends with its corresponding <code>[end]</code> tag. All the menu commands (called here, tags) are enclosed by square brackets, menu names will be enclosed between parentheses and the actual commands are enclosed between braces. Comments are allowed in this file, for lines beginning with <code>#</code>. 

In the example shown above, the first <code>[exec]</code> line defines a new entry named "XTerm White on Black", which will execute <tt>xterm -ls -fg white -bg black</tt> as if from a command line. Next is a submenu which is defined using the <code>[submenu]</code> tag, and after that a section called "More terminals", with two more <code>[exec]</code> commands. Any submenu definition must have its corresponding <code>[end]</code> tag. 

There are other menu commands that can be used in the {{Path|~/.fluxbox/menu}} file. Read the [http://fluxbox.org/docbook.php official documentation] available online for more information. 

=== Выбор стандартных приложений ===

Смотрите [[DefaultApplication]]

=== Итог ===

Поздравляем! Fluxbox установлен, настроен и готов к работе. Если появились некоторые вопросы или дополнительные идеи, то не стесняйтесь отредактировать эту страницу, добавить предложение в соответствующую страницу обсуждения, и/или уведомить о багах на [https://bugs.gentoo.org/ Bugzilla]

== Внешние ресурсы == 

* [http://fluxbox-wiki.org Fluxbox wiki]
* Fluxbox разработчики и пользователи в #fluxbox на chat.freenode.net


[[Category:Window manager]] {{Migrated|originalauthors=Jonathan Smith, Alin Dobre, Joshua Saddler, lack}}
