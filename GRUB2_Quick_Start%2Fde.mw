<languages />
Dieser Artikel [[Article description::enthält Informationen zum Einrichten und Betreiben von '''GRUB2''' in den einfachsten Konfigurationen.]] Weitere, umfassendere Informationen finden Sie unter [[GRUB2]] (englisch). Zur Migration von [[GRUB|GRUB Legacy]] (englisch) zu GRUB2, see [[GRUB2 Migration]] (englisch).

== Installation von GRUB2 ==

Das Paket {{Package|sys-boot/grub}} verwendet SLOTs; sowohl grub-0.97 als auch grub-2.00 können zur selben Zeit installiert sein. Obwohl beide Versionen von GRUB gleichzeitig auf dem System installiert sein können, kann nur eine Version von GRUB zu einem bestimmten Zeitpunkt der aktive Bootloader sein.

Bevor GRUB2 installiert wird, ist es notwendig zuerst die Variable <var>GRUB_PLATFORMS</var> in {{Path|make.conf}} (optional) zu setzen. Wenn diese nicht vorhanden ist versucht GRUB2 zu erraten welche Plattform auf dem System zu verwenden ist. Für x86/AMD64 Architekturen wird dann ''pc'' verwendet und die Installation mit ''MBR'' anstelle von ''UEFI'' durchgeführt.

{{FileBox|filename=/etc/portage/make.conf|title=GRUB_PLATFORMS Beispiel|lang=bash|1=
# Standard PC (BIOS)
GRUB_PLATFORMS="pc"
 
# UEFI on amd64
GRUB_PLATFORMS="efi-64"
 
# Both UEFI and PC
GRUB_PLATFORMS="efi-64 pc"
}}

Wenn die Variable gesetzt ist, kann GRUB installiert werden:

{{emerge|sys-boot/grub:2}}

== Aktivierung des GRUB2 Bootloader ==

Eventuell muss {{Path|/boot}} gemountet werden:

{{RootCmd|mount /boot}}

Handelt es sich um eine EFI-Plattform muss die [[EFI System Partition]] unter {{Path|/boot/efi}} verfügbar sein. Dies wird entweder durch einen eigenen Mount (unter {{Path|/boot/efi}}) erreicht oder dadurch, dass die Boot-Partition die EFI System-Partition ist.

Wenn die Partition {{Path|/boot/efi}} mit FAT formatiert ist:

{{RootCmd|mount /boot/efi}}

Starten Sie das Utility {{c|grub2-install}} um die relevanten Dateien nach {{Path|/boot/grub}} zu kopieren. Auf der PC Plattform installiert dies ebenfalls ein Boot-Image auf den Master Boot Record (MBR) oder auf den Boot-Sektor einer Partition.

Installation von GRUB2 auf den MBR:

{{RootCmd|grub-install /dev/sda||output=<pre>
Installation finished. No error reported.
</pre>}}

Installation von GRUB2 auf ein  EFI-System:

{{RootCmd|grub-install --target{{=}}x86_64-efi|output=<pre>
Installation finished. No error reported.
</pre>}}

{{Important/de|Wenn Sie GRUB2 auf einem EFI-fähigen System installieren (wie im Beispiel oben) und es Probleme gibt, stellen Sie sicher, dass die <var>GRUB_PLATFORMS</var> Variable in {{Path|/etc/portage/make.conf}} korrekt eingestellt ist.}}

Der {{c|grub2-install}} Befehl akzeptiert eine <code>--target</code> Option um festzulegen welche CPU/Plattform installiert werden soll. Falls diese nicht angegeben ist, wird grub2-install raten. Auf X86/AMD64 wird er per Voreinstellung <code>i386-pc</code> verwenden.

== Automatische Konfiguration ==

Die Konfiguration von GRUB2 erfolgt traditionell durch das Programm {{c|grub2-mkconfig}} um eine Konfigurationsdatei zu erzeugen.

Der Befehl {{c|grub2-mkconfig}} erzeugt die Konfigurationsdatei auf Basis von Vorlagen aus {{Path|/etc/grub.d}}. Die Standard-Vorlagen sollten die meisten gewöhnlichen Boot-Setups abdecken.

{{Cmd|ls /etc/grub.d|lang=bash|
|output=<pre>
00_header  10_linux  20_linux_xen  30_os-prober  40_custom  41_custom  README}}
</pre>

Das Verhalten dieser Vorlagen kann durch festlegen von Variablen in {{Path|/etc/default/grub}} gesteuert werden. Siehe [http://www.gnu.org/software/grub/manual/html_node/Simple-configuration.html GRUB Manual] (englisch) für weitere Informationen.

=== Kernel Namensschema ===

Der Befehl {{c|grub2-mkconfig}} kann nur Linuxkernel automatisch erkennen, wenn deren Namen mit <code>vmlinuz-</code> oder <code>kernel-</code> beginnen.

Zum Beispiel:

{{CodeBox|title=Kernel Namensbeispiele, die GRUB2 erkennen kann|<pre>
 /boot/vmlinuz-3.4.3
 /boot/kernel-2.6.39-gentoo
 /boot/kernel-genkernel-x86_64-3.17.1-gentoo-r1
</pre>}}

Bei Verwendung eines [[initramfs]] (englisch) sollte der Name mit {{Path|initramfs}} oder {{Path|initrd-}} beginnen und mit {{Path|.img}} enden. Die Versionsnummer muss zu einem der Kernel-Abbilder passen. Dateinamen die von {{c|[[genkernel]]}} (englisch) erstellt wurden funktionieren ebenfalls.

Zum Beispiel:

{{CodeBox|title=initramfs Beispielnamen, die GRUB2 erkennen kann|<pre>
 /boot/initramfs-3.4.3.img
 /boot/initramfs-genkernel-x86_64-2.6.39-gentoo
</pre>}}

Um die Konfigurationsdatei {{Path|grub.cfg}} zu erstellen, benutzen Sie den Befehl {{c|grub-mkconfig}}:

{{RootCmd|grub-mkconfig -o /boot/grub/grub.cfg|output=<pre>
Generating grub.cfg ...
Found linux image: /boot/vmlinuz-3.2.9
done
</pre>}}

=== Kernel Startmeldungen unterdrücken ===

Die Ausgabe der Kernelstartmeldungen wird unterdrückt, wenn in {{Path|/etc/default/grub}} die Variable
<var>GRUB_CMDLINE_LINUX_DEFAULT</var> mit dem Wert <code>quiet</code> belegt ist.

{{FileBox|filename=/etc/default/grub|title=Beispiel für unterdrücke Textmeldungen zum Systemstart|lang=bash|1=
GRUB_CMDLINE_LINUX_DEFAULT="quiet"
}}

=== Systemd ===

Der ''systemd'' als init-System wird von GRUB2 folgendermaßen aufgerufen:

{{FileBox|filename=/etc/default/grub|title=Systemd als init-System|lang=bash|1=
GRUB_CMDLINE_LINUX="init=/usr/lib/systemd/systemd"
}}

=== Ein anderes Betriebssystem laden ===

{{c|grub-mkconfig}} kann auch Konfigurationen erzeugen, um andere Betriebssysteme zu laden. Hierfür ist die Installation des Paketes {{Package|sys-boot/os-prober}} erforderlich.

Um ein MS-Windows zu booten muss zusätzlich das Packet {{Package|sys-fs/ntfs3g}} installiert sein. Es erlaubt dem {{c|grub-mkconfig}} Utility das NTFS Dateisystem zu untersuchen.

== Manuelle Konfiguration ==

Benutzer müssen nicht zwingend {{c|grub-mkconfig}} verwenden, die Datei {{Path|grub.cfg}} kann auch manuell bearbeitet werden.

Da die meisten Anwender Erfahrung mit dem GRUB Legacy Format haben, zeigt das nächste Beispiel wie auf Grundlage einer GRUB Legacy Konfiguration eine GRUB2 Konfiguration geschrieben wird.

{|
! style="text-align: left;" | {{Path|grub.conf}} (GRUB Legacy)
|
! style="text-align: left;" | {{Path|grub.cfg}} (GRUB 2)
|-
| style="background: rgb(250,250,250); vertical-align: top; border: 1px solid black; padding: 5px 7px;" | <code style="color: gray; margin: 0; padding: 0; border: 0; background: transparent; line-height: normal;">timeout 5<br />
<br />
<span style="font-weight: bold; color: maroon;">title</span> Gentoo Linux 3.2.12<br />
root <span style="font-weight: bold; color: maroon;">(</span>hd0,<span style="font-weight: bold; color: maroon;">0)</span><br />
<span style="font-weight: bold; color: maroon;">kernel</span> /boot/kernel-3.2.12-gentoo root=/dev/sda3</code>
| style="vertical-align: middle; font-size: 50px; color: gray;" | ⇨
| style="background: rgb(250,250,250); vertical-align: top; border: 1px solid black; padding: 5px 7px;" | <code style="color: gray; margin: 0; padding: 0; border: 0; background: transparent; line-height: normal;">timeout<span style="font-weight: bold; color: green;">=</span>5<br />
<br />
<span style="font-weight: bold; color: green;">menuentry</span> <span style="font-weight: bold; color: green;">'</span>Gentoo Linux 3.2.12<span style="font-weight: bold; color: green;">'</span> <span style="font-weight: bold; color: green;">{</span><br />
<span style="display: inline-block; width: 4ex; overflow: hidden;">	</span>root<span style="font-weight: bold; color: green;">=</span>hd0,<span style="font-weight: bold; color: green;">1</span><br />
<span style="display: inline-block; width: 4ex; overflow: hidden;">	</span><span style="font-weight: bold; color: green;">linux</span> /boot/kernel-3.2.12-gentoo root=/dev/sda3<br />
<span style="font-weight: bold; color: green;">}</span>
|}

{{Note|GRUB Legacy numbers partitions starting with 0; GRUB2 numbers partitions starting with 1. Both bootloaders number drives starting with 0.}}

== Siehe auch ==

Bitte beachten sie den [[GRUB2]] Artikel (englisch) für weitere Informationen und eine vollständige Liste der Möglichkeiten.


[[Category:Bootloaders]]
