The objective of this article is to list problems and errors that may occur from time to time when using [[GRUB Legacy]]. All these solutions have been acquired through the cooperation of users on the Gentoo Forums.

== Starting notes ==

=== Acknowledgements ===

Many thanks to [https://forums.gentoo.org/profile.php?mode=viewprofile&u=18420 Earthwings], [https://forums.gentoo.org/profile.php?mode=viewprofile&u=39305 penetrode], [https://forums.gentoo.org/profile.php?mode=viewprofile&u=41638 loyaltonone], [https://forums.gentoo.org/profile.php?mode=viewprofile&u=4980 pilla], [https://forums.gentoo.org/profile.php?mode=viewprofile&u=3139 airhead], [https://forums.gentoo.org/profile.php?mode=viewprofile&u=13816 nephros], [https://forums.gentoo.org/profile.php?mode=viewprofile&u=25859 yamakawa] and all the others for the suggestions on the original [https://forums.gentoo.org/viewtopic.php?t=122656 thread].

=== Disclaimer warning ===

The examples provided are just examples. Be sure to change partition numbers and the like according to the specific systems specs. Follow the solutions provided by this document at the readers own risk.

== GRUB loading, please wait... ==

=== Situation ===

{{GenericCmd
|output=<pre>
GRUB loading stage 1.5
GRUB loading, please wait...
</pre>}}

After this message, the system stops. If attempting to boot the system using a GRUB floppy, the problem disappears.

=== Solution ===

According to [https://forums.gentoo.org/profile.php?mode=viewprofile&u=3134 The_Bell], changing the boot order in the [[BIOS]] can solve the problem.

Tell the BIOS to not boot from the floppy first.

[https://phz.fi/2014/10/30/grub-loading-stage-1-5-grub-loading-please-wait/] took hard disks off the system one-by-one until found out the problem was caused by the SiI3512A SATA RAID-controller.

[https://forums.gentoo.org/profile.php?mode=viewprofile&u=39305 penetrode] wrote that this may also be due to bad CFLAGS settings. Although the current GRUB ebuild filters out<code>-fstack-protector</code>, it can't hurt to recompile GRUB with clean CFLAGS if nothing else helps.

{{RootCmd|CFLAGS{{=}}"-O2 -march{{=}}i686 -fomit-frame-pointer -pipe" emerge grub:0 --ask}}

This problem appeared on a dell r320 server, caused by having serial and terminal options in {{Path|grub.conf}}, problem disappeared after removing those options.

{{FileBox|filename=grub.conf|title=options to remove|1=
#serial --unit=1 --speed=19200  
#terminal --timeout=10 serial
}}

== GRUB Error 12 ==

=== Situation ===

{{GenericCmd
|output=<pre>
12 : Invalid device requested.
</pre>}}

This error is returned if the device strings syntax is correct but other than that, an error occurred that isn't defined by any other error.

=== Solution ===

When GRUB was installed in the boot record using the interactive commands, were the two lines below executed in the GRUB prompt?

{{Cmd
|root (hd0,0)
|setup (hd0)
|prompt=grub>
|color=white
}}

<code>(hd0,0)</code> must be replaced with the boot partition and <code>(hd0)</code> with the HDD that was chosen. Remember that <code>(hd0)</code> will install the bootloader in the Master Boot Record of the first hard disk, the primary master.

== GRUB error 15 ==

=== Situation ===

This error can occur in two different stages of the GRUB configuration, either during the initial configuration (installing GRUB in the master boot record) or after booting the system and attempting to launch Linux (or any other entry).

Initial configuration:

{{Cmd
|root (hd0,0)
|prompt=grub>
|color=white
|output=<pre>
 Filesystem type is xfs, partition type 0x83
</pre>
}}

{{Cmd
|setup (hd0)
|prompt=grub>
|color=white
|output=<pre>
 Checking if "/boot/grub/stage1" exists... no
 Checking if "/grub/stage1" exists... no

Error 15: File not found
</pre>
}}

Booting an entry:

{{GenericCmd
|output=<pre>
Booting 'Gentoo Linux'
  
root (hd0,0)
Filesystem type is ext2fs, partition type 0x83
kernel (hd0,0)/boot/kernel-2.4.20 root=/dev/sda3 vga=792
  
Error 15: File not found
Press any key to continue...
</pre>}}

=== Solution - Initial configuration ===

This error is returned if the specified file name cannot be found, but everything else (like the disk/partition info) is OK.

Frequently, the error notes a missing kernel image file. Make sure that the file it is referring to exists on the boot partition.

To find out the exact name of the kernel, boot from the installation cd, mount the root and (if applicable) boot partition. Next, chroot into the Gentoo system and do a listing of the available files to see what kernel images there are available:

{{RootCmd
|cd /boot
|ls
}}

This will list all the kernels that there are on the boot partition. If the kernel is missing make sure to have compiled a kernel (using {{c|genkernel}} or manually):

{{RootCmd
|cd /usr/src/linux/
|make menuconfig
|make
}}

And that it has been copied to the boot partition:

{{RootCmd|cp /usr/src/linux/arch/i386/boot/bzImage /boot}}

Verify that the name of the kernel is exactly the same as the one mentioned in the {{Path|grub.conf}} file. Also make sure that the <code>kernel</code> line in the {{Path|grub.conf}} file is referring to that partition (either explicitly or implicitly).

Another reported mistake is to have the BIOS ignore the disk on which the kernel or GRUB stages reside. Also, the partition on which GRUB stores its stages should not use a software RAID-5 (or other striping technology) configuration.

=== Solution - Booting an entry ===

First, verify that the <code>root</code> and <code>setup</code> lines that were used are correct.

If it is certain they are valid, then there is the ''possibility'' of using a flawed GRUB version (0.93.20031222). Upgrade the Portage tree or mask this version of GRUB: 

{{RootCmd|echo "{{=}}sys-boot/grub-0.93.20031222" >> /etc/portage/package.mask}}

{{Emerge|sys-boot/grub:0}}

Another option is using the {{c|grub-install}} script as is recommended by the GRUB authors. The <code>--root-directory</code> option is needed if there is a separate boot partition, otherwise it should be left out.

{{RootCmd|grub-install --root-directory{{=}}/boot /dev/sda}}

When all this fails, the boot partition may be corrupt. Check the partition for errors: 

{{RootCmd|fsck -y /dev/sda1}}

== GRUB error 17 ==

=== Situation ===

{{GenericCmd
|output=<pre>
root (hd0,0)
filesystem type unknown partition type 0x7
  
Error 17 : Cannot mount selected partition
</pre>}}

=== Solution ===

This error is returned if the partition requested exists, but the filesystem type cannot be recognized by GRUB. 

Be sure to check the <code>root(x,y)</code> settings in {{Path|grub.conf}}.

Also, when trying to boot Windows, make sure that the {{Path|grub.conf}} file has the <code>root (hdX,Y)</code> (or <code>rootnoverify (hdX,Y)</code> ) and <code>chainloader (hdX,Y)+1</code> in it.

== GRUB error 18 ==

=== Situation ===

{{GenericCmd
|output=<pre>
kernel (hd1,4)/bzImage root=/dev/sdb7
  
Error 18: Selected cylinder exceeds max supported by BIOS
</pre>}}

=== Solution ===

This error is returned when a read is attempted at a linear block address beyond the end of the BIOS translated area. This generally happens if the disk is larger than the BIOS can handle (512 MB for (E)IDE disks on older machines or larger than 8 GB in general).

Try an update for the BIOS and/or move the boot partition to the front (or at least into the appropriate range).

== GRUB GRUB GRUB GRUB GRUB ... ==

=== Situation ===

{{GenericCmd
|output=<pre>
GRUB GRUB GRUB GRUB GRUB GRUB GRUB GRUB GRUB GRUB GRUB GRUB GRUB GRUB GRUB
  GRUB GRUB GRUB GRUB GRUB GRUB GRUB GRUB GRUB GRUB GRUB GRUB GRUB GRUB GRUB
...
</pre>}}

=== Solution ===

According to [https://forums.gentoo.org/profile.php?mode=viewprofile&u=3139 airhead] this can be caused by having the BIOS detect the disks automatically. Try to set the BIOS entry to User Type HDD.

Another possibility is that Grub was installed on the MBR and then reinstalled (for instance due to hard disk changes) but using the wrong <code>setup</code> and <code>root</code> commands.

== Probing devices to guess BIOS drives. This may take a long time ==

=== Situation ===

While trying to install GRUB, it hangs after displaying the following line:

{{RootCmd
|grub
|output=<pre>
Probing devices to guess BIOS drives. This may take a long time.
</pre>}}

=== Solution ===

One reported cause was an exotic configuration of disk devices, like ultra/non-ultra DMA disks on one cable.

== When installing GRUB, it just hangs ==

=== Situation ===

When installing GRUB, it hangs:

{{RootCmd|grub}}

At this stage, the installation stops.

=== Solution ===

If there is no floppy drive, was the <code>--no-floppy</code> switch used?

{{RootCmd|grub --no-floppy}}

== Uncompressing Linux... Ok, booting the kernel ==

=== Situation ===

The system hangs after displaying the following line:

{{GenericCmd
|output=<pre>
Uncompressing Linux... Ok, booting the kernel.
</pre>}}

=== Solution ===

Strictly speaking, this is no GRUB error. One possible cause is that ACPI is not working correctly but is enabled in the kernel. Try to disable it in the BIOS or in the kernel.

== GRUB just shows a GRUB prompt ==

=== Situation ===

When booting the system, a GRUB prompt appears instead of a list of entries that were defined in the {{Path|grub.conf}} file.

=== Solution ===

Mount the boot partition and verify if the {{Path|grub/grub.conf}} file exists.

{{RootCmd
|mount /dev/sda1 /mnt/gentoo/boot
|cat /mnt/gentoo/boot/grub/grub.conf
}}

Also make sure that the {{Path|menu.lst}} symbolic link exists:

{{RootCmd
|ls -l /mnt/gentoo/boot/grub/menu.lst
|output=<pre>
lrwxrwxrwx  1 root root 9 Mar  7 14:00 /mnt/gentoo/boot/grub/menu.lst -> grub.conf
</pre>}}

If not, recreate the symbolic link:

{{RootCmd
|cd /mnt/gentoo/boot/grub
|ln -snf grub.conf menu.lst
}}

If this is the case, reinstall GRUB:

{{RootCmd
|grub-install --root-directory{{=}}/boot /dev/sda
|prompt=(chroot) #
}}

== Could not find device for /boot/boot: not found or not a block device ==

=== Situation ===

When running {{c|grub-install}} during the GRUB installation, the following error appears:

{{RootCmd
|grub-install --root-directory{{=}}/boot /dev/sda
|output=<pre>
Could not find device for /boot/boot: not found or not a block device
</pre>}}

=== Solution ===

Check that the following wasn't forgotten:

{{RootCmd|grep -v rootfs /proc/mounts > /etc/mtab}}

== The system reboots after hitting return at the GRUB menu ==

=== Situation ===

After hitting the {{Key|Enter}} ({{Key|Return}}) key at the GRUB menu during the system boot, the system reboots.

=== Solution ===

Try disabling framebuffer support in the kernel. If this does not help, disable APM and ACPI.

== After hitting the Enter (Return) key at the GRUB menu, the screen blanks out ==

=== Situation ===

After hitting {{Key|Enter}} ({{Key|Return}}) at the GRUB menu during system boot, the screen blanks out, but the system is responsive (for instance, the numlock LED is switchable).

=== Solution ===

Turn off framebuffer (typically remove <code>vga=XYZ</code> from {{Path|grub.conf}}) and check the processor architecture in the kernel config.

== Missing GRUB image ==

=== Situation ===

When booting the system, the spiffy Gentoo splash screen is not seen.

=== Solution ===

First of all check if the splash screen file that is being are referred to in {{Path|grub.conf}} really exists. If that is the case, go and check the GRUB ebuild. Maybe the patch for the splash image is commented out in the version that is being used.

== Failing To boot Windows from a second hard drive ==

=== Situation ===

After selecting the Windows entry, the system refuses to boot without any clear reason as to why.

=== Solution ===

[https://forums.gentoo.org/profile.php?mode=viewprofile&u=14595 cyrillic] provides information that it is possible to "map" the disks in a different order by changing {{Path|grub.conf}}'s Windows entry like so:

{{FileBox|filename=grub.conf|title=Mapping disks|1=
title Windows XP
  map (hd0) (hd1)
  map (hd1) (hd0)
  chainloader (hd1,0)+1
}}

== GRUB segfaults when trying to install ==

=== Situation ===

The situation described below is only relevant for grub-0.95.x at the moment of installing GRUB at the boot sector.

{{Cmd
|root (hd0,0)
|setup (hd0)
|prompt=grub> 
|color=white
|output=<pre>
Segmentation fault
</pre>}}

=== Solution ===

This is a known bug related to this problem and has been fixed in grub-0.96. It is also known that grub-0.94-r1 and grub-0.94-r2 should work correctly. If that fails too, try to emerge grub-static which is currently stable on {{Keyword|amd64}} and unstable on {{Keyword|x86}} and ({{Keyword|~x86}}). Check out {{Bug|79378}} for additional information.

{{Migrated|originalauthors=Hartwig Brandl, Ioannis Aslanidis}}

[[Category:Bootloaders]]
