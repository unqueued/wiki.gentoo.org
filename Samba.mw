{{InfoBox stack
|{{InfoBox homepage|http://www.samba.org|header=true}}
|{{InfoBox wikipedia|Samba (software)}}
}}
'''Samba''' is a re-implementation of the SMB/CIFS networking protocol, a MS Windows alternative to [[NFS]].

== Installation ==
=== Kernel ===
Activate the following kernel options:
{{KernelBox|title=Enable CIFS|1=
File Systems --->
    [*] Network File Systems --->
        [*] CIFS support (advanced network filesystem, SMBFS successor)--->
            [*] CIFS Statistics
                [*] Extended Statistics
            [*] CIFS Extended Attributes
                [*] CIFS POSIX Extentions
}}

=== Samba USE flags ===
{{USEflag|package=net-fs/samba|desc=Optional USE flags for {{Package|net-fs/samba}}:
|acl
|addns
|ads
|aio
|avahi
|caps
|cluster
|client
|cups
|debug
|dmapi
|doc
|examples
|fam
|ldap
|ldb
|netapi
|pam
|quota
|readline
|server
|smbclient
|smbsharemodes
|selinux
|swat
|syslog
|winbind
}}

=== Emerge Samba ===
{{Emerge|net-fs/samba}}

=== CIFS USE flags ===
If the full samba package is not needed, install the {{Package|net-fs/cifs-utils}} package:
{{USEflag|package=net-fs/cifs-utils|desc=Optional USE flags for {{Package|net-fs/cifs-utils}}:
|ads
|caps
|caps-ng
|creds
}}

=== Emerge CIFS ===
{{Emerge|cifs-utils}}

== Usage ==
{{RootCmd|rc-service samba start}}
{{RootCmd|rc-update add samba default}}

=== CIFS share ===
==== Mount the shared content ====
Once the client is fully configured, the shares can be accessed by following the next steps.

Create the mount point:
{{RootCmd|mkdir -p /mnt/My-Disk/{Media,Shared} }}

Mount the exported folders:
{{RootCmd|mount.cifs //O2-Foobar/Media /mnt/My-Disk/Media -o guest}}
{{RootCmd|mount.cifs //O2-Foobar/Shared /mnt/My-Disk/Shared -o guest}}

To automatically mount shares on every boot, edit the [[fstab]] to look like this:
{{FileBox|filename=/etc/fstab|1=
//O2-Foobar/Media  /mnt/My-Disk/Media  cifs guest
//O2-Foobar/Shared /mnt/My-Disk/Shared cifs guest
}}

{{Note|
* In the case of permission problems are encountered when trying to create files and folders on the disk, try to use <code>gid{{=}}<user's_gid>, uid{{=}}<user's_uid></code>
* Be sure to replace <code><user's_gid></code> with the user ID of choice.}}

== Troubleshooting ==
The following problems may occur when trying to mount new CIFS shares.

=== Cannot resolve <server-name> ===
More specifically, the actual error:
{{RootCmd|mount.cifs ...|output=<pre>
"mount error: could not find target server. TCP name foo/bar not found. No ip
address specified and hostname not found"
</pre>}}

This can easily be fixed by editing {{Path|/etc/nsswitch}} and appending <code>wins</code> next to the <code>hosts</code> entry:
{{FileBox|filename=/etc/nsswitch||1=
hosts: files dns wins
}}

If this does not work, use the NFS server's IP address instead of the O2-Foobar hostname. The <tt>nmblookup</tt> utility (provided by {{Package|net-fs/samba}}) comes in handy when trying to find the IP address of an NFS host:
{{RootCmd|nmblookup O2-Foobar}}

=== Shutdown process hangs when trying to unmount CIFS shares ===
If the system fails to shutdown or reboot properly, users must make sure the CIFS shares are unmounted properly before [[udev]] tries to stop.

The easy way is to create a [[local.d]] script:
{{RootCmd|echo "umount -a -t cifs -f" > /etc/local.d/cifs.stop}}

=== Windows asking for passwords ===
<pre>
security = share
</pre>

== See also ==
* [[SSHFS]]

== External resources ==
* [[Samba/HOWTO|Samba HOWTO]] on this wiki
* [[Samba4 Migrating/HOWTO|Samba3 Migrating to Samba4 or AD HOWTO]] on this wiki
* [http://www.samba.org/samba/docs/man/Samba-Guide/ Practical Exercises in Successful Samba Deployment]
* [http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/ Samba Howto Collection]
* [http://www.samba.org/samba/GUI/ Samba GUI]

[[Category:Software]]
[[Category:Daemons]]
