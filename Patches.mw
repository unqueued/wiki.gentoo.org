{{InfoBox stack
|{{InfoBox wikipedia|SoftwareTitleOnTheWikipedia|header=true}}
}}

= Patches =

This page provides an overview on patches, patching and best practices.
The usage of patches by portage is discussed at [[/etc/portage/patches|Portage : Patches]] while this is focused upon their creation.

== Creating Patches ==

{{Note|There does not appear to be a section detailing how to actually "create patches". This section and it's subsections aim to remedy this but it's possible they belong else where. This section could have saved one an afternooo...n of <code>ebuild PACKAGE.ebuild manifest prepare</code>}}

=== TortoiseGit and Git for Windows ===

Patches generated by [//tortoisegit.org/docs/tortoisegit/tgit-dug-patch.html Tortoise Git] and Git for Windows are padded with additional information that <code>patch</code> does not understand. 

{{FileBox|filename=PATCH.patch|title=Typical Tortoise Git/Git for Windows Patch|1=
From HASH Day Mon DD hh:mm:ss YYYY
From: AUTHOR <AUTHOR@E-MAIL.TLD>
Date: Day, DD MMM YYYY hh:mm:ss +hhmm
Subject: [PATCH] COMMIT MESSAGE

---
 PATH/TO/FILE.EXT  1 +
 1 file changed, 1 insertion(+)

diff --git a/PATH/TO/FILE.EXT b/PATH/TO/FILE.EXT
index HA..SH CODE
--- a/PATH/TO/FILE.EXT
+++ b/PATH/TO/FILE.EXT
@@ -56,6 +56,7 @@ 
+  some new code
-  some old code
-- 
VERSION.windows.REVISION}}

The individual generating the patch has to strip these additional lines to make a viable patch file.

{{FileBox|filename=PATCH.patch|title=Acceptable Tortoise Git/Git for Windows Patch|1=
--- a/PATH/TO/FILE.EXT
+++ b/PATH/TO/FILE.EXT
@@ -56,6 +56,7 @@ 
+  some new code
-  some old code
}}

== Nesting ==

If the file(s) being patched are not unpacked into the root of the working directory, {{Path|PATH/TO/A/FILE}}, but rather some sub-directory of the working directory, {{Path|SOME/OTHER/PATH/TO/A/FILE}}, then the patch must be modified to accommodate it.

{{FileBox|filename=PATCH.patch|1=
--- a/SOME/OTHER/PATH/TO/FILE.EXT
+++ b/SOME/OTHER/PATH/TO/FILE.EXT
...
}}

{{Note|This is necessary for, atleast, Go based ebuilds which nest the source code under the repository path e.g. <nowiki>http://git.com/project/repository</nowiki> gets unpacked into the working directory under {{Path|src/git.com/project/repository}} }}

== See also ==

* [[/etc/portage/patches|Portage : Patches]] - (Link to related Gentoo Wiki articles using bullet points for each link in this section; each link should be local to the Wiki. Use a dash to separate the link from a reason why the link was decided upon.)

== External resources ==

* (Link to external resources (outside the Wiki) using bullet points in this section. It is common for the information in this section to full sentences that are links.)

== References ==

* How to write [https://dev.gentoo.org/~vapier/clean-patches clean patches] when not using ''git-format-patch''.

{{reflist}}

[[Category:Patches]]
