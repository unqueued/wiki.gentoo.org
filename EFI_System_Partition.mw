{{stub}}
{{InfoBox stack|{{InfoBox wikipedia|EFI system partition|header=true}}}}

The '''EFI system partition (ESP)''' is a [[FAT|fat]] formatted partition containing the [[bootloader|boot loader]]s or kernel images for all installed operating systems.

In order to boot directly from UEFI, the kernel needs to have these options enabled:

Enable GPT partition label support if that was used previously when partitioning the disk (<var>CONFIG_PARTITION_ADVANCED</var> and <var>CONFIG_EFI_PARTITION</var>):

{{KernelBox|title=Enable support for GPT|1=
-*- Enable the block layer --->
   Partition Types --->
      [*] Advanced partition selection
      [*] EFI GUID Partition support
}}

{{c|parted}} ({{package|sys-block/parted}}) will show it with the '''boot, esp''' flags:

{{RootCmd|parted /dev/sda print|output=<pre>Model: ATA SAMSUNG SSD SM84 (scsi)
Disk /dev/sda: 256GB
Sector size (logical/physical): 512B/512B
Partition Table: gpt
Disk Flags: 

Number  Start   End     Size    File system  Name                          Flags
 1      1049kB  99.6MB  98.6MB  fat32        EFI System Partition          boot, esp
</pre>}}

For creation instructions see [[Handbook:AMD64/Blocks/Disks#Default:_Using_parted_to_partition_the_disk|Handbook]]

{{c|gdisk}} ({{package|sys-apps/gptfdisk}}) will show it with partition code '''EF00''':

{{RootCmd|gdisk -l /dev/sda|output=<pre>GPT fdisk (gdisk) version 1.0.1

Partition table scan:
  MBR: protective
  BSD: not present
  APM: not present
  GPT: present

Found valid GPT with protective MBR; using GPT.
Disk /dev/sda: 500118192 sectors, 238.5 GiB
Logical sector size: 512 bytes
Disk identifier (GUID): 1B59C2C8-8795-4625-9718-4D636B005AC1
Partition table holds up to 128 entries
First usable sector is 34, last usable sector is 500118158
Partitions will be aligned on 2048-sector boundaries
Total free space is 2669 sectors (1.3 MiB)

Number  Start (sector)    End (sector)  Size       Code  Name
   1            2048          194559   94.0 MiB    EF00  EFI System Partition
</pre>}}

There is a standard layout for the ESP. Vendors and distributions are supposed to put their stuff into vendor specific directories.

{{Cmd|tree -L 3 /boot|output=<pre>
 /boot
 └── EFI
     ├── Boot
     │   └── bootx64.efi
     ├── Gentoo
     │   └── vmlinuz-4.9.16-gentoo.efi
     └── Microsoft
         ├── Boot
         └── Recovery
</pre>}}

Here the Microsoft subtree - and also the Boot subtree - was created by an earlier installation of Windows 10 Creators Update. The Boot subtree is the fallback directory. If UEFI can't find any vendor specific directories it will boot from here. In a multiboot environment with properly set up vendor specific subtrees the Boot subtree can be deleted.

== See also ==

* [[EFI stub kernel]]
* [[Handbook:AMD64/Blocks/Disks#Using_UEFI]]
* [[efibootmgr]]

== External resources ==

* [https://wiki.archlinux.org/index.php/EFI_System_Partition EFI System Partition on Arch wiki]
* [http://www.rodsbooks.com/gdisk/ GPT fdisk homepage] with information and tutorials about GPT partitioning.
