[http://thekelleys.org.uk/dnsmasq/doc.html Dnsmasq] is a simple DHCP/DNS server which can be used in a local network of up to a 1000 clients. Key features are easy configuration and a small system footprint. 

== Installation ==
The installation of Dnsmasq is simple; emerge, start the service, and optionally add the service to your default runlevel.
{{Emerge|net-dns/dnsmasq}}
{{RootCmd|/etc/init.d/dnsmasq start}}
{{RootCmd|rc-update add dnsmasq default}}


== Configuration ==
A common sample configuration is listed below. Many more configuration options are available; the installed '''/etc/dnsmasq.conf''' file contains the full (commented) list of options. After editing, the service should be restarted for the changes to take effect.

{{File|/etc/dnsmasq.conf||<pre>
# Listen only to this interface
interface=eth1

# Assign names based on mac adress
dhcp-host=00:1e:68:c2:ff:ee,endor,192.168.0.54,24h

# Any other DHCP request gets an ip from this range
dhcp-range=eth1,192.168.0.100,192.168.0.120,12h

# Enable the TFTP server and set the root directory for files available via TFTP.
enable-tftp
tftp-root=/var/lib/tftpboot
dhcp-boot=/pxelinux.0
</pre>}}

{{RootCmd|/etc/init.d/dnsmasq restart}}

== Maintenance ==
Some maintenance tasks are explained below.

=== Resetting Leases ===
When switching network cards you will want to update the MAC adress of a certain IP adress in your configuration. However you might not get the intended IP, because it was leased to the old MAC adress. The correct way to handle this is to stop the service, edit the leases file at '''/var/lib/misc/dnsmasq.leases''', and start the service.
{{RootCmd|/etc/init.d/dnsmasq stop}}
{{File|/var/lib/misc/dnsmasq.leases|remove any leases you like|<pre>
1321167121 00:b0:d0:ed:ec:80 192.168.0.23 dantooine *
1321114991 00:16:35:02:91:14 192.168.0.22 dagobah *
1321159899 00:01:03:ba:b9:34 192.168.3.13 hoth 01:00:01:03:ba:b9:34
</pre>}}
{{RootCmd|/etc/init.d/dnsmasq start}}

[[Category:Software]]
