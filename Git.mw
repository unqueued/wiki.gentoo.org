{{Lowercase title}}
{{InfoBox stack
|{{InfoBox homepage|http://git-scm.com|header=true}}
|{{InfoBox gitweb|https://git.kernel.org/cgit/|raw=true}}
|{{InfoBox wikipedia|Git (software)}}
|{{InfoBox ohloh}}
}}

{{Tip|The {{c|git}} repositories for Gentoo developers can be found here: https://gitweb.gentoo.org/}}

'''Git''' is [[Article description::distributed revision control and source code management software.]] The goal of this article is to easily get a Git repository up and running.

Git was developed by Linus Torvalds for use on the Linux Kernel and other open source projects. According to a talk he gave for Google, he was searching for a Source Control Management (SCM) and used three criteria.

SCM must:

# Be distributed;
# Be fast;
# Output exactly what was put in, or an error should be printed.

Since there were no satisfactory options Linus wrote {{c|git}}.

== Installation ==

=== USE flags ===

{{USEflag|package=dev-vcs/git}}

=== Emerge ===

Install {{Package|dev-vcs/git}}:

{{Emerge|dev-vcs/git}}

== Configuration ==

Before contributing to a project it is imperative to establish a user name and email for each user. Substitute the bracketed Larry references (brackets and everything in-between, but leave the quotes) in the next example for a personal user name and e-mail address:

{{Cmd
|git config --global user.email "<larry@gentoo.org>"
|git config --global user.name "<larry_the_cow>"
}}

=== Local ===

If you're the only one using your project, or if you're creating something which will be shared in a distributed way, then you should start on your workstation. If you intend to have a central server which everyone uses as the "official" server (e.g. GitHub) then it might be easier to create an empty repository there.

The next list of commands will describe how to create a repository on a workstation:

{{Cmd
|cd ~/src
|mkdir hello
|cd hello
|touch README.TXT
|git init
}}

You're done.  You've created a local repository. It's in the {{Path|.git}} folder, so don't delete your {{Path|hello}} folder unless you mean to lose everything.

{{Note|Your repository is the {{Path|.git}} folder inside the main {{Path|hello}} folder.  If you delete {{Path|~/src/hello}}, then your repo is gone.}}

Now, let's say we make some edits:

{{Cmd
|cat "Hello, world!" >> readme.txt
}}

The new {{Path|readme.txt}} file must be added (staged) before it can be included in the git repository. Use the next commands to stage the file and to make the commit:

{{Cmd
|git add readme.txt
|git commit -m "Added text to readme.txt"
}}

=== Server ===

In this section will cover setting up a Git server for remote project management through SSH.

{{Note|The Git server is only necessary if you intend to have an ''unauthenticated read-only server'' for people to get code from. See here: http://git-scm.com/book/en/Git-on-the-Server-Git-Daemon}}

If not sure then skip this section.

==== Initial setup ====

Start by creating the needed group, user, and home directory.
The user uses the <code>git-shell</code> to prevent normal shell access.
{{RootCmd
|groupadd git
|useradd -m -g git -d /var/git -s /usr/bin/git-shell git}}


Edit {{Path|/etc/conf.d/git-daemon}} to change user from ''"nobody"'' to ''"git"'' and start the daemon:

{{FileBox|filename=/etc/conf.d/git-daemon|lang=bash|1=
GIT_USER="git"
GIT_GROUP="git"
}}

If wants to accept git push and allow access all direct, 
it needs to add two options --enable=receive-pack and --export-all to GITDAEMON_OPTS , ex:
{{FileBox|filename=/etc/conf.d/git-daemon|lang=bash|1=
GITDAEMON_OPTS="--syslog --export-all --enable=receive-pack --base-path=/var/git"
}}


{{RootCmd|/etc/init.d/git-daemon start}}

=== SSH keys ===

[[SSH]] is the preferred method to handle the secure communications between client and server.
For Git to work properly, you must have private/public key logins enabled and all client public keys added to {{Path|/var/git/.ssh/authorized_keys}}.

For more information and instructions on how to enable, create, and share keys, please see the [[SSH#Passwordless_Authentication|SSH - Passwordless Authentication]] wiki page.

{{Note|'''this step must be completed before continuing'''}}

== Usage ==

=== Create a repository and make the initial commit ===

On the server:

Become the ''git'' user to make sure all objects are owned by this user:

{{RootCmd|su git}}

{{Note|If the following message appears, 
'''fatal: Interactive git shell is not enabled.'''
'''hint: ~/git-shell-commands should exist and have read and execute access.'''
temporarily set the login shell to /bin/bash (''usermod -s /bin/bash git'') and set it back after creating the bare repository (''usermod -s /usr/bin/git-shell git''). This may be also necessary when setting ssh access (see also [https://serverfault.com/questions/285324/git-shell-not-enabled this post]).}}

Create a bare repository:

{{Cmd
|cd /var/git
|mkdir /var/git/newproject.git
|cd /var/git/newproject.git
|git init --bare
}}

On a the client station:

{{Cmd
|mkdir ~/newproject
|cd ~/newproject
|git init
|touch test
|git add test
|git config --global user.email "larry@gentoo.org"
|git config --global user.name "larry_the_cow"
|git commit -m 'initial commit'
|git remote add origin git@example.com:/var/git/newproject.git
|git push origin master
}}

{{Note|If the SSH server is not running with the default port adding the remote should look like this, with the appropriate port (in this case <code>59876</code>) following the host name:
: {{Cmd|git remote add origin ssh://git@example.com:59876/var/git/newproject.git}} }}

=== Common commands ===

Clone a repository:

{{Cmd|git clone git@example.com:/newproject.git}}
{{Cmd|git clone git://example.com:/newproject.git}}

{{Note|The following syntaxes apply in the example above:
{{Cmd|ssh://[user@]host.xz[:port]/path/to/repo.git/}}
{{Cmd|git://host.xz[:port]/path/to/repo.git/}}
For more, see man git-pull(1)}}

=== Repository management via GUI ===

Git ships with a tk GUI. Invoke it using:

{{Cmd
|gitk
|prompt=user ~/repository.git $
}}

{{Note|Make sure to compile git with <code>tk</code> USE flag. Also make sure to be within a git repository.}}

=== Serving and managing repositories via builtin web interface ===

Git comes with a built-in web interface called {{c|[http://git-scm.com/docs/gitweb gitweb]}}. It can run on a variety of web servers:

* [[lighttpd]] - No configuration necessary.
* [[Apache]] - Some configuration necessary.
* [[nginx]] - A small, robust, and high-performance HTTP server and reverse proxy.

In order to use {{c|gitweb}} be sure one of the three web servers has been installed and {{c|git}} has been built with the <code>cgi</code> USE flag.

There is a simple setup script that will create a working default configuration, start a web server (the default configuration is for {{c|lighttpd}}) and open the URL in a browser. Navigate to the repositories directory. Once inside type:

{{Cmd
|git instaweb
|prompt=user ~/repository.git $
}}

If {{c|git instaweb}} opens a 404 error, enable the <code>cgi</code> USE flag and rebuild {{c|git}}.

==== Help ====

Find out more about the options using the the built-in help output:

{{Cmd
|git help instaweb
|prompt=user ~/repository.git $
}}

For additional help consider reading the contextual man page:

{{Cmd
|man git instaweb
|prompt=user ~/repository.git $
}}

==== Configuration ====

Per-project configuration can be set in the repositories {{Path|.git/config}} file:

{{Cmd
|vim .git/config
|prompt=user ~/repository.git $
}}

Values in this file should be specific in an [https://en.wikipedia.org/wiki/INI_file ini-style format]:

{{FileBox|filename=.git/config|title=Setting lighttpd values for instaweb in a repository's configuration|lang=ini|1=
[instaweb]
        ; local = true
        httpd = lighttpd
        port = 8080
        browser = elinks
        modulePath = /usr/lib64/lighttpd/
}}

Adjust the values as needed. If the <code>local = true</code> light is uncommented (remove the <code>;</code>) {{c|instaweb}} will only be connectable from the localhost.

== See also ==

* [[Cgit]] - A fast web-interface (CGI) for {{c|git}}.
* [[Gitolite]]
* [[Git/tracking-etc]]
* [[CVS]] - Gentoo's old VCS for projects and the Portage tree.
* [[Kernel git-bisect]]

== External resources ==

* http://try.github.io/levels/1/challenges/1 - Video tutorials.
* https://www.codeschool.com/courses/git-real - Free, good, basic first-time tutorial
* [http://jeffkreeftmeijer.com/2010/why-arent-you-using-git-flow/ git flow documentation] - Client side scripts to make git repository management a snap.
* [http://git-scm.com/book/ The Official Git Handbook] - Hosted at the official git website.
* [http://rogerdudler.github.io/git-guide/ Git - The simple guide]
* [https://codewords.recurse.com/issues/two/git-from-the-inside-out Git from the inside out] - A well written publication from the Recurse Center. This article addresses what happens beneath the surface when using git.
* [https://hackernoon.com/lesser-known-git-commands-151a1918a60 Lesser known git commands] - A blog entry on helpful commands that go unnoticed.

[[Category:Software]]
