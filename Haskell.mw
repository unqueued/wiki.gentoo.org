{{InfoBox stack
|{{InfoBox homepage|https://haskell.org/haskellwiki/Haskell|header=true}}
|{{InfoBox wikipedia|Haskell (programming language)}}
|{{InfoBox project|Haskell}}
|{{InfoBox overlay|https://github.com/gentoo-haskell/gentoo-haskell/blob/master/README.rst}}
|{{InfoBox irc|haskell}}
|{{InfoBox irc|gentoo-haskell}}
}}

'''Haskell''' is [[Article description::a purely-functional programming language.]]

== Available ebuild repositories ==

* [https://github.com/gentoo-haskell/gentoo-haskell/blob/master/README.rst Gentoo-Haskell ebuild repository]. The most important part is that this repository requires a specific unmasking procedure to prevent blockers.

== Compiler and interpreter ==

* The probably most important and up-to-date Haskell-implementation is the [https://www.haskell.org/ghc/ '''Glasgow Haskell Compiler'''] (GHC). You can install it with:
: {{Emerge|dev-lang/ghc}}
: The package also includes an interpreter called GHCI (except on the ARM-architecture).
* Furthermore, there's [https://www.haskell.org/hugs/ '''Hugs'''], an (meanwhile (almost) out-dated) interpreter for Haskell98. You can install it with:
: {{Emerge|dev-lang/hugs98}}

== Cabal ==

With [https://www.haskell.org/cabal/ '''cabal'''] you can package and build libraries and programs. Install it with:
{{Emerge|dev-haskell/cabal-install}}

{{Warning|The Gentoo Haskell team does not recommend the use of {{Package|dev-haskell/cabal-install}} to install Haskell packages. Instead, <code>emerge</code> should be used, or the package should be installed locally in a [https://www.haskell.org/cabal/users-guide/installing-packages.html#developing-with-sandboxes sandbox]. If you need a package that isn't in the main Gentoo tree, it may be present in the [https://github.com/gentoo-haskell/gentoo-haskell/ Haskell ebuild repository]. If not, please file a bug/issue, or ask us in  [irc://irc.gentoo.org/gentoo-haskell #gentoo-haskell] on IRC!}}

== Updating Haskell packages ==

Sometimes:

{{Emerge|params=-auvDN --keep-going|@world}}

has trouble figuring out how to update Haskell packages. Providing emerge with the full list of dev-haskell packages that have upgrades available can sometimes help:

{{RootCmd|eix-update}}

{{Emerge|params=-av --oneshot --keep-going|`eix --only-names --upgrade -C dev-haskell`}}

{{RootCmd|haskell-updater}}

Unless <code>EAPI="6"</code> is approved sometimes we have sub-slot blockers (when updating ghc or some specific package there are a list of blockers) this issue could be solved via running:

{{RootCmd|haskell-updater --all -- {{=}}dev-lang/ghc-''<latest.version>''}}

== Hoogle with local installation ==

The Hoogle ebuild is currently only available in the official ''gentoo-haskell'' [[ebuild repository]]. So add that first.

{{Important|Remember to unmask the each package as described in the [https://github.com/gentoo-haskell/gentoo-haskell/blob/master/README.rst repository README]}}

{{RootCmd|layman -a haskell}}

In order to get the an offline installation of all hoogle data, you need to enable the <code>doc</code>, <code>hscolour</code>, and <code>hoogle</code> USE flag values.

{{RootCmd|echo "dev-haskell/* doc hoogle hscolour" >> /etc/portage/package.use}}

Enable the relevant USE flags for hoogle to store all data local, and emerge hoogle:

{{RootCmd|echo "dev-haskell/hoogle fetchdb fetchdb-ghc localdb" >> /etc/portage/package.use}}

{{Emerge|dev-haskell/hoogle}}

After emerging haskell packages, the hoogle database of the locally installed packages is updated by running:

{{RootCmd|hoogle-build-localdb}}

(It's normal for <code>hoogle-build-localdb</code> to output a bunch of junk. Redirect {{Path|stdout}} to {{Path|/dev/null}} if you add it to your e.g. {{Path|/etc/cron.daily}}.)

At this point, you should be able to use Hoogle from the command-line. For example, the following will search for the <code>splitOn</code> function:

{{Cmd|$ hoogle splitOn|output=<pre>
Data.Text.Lazy splitOn :: Text -> Text -> [Text]
Data.Text splitOn :: Text -> Text -> [Text]
Data.List.Extra splitOn :: Eq a => [a] -> [a] -> [[a]]
Extra splitOn :: Eq a => [a] -> [a] -> [[a]]
Data.List.Split.Internals splitOn :: Eq a => [a] -> [a] -> [[a]]
Data.List.Split splitOn :: Eq a => [a] -> [a] -> [[a]]
Data.List.Split.Internals splitOneOf :: Eq a => [a] -> [a] -> [[a]]
Data.List.Split splitOneOf :: Eq a => [a] -> [a] -> [[a]]
</pre>}}

=== Integration with GHCi ===

If you'd like to use Hoogle within GHCi, you can do it with a little modification to your local {{Path|~/.ghci}} file. Add the following:

{{FileBox|filename=~/.ghci|lang=haskell|1=
-- Surround a string in single quotes.
let single_quote s = concat ["'", s, "'"]

-- Escape a single quote in the shell. (This mess actually works.)
let escape_single_quote c = if c == '\'' then "'\"'\"'" else [c]

-- Simple heuristic to escape shell command arguments.
let simple_shell_escape = single_quote . (concatMap escape_single_quote)

:def hoogle \x -> return $ ":!hoogle --color " ++ (simple_shell_escape x)
:def doc \x -> return $ ":!hoogle --info --color " ++ (simple_shell_escape x)
}}

Now, within GHCi, you should have access to two new commands, <code>:hoogle</code> and <code>:doc</code>. The first will perform a normal Hoogle search and print the output:

{{Cmd|ghci|output=<pre>
ghci> :hoogle splitOn
Searching for: splitOn
Data.Text.Lazy splitOn :: Text -> Text -> [Text]
Data.Text splitOn :: Text -> Text -> [Text]
Data.List.Extra splitOn :: Eq a => [a] -> [a] -> [[a]]
Extra splitOn :: Eq a => [a] -> [a] -> [[a]]
Data.List.Split.Internals splitOn :: Eq a => [a] -> [a] -> [[a]]
Data.List.Split splitOn :: Eq a => [a] -> [a] -> [[a]]
Data.List.Split.Internals splitOneOf :: Eq a => [a] -> [a] -> [[a]]
Data.List.Split splitOneOf :: Eq a => [a] -> [a] -> [[a]]
</pre>}}

The second will display the Haddock documentation for the method:

{{Cmd|ghci|output=<pre>
ghci> :doc splitOn
Searching for: splitOn
Data.Text.Lazy splitOn :: Text -> Text -> [Text]

O(m+n) Break a Text into pieces separated by the first Text argument (which cannot be an empty string), consuming the delimiter. An empty delimiter is invalid, and will cause an error to be raised.

Examples:

> splitOn "\r\n" "a\r\nb\r\nd\r\ne" == ["a","b","d","e"]
> splitOn "aaa"  "aaaXaaaXaaaXaaa"  == ["","X","X","X",""]
> splitOn "x"    "x"                == ["",""]

and

> intercalate s . splitOn s         == id
> splitOn (singleton c)             == split (==c)

(Note: the string s to split on above cannot be empty.)

This function is strict in its first argument, and lazy in its second.

In (unlikely) bad cases, this function's time complexity degrades towards O(n*m). 

From package text
splitOn :: Text -> Text -> [Text]
</pre>}}

== HLint ==

[http://community.haskell.org/~ndm/hlint/ '''HLint'''] checks and simplifies the Haskell source code! Install it with:

{{RootCmd|layman -a haskell}}

{{Emerge|dev-haskell/hlint}}

== Editor plugins ==

=== Emacs ===

==== Haskell mode ====

The [https://www.haskell.org/haskellwiki/Haskell_mode_for_Emacs Haskell-Mode] for (X)Emacs makes programming easier; install it with:

{{Emerge|app-emacs/haskell-mode}}

For GNU Emacs:

{{Emerge|app-xemacs/haskell-mode}}

for XEmacs.

Then, you can configure it with <code>M-x customize-group RET haskell RET</code>.

==== ghc-mod ====

The official Gentoo Haskell ebuild repository provides an ebuild for ghc-mod, an extension of Haskell mode. Add the repository with:

{{RootCmd|layman -a haskell}}

Then, install the ebuild:

{{Emerge|app-emacs/ghc-mod}}

=== Haskell-Mode for Vim ===

[http://projects.haskell.org/haskellmode-vim/ There]'s also a Haskell-Mode for [[Vim]].

== Troubleshooting ==

=== Haskell ebuilds failing with out of memory error ===

When [[:/etc/portage/make.conf#MAKEOPTS|MAKEOPTS]] is set to allow parallel jobs, ghc may fail in Haskell ebuilds with <code>ghc: failed to create OS thread: Cannot allocate memory</code>. To fix this, lower the amount of jobs set in <var>MAKEOPTS</var>, or do not allow parallel jobs at all. <var>MAKEOPTS</var> can be overridden for failing ebuilds as described in [[Knowledge Base:Overriding environment variables per package|Overriding environment variables per package]].

== External resources ==

* The {{IRC|haskell|mode=webchat}} and {{IRC|gentoo-haskell|mode=webchat}} channels on code.freenode.net.

[[Category:Haskell]]
