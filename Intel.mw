{{Lowercase title}}
{{InfoBox stack
|{{InfoBox homepage|http://intellinuxgraphics.org|header=true}}
|{{InfoBox wikipedia|Intel GMA}}
|{{InfoBox gitweb|https://cgit.freedesktop.org/xorg/driver/xf86-video-intel|text=GitWeb (userspace driver)|raw=true}}
|{{InfoBox odoc|https://01.org/linuxgraphics/}}
}}

'''intel''' is the open source graphics driver for Intel GMA onboard graphics cards, starting with the Intel 810.

== Hardware detection ==

To choose the right driver, first detect the graphics card. {{c|[[lspci]]}} can be used for this task:

{{RootCmd|lspci {{!}} grep -i VGA}}

This should show something like this:
{{RootCmd|lspci {{!}} grep -i VGA|output=<pre>00:02.0 VGA compatible controller: Intel Corporation 3rd Gen Core processor Graphics Controller (rev 09)</pre>}}

{{Note|The {{c|lspci}} output for the graphics controller may refer to ''CPU generations'', whereas the '''Feature support''' table below refers to ''GPU generations''. E.g., “3rd Gen” in the example lspci output above corresponds to “Gen7” in the table below.}}

== Feature support ==

{| class="table table-striped table-condensed"
|-
! Generation
! Chipset
! OpenGL
! OpenGL ES
! OpenCL
! [[VAAPI]]
! VIDEO_CARDS
|-
| [[Wikipedia:List_of_Intel_graphics_processing_units#First_generation|Gen 1]]
| 810, 815
| {{Yes|1.2}}
| {{No}}
| {{No}}
| {{No}}
| ''intel''
|-
| [[Wikipedia:List_of_Intel_graphics_processing_units#Second_generation|Gen 2]]
| i830M, 845G, 855GM, 865G
| {{Yes|1.3}}
| {{No}}
| {{No}}
| {{No}}
| ''intel''
|-
| [[Wikipedia:List_of_Intel_graphics_processing_units#Third_generation|Gen 3]]
| 915G/GM, 945G/GM, G/Q33, Atom D4xx/D5xx/N4xx/N5xx
| {{Yes|1.4/1.5}}
| {{No}}
| {{No}}
| {{No}}
| ''intel i915''
|-
| [[Wikipedia:List_of_Intel_graphics_processing_units#Fourth_generation|Gen 4]]
| 965G/GM/Q, G/Q35, G41, G/Q43, G/GM/Q45
| {{Yes|2.1}}
| {{Yes|2.0}}
| {{No}}
| {{Partial|G/GM45: MPEG2 only}}
| ''intel i965''
|-
| [[Wikipedia:List_of_Intel_graphics_processing_units#Fifth_generation|Gen 5]]
| [[Wikipedia:Nehalem_(microarchitecture)|Nehalem]] (Ironlake)
| {{Yes|2.1}}
| {{Yes|2.0}}
| {{No}}
| {{Yes}}
| ''intel i965''
|-
| [[Wikipedia:List_of_Intel_graphics_processing_units#Sixth_generation|Gen 6]]
| [[Wikipedia:Sandy_Bridge|Sandy Bridge]]
| {{Yes|3.3}}
| {{Yes|3.0}}
| {{No}}
| {{Yes}}
| ''intel i965''
|-
| [[Wikipedia:List_of_Intel_graphics_processing_units#Seventh_generation|Gen 7]]
| [[Wikipedia:Ivy_Bridge_(microarchitecture)|Ivy Bridge]], Valley View, [[Wikipedia:Haswell_(microarchitecture)|Haswell]], Atom Z36xx/Z37xx
| {{Yes|3.3}}
| {{Yes|3.0}}
| {{Yes|1.1<ref name="ocl" group="table"/>}}
| {{Yes}}
| ''intel i965''
|-
| [[Wikipedia:List_of_Intel_graphics_processing_units#Eighth_generation|Gen 8]]
| [[Wikipedia:Broadwell_(microarchitecture)|Broadwell]], Cherryview (Braswell, Cherry Trail)
| {{Yes|3.3}}
| {{Yes|3.0}}
| {{Yes|1.1<ref name="ocl" group="table"/>}}
| {{Yes}}
| ''intel i965''
|-
| [[Wikipedia:List_of_Intel_graphics_processing_units#Ninth_generation|Gen 9]]
| [[Wikipedia:Skylake_(microarchitecture)|Skylake]]
| {{Yes|4.4}}
| {{Yes|3.0}}
| {{Yes|1.1<ref name="ocl" group="table"/>}}
| {{Yes}}
| ''intel i965''
|}

<references group="table">
<ref name="ocl">Uses the {{Package|dev-libs/beignet}} package ([http://wiki.freedesktop.org/www/Software/Beignet/ Upstream info])</ref>
</references>

A full list of Intel CPU graphic capabilities can be found [[Wikipedia:Intel_HD_and_Iris_Graphics#Capabilities|here]].

== Installation ==

=== Firmware ===

If you are using Kabylake, Skylake or Broxton Intel Graphics, install sys-kernel/linux-firmware.

{{Emerge|params+=|sys-kernel/linux-firmware}}

Otherwise you might see errors such as 
<pre>
kernel: i915 0000:00:02.0: Direct firmware load for i915/skl_dmc_ver1.bin failed with error -2
kernel: i915 0000:00:02.0: Failed to load DMC firmware [https://01.org/linuxgraphics/intel-linux-graphics-firmwares], disabling runtime power management.
</pre>
in dmesg. Include the files required for your GPU in the kernel, in this case:

{{KernelBox|
Device Drivers  --->
    Generic Driver Options  --->
        -*- Userspace firmware loading support
        [*] Include in-kernel firmware blobs in kernel binary
            (i915/skl_dmc_ver1.bin)
            (/lib/firmware) Firmware blobs root directory
}}

=== Kernel ===

The following kernel options need to be activated:

{{KernelBox|title=Prior to linux-4.4|1=
Processor type and features  --->
    [*] MTRR (Memory Type Range Register) support
Device Drivers  --->
    Graphics support  --->
        <*> /dev/agpgart (AGP Support)  --->
             <*> Intel 440LX/BX/GX, I8xx and E7x05 chipset support
        <*> Direct Rendering Manager (XFree86 4.1.0 and higher DRI support) --->
            <*> Intel 8xx/9xx/G3x/G4x/HD Graphics
            [*]   Enable modesetting on intel by default
            [*]   Enable legacy fbdev support for the modesetting intel driver 
}}

The legacy fbdev support is required since kernel 3.14.14 at least for i915 (<code>CONFIG_DRM_I915_FBDEV=y</code>).<ref>Gentoo Forums, [https://forums.gentoo.org/viewtopic-t-998526.html "Black screen on boot after kernel upgrade - grub2"]</ref><ref>Gentoo Forums, [https://forums.gentoo.org/viewtopic-p-7596748.html "Black screen on kernel 3.14.14"]</ref>
For hybrid Intel/AMD system, follow also the steps of [[radeon]] (opensource) or [[Fglrx|fglrx]] (closed binary) drivers.

Since kernel version 4.4 the driver has been moved and the legacy fbdev support is now <code>CONFIG_DRM_FBDEV_EMULATION=y</code>.          

{{KernelBox|title=linux-4.4|<pre>
        Device Drivers  --->
            Graphics support  --->
                <*> /dev/agpgart (AGP Support)  --->
                    --- /dev/agpgart (AGP Support)
                    < >   AMD Opteron/Athlon64 on-CPU GART support
                    -*-   Intel 440LX/BX/GX, I8xx and E7x05 chipset support
                    < >   SiS chipset support
                    < >   VIA chipset support
                [ ] VGA Arbitration
                [ ] Laptop Hybrid Graphics - GPU switching support
                <*> Direct Rendering Manager (XFree86 4.1.0 and higher DRI support)  --->
                    --- Direct Rendering Manager (XFree86 4.1.0 and higher DRI support)
                    [*]   Enable legacy fbdev support for your modesetting driver
                [ ] Allow to specify an EDID data set instead of probing for it
                    I2C encoder or helper chips  --->
                < > 3dfx Banshee/Voodoo3+
                < > ATI Rage 128
                < > ATI Radeon
                < > AMD GPU
                < > Nouveau (NVIDIA) cards
                < > Intel I810
                <*> Intel 8xx/9xx/G3x/G4x/HD Graphics
                [ ]   Enable preliminary support for prerelease Intel hardware by default
                < > Matrox g200/g400
                < > SiS video cards
                < > Via unichrome video cards
                < > Savage video cards
                < > Virtual GEM provider
                < > DRM driver for VMware Virtual GPU
                < > Intel GMA5/600 KMS Framebuffer
                < > DisplayLink
                < > AST server chips
                < > Kernel modesetting driver for MGA G200 server engines
                < > Cirrus driver for QEMU emulated device
                < > QXL virtual GPU
                < > DRM Support for bochs dispi vga interface (qemu stdvga)
                    Display Panels  ----                 
                    Display Interface Bridges  ----
                    Frame buffer Devices  --->
                -*- Backlight & LCD device support  --->
                    Console display driver support  --->
                [*] Bootup logo  --->    
</pre>}}

=== Driver ===

Portage uses the <var>[https://packages.gentoo.org/useflags/video_cards_intel VIDEO_CARDS]</var> variable, which expands into the <var>[[:/etc/portage/make.conf#USE_EXPAND|USE_EXPAND]]</var> variable, for enabling support for various graphics cards in packages. Assuming {{Package|x11-base/xorg-drivers}} has already been installed, setting <var>VIDEO_CARDS</var> variable in {{Path|[[:/etc/portage/make.conf#VIDEO_CARDS|etc/portage/make.conf]]}} will pull in the correct video driver: (see the [[Intel#Feature support|feature matrix]]) 

{{FileBox|filename=[[:/etc/portage/make.conf#VIDEO_CARDS|etc/portage/make.conf]]|title=Gen 1|lang=bash|1=VIDEO_CARDS="intel"}}

{{FileBox|filename=[[:/etc/portage/make.conf#VIDEO_CARDS|etc/portage/make.conf]]|title=Gen 2 and Gen 3|lang=bash|1=VIDEO_CARDS="intel i915"}}

{{FileBox|filename=[[:/etc/portage/make.conf#VIDEO_CARDS|etc/portage/make.conf]]|title=Gen 4 through Gen 9|lang=bash|1=VIDEO_CARDS="intel i965"}}

"[https://packages.gentoo.org/useflags/video_cards_intel intel]" is for {{Package|x11-base/xorg-drivers}} and <code>[https://packages.gentoo.org/useflags/video_cards_i915 i915]</code> resp. <code>[https://packages.gentoo.org/useflags/video_cards_i965 i965]</code> [https://bugs.gentoo.org/show_bug.cgi?id=522878#c1 are for media-libs/mesa].

Check the USE flags of {{Package|x11-drivers/xf86-video-intel}}:

{{USEflag|package=x11-drivers/xf86-video-intel}}

After making any changes update the system so the changes take effect by running the {{c|emerge}} command with the <code>--changed-use</code> option:

{{Emerge|params+=--changed-use --deep|@world}}

=== VAAPI ===

Intel GMA X4500HD / G45 / GM45 and newer supports [[VAAPI]] hardware video acceleration.

== Configuration ==

=== Permissions ===

{{VIDEO CARDS/Permissions}}

=== xorg.conf ===

Choose one of the following configuration options:

* Classic Driver -- {{Package|x11-drivers/xf86-video-intel}}
: As xorg is not aware of i915 or i965 they will need to be addressed as Driver <code>intel</code>.

: {{VIDEO_CARDS/xorg.conf|intel}}

* Alternate Driver for Gen 4+ -- Modesetting -- Experimental

: {{Note|These instructions are labeled as "Experimental" because they are new. Experiences of this configuration can be found in the [[Talk:Intel|Discussion]] of this page. Add any difficulties there so this section can be improved.}}

: As of xorg-server-1.17, the modesetting driver was moved into {{Package|x11-base/xorg-server}}.  This driver has more features than the classic driver, such as GLAMOR.

: xorg-server is easily configured to prefer <code>modesetting</code> over the older <code>intel</code> driver.

: {{VIDEO_CARDS/xorg.conf|modesetting}}

The [[X server]] is designed to work out-of-the-box, with no need to manually edit X.Org's configuration files. It should detect and configure devices such as displays, keyboards, and mice.

However, the main configuration file of the X server is the [[xorg.conf]].

== Troubleshooting ==

* {{Bug|xf86-video-intel|search=package}}
* {{Bug|xorg|site=fdo|search=product|component=Driver%2Fintel}}
* {{Bug|DRI|site=fdo|search=product|component=DRM%2FIntel}}
* [http://intellinuxgraphics.org/how_to_report_bug.html Guide, how to report bugs upstream]


=== html5/vaapi gpu hangs ===

If your GPU hangs up when watching [[VAAPI|vaapi-accelerated]] video e.g. on youtube, you can try enabling your IOMMU:

{{KernelBox|1=
Device Drivers  --->
    [*] IOMMU Hardware Support --->
        [*] Support for Intel IOMMU using DMA Remapping Devices
        [*]   Enable Intel DMA Remapping Devices by default
}}

Related [https://bugs.freedesktop.org/show_bug.cgi?id=92814 upstream bug report].

=== KDM freezes ===

A workaround is to set <code>TerminateServer=true</code> in all sections of the file {{Path|/usr/share/config/kdm/kdmrc}}, which starts with <code>X-</code>.

=== KDE's plasma eating CPU ===

If /usr/bin/plasmashell is always consuming several percent of CPU, perhaps this is related to a vsync problem.
QT Quick Animation seem to loop too fast when vsync is not managed by the driver ([https://bugreports.qt.io/browse/QTBUG-45959 Reference])

A way to enable vsync with SNA is to enable "TearFree" Option in xorg.conf

{{FileBox|filename=/etc/X11/xorg.conf.d/20-intel.conf|lang=xorg_conf|
Section "Device"
        Identifier "Device0"
        Driver "intel"

        Option      "AccelMethod" "SNA"
        Option      "TearFree"    "true"
EndSection}}

[https://community.linuxmint.com/tutorial/view/2304 thanks to mint doc]
=== Black screen ===

* According to this [http://wiki.debian.org/KernelModesetting Debian wiki], <var>CONFIG_FRAMEBUFFER_CONSOLE</var> must be set to y (aka built-in to the kernel). Otherwise, it is possible to always have a black screen unless nomodeset is passed to the kernel, thus disabling kernel mode setting (KMS). <code>acpi_osi="Linux"</code> can be passed to the kernel command line to try to solve this kind of issue. This is usually done through the bootloader.
* Kernel with version 4.2 or newer is needed with some gen8 chipsets<ref>Gentoo Forums, [https://forums.gentoo.org/viewtopic-t-1034212.html "N3700 8086:22b1 i915 black screen, works in kernel 4.2.6"]</ref>.

=== Brightness doesn't change with keyboard shortcuts ===

First, make sure vendor compatibility is on in the kernel configuration. Toshiba for Toshiba, etc.

If it is, or when the brightness buttons are working, the issue is that the kernel can not detect ''where'' the brightness control is located.

Luckily, this is easy enough to modify, as long as the kernel version is >= 3.13.x and < 4.2.

Add {{KernelBox|title=command line|1=video.use_native_backlight=1}} to the kernel command line.

On kernels >= 4.2, the {{c|video.use_native_backlight}} option is no longer available.<ref>RedHat Bug 1272633: [https://bugzilla.redhat.com/show_bug.cgi?id=1272633#c5 "video.use_native_backlight=1 doesn't work" (comment 5)]</ref> You should use one of the following instead (experiment to see which works on your system):

{{KernelBox|title=command line|1=acpi_backlight=video}}
{{KernelBox|title=command line|1=acpi_backlight=native}}
{{KernelBox|title=command line|1=acpi_backlight=vendor}}

Do your key bindings map to actions viewable in xev? Can you adjust the screen brightness using xbacklight, then you can always do a work around via a keyboard remapping. For LXDE it can be done via


{{FileBox|filename=~/.config/openbox/lxde-rc.xml|1=  
<keybind key="XF86MonBrightnessUp">
      <action name="Execute">
          <command>xbacklight +5</command>
      </action>
</keybind>
<keybind key="XF86MonBrightnessDown">
      <action name="Execute">
          <command>xbacklight -5</command>
      </action>
</keybind>
}}

== See also ==

* [[Xorg/Guide]] - A guide on how to configure Xorg.
* [[hprofile]] - Switching between other graphics drivers and intel.

== External resources ==

* [http://www.x.org/wiki/IntelGraphicsDriver X.Org Wiki]

== References ==
{{reflist}}

[[Category:Graphics Adapters]]
