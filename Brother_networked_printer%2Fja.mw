<languages />
This document covers the installation of a Brother network printer . It covers only the networked installation taking the DCP-750CW as an example. It may be applied to other network printer of Brother.

{{Important| While this page should be self-sufficient to install a printer,  it is recommended to read this page and the [[Printing|Printing]] page in their entirety before starting the installation.}} 

== User feedback ==

After having applied this guide to the printer, please update the following table  so that other users can easily confirm if successful installations have been performed with their printer model or not:

{| class="table"
|-
!Printer model
!Arch.
! Gentoo configuration
!Printer?
!Scanner?
!Remarks
|-
|DCP-750CW
|X86_64
|gnome3.8 systemd & gnome OpenRC
|Works!
|Works!
|No remark
|-
|DCP-7055W
|X86_64
|3.15.9-gentoo, KDE 4.14.3
|Works!
|Works!
|No remark
|-
|DCP-J140W
|X86_64
|3.14.14-gentoo & genkernel
|Works!
|Works!
|Scanner only works after emerging {{Package|dev-libs/libusb-compat}}. Thanks to i92guboj for discovering this and posting it on the Gentoo Forums.
|-
|DCP-J925DW
|x86_64
|Xfce OpenRC
|Works!
|Works!
|Packages ''net-print/brother-dcpj925dw'' and ''media-gfx/brscan4'' in [https://gitweb.gentoo.org/repo/dev/ulm.git/ ulm overlay]
|-
|HL-2240
|x86_64
|OpenRC
|Works!
|n/a
|[http://support.brother.com/g/b/downloadlist.aspx?c=us&lang=en&prod=hl2240_us_eu&os=127]
|-
|HL-L2340DW
|amd64
|OpenRC
|Works!
|n/a
|Use [https://github.com/stefan-langenmaier/brother-overlay/tree/master/net-print/brother-genml1-bin net-print/brother-genml1-bin] from [https://github.com/stefan-langenmaier/brother-overlay/tree/master/ brother-overlay]
|-
|MFC-J4410DW
|x86_64
|KDE SC 4.11.5 OpenRC
|Works!
|Works!
|Filter to copy is at {{Path|/opt/brother/Printers/mfcj4410dw/lpd/filtermfcj4410dw}} but scanner not detected by xsane at the moment though installation is OK.
|-
|MFC-J870DW
|x86_64
|Xfce OpenRC
|Works!
|Works!
|Packages ''net-print/brother-mfcj870dw'' and ''media-gfx/brscan4'' in [https://gitweb.gentoo.org/repo/dev/ulm.git/ ulm overlay]
|-
|MFC-J5910DW
|x86_64
|Gnome 3.12 Systemd
|Works!
|Works!
|Filter to copy is {{Path|/usr/lib64/cups/filter/brother_lpdwrapper_mfcj5910dw}}. Also requires {{Package|dev-libs/libusb-compat}} (see section ''Common Troubles'') 
|-
|MFC-J6920DW
|x86_64
|XFce
|Works!
|Works!
|[http://support.brother.com/g/b/downloadlist.aspx?c=us&lang=en&prod=mfcj6920dw_us_eu_as&os=127&flang=English download page], filter {{Path|/usr/lib64/cups/filter/brother_lpdwrapper_mfcj6920dw}}, scanner config command <tt>brsaneconfig4</tt>
|-
|MFC-9320CW
|x86_64
|Gnome 3.10
|Works!
|Works!
| [https://github.com/stefan-langenmaier/brother-overlay Overlay]
|-
|HL-4570CDW
|x86_64
|Gnome 3.10
|Works!
|n/a
| [https://github.com/stefan-langenmaier/brother-overlay Overlay]
|-
|MFC-7460DN
|x86_64,x86
|
|Works!
|unknown
| [https://github.com/stefan-langenmaier/brother-overlay Overlay]
|-
|DCP-7060D, DCP-7065DN, DCP-8080DN, DCP-L2520DW, DCP-L2540DW, HL-2230, HL-2240, HL-2240D, HL-2270DW, HL-2280DW, HL-5370DW/HL-5370DWT, HL-5440D, HL-5450DN, HL-5470DW, HL-6180DW, HL-L2320D, HL-L2360DW, HL-L2380DW, MFC-7360N, MFC-7460DN, MFC-7860DW, MFC-8480DN, MFC-8510DN, MFC-8710DW, MFC-8890DW, MFC-8910DW, MFC-8950DW, MFC-L2700DW, MFC-L2720DW, MFC-L2740DW
|x86_64,x86
|
|Works!
|unknown
| [https://github.com/stefan-langenmaier/brother-overlay Overlay]
|-
|MFC-8950DW
|x86_64
|KDE 4.12.5
|Works!
|Works!
| Filter to copy is at {{Path|/opt/brother/Printers/MFC8950DW/lpd/filter_MFC8950DW}}
|-
|MFC-5890CN
|x86_64
|NO DEPENDENCY
|Works!
|Works!
|scanner config command <tt>brsaneconfig3</tt>
|-
|MFC-9970CDW
|x86_64
|n/a
|Works!
|unknown
|
|-
|MFC-9140CDN
|x86_64
|Xfce-4.10 OpenRC
|Works!
|Works!
|scanner requires {{Package|dev-libs/libusb-compat}} to work (see section ''Common Troubles'')
|}

== Prerequisites ==

=== cups ===

Make sure {{Package|net-print/cups}} is installed:

{{Emerge|net-print/cups}}

The cups service must be started before the driver(s) can be installed.

===== OpenRC =====

If OpenRC is used, then the following command can be issued to start the ''cups'' service.

{{RootCmd|/etc/init.d/cupsd start}}  

To have it started automatically at boot time, use <tt>rc-update</tt>:

{{RootCmd|rc-update add cupsd default}}

===== Systemd  =====

If systemd is used, then the following command can be issued to start the ''cups'' service.

{{RootCmd|systemctl start cups.service}}  

To have it started automatically at boot time, invoke the following:

{{RootCmd|systemctl enable cups.service}}

== Installing the drivers ==

=== Preferred: Using overlay drivers ===

If the printer is supported by an ebuild in [https://github.com/stefan-langenmaier/brother-overlay/tree/master/ brother-overlay] or some [http://gpo.zugaina.org/Search?search=brother other overlay], then please use it, as it usually contains all the prerequisites mentioned here. It would allow to skip the section "Alternative: rpm installation".

To enable this [[Overlay|overlay]], create the proper {{Path|repos.conf}} file:

{{:/etc/portage/repos.conf/brother-overlay.conf/en}}

{{RootCmd|emaint sync -r brother-overlay && eix-update}}

The package {{Package|dev-vcs/git}} needs to be installed for using this overlay.  Alternatively, [[layman#Adding_custom_overlays|layman]] can be used for adding the overlay.

==== Brother BrGenML1 for CUPS ====

The [https://github.com/stefan-langenmaier/brother-overlay/tree/master/net-print/brother-genml1-bin net-print/brother-genml1-bin] ebuild from [https://github.com/stefan-langenmaier/brother-overlay/tree/master/ brother-overlay] contains the Generic printer drivers as offered on [http://support.brother.com/g/b/downloadlist.aspx?c=us&lang=en&prod=hll2340dw_us_eu_as&os=127 support.brother.com] for a wide range of compatible models (click the ''Compatible Model'' link on [http://support.brother.com/g/b/downloadend.aspx?c=us&lang=en&prod=hll2340dw_us_eu_as&os=127&dlid=dlf101124_000&flang=4&type3=10034#pane3 BrGenML1 Compatible Models]): 
* Generic LPR printer driver (rpm package)
* Generic CUPSwrapper printer driver (rpm package)

{{Emerge|net-print/brother-genml1-bin}}

In cups the driver appears as printer model '''Brother BrGenML1 for CUPS'''.

[[File:Brother_BrGenML1_for_CUPS.png|border]]

=== Alternative: rpm installation ===

As the drivers are available from Brother in the form of an {{Path|.rpm}} file, the {{Package|app-arch/rpm}} package needs to be installed.

{{Emerge|app-arch/rpm}}

==== Missing directories ====

Please create these directories up front; it will save a lot of trouble later:

{{RootCmd| mkdir -p /var/spool/lpd}}
{{RootCmd| mkdir -p /usr/lib64/cups/filter}}

==== Downloading the driver from Brother ====

The drivers for Brother printers are available at [http://welcome.solutions.brother.com/bsc/public_s/id/linux/en/index.html Brother solutions'] web page.

Search for the correct model name by following the directions given by the pages.

After having chosen the right model, four drivers will be presented for download. Please download the two ones ending in {{Path|.rpm}} for ''LPR driver'' and ''cupswrapper driver''.

==== ドライバをインストールする ====

Installing the drivers may be a multiple-step process as some needed directories may appear missing on the system.

To install a driver change to the directory where the downloaded {{Path|.rpm}} files are located.

Next, issue the following command to see the filenames:

{{RootCmd|ls -a |output=<pre>
.  ..  dcp750cwcupswrapper-1.0.1-1.i386.rpm  dcp750cwlpr-1.0.1-1.i386.rpm
</pre>}}

Of course the driver names may change according to the model's name. The output of the previous command can be used to copy and paste the filenames in the rpm command to avoid typos when entering them.

First install the LPR driver.

{{RootCmd|rpm -i --nodeps dcp750cwlpr-1.0.1-1.i386.rpm}}

The installation may give some warnings, telling that some directories are missing. In this case, add the missing directories by hand and re-install the driver with this command:

{{RootCmd|rpm -i --nodeps --replacepkgs dcp750cwlpr-1.0.1-1.i386.rpm}}

Next install the ''cupswrapper'' driver  the same way:

{{RootCmd|rpm -i --nodeps dcp750cwcupswrapper-1.0.1-1.i386.rpm}}

Again, the installation may give some warnings, telling that some directories are missing. Try to add the missing directories by hand and re-install the driver with this command:

{{RootCmd|rpm -i --nodeps --replacepkgs dcp750cwcupswrapper-1.0.1-1.i386.rpm}}

{{Note|Do not forget the --replacepkgs option to force the re-installation of all the necessary files.}}

==== Copying the filter at the right place ====

Copy the filter to the right place with the following command:

{{Note| Have a look at the feedback table at the top of this page to know more about the filter's name.}}

{{RootCmd|cp /usr/lib64/cups/filter/brlpdwrapperdcp750cw /usr/libexec/cups/filter/}}

== Installing the printer ==

=== Connect the printer to the network ===

Connect the printer to the network as described in the network section of the printer model's [http://support.brother.com/g/b/manuallist.aspx?c=us&lang=en&prod=hll2340dw_us_eu_as&flang=English&type3=10014&type2=5 Online User Guide]. From this step, the printer's network address can be obtained which is needed for CUPS in the next step.  When pointing the browser to the printer's network address it will go to the printer's user interface.

<gallery>
File:Myhomeprinter.png
</gallery>

=== Use cups' web interface to install the printer ===

Printer detection works much better if the printer is directly connected to the computer than via network.  So if possible connect the printer to the computer and point the browser at [http://localhost:631 localhost:631].

In the ''CUPS for Administrators'' section of the home page, click on ''Find New Printers''. It will list the available new printer(s). Then, in the printer's line item, click on  ''Add This Printer''.  On the next screen, accept or adjust name, description and location and press ''Continue''.  Complete the dialog with manufacturer Brother and the correct driver, and select ''Add Printer''.

{{Note|If the system asks for a user id and password, enter <tt>root</tt> and the root password. Regular users will not have the proper permissions to install a printer. It might be necessary to leave and re-enter the session to be able to authenticate as <tt>root</tt>.}}

Next, disconnect the printer from the computer.  In CUPS dialog, for the just installed printer, click the ''Administation'' drop down menu and select ''Modify Printer''.  On the next screens, select LPD/LPR, enter the network URL, click continue, select the previously installed "current driver" and ''modify Printer''.

<gallery>
File:Modify_printer1.png|Select LPD/LPR
File:Modify_printer2.png|Enter network URL
File:Modify_printer3.png|Continue
File:Modify_printer4.png|Press "Modify Printer"
</gallery>

{{Note|Other protocols than LPD/LPR can be used. Please refer to Brother's documentation.}}

Don't forget to set the user's default printer

{{Cmd|lpstat -a|output=<pre>
Brother_HL-L2340D_series accepting requests since Fri 29 May 2015 09:11:30 AM CEST
</pre>}}
{{Cmd|lpoptions -d Brother_HL-L2340D_series|output=<pre>
copies=1 device-uri=http://192.168.178.27:631/ipp/port1 finishings=3 job-cancel-after=10800 job-hold-until=no-hold job-priority=50 job-sheets=none,none marker-change-time=1432883490 marker-colors=#000000,none marker-high-levels=100 marker-levels=-1,95 marker-low-levels=16 marker-names='Black\ Toner\ Cartridge,Drum\ Unit' marker-types=toner number-up=1 printer-commands=AutoConfigure,Clean,PrintSelfTestPage printer-info='Brother HL-L2340D series' printer-is-accepting-jobs=true printer-is-shared=false printer-location='Local Printer' printer-make-and-model='Brother BrGenML1 for CUPS ' printer-state=3 printer-state-change-time=1432883490 printer-state-reasons=none printer-type=10522644 printer-uri-supported=ipp://localhost/printers/Brother_HL-L2340D_series
</pre>}}

== Installing the scanner  ==

=== Prerequisites ===

Make sure the {{Package|media-gfx/sane-backends}} package is installed in order to install the driver for the scanner. As most users will use <tt>xsane</tt> to scan a document, just emerge it. The {{Package|media-gfx/sane-backends}} package will be pulled in as a dependency.

{{Emerge|media-gfx/xsane}}

=== Installing the driver ===

Download the driver from the [http://welcome.solutions.brother.com/bsc/public_s/id/linux/en/download_scn.html Brother Solutions]'s download page for the scanner.

{{Important|Pay attention to the family the printer belongs to. Depending on the family, the right brscan will need to be selected (brscan, brscan2, brscan3 or brscan4) as well as the right architecture (32 bits or 64 bits depending on the system installation).}}

Change to the directory where the downloaded drivers are, and run the following command:

{{RootCmd|ls -a}}

This will show the file names of the downloaded files, allowing for easy copy/paste for the next commands.

Install the drivers using <tt>rpm</tt>:

{{RootCmd|rpm -i --nodeps brscan2-0.2.5-1.x86_64.rpm}}

{{Note|If xsane was not installed yet, install it, then add <code>--replacepkgs</code> as an option to the previous command to reinstall the driver.}}

===Configuring the scanner ===

Once the driver is correctly installed, use the following command:

{{RootCmd|brsaneconfig2 -a name{{=}}monScanner model{{=}}DCP-750CW ip{{=}}192.168.1.13}}

{{Note| ''brsaneconfig2'' should be replaced with the command corresponding to the printer's family (see above), ''monScanner'' with any name of personal choice, and ''DCP-750CW'' with the printer's model name.}}

Now check everything is correctly installed:

{{RootCmd|brsaneconfig2 -q {{!}} grep monScanner|output=<pre>
  0 monScanner          "DCP-750CW"         I:192.168.1.13</pre>}}

{{Note|Replace ''monScanner'' with the name chosen above.}}

Congratulation! The scanner is now ready for use!

== トラブルシューティング ==

=== Generic LPR printer driver on amd64 ===

The [http://support.brother.com/g/b/downloadlist.aspx?c=us&lang=en&prod=hll2340dw_us_eu_as&os=127 printer driver] uses statically compiled x86 binaries. To be able to execute them the kernel needs to have the following configuration enabled: IA32_EMULATION

=== Text shifted up ===

Sometimes it happens that the text is shifted up toward the upper border of the page.

To correct this, enter the following command:

{{RootCmd| brprintconf_dcp750cw -pt A4}}

=== Scanner not detected ===

It may happen that, when xsane is launched, the scanner is not detected. This is probably due to a too recent version of libusb. In order to solve this, it might be necessary to install {{Package|dev-libs/libusb-compat}}:

{{Emerge|dev-libs/libusb-compat}}

== 外部の情報 ==

* [http://solutions.brother.com/linux/ Brother solutions, Linux page] on Brother.com
* [https://github.com/stefan-langenmaier/brother-overlay/tree/master/ brother-overlay] on Github.com


[[Category:Brother]]
