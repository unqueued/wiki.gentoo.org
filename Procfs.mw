{{Lowercase title}}
{{InfoBox stack
|{{InfoBox wikipedia|header=true}}
}}
'''procfs''' ('''proc'''ess '''f'''ile'''s'''ystem) is a virtual [[filesystem]] to output and change system and process information. It is generated by the [[kernel]] and mounted at {{Path|/proc}}. The information in the [[sysfs]] filesystem replaces more and more system information of procfs.

== Installation ==

=== Kernel ===

Activate the following kernel options:

{{KernelBox|title=Enable Procfs support|1=
File systems  --->
    Pseudo filesystems  --->
        <*> /proc file system support
}}

== Configuration ==

{{Note|According to [[Handbook:AMD64/Installation/System#Creating_the_fstab_file]] this step seems to no longer be needed.}}
Change the {{Path|/etc/[[fstab]]}} to mount procfs at boot time to {{Path|/proc}}:

{{FileBox|filename=/etc/fstab|title=Adding /proc to fstab|1=
proc     /proc     proc     nosuid,nodev,noexec     0 0
}}

=== Restricting access to PID directories ===

procfs provides the <code>hidepid</code> mount option to restrict access to the {{Path|/proc/<pid>}} directories by other users. This is a hardening technique that can make it more difficult for malicious local users to gather information about the processes of other users<ref>Vasiliy Kulikov. [https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=0499680a42141d86417a8fbaa8c8db806bea1201 procfs: add hidepid= and gid= mount options], [https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/ Linux kernel source tree], January 10th, 2012. Retrieved on July 31st, 2015.</ref>.

<code>hidepid=0</code>: The {{Path|/proc/<pid>/*}} files will be world readable. This is the default.
<br />
<code>hidepid=1</code>: The {{Path|/proc/<pid>}} directories are visible by all users, but users can only access the {{Path|/proc/<pid>}} directories they own. This will protect files such as {{Path|/proc/<pid>/cmdline}}, which may contain sensitive information.
<br />
<code>hidepid=2</code>: Same as <code>hidepid=1</code> but the {{Path|/proc/<pid>}} directories of other users are hidden. Since this will hide all process information from all users except root, it may be useful to allow access to privileged users such as those that belong to the <tt>wheel</tt> group.

{{FileBox|filename=/etc/fstab|title=Hiding process information from other users except those in the wheel group|1=
proc     /proc     proc     nosuid,nodev,noexec,hidepid=2,gid=wheel     0 0
}}

== Usage ==

See the [[Wikipedia:procfs#Linux|Wikipedia article]] for the file's purpose.

* Use <tt>cat</tt> to read the information, e.g. output the version of the currently running kernel:
: {{Cmd|cat /proc/version}}

* To set values at runtime - if possible - use <tt>echo</tt>, e.g. to enable the [[Wikipedia:Magic SysRq key|magic SysRq key]]::
: {{RootCmd|echo 1 > /proc/sys/kernel.sysrq}}

=== sysctl ===

{{InfoBox stack
|{{InfoBox wikipedia|sysctl|header=true}}
}}

<tt>sysctl</tt> is a mechanism to modify certain kernel parameters at runtime. It is part of procfs and the files are located at {{Path|/proc/sys/}}. {{Path|/usr/src/linux/Documentation/sysctl/}} contains documentation of most files.

<tt>sysctl</tt> work with keys, which can be assembled from the file path by removing the {{Path|/proc/sys}} prefix and replace the backsplash with a point. So, e.g. {{Path|/proc/sys/kernel/sysrq}} becomes ''kernel.sysrq''.

It is certainly possible to modify files in {{Path|/proc}} like performed above, however the <tt>sysctl</tt> tool (part of {{Package|sys-process/procps}}) can modify {{Path|/proc}} information in a much more structured way:

* To enable the magic sysrq key:
: {{RootCmd|sysctl kernel.sysrq{{=}}1}}

* To show all keys and their current values:
: {{RootCmd|sysctl -a}}

To configure kernel parameters at boot, add them to a {{Path|.conf}} file in {{Path|/etc/sysctl.d/}}. The recommended location for local settings is {{Path|/etc/sysctl.d/local.conf}}. The legacy file {{Path|/etc/sysctl.conf}} is also supported. To enable the magic SysRq key at boot:

{{FileBox|filename=/etc/sysctl.d/local.conf|1=
kernel.sysrq=1
}}

==== OpenRC ====

The sysctl service reads the files at boot and executes settings. The service is enabled by default.

==== systemd ====

[[systemd]] knows beside {{Path|/etc/sysctl.d/}} also {{Path|/usr/lib/sysctl.d/}} for package-provided config files.

The ''systemd-sysctl'' service is enabled by default.

== References ==

{{reflist}}

[[Category:Filesystems]]
