{{Stub}}

This is a reference card of useful commands for administrating Gentoo.

== Portage package management ==

=== Portage tree sync methods ===

Sync the Portage tree using the mirrors by fetching the latest differences:

{{RootCmd|emerge --sync}}

Sync the Portage tree using the mirrors by obtaining a Portage snapshot that is at most a day old:

{{RootCmd|emerge-webrsync}}

Sync local overlays and the Portage tree using [[eix]]:

{{RootCmd|eix-sync}}

{{package|app-portage/eix}} can be installed by issuing:

{{RootCmd|emerge -a eix}}

Gather more information on <tt>eix</tt> by reading its manual:

{{Cmd|man eix}}

=== Package installation and removal ===

In the following tips {{Package|www-client/firefox}} will be used as an example, substitute the package of interest with FireFox to perform the actions on another package.

List what packages would be installed without installing them:

{{RootCmd|emerge -pv www-client/firefox}}

Install a specific version of a package:

{{RootCmd|emerge {{=}}www-client/firefox-24.8.0}}

Remove a package and the dependencies that no other packages depend on:

{{RootCmd|emerge -cav www-client/firefox}}

Remove a package but not its dependencies:

{{RootCmd|emerge -C www-client/firefox}}

Remove no longer needed packages:

{{RootCmd|emerge -av --depclean}}

As a safety measure, depclean will not remove any packages unless *all* required dependencies have been resolved. As a consequence of this, it often becomes necessary to run:

{{RootCmd|emerge --update --newuse --deep @world}}

Avoid unnecessary rebuilds when USE flags only get added to or dropped from the repository.

{{RootCmd|emerge --update --changed-use --deep @world}}

=== Package upgrades ===

Upgrade all installed packages, dependencies, and deep dependencies that are outdated or have USE flag changes (avoiding unnecessary USE changes):

{{RootCmd|emerge -uDU --with-bdeps{{=}}y @world}}

=== Package troubleshooting ===

Check for and rebuild missing libraries:

{{RootCmd|revdep-rebuild -v}}

<tt>equery</tt> is part of {{package|gentoolkit}}. You can obtain it by issuing this command:

{{RootCmd|emerge -a gentoolkit}}

Tell which installed package provides a command using [[equery]]:

{{Cmd|equery b `which vim`}}

Tell which packages depend on a specific package (cat/pkg in the example) using [[equery]]:

{{Cmd|equery d www-client/firefox}}

Get information about a package using [[eix]]:

{{RootCmd|eix www-client/firefox}}

=== Portage enhancements ===

A graphical user interface to use with the Portage tree:

{{RootCmd|porthole}}

Manage configuration changes after an emerge completes:

{{RootCmd|dispatch-conf}}

=== After installations or updates ===

Rebuilds packages that depend on an recently updated library:

{{RootCmd|revdep-rebuild}}

After updating [[perl]]-core packages:

{{RootCmd|perl-cleaner --all}}

After updating [[python]] core packages:

{{RootCmd|python-updater}}

== USE flags ==

Obtain descriptions and usage of the USE flag <code>X</code> using [[euse]]:

{{Cmd|euse -i X}}

Gather more information on <tt>euse</tt> by reading its manual page:

{{Cmd|man euse}}

Obtain a description of the <code>png</code> USE flag:

{{Cmd|euse -i {{!}} grep png}}

Show what packages have mysql use flag option:

{{Cmd|equery hasuse mysql}}

Show what packages are currently built with mysql use flag:

{{Cmd|eix --installed-with-use mysql}}

Show what use flags are available for a specific package:

{{Cmd|equery uses <package-name>}}

Quickly add a required USE flag for a package install:

{{RootCmd|echo 'dev-util/cmake -qt4' >> /etc/portage/package.use}}

=== Important Portage files<ref group="i">[[:/etc/portage]]</ref> ===

* {{Path|[[:/etc/portage/make.conf]]}} - Global settings (USE flags, compiler options).
* {{Path|[[:/etc/portage/package.use]]}} - USE flags of individual packages.
* {{Path|[[:/etc/portage/package.accept_keywords]]}} - Keyword individual packages; e.g. {{Keyword|~amd64}}, {{Keyword|~x86}}, or {{Keyword|∼arm}}.
* {{Path|[[:/etc/portage/package.license]]}} - Accepted licenses
* {{Path|/var/lib/portage/world}} - List of explicitly installed package atoms.
* {{Path|/var/db/pkg}} - Contains for every installed package a set of files about the installation.

== Log management ==

=== genlop ===

[[genlop]] is a Portage log processor, also estimating build times when emerging packages.

Install <tt>genlop</tt> by issuing:

{{RootCmd|emerge -a app-portage/genlop}}

You can gather more information on {{package|app-portage/genlop}} by reading its manual page:

{{RootCmd|man genlop}}

View last 10 emerges (installs), run:

{{RootCmd|genlop -l {{!}} tail -n 10}}

View how long emerging OpenOffice took, run:
 
{{RootCmd|genlop -t openoffice}}

Estimate how long <tt>emerge -uND --with-bdeps=y @world</tt> will take, run:

{{RootCmd|emerge -pU world {{!}} genlop --pretend}}

Have a console watching the latest merging ebuild during system upgrades, run:

{{RootCmd|watch genlop -unc}}

== Services ==

Obtain root shell (if the current user is listed in the sudoers list):

{{Cmd|sudo -s}}

Start the ssh daemon in the default runlevel at boot:

{{RootCmd|rc-update add sshd default}}

Start the sshd service now:

{{RootCmd|rc-service sshd start}}

Check if the sshd service is running:

{{RootCmd|rc-status sshd}}

== Gentoo Monthly Newsletter (GMN) ==

Search packages in Portage by regular expressions:

{{RootCmd|emerge -s "%^python$"}}

Overlays vary from very small to very large in size. As a result they slow down the majority of Portage operations. That happens because overlays do not contain metadata caches. The cache is used to speed up searches and the building of dependency trees. A neat trick is to generate local metadata cache after syncing overlays.

{{RootCmd|emerge --regen}}

This trick also works in conjunction with eix. <tt>eix-update</tt> can use metadata cache generated by <tt>emerge –-regen</tt> to speed up things. To enable this, add the following variable to {{path|/etc/eixrc/00-eixrc}}:

{{FileBox|filename=/etc/eixrc/00-eixrc|1=
OVERLAY_CACHE_METHOD="assign"
}}

=== qcheck ===

Use <tt>qcheck</tt> to verify installed packages:

{{RootCmd|qcheck -e vim-core}}

<tt>qcheck</tt> comes with {{package|app-portage/portage-utils}} and can be installed by running this command:

{{RootCmd|emerge -a app-portage/portage-utils}}

Learn more about <tt>qcheck</tt> by reading its manual page:

{{cmd|man qcheck}}

== See also ==

{{reflist|group="i"}}

== External resources ==

* [https://github.com/jonasstein/gentoo-cheat Original gentoo-cheat repository.]
* [http://forums.gentoo.org/viewtopic-p-7370146.html Forum post about gentoo-cheat.]
* [http://forums.gentoo.org/viewtopic-t-529919.html Collection of Gentoo tips.]

== References ==

{{reflist}}

[[Category:Core system]]
[[Category:Portage]]
