<languages />

<translate>

{{InfoBox stack
|{{InfoBox homepage|http://www.sshguard.net/|header=true}}
|{{InfoBox ohloh}}
}}

'''sshguard''' is an intrusion prevention system.  sshguard parses server logs, determines malicious activity, and then bans malicious users via firewall rules.  sshguard is written in C so it does not tax an interprator.

== Installation ==
=== Emerge ===
Install {{Package|app-admin/sshguard}}:

{{emerge|app-admin/sshguard}}

=== Configuration ===
sshguard does not have a configuration file.  sshguard is controlled by flags passed to it upon execution.

{{path|/etc/conf.d/sshguard}} is where flags & log path can be passed to the sshguard service.

==== Rules ====
{{file|/etc/conf.d/sshguard|overly strict rules|<pre>
SSHGUARD_OPTS="-p 3600 -s 3600 -a 20"
</pre>}}

==== Logs ====
sshguard will fail to start unless it has proper authorization logs to monitor.

{{file|/etc/conf.d/sshguard|syslog-ng log location|<pre>
SSHGUARD_OPTS="${SSHGUARD_OPTS} -l /var/log/messages"
</pre>}}

== Iptables ==
=== IP v4 ===
Generate blank iptables rules, and start iptables as outlined [[Iptables#First_Run|here]].

Insert these rules to allow sshguard to ban malicious users.

{{RootCmd|iptables -N sshguard}}
&& to block all trafic from offenders
{{RootCmd|iptables -A INPUT -j sshguard}}

== Boot Service ==
=== OpenRC ===
To start sshguard immediately:
{{RootCmd|rc-service sshguard start}}

To start sshguard upon reboot:
{{RootCmd|rc-update add sshguard default}}

</translate>

[[Category:Security]]
[[Category:Server]]
