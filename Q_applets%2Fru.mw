<languages />

{{InfoBox stack
|{{InfoBox project|Portage-Tools|header=true}}
|{{InfoBox github|gentoo/portage-utils}}
|{{InfoBox gitweb|portage-utils.git}}
}}

{{Metadata|abstract=q-апплеты — это набор небольших и быстрых вспомогательных утилит системы Portage, написанных на C. В этом руководстве охватываются некоторые общие применения этих вспомогательных утилит, также известных как пакет app-portage/portage-utils.}}

Пакет {{Package|app-portage/portage-utils}} — это набор очень быстрых утилит, написанных на языке C, которые предлагают более быструю, но более ограниченную альтернативу похожим приложениям из {{Package|app-portage/gentoolkit}}. Обратите внимание, что q-апплеты не предназначены для замены [[Gentoolkit/ru|gentoolkit]]. Утилиты будут гораздо более эффективными, чем эквивалентные утилиты из [[Gentoolkit/ru|gentoolkit]] и могут лучше подходить для использования в скриптах, которые должны часто вызывать Portage. Но они не предлагают такую же функциональность. Q-апплеты не работают с [https://devmanual.gentoo.org/ebuild-writing/using-eclasses/index.html eclasses] и не предоставляют таких инструментов, как {{c|revdep-rebuild}} или {{c|glsa-check}}. 

__TOC__

== Установка ==

=== USE-флаги ===

{{USEflag|package=app-portage/portage-utils}}

=== Emerge ===

Устанавливаем q-апплеты:

{{Emerge|app-portage/portage-utils}}

== Конфигурация ==

=== Построение кэша ===

Перед началом использования апплетов, сначала инициализируйте кэш:

{{RootCmd|q -r}}

== Использование ==

=== Вызов ===

Полный список приложений пакета {{Package|app-portage/portage-utils}} можно просмотреть с помощью команды {{c|man q}} или {{c|q --help}}. Обратитесь к man-странице по каждой описываемой утилите, так как это руководство является только краткой справкой по наиболее полезным функциям и не включает полную информацию по каждому приложению.

Для просмотра доступных апплетов с кратким описанием их назначения используйте {{c|q --help}}:

{{Invocation|q --help|output=<pre>
Usage: q <applet> <args>  : invoke a portage utility applet
  
Currently defined applets:
        q <applet> <args> : virtual applet
    qatom <pkg>           : split atom strings
   qcache <action> <args> : search the metadata cache
   qcheck <pkgname>       : verify integrity of installed packages
 qdepends <pkgname>       : show dependency info
    qfile <filename>      : list all pkgs owning files
    qgrep <misc args>     : grep in ebuilds
    qlist <pkgname>       : list files owned by pkgname
     qlop <pkgname>       : emerge log analyzer
   qmerge <pkgnames>      : fetch and merge binary package
     qpkg <misc args>     : manipulate Gentoo binpkgs
  qsearch <regex>         : search pkgname/desc
    qsize <pkgname>       : calculate size usage
    qtbz2 <misc args>     : manipulate tbz2 packages
     quse <useflag>       : find pkgs using useflags
    qxpak <misc args>     : manipulate xpak archives
  
Options: -[irmM:vqChV]
  -i, --install        * Install symlinks for applets
  -r, --reinitialize   * Reinitialize ebuild cache
  -m, --metacache      * Reinitialize metadata cache
  -M, --modpath  <arg> * Module path
  -v, --verbose        * Make a lot of noise
  -q, --quiet          * Tighter output; suppress warnings
  -C, --nocolor        * Don't output color
  -h, --help           * Print this help and exit
  -V, --version        * Print version and exit</pre>
}}

=== Поиск пакета, к которому принадлежит какой-либо файл (qfile) ===

Команда {{c|qfile}} находит пакет, к которому относится файл: 

{{Cmd|qfile /etc/fonts/fonts.conf|output=<pre>
media-libs/fontconfig (/etc/fonts/fonts.conf)
</pre>}}

{{Cmd|qfile /usr/share/keymaps/atari/atari-uk-falcon.map.gz|output=<pre>
sys-apps/kbd (/usr/share/keymaps/atari/atari-uk-falcon.map.gz)
</pre>}}

=== Проверка целостности пакета (qcheck) ===

Чтобы проверить контрольные суммы MD5 или время модификации файлов, установленных каким-либо пакетом, используйте приложение {{c|qcheck}}: 

{{Cmd|qcheck portage-utils|output=<pre>
Checking app-portage/portage-utils-0.1.13 ...
  * 36 out of 36 files are good
</pre>}}

<div class="mw-translate-fuzzy">
Здесь будет сообщено обо всех файлах, измененных после установки. Если приложение сообщает о файлах конфигурации, отредактированных вручную после установки, то не о чем беспокоиться.
</div> 

=== Перечисление пакетов, зависящих от некоторого другого пакета (qdepends) ===

<div class="mw-translate-fuzzy">
Также существует приложение, позволяющее перечислить все пакеты, которые зависят от какого-то другого пакета. Это выполняется использованием команды {{c|qdepend}}. Используйте опцию <code>-a</code>, чтобы показать всю информацию о переменных <var>DEPEND</var>, <var>RDEPEND</var> и <var>PDEPEND</var> для пакета.
</div> 

{{Cmd|qdepends -a pygtk|output=<pre>
 * DEPEND
dev-python/pygtk-2.8.2: >=dev-lang/python-2.3 >=x11-libs/gtk+-2.8.0
>=dev-libs/glib-2.8.0 >=x11-libs/pango-1.10.0 >=dev-libs/atk-1.8.0
>=gnome-base/libglade-2.5.0 >=dev-python/pycairo-0.9.0 dev-python/numeric
virtual/opengl dev-python/pyopengl >=x11-libs/gtkglarea-1.99
>=dev-util/pkgconfig-0.9 sys-devel/patch
 * RDEPEND
dev-python/pygtk-2.8.2: >=dev-lang/python-2.3 >=x11-libs/gtk+-2.8.0
>=dev-libs/glib-2.8.0 >=x11-libs/pango-1.10.0 >=dev-libs/atk-1.8.0
>=gnome-base/libglade-2.5.0 >=dev-python/pycairo-0.9.0 dev-python/numeric
virtual/opengl dev-python/pyopengl >=x11-libs/gtkglarea-1.99
 * PDEPEND
</pre>}}

=== Перечисление всех пакетов (установленных или неустановленных), зависящих от некоторого другого пакета (qgrep) ===

Апплет q можно использовать, чтобы найти ebuild, в которых упомянуто искомое имя ebuild (в примере ниже используется "libechonest") с очень большой скоростью:

{{Cmd|<nowiki>qgrep -H libechonest | cut -f1 -d":" | uniq</nowiki>|output=<pre>
media-libs/libechonest/libechonest-2.0.2.ebuild
media-libs/libechonest/libechonest-2.2.0-r1.ebuild
media-libs/libechonest/libechonest-2.3.0.ebuild
media-libs/libechonest/libechonest-2.3.1.ebuild
media-libs/libechonest/libechonest-2.3.1-r1.ebuild
media-libs/libechonest/libechonest-9999.ebuild
media-sound/clementine/clementine-1.2.3.ebuild
media-sound/clementine/clementine-1.2.3-r1.ebuild
media-sound/clementine/clementine-1.3.1-r1.ebuild
media-sound/tomahawk/tomahawk-0.8.4-r3.ebuild
media-sound/tomahawk/tomahawk-9999.ebuild
</pre>}}

=== Перечисление файлов, принадлежащих ebuild-файлу (qlist) ===

Команда {{c|qlist}} выдает список всех файлов, принадлежащих какому-либо файлу ebuild. 

{{Cmd|qlist vim|output=<pre>
/usr/bin/gvim
/usr/bin/gvimdiff
/usr/bin/evim
/usr/bin/eview
/usr/bin/gview
/usr/bin/rgvim
[...]
</pre>}}

=== Поиск пакетов, использующих некоторый USE-флаг (quse) ===

Список используемых USE-флагов выполняется с помощью команды {{c|quse}}, которую нужно запустить c root привилегиями. Может потребоваться некоторое время для первоначального создания или обновления кэша файлов ebuild. 

{{Cmd|quse firefox|output=<pre>
app-misc/tracker/tracker-0.12.10-r1.ebuild applet doc eds elibc_glibc exif firefox-bookmarks flac flickr gif
[...]
</pre>}}

=== Определение размеров пакета (qsize) ===

Чтобы определить размер пакета, используйте приложение {{c|qsize}}: 

{{Cmd|qsize vim|output=<pre>
app-editors/gvim-6.4: 10 files, 7 non-files, 2327.516 KB
app-editors/vim-6.4: 6 files, 2 non-files, 2058.14 KB
app-editors/vim-core-6.4: 1024 files, 68 non-files, 10950.984 KB
[...]
</pre>}}

=== Поиск в дереве Portage (qsearch) ===

Одним из наиболее мощных инструментов пакета {{Package|app-portage/portage-utils}} является {{c|qsearch}}. Этот инструмент позволяет выполнить намного более быстрый поиск в дереве Portage, чем при использовании команды {{c|emerge -s}}. 

Ниже приведено несколько примеров его использования: 

{{Cmd|qsearch terminus|output=<pre>
media-fonts/terminus-font A clean fixed font for the console and X11
</pre>}}

Домашнюю страницу пакета можно определить с использованием опции <code>-H</code>:

{{Cmd|qsearch -H terminus|output=<pre>
media-fonts/terminus-font http://www.is-vn.bg/hamster/jimmy-en.html
</pre>}}

Рассмотрим еще один пример, поищем jabber-клиент:

{{Cmd|qsearch -S "jabber client"|output=<pre>
app-emacs/emacs-jabber A Jabber client for Emacs.
net-im/gajim Jabber client written in PyGTK
net-im/gnome-jabber Gnome Jabber Client
net-im/gossip Lightweight Jabber client for GNOME
net-im/imcom Python commandline Jabber Client
net-im/psi QT 3.x Jabber Client, with Licq-like interface
net-im/tkabber Featureful Jabber client for tcl/tk.
x11-themes/psi-themes Iconsets for Psi, a QT 3.x Jabber Client
</pre>}}

=== Извлечение информации из логов команды emerge (qlop) ===

<div class="mw-translate-fuzzy">
Также имеется инструмент для извлечения полезной информации из файла {{Path|emerge.log}}. Он называется {{c|qlop}} и может быть полезен для оценки времени компиляции пакета или для его сравнения со временем компиляции на других системах. Также с его помощью можно посмотреть, что компилируется в данный момент и сколько времени, скорее всего, на это понадобится, что удобно при работе в консоли и при отсутствии других средств для проверки.
</div> 

<div class="mw-translate-fuzzy">
Чтобы узнать, сколько времени обычно требует компиляция пакета {{Package|dev-lang/perl}}:
</div>

{{Cmd|qlop -tH perl|output=<pre>
perl: 7 minutes, 52 seconds for 4 merges
</pre>}}

<div class="mw-translate-fuzzy">
Чтобы увидеть, что устанавливается в настоящий момент, и как долго процесс уже работает:
</div>

{{Cmd|qlop -c|output=<pre>
* perl-5.8.8-r23
    started: Mon May 21 12:41:11 2007
    elapsed: 19 seconds
</pre>}}

== Смотрите также ==

<div class="mw-translate-fuzzy">
* [[Gentoolkit/ru|Gentoolkit]] — набор средств, облегчающих администрирование системы Gentoo.
* [[Q_applets/Qcheck|Qcheck]] — Утилита командной строки предназначенная для проверки целостности установленных пакетов.
</div>
{{Migrated|originalauthors=Åukasz Damentko, {{Dev|nightmorph}}, and Marcelo Góes}}

[[Category:Portage tools]]
