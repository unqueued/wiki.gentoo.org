<languages />

{{Metadata|abstract=この記事は、古いカーネルの削除について説明しています。}}

この記事は、古い[[kernel|カーネル]]の削除について説明しています。

== カーネルのソースの削除 ==

新たなカーネルをインストール後、それが満足に動作しているときには、古いカーネルを削除してもかまいません。古いカーネルのソースを削除するには emerge の ''--depclean'' オプション（''-c''に省略可能）を使用し、（例えば {{Package|sys-kernel/gentoo-sources}} の、）すべての旧バージョンまたは不用なバージョンをスロットを指定して削除することができます。

{{Emerge|params+=--depclean|gentoo-sources}}

現在稼働中のカーネルのソースが削除されないよう確認してください。(アップグレードの方法は、[[Kernel/Upgrade|カーネルアップグレード]] の記事を参照。)

=== カーネルのソースを保護する ===

If newer kernel sources has been merged and you run ''--depclean'' before switching to the newer sources, the current sources will be removed. But if you want to stay with the current sources, this removal is not wanted, because you may need the sources e.g. for updating external kernel modules. It's therefore good practice to add the specific kernel version to your world file to protect it from ''--depclean'' operations.

{{Emerge|params+=--noreplace|gentoo-sources:3.3.8}}

Note the slot notation, using a colon instead of a dash. Every kernel version is its own slot.

== 残ったカーネルを削除する ==

=== eclean-kernel の利用 ===

{{Package|app-admin/eclean-kernel}} は、古いカーネルの清掃/削除をするための簡単なツールです。ビルドされたカーネルのファイルも、残ったカーネルのいずれも参照しないビルドディレクトリも、削除します。

例えば最近の3つのカーネルを残すには:

{{RootCmd|eclean-kernel -n 3}}

=== 手作業での削除 ===

Portage システムはインストールされたファイルのみを削除するので、カーネルのビルド及びインストールの際に生成されたファイルが残ります。これらのファイルは安全に削除することができます。

* カーネルがソースのディレクトリからビルドされる際に、ビルド過程で生成されて残るファイルで、Portage システムによって削除されないもの:

: {{RootCmd|rm -r /usr/src/linux-3.X.Y}}

* カーネルのモジュールは、カーネルのセットアップ中に <tt>/lib/modules/</tt> 内のサブディレクトリにコピーされています:

: {{RootCmd|rm -r /lib/modules/3.X.Y}}

* {{Path|/boot}} 内の古いファイルもまた削除可能です:

: {{RootCmd|rm /boot/kernel-3.X.Y|rm /boot/System.map-3.X.Y|rm /boot/config-3.X.Y}}

* 最後に、ブートローダの設定ファイルに残された余分なエントリをすべて削除しましょう。

[[Category:Kernel]]
