<languages />

{{Metadata|abstract=This guide should help users localize their Gentoo Linux distribution to any known locale. It uses Germany as a case-study, since it is translated from the German doc. Includes configuration for use of the euro currency symbol.}}

== 標準時 ==

現在位置に応じて、システム時間を維持するために、時間帯を設定する必要があります。[[System_time#OpenRC|OpenRCベースのシステム]]および[[System_time#systemd|systemdベースのシステム]]のためにこれを行う方法手順は、[[System_time|システム時刻]]の記事で見つけることができます。

== ロケールシステム ==

=== ロケールとは何ですか? ===

ロケールは、国や言語に特有の設定を決定するために使う情報の集合体で、大抵のプログラムがこれを利用します。ロケールとそのデータはシステムライブラリの一部であり、ほとんどのシステムにおいて {{Path|/usr/share/i18n/locales/}} にあります。ロケール名は一般に、<code>ab_CD</code>という形式で命名されます。ここで<code>ab</code>は2 (または3) 文字の言語コード ([[wikipedia:ISO_639|ISO-639]]で規定) であり、<code>CD</code>は2文字の国コード ([[wikipedia:ISO_3166|ISO-3166]]で規定) になります。多くの場合、<code>@euro</code>または<code>@latin</code>のような変形情報 (バリアント) がロケール名に追加されます。
例えば、<code>de_DE@euro</code>や<code>nan_TW@latin</code>です。ロケールと関連する記事をもっと読むには、[[wikipedia:Locale_(computer_software)|Wikipedia (英語) ]]を探してみてください。

=== ロケール関連の環境変数 ===

ロケール設定の色々な側面を制御する環境変数を以下の表に示します。
これらのすべては、上記の<code>ab_CD</code>形式で表記されたロケール名を1つだけ設定できます。 

{| class="table table-striped" style="text-align: left;" 
|- 
! scope=col width=25% | 変数名
! scope=col width=75% | 説明
|- 
| <var>LANG</var>
| 一度に全てのロケール設定を定義します。同時に、以下のLC_*設定を使うと、個別のカスタマイズが可能です。
|- 
| <var>LC_COLLATE</var>
| 文字列におけるアルファベットの順序を定義します。これは、例えば並び替えされたディレクトリ一覧の出力などに影響を与えます。
|- 
| <var>LC_CTYPE</var>
| そのシステムでの文字取り扱い属性を定義します。これは、どの文字がアルファベットや数値などの一部とみなすか、などを決定します。該当する場合、使用される文字集合も決定します。
|- 
| <var>LC_MESSAGES</var>
| プログラムで使用するローカライズ言語（{{Path|/usr/share/locale/}} から指定します）。メッセージベースの多言語対応手法 (Gnuプログラムの大部分。詳しい情報は次の章をご覧ください) を使ったアプリケーション用です。
|- 
| <var>LC_MONETARY</var>
| 通貨単位と通貨型の数値の書式を定義します。
|- 
| <var>LC_NUMERIC</var>
| 通貨ではない数値の書式を定義します。たとえば桁の区切りや小数点記号などのものに影響します。
|- 
| <var>LC_TIME</var>
| 日付と時刻の書式を定義します。
|- 
| <var>LC_PAPER</var>
| 既定の紙の大きさを定義します。
|- 
| <var>LC_ALL</var>
| 他のすべての設定を上書きするための特殊な環境変数です。
|-
|}

{{Note/ja|あるロケール (特にエストニアのもの) では異なる順序付けを使用しているにも関わらず、いくつかのプログラムは、アルファベットの伝統的な英語での順序付けを期待して書かれています。そのため、システム全体の設定を行う際、明確に<var>LC_COLLATE</var>へCを設定しておくことをお勧めします。}}

{{Warning/ja|<var>LC_ALL</var>を設定するのは、(<var>LANG</var>を除く)他の全ての <var>LC_*</var>変数の設定を上書きしてしまうので、特に避けるべきです。つまり、<var>LC_ALL</var>をリセットしない限りは他の手段による変更が有効にならないということです。大概は、起動時に<var>LC_ALL</var>を設定することは最良の選択ではないでしょう。}}

最も一般的なのは、ユーザが<var>LANG</var>変数のみをグローバルに設定することです。

=== 特定のロケールの生成 ===

ほとんどのユーザは、おそらくシステムで1つ、もしかしたら2つのロケールを使用するでしょう。追加のロケールをどのように指定するかについては、ファイル{{Path|/etc/locale.gen}}の中に説明があります。 

{{CodeBox|title=ロケールを/etc/locale.genに追加する|1=
en_GB ISO-8859-1
en_GB.UTF-8 UTF-8
de_DE ISO-8859-1
de_DE@euro ISO-8859-15
}}

{{Note/ja|ユーロ通貨記号 (€) を非UTF-8ベースのロケールで使う場合、{{Path|/usr/share/i18n/SUPPORTED/}} の中の<code>@euro</code>が付いた値をロケールとして使用してください。}}

次のステップは、{{c|locale-gen}} を実行することです。これは、{{Path|/etc/locale.gen}} ファイルの中で指定された全てのロケールを生成し、ロケールアーカイブ ({{Path|/usr/lib/locale/locale-archive}}) に書き込みます。 

{{RootCmd|locale-gen|output=<pre>
 * Generating 4 locales (this might take a while) with 1 jobs
 *  (1/4) Generating en_GB.ISO-8859-1 ...                       [ ok ]
 *  (2/4) Generating en_GB.UTF-8 ...                            [ ok ]
 *  (3/4) Generating de_DE.ISO-8859-1 ...                       [ ok ]
 *  (4/4) Generating de_DE.ISO-8859-15@euro ...                 [ ok ]
 * Generation complete
</pre>}}

{{c|locale -a}} を実行して、選択したロケールが使用可能かを確認してください。

{{Cmd|locale -a|output=<pre>
C
POSIX
de_DE
de_DE.iso88591
de_DE.iso885915@euro
de_DE@euro
deutsch
en_GB
en_GB.iso88591
en_GB.utf8
german
</pre>}}

{{Path|/usr/lib/locale/locale-archive}} ファイルは、{{c|localedef}} を使って表示できます。

{{Cmd|localedef --list-archive}}

その未加工の内容は、{{c|strings}} コマンドを使って表示可能です。

{{Cmd|strings /usr/lib/locale/locale-archive {{!}} less}}

=== ロケール設定 ===

==== OpenRC ==== 

OpenRCを使用する際、ロケール設定は環境変数に格納されます。一般的には、{{Path|/etc/env.d/02locale}} (システム全体の設定用) と {{Path|~/.bashrc}} (ユーザ固有の設定用) ファイルで設定します。詳細は記事[[UTF-8#Setting_the_locale|UTF-8]]に記載されています。システム全体の設定 ({{Path|/etc/env.d/02locale}}) は {{c|eselect locale}} を通じて管理できます。例えば、<var>LANG</var>変数を<code>C</code>という値に設定するには:

{{RootCmd|eselect locale list|output=<pre>
Available targets for the LANG variable:
  [1]   C 
  [2]   POSIX
  [3]   en_US
  [4]   en_US.iso885915
  [5]   en_US.utf8
  [ ]   (free form)
</pre>}}

{{RootCmd|eselect locale set 1}}

もちろん、手動でファイルを編集することで、ロケール変数を様々に変化させることも可能です。

{{FileBox|filename=/etc/env.d/02locale|title=/etc/env.d/02locale でシステムのデフォルトのロケールを設定|lang=bash|1=
LANG="de_DE.UTF-8"
LC_COLLATE="C"
}}

特に、より伝統的なUNIX環境ではかなり一般的なのですが、グローバル設定
を不変のまま (すなわち <code>C</code> ロケール) にしておくことも可能です。それでもユーザは、自分のシェルのRCファイルで自分の優先ロケールを指定することが可能です: 

{{FileBox|filename=~/.bashrc|title=ユーザ用ロケールの設定|lang=bash|1=
export LANG="de_DE.UTF-8"
export LC_COLLATE="C"
}}

システムを構成する別の方法は、既定は<code>C</code>ロケールにしたまま、同時にUTF-8での文字表示を有効にすることです。このオプションは、{{Path|/etc/env.d/02locale}} で下記のような設定を使用することで実現できます: 

{{CodeBox|title=UTF-8を指定しながらの伝統的なCロケールの使用|lang=bash|1=
LC_CTYPE=de_DE.UTF-8
}}

上記のスニペットを使うと、ユーザは選択した言語を全面的に使用しなくとも、ローカライズされたファイル名を適切に見ることができるようになります。 

一旦、正しいロケールを設定したら、変更をシステムに認識させるため、環境変数を更新してください。

システム全体の既定ロケールならば:

{{RootCmd|env-update && source /etc/profile}}

ユーザ固有のロケールならば:

{{Cmd|source ~/.bashrc}}

その後、{{Key|Ctrl}}+{{Key|Alt}}+{{Key|Backspace}}を押してXサーバを殺し
、ログアウトしてからユーザとしてログインしてください。 

では、変更内容が反映されていることを確認してください: 

{{Cmd|locale}}

==== systemd ====

systemdの場合、ロケールの設定には {{c|localectl}} コマンドを使います。利用可能なロケール一覧を確認するには:

{{RootCmd|localectl list-locales}}

次に、目的のロケールを設定します:

{{RootCmd|<nowiki>localectl set-locale LANG=de_DE.utf8</nowiki>}}

最後に結果がうまくいっているかを確認してください:

{{RootCmd|<nowiki>localectl | grep "System Locale"</nowiki>|output=<pre>
   System Locale: LANG=de_DE.utf8
</pre>}}

== コンソール用のキーボードレイアウト ==

=== OpenRC ===

コンソールが使用するキーボードのレイアウトは、{{Path|/etc/conf.d/keymaps}}の中の<var>keymap</var>変数によって設定されています。有効な値は{{Path|/usr/share/keymaps/YOUR_ARCH/}}に記載されています。{{Path|i386}}は、更にレイアウトごとに細分化されています (例えば{{Path|qwerty/}}、{{Path|azerty/}})。さまざまなオプションの、どれがニーズに対して最高に適合しているかの決定を試みるため、いくつかの言語には複数のオプションがあります。 

{{FileBox|filename=/etc/conf.d/keymaps|title=コンソール用キーマップの設定|lang=bash|1=
keymap="de"
#keymap="de-latin1"
#keymap="de-latin1-nodeadkeys"
}}

=== systemd ===

systemdでは、コンソールで使用されるキーマップレイアウトは {{c|localectl}} コマンドを使って設定できます。最初に、利用可能なキーマップレイアウトを確認します:

{{RootCmd|localectl list-keymaps}}

次に、要求されたコンソールキーマップレイアウトを設定します:

{{RootCmd|localectl set-keymap it}}

最後に適切にコンソールキーマップレイアウトが設定されているかを確認します:

{{RootCmd|<nowiki>localectl | grep "VC Keymap"</nowiki>|output=<pre>
       VC Keymap: it
</pre>}}

== Xサーバ用のキーボードレイアウト ==

=== OpenRC ===

Xサーバが使用するキーボードレイアウトは、{{Path|/etc/X11/xorg.conf.d/30-keyboard.conf}}の中の <var>XkbLayout</var> オプションで指定されています。詳細は、[[Xorg/Guide/ja#Configuring_the_keyboard|Xorgガイド]]と[[Keyboard_layout_switching#X11|キーボードレイアウトの切り替え]]の記事を参照してください。

=== systemd ===

systemdでは、X11サーバで使用されるキーマップレイアウトは {{c|localectl}} コマンドを使って設定できます。最初に、利用可能なX11キーマップレイアウトを確認します:

{{RootCmd|localectl list-x11-keymap-layouts}}

次に、要求されたX11キーマップレイアウトを設定します:

{{RootCmd|localectl set-x11-keymap it}}

最後に適切にX11キーマップレイアウトが設定されているかを確認します:

{{RootCmd|<nowiki>localectl | grep "X11 Layout"</nowiki>|output=<pre>
      X11 Layout: it
</pre>}}

== NLS ==

For message based localization to work in programs that support it and have the [https://packages.gentoo.org/useflags/nls <code>nls</code> (Native Language Support) USE flag], compile the programs with this flag set. Message strings are installed in {{Path|/usr/share/locale/<locale>/LC_MESSAGES/<package>.mo}} files. Most of the programs using NLS also need the gettext library to extract and use localized messages. Of course, Portage will automatically install it when needed.

After enabling the <code>nls</code> USE flag some packages might need to be re-emerged:

{{Emerge|params+=--changed-use --deep --with-bdeps=y|@world}}

== LINGUAS ==

<var>[https://packages.gentoo.org/useflags/linguas_en LINGUAS]</var> <ref>[https://devmanual.gentoo.org/general-concepts/linguas/ LINGUAS] in Gentoo Development Guide</ref>と呼ばれる<var>USE_EXPAND</var>フラグも存在し、gettextベースのプログラムでインストールされるローカライゼーションファイルに影響します。この変数は空白区切りで言語コードを持ち、変数を設定する場所としては{{Path|[[:/etc/portage/make.conf|/etc/portage/make.conf]]}}が提案されています: 

{{RootCmd|nano -w /etc/portage/make.conf|output=<pre>
## (LINGUAS 変数を追加する。例えばドイツ語とフィンランド語と英語:)
LINGUAS="de fi en"
</pre>}}

<code>LINGUAS=""</code>のようにすると、大抵のebuildはパッケージのデフォルト言語だけをインストールし、<code>LC_MESSAGES</code>ファイルは何もインストールしません。

A list of installed programs making use of the <var>[https://packages.gentoo.org/useflags/linguas_en LINGUAS]</var> <var>USE_EXPAND</var> flag and their supported languages can be shown as follows:

{{Cmd|eix -I -U linguas}}

利用可能な<var>LINGUAS</var>の値のリストは {{Path|/usr/portage/profiles/desc/linguas.desc}} にあります: 

{{Cmd|grep -i french /usr/portage/profiles/desc/linguas.desc|output=<pre>
fr - French locale
fr_CA - French locale for Canada
fr_FR - French locale for France
</pre>
}}

<var>[https://packages.gentoo.org/useflags/linguas_en LINGUAS]</var> <var>USE_EXPAND</var>フラグを設定した後は、いくつかのパッケージを再emergeする必要があるかもしれません:

{{Emerge|params+=--changed-use --deep --with-bdeps=y|@world}}

{{Note|<var>USE_EXPAND</var>される変数としての<var>LINGUAS</var>は、<var>L10N</var>変数(下記を参照)に置き換えられているところです。これは、標準のgettextの挙動との概念的な衝突を避けるためです。パッケージが変換される移行期間の後、<var>LINGUAS</var>は普通の環境変数となります。}}

== L10N ==

<var>L10N</var>と呼ばれるもう一つの<var>USE_EXPAND</var>変数は、どの追加ローカライゼーションサポートがインストールされるかを決定します。これは一般に、パッケージによる追加の言語パックのインストールに使用されます。<var>LINGUAS</var>と同じように、この変数は空白区切りで言語タグのリストを持ち、{{Path|/etc/portage/make.conf}}で設定することができます:

{{RootCmd|nano -w /etc/portage/make.conf|output=<pre>
## (Add in the L10N variable. For instance, for German and Brazilian Portuguese:)
L10N="de pt-BR"
</pre>}}

To set it per-package, edit {{Path|[[:/etc/portage/package.use]]}} and prefix the requested language packs with "l10n_", as shown in the next example:

{{FileBox|filename=/etc/portage/package.use|lang=bash|1=
app-text/aspell l10n_de l10n_pt_BR
}}

Note that while the common two letter language codes (like <code>de</code> or <code>fr</code>) are identical in <var>LINGUAS</var> and <var>L10N</var>, more complex entries have a different syntax because <var>L10N</var> uses [https://www.w3.org/International/articles/language-tags/ IETF language tags] (aka BCP 47). For example, <code>pt_BR</code> and <code>sr@latin</code> in <var>LINGUAS</var> become <code>pt-BR</code> and <code>sr-Latn</code> in <var>L10N</var>, respectively.

A list of <var>L10N</var> values that can be used is provided as {{Path|/usr/portage/profiles/desc/l10n.desc}}:

{{Cmd|grep -i portuguese /usr/portage/profiles/desc/l10n.desc|output=<pre>
pt - Portuguese
pt-BR - Portuguese (Brazil)
pt-PT - Portuguese (Portugal)
</pre>}}

After setting the <var>L10N</var> <var>USE_EXPAND</var> variable it may be necessary to re-emerge some packages:

{{Emerge|params+=--changed-use --deep --with-bdeps=y|@world}}

== 参考 ==


* [[Handbook:AMD64/Installation/Base#Configure_locales|Configuring locales]] (Gentoo Handbooks)
* [[Evdev#Keyboard_layout|Keyboard layout]] inside the Evdev article
* [[X resources]]
* [[Localization/Guide/The_Euro_symbol|The Euro symbol]] ([http://unicode-table.com/en/20AC/ €]) for the console and in X

== 外部の情報 == 

* [https://www.gnu.org/software/libc/manual/html_node/Locales.html Locales and Internationalization] (gnu.org)
* [https://gentoo.org/support/news-items/2016-06-23-l10n-use_expand.html L10N USE_EXPAND variable replacing LINGUAS]
* [https://blogs.gentoo.org/mgorny/2016/05/16/how-linguas-are-thrice-wrong/ Michał Górny:How LINGUAS are thrice wrong!]
* [https://archives.gentoo.org/gentoo-dev/message/a08ea09c2c8e534fd9bc1146703c66ff <nowiki>[gentoo-dev] [RFC] How to deal with LINGUAS mess?</nowiki>]
* [https://archives.gentoo.org/gentoo-dev/message/41e09d1ddc8b30abb9f9d21d205b7b82 <nowiki>[gentoo-dev] [RFC] Masterplan for solving LINGUAS problems</nowiki>]

== 参照 ==

{{reflist}}


[[Category:Localization]] {{Migrated|originalauthors=Alexander Holler, Steven Lucy, Benny Chuang, Lars Weiler, Tobias Scherbaum, Flammie Pirinen, nightmorph, klondike}}
