== Sysbench ==

The {{Package|app-benchmarks/sysbench}} package provides the '''sysbench''' application, which provides benchmarking capabilities towards Linux. It supports testing CPU, memory, File I/O, mutex performance and even MySQL benchmarking.

To install benchmark, there are two USE flags applicable.

{{USEflag
|package=app-benchmarks/sysbench
|aio+yes+
|mysql++
}}

=== Using sysbench ===

As mentioned, sysbench supports several benchmark workloads: fileio, cpu, memory, threads, mutex, oltp

==== Using the fileio measurements ====

When using ''fileio'', you will need to create a set of test files to work on. It is recommended that the size is larger than the available memory to ensure that file caching does not influence the workload too much.

{{RootCmd|sysbench --test{{=}}fileio --file-total-size{{=}}128G prepare
|sysbench --test{{=}}fileio --file-total-size{{=}}128G --file-test-mode{{=}}rndrw --max-time{{=}}300 --max-requests{{=}}0 run
|sysbench --test{{=}}fileio --file-total-size{{=}}128G cleanup}}

As this is I/O benchmarking, you can tell sysbench which kind of workload you want to run: sequential reads, writes or random reads, writes, or a combination. In the above example, random read/write is used (rndrw). The duration of the test is given through the ''--max-time'' parameter (in seconds).

The output of a run is shown below:

{{RootCmd|sysbench --test{{=}}fileio --file-total-size{{=}}32G --file-test-mode{{=}}rndrw --max-time{{=}}300 --max-requests{{=}}0 run|output=<pre>
sysbench 0.4.12:  multi-threaded system evaluation benchmark

Running the test with following options:
Number of threads: 1

Extra file open flags: 0
128 files, 256Mb each
32Gb total file size
Block size 16Kb
Number of random requests for random IO: 0
Read/Write ratio for combined random IO test: 1.50
Periodic FSYNC enabled, calling fsync() each 100 requests.
Calling fsync() at the end of test, Enabled.
Using synchronous I/O mode
Doing random r/w test
Threads started!
Time limit exceeded, exiting...
Done.

Operations performed:  14788 Read, 9858 Write, 31488 Other = 56134 Total
Read 231.06Mb  Written 154.03Mb  Total transferred 385.09Mb  (1.2836Mb/sec)
   82.15 Requests/sec executed

Test execution summary:
    total time:                          300.0149s
    total number of events:              24646
    total time taken by event execution: 173.9797
    per-request statistics:
         min:                                  0.01ms
         avg:                                  7.06ms
         max:                                 92.72ms
         approx.  95 percentile:              16.57ms

Threads fairness:
    events (avg/stddev):           24646.0000/0.00
    execution time (avg/stddev):   173.9797/0.00

</pre>}}

The important part to look at is the information regarding the operations:
  Operations performed:  14788 Read, 9858 Write, 31488 Other = 56134 Total
  Read 231.06Mb  Written 154.03Mb  Total transferred 385.09Mb  (1.2836Mb/sec)

These numbers can be compared with runs on different file systems, other systems, etc. 

=== Resources ===

* [http://www.howtoforge.com/how-to-benchmark-your-system-cpu-file-io-mysql-with-sysbench How to benchmark your system with sysbench]
