<languages />
<translate>
Cinnamon is a traditional and modern desktop environment: traditional desktop metaphor as Gnome 2, [[LXDE]] or [[Xfce]], with very good graphical and functional features. It is forked from Gnome Shell and developed for Linux Mint. It is provided for Gentoo as a Gnome package: [http://packages.gentoo.org/package/gnome-extra/cinnamon gnome-extra/cinnamon] for amd64 and x86 platforms. Here we refer to 2.4.6 and older 2.2.16 Cinnamon versions.

== With/Without systemd ==

=== Without systemd ===

Cinnamon works great without systemd. For that, eselect a profile without Gnome, as this one: <tt>default/linux/amd64/13.0/desktop</tt> (platform and version can be different). To get system profiles list:
{{RootCmd|eselect profile list|output=<pre>
[1] default/linux/amd64/13.0
[2] default/linux/amd64/13.0/selinux
[3] default/linux/amd64/13.0/desktop
[4] default/linux/amd64/13.0/desktop/gnome
[5] default/linux/amd64/13.0/desktop/gnome/systemd
etc.</pre>
}}
Then to set the system profile:
{{RootCmd|eselect profile set default/linux/amd64/13.0/desktop}}
Set profile complete name as in example, or profile number according to profiles list.

Also, follow the [[Gentoo_Without_systemd|Gentoo Without Systemd]] wiki page instructions.

=== With systemd ===

For Cinnamon with systemd, eselect either the <tt>default/linux/amd64/13.0/desktop/gnome/systemd</tt> profile for system-wide systemd, or <tt>default/linux/amd64/13.0/desktop/gnome</tt> for Gnome systemd dependencies. The platform and version can be different.

== Installing ==

Of course, [[Xorg/Guide|Xorg]] must be first installed for Cinnamon to work.

Some USEflags, <code>icu</code> and <code>pulseaudio</code>, are needed by Cinnamon dependencies. Add them to the system's {{Path|/etc/portage/package.use}} file, or, if {{Path|/etc/portage/package.use}} is a directory, to a {{Path|/etc/portage/package.use/fileName}} file.

{{Path|/etc/portage/package.use}} file example:

{{RootCmd
|echo ">{{=}}media-libs/harfbuzz-0.9.35 icu" >> /etc/portage/package.use
|echo ">{{=}}media-plugins/alsa-plugins-1.0.28 pulseaudio" >> /etc/portage/package.use
}}

For Cinnamon and other applications to be translated to a specific language, if this was not done during Gentoo install, add the appropriate language to the {{Path|make.conf}}:
{{FileBox|filename=/etc/portage/make.conf|lang=bash|1=
LINGUAS="fr" # or en, de, it, es, etc.
}}

Cinnamon will need a few other packages in order to work properly: {{Package|x11-libs/gtk+extra}}, {{Package|gnome-extra/polkit-gnome}}, and {{Package|x11-drivers/xf86-video-modesetting}}.

So, let's go to install!

{{Emerge|gnome-extra/cinnamon x11-libs/gtk+extra gnome-extra/polkit-gnome x11-drivers/xf86-video-modesetting}}

Compilation duration can be very long: [http://packages.gentoo.org/package/net-libs/webkit-gtk net-libs/webkit-gtk], one or the many Cinnamon dependencies, takes about eight hours to compile with an Intel Core 2 Duo processor, more than one hour with an Intel quad cores i7 processor with hyper-threading.

== Settings ==

=== Services ===

Xorg server and Cinnamon need the dbus and consolekit services, add them at boot time:
{{RootCmd
|rc-update add dbus default
|rc-update add consolekit default
}}

Running these services before restart:
{{RootCmd
|rc-service dbus start
|rc-service consolekit start
}}

[[NetworkManager]] is not needed because network is configured during Gentoo install. As a reminder and only to replace this first install:
{{RootCmd
|rc-update add NetworkManager default
|rc-service NetworkManager start
}}

=== Sudo ===

For an ordinary user to reboot or shutdown, sudo is needed with some settings. First install {{Package|app-admin/sudo}}:
{{Emerge|app-admin/sudo}}

Next modify sudo's configuration with the <tt>visudo</tt> command:

{{RootCmd|visudo}}

Visudo runs the default text editor with sudoers file, add for a named user:

{{CodeBox|lang=bash|1=
userName  ALL=(root) NOPASSWD: /sbin/reboot
userName  ALL=(root) NOPASSWD: /sbin/halt
userName  ALL=(root) NOPASSWD: /sbin/poweroff
userName  ALL=(root) NOPASSWD: /sbin/shutdown
}}
	
Or for the <code>wheel</code> group users:
{{CodeBox|lang=bash|1=
%wheel  ALL=(root) NOPASSWD: /sbin/reboot
%wheel  ALL=(root) NOPASSWD: /sbin/halt
%wheel  ALL=(root) NOPASSWD: /sbin/poweroff
%wheel  ALL=(root) NOPASSWD: /sbin/shutdown
}}

=== Polkit Rules and Actions ===

For an ordinary user to perform root only actions, put a javascript file in {{Path|/etc/polkit-1/rules.d}}, for example named {{Path|55-allowing-actions.rules}} ({{Path|50-default.rules}} already exists).

Get the list of actions with <tt>pkaction</tt>, their names are quite self-explanatory:
{{RootCmd|pkaction|output=<pre>
org.cinnamon.settings-daemon.plugins.power.backlight-helper
org.cinnamon.settings-users
org.cinnamon.settingsdaemon.datetimemechanism.configure
org.freedesktop.ModemManager1.Contacts
org.freedesktop.ModemManager1.Control
org.freedesktop.ModemManager1.Device.Control
org.freedesktop.ModemManager1.Firmware
org.freedesktop.ModemManager1.Location
org.freedesktop.ModemManager1.Messaging
org.freedesktop.ModemManager1.USSD
org.freedesktop.NetworkManager.enable-disable-network
org.freedesktop.NetworkManager.enable-disable-wifi
etc.
</pre>
}}

To authorize an user belonging to <code>wheel</code> group to suspend, hibernate, shutdown and restart from Cinnamon:
{{FileBox|filename=/etc/polkit-1/rules.d/55-allowing-actions.rules|lang=javascript|1=
polkit.addRule (function (action, subject)
{
  if (action.id == "org.freedesktop.upower.hibernate" {{!}}{{!}}
      action.id == "org.freedesktop.upower.suspend" {{!}}{{!}}
      action.id == "org.freedesktop.consolekit.system.stop" {{!}}{{!}}
      action.id == "org.freedesktop.consolekit.system.restart" &&
      subject.isInGroup ("wheel"))
      {
        return polkit.Result.YES;
      }
});
}}
All needed actions can be added to change color profiles, use Nemo (Cinnamon files manager) as root, mount and eject medias, set screen backlight, use network manager, change wallpaper etc. Just don't make javascript mistakes…! Several <code>polkit.addRule (function (action, subject){&nbsp;…&nbsp;}</code> blocks can be used.

Another simpler way is to authorize all actions by only testing <code>wheel</code> group membership:
{{FileBox|filename=/etc/polkit-1/rules.d/55-allowing-all-actions.rules|lang=javascript|1=
polkit.addRule (function (action, subject)
{
  if (subject.isInGroup ("wheel"))
  {
    return polkit.Result.YES;
  }
});
}}
More detailed explanations in [http://www.freedesktop.org/software/polkit/docs/latest/index.html polkit Reference Manual], particularly [http://www.freedesktop.org/software/polkit/docs/latest/polkit.8.html polkit page].

== Starting Cinnamon ==

When not using a login/display manager, make a {{Path|.xinitrc}} file in the user's home directory with this content:

{{FileBox|filename=~/.xinitrc|lang=bash|1=
exec cinnamon-session
}}

Then to start Xorg and Cinnamon, once logged in:
{{Cmd|startx}}

With a display manager follow their [[display manager|wiki pages]] instructions.

== Theming ==

=== Mint-X Icons ===

By default Cinnamon comes with gnome icons. [https://github.com/linuxmint/mint-x-icons Mint-X icons are on GitHub]. Download, unzip and put the Mint-X icon set in {{Path|/usr/share/icons}}:
{{RootCmd|mv pathToUnzipedArchive/mint-x-icons-master/usr/share/icons/Mint-X /usr/share/icons/Mint-X}}
Then make a cache for it:
{{RootCmd|gtk-update-icon-cache /usr/share/icons/Mint-X}}
The new icons set can be selected in Cinnamon Control Center. Mint-X icons are green, there are others colors which can be installed too, like Mint-X-Grey or Mint-X-Orange. Always first install Mint-X icon set, others icons sets rely on it.

=== Desktop Icons Text Color ===

Icon's text color in Cinnamon desktop is black by default, not always readable. This color is differently modified according to GTK+ 3 version, get it with:

{{Cmd|emerge --info x11-libs/gtk+}}

==== GTK+ version < 3.13.3 ====

Computer basis color. Get white text by adding CSS rules in {{Path|/usr/share/themes/Adwaita/gtk-3.0/gtk.css}}, after <tt>@import</tt> line (Adwaita is the default theme coming with GTK+): 

{{FileBox|filename=/usr/share/themes/Adwaita/gtk-3.0/gtk.css|lang=css|1=
@import url("resource:///org/gnome/adwaita/gtk-main.css");

/* added css rules */
.nemo-desktop.nemo-canvas-item {
  color: #fff;
}

.nemo-desktop.nemo-canvas-item:selected {
  background-color: alpha(#fff, 0.2);
}
}}

The 2nd rule concerns selected desktop icon and can be modified to get others background color or transparency. In <tt>alpha(#fff, 0.2)</tt>, <tt>#fff</tt> is the color and <tt>0.2</tt> the transparency level.

==== GTK+ version >= 3.13.3 ====

User basis color. Adwaita is now included to GTK+ as default theme replacing Raleigh, rules must be set in users home directories: {{Path|~/.config/gtk-3.0/gtk.css}}, without <tt>@import</tt> line. Aditionally in this example left Nemo side bar is grey colored.

{{FileBox|filename=~/.config/gtk-3.0/gtk.css|lang=css|1=
.nemo-desktop.nemo-canvas-item {
  color: #fff;
}

.nemo-desktop.nemo-canvas-item:selected {
  background-color: alpha(#fff, 0.2);
}

NemoWindow .sidebar, NemoWindow .sidebar .view {
  background-color: #444;
  color: #eee;
}
}}

=== Mint-X Themes ===

Cinnamon comes with cinnamon theme, obviously... [https://github.com/linuxmint/cinnamon-themes Mint-X themes are on GitHub], unzip and copy to {{Path|/usr/share/themes}} if needed. They can be selected in Cinnamon Control Center.

=== Playing with Themes ===

Almost all theme settings can be changed in <tt>cinnamon.css</tt> file in a theme directory. Example with Cinnamon theme, which is not in {{Path|/usr/share/themes}} but in {{Path|/usr/share/cinnamon/theme}}: first copy theme's directory to an user themes sub-directory, named for example {{Path|other-cinnamon}}, which will be new theme name:

{{RootCmd|mkdir /home/userName/.themes/other-cinnamon|cp -R /usr/share/cinnamon/theme /home/userName/.themes/other-cinnamon/cinnamon|chown -R userName:userName /home/userName/.themes/other-cinnamon
}}
Edit {{Path|~/.themes/other-cinnamon/cinnamon/cinnamon.css}}, changes can be viewed by selecting another theme then reselecting the theme beeing changed.

== Debugging ==

If problems launch Xorg server via ssh to get live error messages. More messages with <code>--debug</code> parameter for cinnamon-session:

{{FileBox|filename=~/.xinitrc|lang=bash|1=
exec cinnamon-session --debug
}}

Alternatively you can have a look at {{Path|/var/log/Xorg.0.log}}.

If Cinnamon can't launch, deleting {{Path|.cinnamon}} in your home directory is not enough, other Cinnamon or Gnome (as <tt>dconf</tt>) items must be deleted too before X restart, in directories {{Path|.cache}} {{Path|.config}} {{Path|.local}}. {{Path|.gnome2}} can be entirely deleted.

== Installing common applications ==

Some usual Gnome, or not Gnome applications install.

=== Terminal ===

Lxterminal requires no dependencies, gnome-terminal needs systemd, mate-terminal should install all Mate desktop environment, xfce4-terminal requires some dependencies but is better featured than lxterminal.

==== Without systemd ====

{{Emerge|x11-terms/xfce4-terminal}}
Or:
{{Emerge|lxde-base/lxterminal}}

==== With systemd ====

{{Emerge|x11-terms/gnome-terminal}}

=== Others ===

For example calculator, screen copy utility, pictures, PDF display, system monitor, archive manager…

{{Emerge|media-gfx/eog gnome-extra/gnome-calculator media-gfx/gnome-screenshot gnome-extra/gnome-system-monitor app-arch/file-roller app-text/evince app-cdr/brasero}}

[[Category:Desktop_environment]]
</translate>
