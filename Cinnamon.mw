<languages />
<translate>
{{InfoBox stack
|{{InfoBox homepage|http://cinnamon.linuxmint.com/|header=true}}
|{{InfoBox wikipedia|Cinnamon_(software)}}
|{{InfoBox github|linuxmint/Cinnamon}}
}}
Cinnamon is a contemporary desktop environment with a traditional interface that Gnome 2, [[LXDE]] or [[Xfce]] users will find easy to work with. Cinnamon has very good graphical and functional features. Forked from Gnome Shell and developed for [http://linuxmint.com/ Linux Mint] it is available for the {{Keyword|amd64}} and {{Keyword|x86}} architectures.

== Installation ==

=== Prerequisites ===

Cinnamon works great under OpenRC without systemd. To install no systemd dependencies, eselect a profile without Gnome: default/linux/amd64/13.0/desktop. To install Gnome systemd dependencies only, eselect default/linux/amd64/13.0/desktop/gnome. The architecture and version can be different in both cases.

To get system profiles list type:

{{RootCmd|eselect profile list|output=<pre>
[1] default/linux/amd64/13.0
[2] default/linux/amd64/13.0/selinux
[3] default/linux/amd64/13.0/desktop
[4] default/linux/amd64/13.0/desktop/gnome
[5] default/linux/amd64/13.0/desktop/gnome/systemd
etc.
</pre>}}

==== OpenRC ====

Then to set a system profile using its complete name:

{{RootCmd|eselect profile set default/linux/amd64/13.0/desktop}}

Or with the associated profile number according to profiles list above:

{{RootCmd|eselect profile set 3}}

Also, follow the instructions available in the [[Gentoo_Without_systemd|Gentoo Without Systemd]] article.

==== Systemd ====

For Cinnamon with systemd support select the GNOME desktop profile ending in systemd:

{{RootCmd|eselect default/linux/amd64/13.0/desktop/gnome/systemd}}

{{Note|The system architecture (<code>amd64</code>) and version (<code>13</code>) can be different as long as the ending of the string is <code>/gnome/systemd</code>.}}

==== Xorg ====

Of course for Cinnamon to work properly Xorg [[Xorg/Guide|must be first installed]]. Be sure is working properly before proceeding with this article. If needed, test Xorg as detailed in [[Xorg/Guide#Using_startx|Using startx]] chapter of Xorg Gentoo guide.

For Cinnamon and other applications to be translated to a specific language (Linguas), if this was not done during the initial Gentoo installation, add the appropriate language value to the <var>LINGUAS</var> variable in {{Path|make.conf}}:

{{FileBox|filename=/etc/portage/make.conf|lang=bash|title=Set make.conf for French language code|1=
LINGUAS="fr" # or en, de, it, es, etc.
}}

Cinnamon will need two other packages: {{Package|x11-libs/gtk+extra}} and {{Package|x11-drivers/xf86-video-modesetting}}. Install them now:

{{Emerge|x11-libs/gtk+extra x11-drivers/xf86-video-modesetting}}

Two USE flags, <code>icu</code> and <code>pulseaudio</code>, are needed by Cinnamon dependencies. Accept a {{c|emerge}} temporary {{Path|package.use}} or {{Path|package.use/cinnamon}} file creation or modification (provided by <code>--ask</code> parameter), rename it as proposed then re-run the installation command.

{{Note|The compilation duration for {{Package|net-libs/webkit-gtk}} can be very long, especially older hardware. Be patient, Cinnamon is worth it!}}

=== USE flags ===

{{USEflag|package=gnome-extra/cinnamon|desc=Optional USE flags for {{Package|gnome-extra/cinnamon}}:
|networkmanager
|nls
|python_targets_python2_7+++Build with Python 2.7
|python_targets_python3_3+++Build with Python 3.3
|python_targets_python3_4+++Build with Python 3.4
}}

=== Emerge ===

Finally, after performing all the steps above, ask Portage to emerge Cinnamon:

{{Emerge|gnome-extra/cinnamon}}

== Configuration ==

=== Services ===

==== OpenRC ====

Xorg server and Cinnamon need the {{c|dbus}} and {{c|consolekit}} services. Add them to start at system boot time:

{{RootCmd
|rc-update add dbus default
|rc-update add consolekit default
}}

Start the services without restarting the system:

{{RootCmd
|rc-service dbus start
|rc-service consolekit start
}}

[[NetworkManager]] is a Cinnamon dependency and is not needed if network was configured during the initial Gentoo installation. It should not run concurrently with another network service. If NetworkManager is desired be sure to disable other network management programs or services before starting it. For example, if the system was originally configured to use Gentoo's netifrc scripts to manage the network connections, disable any network services:

{{RootCmd
|rc-service net.eth0 stop
|rc-update del net.eth0 default
}}

{{Note|When using {{Package|sys-fs/udev}} network interfaces will be using [http://www.freedesktop.org/wiki/Software/systemd/PredictableNetworkInterfaceNames/ Predictable Network Interface Names] to name the active interfaces. This will produce names like ''enp12s0'', ''eno1'', ''enp2s0'', etc. When using {{Package|sys-fs/eudev}}, the Gentoo udev fork avoiding systemd dependencies, first network interface name is often ''eth0''.}}

After removing other network services, add NetworkManager:

{{RootCmd
|rc-service NetworkManager start
|rc-update add NetworkManager default
}}

==== Systemd ====

With systemd use {{c|systemctl}} as detailed in [[Systemd#Enabling.2C_disabling.2C_starting_and_stopping_services|systemd page]].

=== Sudo ===

For an ordinary user to reboot or shutdown from Cinnamon, {{c|sudo}} is needed with some settings. First install {{Package|app-admin/sudo}}:

{{Emerge|app-admin/sudo}}

Next modify {{c|sudo}} configuration with the {{c|visudo}} command:

{{RootCmd|visudo}}

Visudo runs the default text editor with {{Path|sudoers}} file, replace <code>username</code> in the text below with the username of each Cinnamon user:

{{FileBox|filename=/etc/sudoers|lang=bash|1=
username  ALL=(root) NOPASSWD: /sbin/reboot
username  ALL=(root) NOPASSWD: /sbin/halt
username  ALL=(root) NOPASSWD: /sbin/poweroff
username  ALL=(root) NOPASSWD: /sbin/shutdown
}}

Or for the ''wheel'' group users:

{{FileBox|filename=/etc/sudoers|lang=bash|1=
%wheel  ALL=(root) NOPASSWD: /sbin/reboot
%wheel  ALL=(root) NOPASSWD: /sbin/halt
%wheel  ALL=(root) NOPASSWD: /sbin/poweroff
%wheel  ALL=(root) NOPASSWD: /sbin/shutdown
}}

=== Polkit rules and actions ===

For an ordinary user to perform root only actions from Cinnamon policy kit actions must be set. Use {{c|pkaction}} to get a list of actions, the names are self-explanatory:

{{RootCmd|pkaction|output=<pre>
org.cinnamon.settings-daemon.plugins.power.backlight-helper
org.cinnamon.settings-users
org.cinnamon.settingsdaemon.datetimemechanism.configure
org.freedesktop.ModemManager1.Contacts
org.freedesktop.ModemManager1.Control
org.freedesktop.ModemManager1.Device.Control
org.freedesktop.ModemManager1.Firmware
org.freedesktop.ModemManager1.Location
org.freedesktop.ModemManager1.Messaging
org.freedesktop.ModemManager1.USSD
org.freedesktop.NetworkManager.enable-disable-network
org.freedesktop.NetworkManager.enable-disable-wifi
etc.
</pre>}}

The simplest way is to authorize all actions by only testing ''wheel'' group membership. Put a JavaScript file in {{Path|/etc/polkit-1/rules.d}}, named for example {{Path|55-allowing-all-actions.rules}}:

{{FileBox|filename=/etc/polkit-1/rules.d/55-allowing-all-actions.rules|lang=javascript|title=Setting general polkit rule|1=
polkit.addRule (function (action, subject)
{
  if (subject.isInGroup ("wheel"))
  {
    return polkit.Result.YES;
  }
});
}}

To only authorize some actions, their names must be indicated. For a ''wheel'' group user to suspend, hibernate, shutdown and restart make a {{Path|55-allowing-actions.rules}} file:

{{FileBox|filename=/etc/polkit-1/rules.d/55-allowing-actions.rules|lang=javascript|title=Setting polkit rules|1=
polkit.addRule (function (action, subject)
{
  if (action.id == "org.freedesktop.upower.hibernate" {{!}}{{!}}
      action.id == "org.freedesktop.upower.suspend" {{!}}{{!}}
      action.id == "org.freedesktop.consolekit.system.stop" {{!}}{{!}}
      action.id == "org.freedesktop.consolekit.system.restart" &&
      subject.isInGroup ("wheel"))
      {
        return polkit.Result.YES;
      }
});
}}

All needed actions can be added to change color profiles, use Nemo (Cinnamon files manager) as root, mount and eject media, set screen backlight, use network manager, change wallpaper, etc. Several <code>polkit.addRule (function (action, subject){&nbsp;…&nbsp;});</code> blocks can be used.

{{Important|{{Path|/etc/polkit-1/rules.d/50-default.rules}} already exists. New created file name begins with '''55''' and will be processed after {{Path|50-default.rules}}. Do not make a file which should be processed before it, with a name beginning with '''45''' for example.
}}

=== Starting Cinnamon ===

When not using a login/display manager, make a {{Path|.xinitrc}} file in the user's home directory:

{{FileBox|filename=~/.xinitrc|lang=bash|title=Cinnamon launch directive|1=
exec cinnamon-session
}}

Then to start Xorg and Cinnamon, once logged in:

{{Cmd|startx}}

With a display manager follow [[display manager|their wiki pages]] instructions.

=== Theming ===

==== Mint-X icons ====

By default Cinnamon comes with Gnome icons. [https://github.com/linuxmint/mint-x-icons Mint-X icons are on GitHub]. Download, unzip, and put the Mint-X icon set in {{Path|/usr/share/icons}}:

{{RootCmd|mv pathToUnzipedArchive/mint-x-icons-master/usr/share/icons/Mint-X /usr/share/icons/Mint-X}}

Then make a cache for it:

{{RootCmd|gtk-update-icon-cache /usr/share/icons/Mint-X}}

The new icons set can be selected in Cinnamon Control Center. Mint-X icons are green, there are others colors which can be installed too, like Mint-X-Grey or Mint-X-Orange. Also make a cache for them.

{{Important|Always install Mint-X icon set with colored icons sets, they rely on it.}}

==== Desktop icons text color ====

Icon's text color in Cinnamon desktop is black by default, not always readable. This color is differently modified according to GTK+ 3 version, get it with:

{{Cmd|emerge --info x11-libs/gtk+}}

=== GTK+ version ===

==== < 3.13.3 ====

'''System basis color.''' Change text color by adding CSS rules in {{Path|/usr/share/themes/Adwaita/gtk-3.0/gtk.css}}, after <code>@import</code> line (Adwaita is the default theme coming with GTK+):

{{FileBox|filename=/usr/share/themes/Adwaita/gtk-3.0/gtk.css|lang=css|title=CSS rules|1=
@import url("resource:///org/gnome/adwaita/gtk-main.css");

/* added css rules */
.nemo-desktop.nemo-canvas-item {
  color: #fff;  /* #fff is white web color indication, #333 should be dark grey */
}

.nemo-desktop.nemo-canvas-item:selected {
  background-color: alpha (#fff, 0.2);  /* 0.2 is transparency level */
}
}}

The 2<sup>nd</sup> rule concerns selected desktop icon and can be modified to get others background color or transparency.

==== >= 3.13.3 ====

'''User basis color.''' Adwaita is now included to GTK+ as the theme replacing Raleigh, rules must be set in users home directories: {{Path|~/.config/gtk-3.0/gtk.css}}, without <code>@import</code> line. Aditionally in this example left Nemo side bar is grey colored:

{{FileBox|filename=~/.config/gtk-3.0/gtk.css|lang=css|title=CSS rules|1=
.nemo-desktop.nemo-canvas-item {
  color: #fff;
}

.nemo-desktop.nemo-canvas-item:selected {
  background-color: alpha (#fff, 0.2);
}

NemoWindow .sidebar, NemoWindow .sidebar .view {
  background-color: #444;
  color: #eee; /* light grey */
}
}}

=== Mint-X themes ===

Cinnamon comes with cinnamon theme, obviously… The Mint-X themes are [https://github.com/linuxmint/cinnamon-themes available for download] on GitHub. Download them, unzip, and copy to {{Path|/usr/share/themes}} if needed. They can be selected in Cinnamon Control Center.

=== Playing with themes ===

Almost all theme settings can be changed in {{Path|cinnamon.css}} file in a theme directory. Example with Cinnamon theme, which is not in {{Path|/usr/share/themes}} but in {{Path|/usr/share/cinnamon/theme}}: first copy theme's directory to an user themes sub-directory, named for example {{Path|other-cinnamon}}, which will be new theme name:

{{RootCmd
|mkdir /home/userName/.themes/other-cinnamon
|cp -R /usr/share/cinnamon/theme /home/userName/.themes/other-cinnamon/cinnamon
|chown -R userName:userName /home/userName/.themes/other-cinnamon
}}

Edit {{Path|~/.themes/other-cinnamon/cinnamon/cinnamon.css}}, changes can be viewed by selecting another theme then reselecting the theme being changed.

=== Installing common applications ===

==== Terminals ====

* {{Package|lxde-base/lxterminal}} - Requires no dependencies.
* {{Package|x11-terms/xfce4-terminal}} - Requires some dependencies but is better featured than {{Path|lxterminal}}.
* {{Package|x11-terms/gnome-terminal}} Requires systemd.

===== OpenRC =====

Emerge the Xfce4 terminal program:

{{Emerge|x11-terms/xfce4-terminal}}

Or the lxterminal:

{{Emerge|lxde-base/lxterminal}}

===== Systemd =====

When using Systemd emerge the GNOME terminal:

{{Emerge|x11-terms/gnome-terminal}}

==== Other ====

For example calculator {{Package|gnome-extra/gnome-calculator}}, screen copy utility {{Package|media-gfx/gnome-screenshot}}, pictures {{Package|media-gfx/eog}} and PDF {{Package|app-text/evince}} display, system monitor {{Package|gnome-extra/gnome-system-monitor}}, archive manager {{Package|app-arch/file-roller}}, disk burning {{Package|app-cdr/brasero}}, text editor {{Package|app-editors/gedit}}.

{{Emerge|media-gfx/eog gnome-extra/gnome-calculator media-gfx/gnome-screenshot gnome-extra/gnome-system-monitor app-arch/file-roller app-text/evince app-cdr/brasero app-editors/gedit}}

== Troubleshooting ==

If problems launch Cinnamon via {{c|ssh}} to get Xorg live error messages. More messages with <code>--debug</code> parameter for {{c|cinnamon-session}}:

{{FileBox|filename=~/.xinitrc|lang=bash|title=Cinnamon debug launch|1=
exec cinnamon-session --debug
}}

Alternatively have a look at {{Path|/var/log/Xorg.0.log}}.

If Cinnamon cannot launch, deleting {{Path|.cinnamon}} in home directory is not enough, other Cinnamon or Gnome items must be deleted too before X restarts. These can be found in directories {{Path|.cache}}, {{Path|.config}} and {{Path|.local}}. {{Path|.gnome2}} can be entirely deleted.
</translate>

== External resources ==

* Polkit see [http://www.freedesktop.org/software/polkit/docs/latest/index.html polkit Reference Manual] and [http://www.freedesktop.org/software/polkit/docs/latest/polkit.8.html polkit page].
* Web color syntax see [https://en.wikipedia.org/wiki/Web_colors Wikipedia article].
* A [https://wiki.gnome.org/Apps Gnome applications list].
* [http://segfault.linuxmint.com/ Cinnamon announcements].


[[Category:Desktop_environment]]
