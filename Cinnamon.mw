<languages />
<translate>
{{InfoBox stack
|{{InfoBox homepage|http://cinnamon.linuxmint.com/|header=true}}
|{{InfoBox wikipedia|Cinnamon_(software)}}
}}

Cinnamon is a traditional and modern desktop environment: traditional desktop metaphor as Gnome 2, [[LXDE]] or [[Xfce]], with very good graphical and functional features. Forked from Gnome Shell and developed for [http://linuxmint.com/ Linux Mint], it is provided for Gentoo as a Gnome package {{Package|gnome-extra/cinnamon}} for {{Keyword|amd64}} and {{Keyword|x86}} platforms.

== Installation ==

=== Prerequisites ===

==== Profiles ====

===== OpenRC =====

Cinnamon works great under OpenRC without systemd. To install no systemd dependencies, eselect a profile without Gnome: <tt>default/linux/amd64/13.0/desktop</tt>. To install Gnome systemd dependencies only, eselect <tt>default/linux/amd64/13.0/desktop/gnome</tt>. Platform and version can be different in both cases. To get system profiles list:

{{RootCmd|eselect profile list|output=<pre>
[1] default/linux/amd64/13.0
[2] default/linux/amd64/13.0/selinux
[3] default/linux/amd64/13.0/desktop
[4] default/linux/amd64/13.0/desktop/gnome
[5] default/linux/amd64/13.0/desktop/gnome/systemd
etc.</pre>
}}

Then to set the system profile with it's complete name:

{{RootCmd|eselect profile set default/linux/amd64/13.0/desktop}}

Or with profile number according to profiles list:

{{RootCmd|eselect profile set 3}}

Also, follow the [[Gentoo_Without_systemd|Gentoo Without Systemd]] wiki page instructions.

===== Systemd =====

For Cinnamon with systemd, eselect <tt>default/linux/amd64/13.0/desktop/gnome/systemd</tt>. The platform and version can be different.

==== Xorg ====

Of course, [[Xorg/Guide|Xorg must be first installed]] for Cinnamon to work. Be shure it is working properly. If needed, test Xorg as detailed in [[Xorg/Guide#Using_startx|Using startx]] chapter of Xorg Gentoo guide.

For Cinnamon and other applications to be translated to a specific language, if this was not done during Gentoo install, add the appropriate language to the {{Path|make.conf}}:

{{FileBox|filename=/etc/portage/make.conf|lang=bash|title=Set make.conf for French language code|1=
LINGUAS="fr" # or en, de, it, es, etc.
}}

Cinnamon will need two others packages in order to work: {{Package|x11-libs/gtk+extra}} and {{Package|x11-drivers/xf86-video-modesetting}}.

Installing:

{{Emerge|x11-libs/gtk+extra x11-drivers/xf86-video-modesetting}}

Two USE flags, <code>icu</code> and <code>pulseaudio</code>, are needed by Cinnamon dependencies. Accept {{c|emerge}} temporary {{Path|package.use}} or {{Path|package.use/anyFileName}} file creation or modification (provided by <code>--ask</code> parameter), rename it as proposed then run again the installation command.

{{Note|Compilation duration for {{Package|net-libs/webkit-gtk}} can be very long, especially older hardware. Be patient, Cinnamon is worth it!}}

=== USE flags ===

{{USEflag|package=gnome-extra/cinnamon|desc=Optional USE flags for {{Package|gnome-extra/cinnamon}}:
|networkmanager
|nls
|python_targets_python2_7+++Build with Python 2.7
|python_targets_python3_3+++Build with Python 3.3
|python_targets_python3_4+++Build with Python 3.4
}}

=== Emerge ===

{{Emerge|gnome-extra/cinnamon}}

== Configuration ==

=== Services ===

==== OpenRC ====

Xorg server and Cinnamon need the <tt>dbus</tt> and <tt>consolekit</tt> services, add them at boot time:

{{RootCmd
|rc-update add dbus default
|rc-update add consolekit default
}}

Running these services before restart:

{{RootCmd
|rc-service dbus start
|rc-service consolekit start
}}

[[NetworkManager]] is a Cinnamon dependency and isn't needed because network is configured during Gentoo install. It should not run concurrently with another network service. Optionaly, to replace a network service named <tt>net.eth0</tt> by <tt>NetworkManager</tt>:

{{RootCmd
|rc-service net.eth0 stop
|rc-update del net.eth0 default
|rc-service NetworkManager start
|rc-update add NetworkManager default
}}

{{Note|With {{Package|sys-fs/udev}}, by default during Gentoo install, net service can be named for example <tt>net.enp12s0</tt>. With {{Package|sys-fs/eudev}}, the Gentoo <tt>udev</tt> fork avoiding systemd dependencies, first net service name is often <tt>net.eth0</tt>. Change above example service name if needed.
}}

==== Systemd ====

With systemd use {{c|systemctl}} as detailed in [[Systemd#Enabling.2C_disabling.2C_starting_and_stopping_services|systemd page]].

=== Sudo ===

For an ordinary user to reboot or shutdown from Cinnamon, <tt>sudo</tt> is needed with some settings. First install {{Package|app-admin/sudo}}:

{{Emerge|app-admin/sudo}}

Next modify <tt>sudo</tt> configuration with the <tt>visudo</tt> command:

{{RootCmd|visudo}}

Visudo runs the default text editor with <tt>sudoers</tt> file, add for a named user:

{{CodeBox|lang=bash|1=
userName  ALL=(root) NOPASSWD: /sbin/reboot
userName  ALL=(root) NOPASSWD: /sbin/halt
userName  ALL=(root) NOPASSWD: /sbin/poweroff
userName  ALL=(root) NOPASSWD: /sbin/shutdown
}}

Or for the <tt>wheel</tt> group users:

{{CodeBox|lang=bash|1=
%wheel  ALL=(root) NOPASSWD: /sbin/reboot
%wheel  ALL=(root) NOPASSWD: /sbin/halt
%wheel  ALL=(root) NOPASSWD: /sbin/poweroff
%wheel  ALL=(root) NOPASSWD: /sbin/shutdown
}}

=== Polkit rules and actions ===

For an ordinary user to perform root only actions from Cinnamon, policy kit actions must be configured. Get the list of these actions, their names are quite self-explanatory:

{{RootCmd|pkaction|output=<pre>
org.cinnamon.settings-daemon.plugins.power.backlight-helper
org.cinnamon.settings-users
org.cinnamon.settingsdaemon.datetimemechanism.configure
org.freedesktop.ModemManager1.Contacts
org.freedesktop.ModemManager1.Control
org.freedesktop.ModemManager1.Device.Control
org.freedesktop.ModemManager1.Firmware
org.freedesktop.ModemManager1.Location
org.freedesktop.ModemManager1.Messaging
org.freedesktop.ModemManager1.USSD
org.freedesktop.NetworkManager.enable-disable-network
org.freedesktop.NetworkManager.enable-disable-wifi
etc.
</pre>
}}

The simplest way is to authorize all actions by only testing ''wheel'' group membership. Put a javascript file in {{Path|/etc/polkit-1/rules.d}}, named for example {{Path|55-allowing-all-actions.rules}}:

{{FileBox|filename=/etc/polkit-1/rules.d/55-allowing-all-actions.rules|lang=javascript|title=Setting general polkit rule|1=
polkit.addRule (function (action, subject)
{
  if (subject.isInGroup ("wheel"))
  {
    return polkit.Result.YES;
  }
});
}}

To only authorize some actions, their names must be indicated. For a <tt>wheel</tt> group user to suspend, hibernate, shutdown and restart, make a {{Path|55-allowing-actions.rules}} file:

{{FileBox|filename=/etc/polkit-1/rules.d/55-allowing-actions.rules|lang=javascript|title=Setting polkit rules|1=
polkit.addRule (function (action, subject)
{
  if (action.id == "org.freedesktop.upower.hibernate" {{!}}{{!}}
      action.id == "org.freedesktop.upower.suspend" {{!}}{{!}}
      action.id == "org.freedesktop.consolekit.system.stop" {{!}}{{!}}
      action.id == "org.freedesktop.consolekit.system.restart" &&
      subject.isInGroup ("wheel"))
      {
        return polkit.Result.YES;
      }
});
}}

All needed actions can be added to change color profiles, use Nemo (Cinnamon files manager) as root, mount and eject medias, set screen backlight, use network manager, change wallpaper etc. Several <code>polkit.addRule (function (action, subject){&nbsp;…&nbsp;});</code> blocks can be used.

{{Important|{{Path|/etc/polkit-1/rules.d/50-default.rules}} already exists. New created file name begins with '''55''' and will be processed after {{Path|50-default.rules}}. Don't make a file which should be processed before it, with a name beginning with '''45''' for example.
}}

=== Starting Cinnamon ===

When not using a login/display manager, make a {{Path|.xinitrc}} file in the user's home directory:

{{FileBox|filename=~/.xinitrc|lang=bash|title=Cinnamon launch directive|1=
exec cinnamon-session
}}

Then to start Xorg and Cinnamon, once logged in:

{{Cmd|startx}}

With a display manager follow [[display manager|their wiki pages]] instructions.

=== Theming ===

==== Mint-X icons ====

By default Cinnamon comes with Gnome icons. [https://github.com/linuxmint/mint-x-icons Mint-X icons are on GitHub]. Download, unzip and put the <tt>Mint-X</tt> icon set in {{Path|/usr/share/icons}}:

{{RootCmd|mv pathToUnzipedArchive/mint-x-icons-master/usr/share/icons/Mint-X /usr/share/icons/Mint-X}}

Then make a cache for it:

{{RootCmd|gtk-update-icon-cache /usr/share/icons/Mint-X}}

The new icons set can be selected in Cinnamon Control Center. <tt>Mint-X</tt> icons are green, there are others colors which can be installed too, like <tt>Mint-X-Grey</tt> or <tt>Mint-X-Orange</tt>. Also make a cache for them.

{{Important|Always install <tt>Mint-X</tt> icon set with colored icons sets, they rely on it.}}

==== Desktop icons text color ====

Icon's text color in Cinnamon desktop is black by default, not always readable. This color is differently modified according to <tt>GTK+ 3</tt> version, get it with:

{{Cmd|emerge --info x11-libs/gtk+}}

=== GTK+ version ===

==== < 3.13.3 ====

'''System basis color.''' Change text color by adding CSS rules in {{Path|/usr/share/themes/Adwaita/gtk-3.0/gtk.css}}, after <code>@import</code> line (Adwaita is the default theme coming with GTK+):

{{FileBox|filename=/usr/share/themes/Adwaita/gtk-3.0/gtk.css|lang=css|title=CSS rules|1=
@import url("resource:///org/gnome/adwaita/gtk-main.css");

/* added css rules */
.nemo-desktop.nemo-canvas-item {
  color: #fff;  /* #fff is white web color indication, #333 should be dark grey */
}

.nemo-desktop.nemo-canvas-item:selected {
  background-color: alpha (#fff, 0.2);  /* 0.2 is transparency level */
}
}}

The 2<sup>nd</sup> rule concerns selected desktop icon and can be modified to get others background color or transparency.

==== >= 3.13.3 ====

'''User basis color.''' Adwaita is now included to GTK+ as the theme replacing Raleigh, rules must be set in users home directories: {{Path|~/.config/gtk-3.0/gtk.css}}, without <code>@import</code> line. Aditionally in this example left Nemo side bar is grey colored:

{{FileBox|filename=~/.config/gtk-3.0/gtk.css|lang=css|title=CSS rules|1=
.nemo-desktop.nemo-canvas-item {
  color: #fff;
}

.nemo-desktop.nemo-canvas-item:selected {
  background-color: alpha (#fff, 0.2);
}

NemoWindow .sidebar, NemoWindow .sidebar .view {
  background-color: #444;
  color: #eee; /* light grey */
}
}}

=== Mint-X themes ===

Cinnamon comes with <tt>cinnamon</tt> theme, obviously… [https://github.com/linuxmint/cinnamon-themes Mint-X themes are on GitHub], unzip and copy to {{Path|/usr/share/themes}} if needed. They can be selected in Cinnamon Control Center.

=== Playing with themes ===

Almost all theme settings can be changed in {{Path|cinnamon.css}} file in a theme directory. Example with Cinnamon theme, which is not in {{Path|/usr/share/themes}} but in {{Path|/usr/share/cinnamon/theme}}: first copy theme's directory to an user themes sub-directory, named for example {{Path|other-cinnamon}}, which will be new theme name:

{{RootCmd|mkdir /home/userName/.themes/other-cinnamon|cp -R /usr/share/cinnamon/theme /home/userName/.themes/other-cinnamon/cinnamon|chown -R userName:userName /home/userName/.themes/other-cinnamon
}}

Edit {{Path|~/.themes/other-cinnamon/cinnamon/cinnamon.css}}, changes can be viewed by selecting another theme then reselecting the theme beeing changed.

=== Installing common applications ===

Some usual Gnome, or not Gnome applications install.

==== Terminals ====

{{Package|lxde-base/lxterminal}} requires no dependencies, {{Package|x11-terms/xfce4-terminal}} requires some dependencies but is better featured than <tt>lxterminal</tt>, {{Package|x11-terms/gnome-terminal}} needs systemd.

===== OpenRC =====

Emerge {{c|xfce4-terminal}}:

{{Emerge|x11-terms/xfce4-terminal}}

Or {{c|lxterminal}}:

{{Emerge|lxde-base/lxterminal}}

===== Systemd =====

Emerge {{c|gnome-terminal}}:

{{Emerge|x11-terms/gnome-terminal}}

==== Others ====

For example calculator {{Package|gnome-extra/gnome-calculator}}, screen copy utility {{Package|media-gfx/gnome-screenshot}}, pictures {{Package|media-gfx/eog}} and PDF {{Package|app-text/evince}} display, system monitor {{Package|gnome-extra/gnome-system-monitor}}, archive manager {{Package|app-arch/file-roller}}, disk burning {{Package|app-cdr/brasero}}, text editor {{Package|app-editors/gedit}}.

{{Emerge|media-gfx/eog gnome-extra/gnome-calculator media-gfx/gnome-screenshot gnome-extra/gnome-system-monitor app-arch/file-roller app-text/evince app-cdr/brasero app-editors/gedit}}

== Troubleshooting ==

If problems launch Cinnamon via {{c|ssh}} to get Xorg live error messages. More messages with <code>--debug</code> parameter for {{c|cinnamon-session}}:

{{FileBox|filename=~/.xinitrc|lang=bash|title=Cinnamon debug launch|1=
exec cinnamon-session --debug
}}

Alternatively have a look at {{Path|/var/log/Xorg.0.log}}.

If Cinnamon can't launch, deleting {{Path|.cinnamon}} in home directory is not enough, other Cinnamon or Gnome items must be deleted too before X restart, in directories {{Path|.cache}}, {{Path|.config}} and {{Path|.local}}. {{Path|.gnome2}} can be entirely deleted.

== External resources ==

* Polkit see [http://www.freedesktop.org/software/polkit/docs/latest/index.html polkit Reference Manual] and [http://www.freedesktop.org/software/polkit/docs/latest/polkit.8.html polkit page].
* Web color syntax see [https://en.wikipedia.org/wiki/Web_colors Wikipedia article].
* A [https://wiki.gnome.org/Apps Gnome applications list].
* http://segfault.linuxmint.com/ - Cinnamon announcements

[[Category:Desktop_environment]]

</translate>
