'''AutoFS''' uses the Linux kernel Automounter to automatically mount several types of media like memory sticks, network shares, CD-Rom/DVD/BR etc. on demand.

== Installation ==

=== Kernel ===

Activate the following kernel options:

{{KernelBox|<pre>
File systems --->
    <*> Kernel automounter version 4 support (also supports v3)
</pre>}}

=== USE flags ===

{{USEflag|package=net-fs/autofs}}

=== Emerge ===

Like most filesystems available for Linux, after AutoFS has been enabled in the kernel, the user space package must be installed for system administration:

{{Emerge|net-fs/autofs}}

== Configuration ==

=== Service ===

==== OpenRC ====

Start and add AutoFS to the default runlevel:

{{RootCmd
|/etc/init.d/autofs start
|rc-update add autofs default
}}

=== Files ===

The configuration files are found in the following locations:

* {{Path|/etc/conf.d/autofs}}
* {{Path|/etc/autofs/auto.master}}
* {{Path|/etc/autofs/auto.misc}}

== Usage ==

General configuration files for AutoFS. 

{{Important|You probably need to install additional software and modules to mount DVD, NFS, CIFS etc. The mount helpers need to be available for each file system you configure.}}

=== autofs configuration ===

The default options for autofs can be changed by setting the proper configuration variables located in {{Path|/etc/conf.d/autofs}}. The default location for the master map is ({{Path|/etc/autofs/auto.master}}). It can be changed by setting the <var>MASTER_MAP_NAME</var> configuration variable in {{Path|/etc/conf.d/autofs}}.

{{Note|The following examples of configuration files take into account the default location for {{Path|auto.master}}.}}

=== auto.master ===

In this configuration file is defined what other configuration files should be included as root mount-point. Here is one example with one additional mount-point on {{Path|/mnt/auto}}:

{{FileBox|filename=/etc/autofs/auto.master|lang=properties|1=
+auto.master # extry needed for NIS mapping
# Here are the files listed, that should be included
# mount-point {{!}} config file {{!}} options
/mnt/auto   /etc/autofs/auto.misc    <nowiki>--timeout=15 --ghost</nowiki>
}}

{{Note|{{Path|/mnt/auto}} is the root mount-point for all file systems defined in auto.misc. <code>--timeout</code> defines how many seconds to wait before the file system is unmounted. <code>--ghost</code> creates empty folders for each mount-point in auto.misc, this prevents timeouts if a network share cannot be contacted.}}

=== auto.misc ===

Here is our example for the file auto.misc. The folders for the mount-points are automatically created:

{{FileBox|filename=/etc/autofs/auto.misc|lang=properties|1=
# mount-point below /mnt/auto {{!}} mount options {{!}} device, network share etc.

# CD-Rom on /mnt/auto/cd
cd              -fstype<nowiki>=</nowiki>iso9660,ro,nosuid,nodev              :/dev/cdrom
# nework share mounted via NFSv3 on /mnt/auto/data
data            -rw,vers<nowiki>=</nowiki>3,soft,async                        192.168.0.254:/tank1/data
# nework share mounted via CIFS on /mnt/auto/data1
data1           -fstype<nowiki>=</nowiki>cifs,credentials<nowiki>=</nowiki>/root/smb.txt       ://192.168.0.254/data1
# memory stick used regulary with known UUID, for example a kindle
kindle          -fstype<nowiki>=</nowiki>vfat,rw,uid<nowiki>=</nowiki>1000                     :UUID<nowiki>="4CBF-23A2"</nowiki>
}}

{{Note|There are several more examples in the auto.misc that comes with the package}}

=== Simple Windows-like SMB shares usage ===

If you want to use network SMB shares easily you can try the following configuration. You will be able to automount, for example, by issuing "cd /net/10.50.40.32/share" command in shell or "/net/10.50.40.32/share" in a browser or commander and work with the files inside as they were located on local machine. Make the following modifications:

{{FileBox|filename=/etc/autofs/auto.master|lang=properties|1=
#+auto.master
/net file:/etc/autofs/auto.smbm --ghost --nonstrict
}}

{{FileBox|filename=/etc/autofs/auto.smbm|lang=properties|1=
* -fstype=autofs,-Dhost=& file://etc/autofs/auto.share
}}

{{FileBox|filename=/etc/autofs/auto.share|lang=properties|1=
* -fstype=cifs,username=guest,password=,file_mode=0664,dir_mode=0775,uid=netmount,gid=netmount,port=139 ://${host}/&
}}

Restart autofs daemon and you are ready to use simple automount.

== External resources ==

* [http://tldp.org/HOWTO/Automount.html Automount mini-Howto] on The Linux Documentation Project website

[[Category:Software]]
