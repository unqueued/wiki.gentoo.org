<languages/>

== vmail пользователь ==

Поскольку действительные идентификаторы пользователей и групп UNIX нужны для хранения почтовых ящиков, они должны быть корректными.
* Большинство сервисов получают системный идентификатор ниже 1000.
* В Gentoo идентификатор пользователя начинается с 1000.
* Идентификатор из 5000 выбирается для пользователя vmail.

Если существуют сотни пользователей командной строки, разные идентификаторы могут быть так же использованы.
Это не будет учетной записью командной строки для кого бы то ни было.

{{RootCmd|groupadd -g 5000 vmail
|useradd -m -d /var/vmail -s /bin/false -u 5000 -g vmail vmail}}

{{Note|Указание идентификаторов пользователя и группы не требуется, но это аккуратно, так что стоит задуматься. После того, как пользователи и группы добавлены, будет разумно отредактировать файлы {{Path|/etc/passwd}} и {{Path|/etc/group}}, переместив новых пользователей и группы в подходящие места. Это рекомендуется, потому что по умолчанию <tt>useradd</tt> и <tt>groupadd</tt> увеличивают на единицу последнюю найденную запись и таким образом новый пользователь будет иметь позицию 5001. Очевидно, что это важно в том случае, если эти два файла нуждаются в упорядоченной организации имеющийся в них информации.}}

== Место для хранения ==

Теперь задумаемся о месте хранения почты. Это может быть раздел, NFS или обычная поддиректория. {{Path|/var/vmail}} выбран, как отмечалось выше, и создан раздел raid10 размером 32Гб. Где бы не было место хранения, права должны быть соответствующим образом изменены.

{{RootCmd|chown vmail:vmail /var/vmail/}}

Также права должны быть настроены должным образом:

{{RootCmd|chmod 2770 /var/vmail/}}

Проверьте права что бы убедиться, что ранее в них не было допущено ошибки:

{{RootCmd|ls -ld /var/vmail|output=
drwxrws--- 3 vmail vmail 4096 Aug  2 07:24 /var/vmail
}}

== Vmail пользователь и Postfix ==

Postfix needs to know where and under what ownership to store mail.

{{Note|If required, this also can be looked up on a per user basis from the database. For example, when the maildirs are not located in a central directory, but in each users home directory. In this document, the vmail user is the only user to be allowed access, and thus this is not touched on.}}

{{FileBox|filename=/etc/postfix/main.cf|title=Binding UID and GID's to postfix|1=
# Link the mailbox uid and gid to postfix.
virtual_uid_maps = static:5000
virtual_gid_maps = static:5000
 
# Set the base address for all virtual mailboxes
virtual_mailbox_base = /var/vmail
}}

[[Category:Mail Servers]]
