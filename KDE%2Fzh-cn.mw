<languages />

{{InfoBox stack
|{{InfoBox homepage|https://www.kde.org/|header=true}}
|{{InfoBox wikipedia}}
|{{InfoBox project|KDE}}
}}

<div class="mw-translate-fuzzy">
'''KDE''' 是自由软件社区，提供的一组应用程序，包括流行的 Plasma 桌面环境。
</div>

<div class="mw-translate-fuzzy">
Gentoo对KDE项目的支持非常好，包括对KDE Frameworks 5，Plasma 5和Applications 5的全面支持，以及其他各种各样基于KDE的软件。
</div> 

== 准备 ==

=== 配置 ===

选择一个适当的[[Profile (Portage)|Portage配置]]，尽管这不是必须的，但是我们仍建议这么做。因为这会设置一些全局或针对特定软件包的 USE 旗标来确保你能够获得顺畅的 KDE 使用体验。

为了选择适当的[[Profile (Portage)|Portage配置]]，首先需要列出有哪些可用的[[Profile (Portage)|Portage配置]]：

<div class="mw-translate-fuzzy">
{{RootCmd|eselect profile list|output=<pre>
  [1]   default/linux/amd64/13.0
  [2]   default/linux/amd64/13.0/selinux
  [3]   default/linux/amd64/13.0/desktop
  [4]   default/linux/amd64/13.0/desktop/gnome
  [5]   default/linux/amd64/13.0/desktop/gnome/systemd
  [6]   default/linux/amd64/13.0/desktop/kde
  [7]   default/linux/amd64/13.0/desktop/kde/systemd
  [8]   default/linux/amd64/13.0/desktop/plasma
  [9]   default/linux/amd64/13.0/desktop/plasma/systemd
  ...
</pre>}}
</div>

然后选择正确的[[Profile (Portage)|Portage配置]]，把下面的命令中的<code>X</code>替换为合适的[[Profile (Portage)|Portage配置]]对应的数字：

{{RootCmd|eselect profile set X}}

<div class="mw-translate-fuzzy">
 如果要使用 Plasma 5 桌面环境，请选择<code>desktop/plasma</code>  [[OpenRC]]或者 <code>desktop/plasma/systemd</code>  [[systemd/zh-cn]]。
</div>

=== 服务 ===

<div class="mw-translate-fuzzy">
在安装 KDE 软件之前，建议先设置并启用几个别的服务。它们当中的一部分已经由 ''desktop/plasma'' 或 ''desktop'' 的 [[Profile (Portage)|Portage配置]]设定好了。这些服务是：
* [[D-Bus]]: 启用 D-Bus 信息总线系统（D-Bus message bus system）。
* [[polkit]]: 启用 polkit 框架以控制系统中的服务的权限。
* [[udev]]: 启用对 udev —— Linux 下的动态的、常驻后台的自动为设备命名的服务（dynamic and persistent device naming service） ——的支持。 
* [[udisks]]: 启用一些与存储相关的服务。
</div>

==== Session tracker ====

Choose exactly one of:

* [[elogind]]: Standalone logind package extracted from systemd project for use with [[OpenRC]] or other init systems.
* [[systemd]]: Uses the session tracker part of systemd. Users of systemd do not need to take any other initiative here.
* [[ConsoleKit|consolekit]]: Framework for defining and tracking users, login sessions, and seats. It is currently default for the {{Path|desktop/plasma}} profile.

For [[Wayland]] support, a logind implementation is required. Gentoo provides [[elogind]] as an alternative to [[systemd]].

==== Device manager ====

Choose exactly one of:

* [[eudev]]: Gentoo's fork of udev with the goal of obtaining better compatibility. It is the default for the {{Path|desktop/plasma}} profile.
* [[udev]]: Enables support for udev Linux dynamic and persistent device naming.
* [[systemd]]: Uses the device manager part of systemd. Users of systemd do not need to take any other initiative here.

==== Miscellaneous ====

* [[D-Bus]]: Enables use of the D-Bus message bus system.
* [[polkit]]: Enables the polkit framework for controlling privileges for system-wide services.
* [[udisks]]: Enables support for some storage related services.

===  X 服务 ===

阅读下列来自 [[X server]] 的介绍来设置 X 环境。

=== Package conflicts ===

KDE Plasma and Applications come with many dependencies. Some of these dependencies will predetermine package choices where otherwise there would be options to choose from.

* [[FFmpeg]]: By default, {{Package|dev-qt/qtwebengine}} has USE <code>system-ffmpeg</code> enabled, making it depend on {{Package|media-video/ffmpeg}}. Users preferring {{Package|media-video/libav}} for the rest of their system will need to switch off that flag.
* JPEG: Since 5.11.1, {{Package|dev-qt/qtwebengine}} depends on {{Package|media-libs/libjpeg-turbo}}. It is Gentoo's recommended default over {{Package|media-libs/jpeg}} anyway.

== Plasma ==

Plasma 5 是 KDE 正在发展的一代桌面环境，基于 Qt 5 和 KDE Framework 5 。

=== 可用版本 ===

{| {{{!}} class{{=}}"table table-striped table-condensed"
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | KDE
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Gentoo
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Ebuild repository
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Status
|-
| KDE Plasma 5.14.3
| kde-plasma/plasma-meta-5.14.3
| gentoo
| Stable for {{Keyword|amd64}} and {{Keyword|x86}}; Testing for {{Keyword|arm}} and {{Keyword|arm64}}
|-
| KDE Plasma 5.14.5
| kde-plasma/plasma-meta-5.14.5
| gentoo
| Testing for {{Keyword|amd64}}, {{Keyword|arm}}, {{Keyword|arm64}} and {{Keyword|x86}}
|-
| KDE Plasma master branch
| kde-plasma/plasma-meta-9999
| [[KDE/Ebuild repository|KDE]]
| Live version
|}

<div class="mw-translate-fuzzy">
{{Note/zh-cn|在继续安装之前，请确保选择了一个 Plasma 的[[Profile (Portage)|Portage配置]]。 KDE 4 用户则需要一些额外的步骤。}}
</div>

==== 安装 ====

<div class="mw-translate-fuzzy">
 {{Package|kde-plasma/plasma-meta}} 包提供完整的 Plasma 5 套件，由以下 USE 旗标配置：
{{USEflag|package=kde-plasma/plasma-meta|desc=}}
</div>

{{Emerge|kde-plasma/plasma-meta}}

<div class="mw-translate-fuzzy">
你也可以选择通过安装 {{Package|kde-plasma/plasma-desktop}} 获得一个基本的桌面环境，让你用户自己安装需要的软件：
</div>

{{Emerge|kde-plasma/plasma-desktop}}

{{Note/zh-cn|请注意这样的安装方式会导致一些重要的包缺失，比如 {{Package|kde-plasma/powerdevil}} （电源管理，睡眠和休眠选项）和 {{Package|kde-plasma/systemsettings}} ，如果你用了上面这种方式请手动安装这两个软件包。}}

By default the classic tree view of {{package|kde-plasma/systemsettings}} is not enabled. The following USE flag will enable it:
{{FileBox|filename=/etc/portage/package.use/systemsettings|title=Enable classic tree view|lang=bash|1=
kde-plasma/systemsettings classic
}}

Recompile systemsettings with new USE flags:
{{emerge|--changed-use kde-plasma/systemsettings}}

==== 小工具 ====

{{Package|kde-plasma/kdeplasma-addons}} 提供了很多有用的小工具 (早就被 {{package|kde-plasma/plasma-meta}}作为依赖安装了)：

{{Emerge|kde-plasma/kdeplasma-addons}}

==== 显示管理器 ====

[[SDDM]] （Simple Desktop Display Manager） 是被推荐的登录管理器并且它默认会通过 {{package|kde-plasma/plasma-meta}} 被自动安装。 另外你也可以选择使用 [[LightDM]] ,这需要为 {{package|kde-plasma/plasma-meta}} 设置 <code>-sddm</code> 的 USE 旗标， 同时还要修改 {{Path| /etc/conf.d/xdm}} 中的设置。 同时在发生错误时请阅读 [[SDDM]] 页面。

[[SDDM]] does not yet support [[Multiseat|multiseat]], while [[LightDM]] does.

==== No display manager ====

Plasma can be started the old-fashioned way with {{c|startx}}, but extra care needs to be taken to ensure it gets a valid session. The following solution is limited to [[ConsoleKit]]:

{{FileBox|filename=~/.xinitrc|lang=bash|1=
#!/bin/sh
exec ck-launch-session dbus-launch --sh-syntax --exit-with-session startkde
}}

=== System tray ===

Plasma 5 uses the StatusNotifier specification for systray icons <ref>http://blog.martin-graesslin.com/blog/2014/03/system-tray-in-plasma-next/</ref>. As not all applications have been ported to the new system, some workarounds exist <ref>http://blog.martin-graesslin.com/blog/2014/06/where-are-my-systray-icons/</ref>, and Plasma 5 has a means to convert old xembed-based system tray icons to StatusNotifier icons.

Legacy support is enabled by activating <code>legacy-systray</code> for {{package|kde-plasma/plasma-meta}}, which is pulling in {{package|kde-plasma/xembed-sni-proxy}}.

{{RootCmd|echo "kde-plasma/plasma-meta legacy-systray" >> /etc/portage/package.use/plasma-systray}}

==== Pidgin ====

{{Package|net-im/pidgin}} requires {{Package|x11-plugins/pidgin-indicator}}. After install, the ''Ubuntu Indicator'' plugin can be found under ''Tools | Plugins''.

=== KWallet ===

<div class="mw-translate-fuzzy">
许多用户被推荐使用 {{Package|kde-frameworks/kwallet}}， Plasma桌面的密码管理器， 再你登录桌面后连接（无线）网络。 在现在的很多发行版上还有第二个KWallet服务 - {{Package|kde-apps/kwalletd}} 为基于kdelibs4的程序提供相同的储存密码功能。 {{Package|kde-plasma/kwallet-pam}} 提供了避免用户在登录后需要再次输入密码访问kwallet的功能。
</div>

<div class="mw-translate-fuzzy">
对于管理kwallet，导入或导出密码，这里有个{{Package|kde-apps/kwalletmanager}}：
</div>

{{Emerge|kde-apps/kwalletmanager}}

<div class="mw-translate-fuzzy">
=== KWallet 自动解锁 ===
</div>

{{Package|kde-plasma/kwallet-pam}} provides a mechanism to avoid being subsequently asked for access to kwallet after login.

{{Emerge|kde-plasma/kwallet-pam}}

需要如下的配置：
* 为了KWallet的安全性，请使用比较传统的blowfish加密，而不是GPG
* 在kwallet和用户使用相同的密码
* 让登录管理器支持PAM特性 - {{Package|x11-misc/sddm}} 和 {{Package|x11-misc/lightdm}} 都支持

<div class="mw-translate-fuzzy">
{{FileBox|filename=/etc/pam.d/sddm|title=Adding lines for KWallet PAM unlocking via SDDM|lang=bash|1=
-auth           optional        pam_kwallet5.so
-session        optional        pam_kwallet5.so auto_start
# 下面两行也会解锁基于kdelibs4的程序
-auth           optional        pam_kwallet.so kdehome=.kde4
-session        optional        pam_kwallet.so
}}
</div>

<div class="mw-translate-fuzzy">
{{Note|对于LightDM， 需要自己编辑{{Path|/etc/pam.d/lightdm}} }}
</div>

==== Disabling KWallet ====

To disable the KWallet subsystem completely, edit the following file:

{{FileBox|filename=~/.config/kwalletrc|lang=bash|1=
[Wallet]
Enabled=false
}}

=== SSH/GPG 密钥启动/关闭脚本 ===

ssh-agent 脚本位于 {{Path|/etc/plasma/startup}} 与 {{Path|/etc/plasma/shutdown}}。[[Keychain]] 提供了更多信息

=== Run GUI applications with root privileges ===

{{Warning|It could be a ''very'' bad idea to start GUI applications with root privileges, versus adding the regular user to the relevant group or simply just running the command unprivileged. Only use {{c|kdesu}} when absolutely necessary.}}

KDE Plasma has a utility in order to start graphical programs with root privileges. It is provided by {{Package|kde-plasma/kde-cli-tools}} - if built with USE flag <code>kdesu</code>, a graphical frontend to {{Package|kde-frameworks/kdesu}} is installed, which can be used by invoking {{c|kdesu}}. This can be done either from KRunner or a terminal emulator:

{{Cmd|kdesu <program-name>}}

A message dialog will be displayed prompting for the root password.

{{Note|Some applications such as kwrite, dolphin etc. refuse to be opened with {{c|kdesu}} for security reasons.}}

=== 应用程序（Applications） ===

<div class="mw-translate-fuzzy">
与很多基于 Qt 5/KDE Frameworks 5 和/或 基于 Qt 4/KDElibs 4 的应用程序和支持库一起发布（而后者依旧处于长期服务模式）。在Portage 树当中，使用slots <code>4</code> 和 <code>5</code> 来区分。 上游正在进行从 KDE 4 到 5 的迁移，这可以从每次主要版本更新当中看出。这之中即有已经成熟的 Plasma 5 程序，也有新迁移过来的程序。注意，这同时意味着大版本更新时可能会造成依赖的冲突。当两个不同的软件包依赖于 slot 4 和 5 的相同库的时候将无法被安装:无法同时安装的相同库 - 此类包从* -meta中删除。
</div>

=== 可用版本 ===

{| {{{!}} class{{=}}"table table-striped table-condensed"
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | KDE
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Gentoo
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Ebuild repository
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Status
|-
| KDE Applications 18.08.3
| kde-apps/kde-apps-meta-18.08.3
| gentoo
| Stable for {{Keyword|amd64}} and {{Keyword|x86}}
|-
| KDE Applications 18.12.0
| kde-apps/kde-apps-meta-18.12.0
| gentoo
| Testing for {{Keyword|amd64}} and {{Keyword|x86}}
|-
| KDE Applications 18.12 stable branch
| kde-apps/kde-apps-meta-18.12.49.9999
| [[KDE/Ebuild repository|KDE]]
| Live version
|-
| KDE Applications master branch
| kde-apps/kde-apps-meta-9999
| [[KDE/Ebuild repository|KDE]]
| Live version
|}

KDE Applications这个包会安装以下包：

<div class="mw-translate-fuzzy">
{| {{{!}} class{{=}}"table table-striped table-condensed"
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Package name
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Description
|-
|-
| {{Package|kde-apps/kdeaccessibility-meta}}
| “无障碍”程序和工具。
|-
| {{Package|kde-apps/kdeadmin-meta}}
| 管理工具，用以管理系统。
|-
| {{Package|kde-apps/kdecore-meta}}
| 大部分基本的软件。
|-
| {{Package|kde-apps/kdeedu-meta}}
| 教育用程序和游戏。
|-
| {{Package|kde-apps/kdegames-meta}}
| 基本的桌面游戏
|-
| {{Package|kde-apps/kdegraphics-meta}}
| 图形方面的程序，例如图片查看器，取色器等等。
| {{Package|kde-apps/kdemultimedia-meta}}
| 多媒体程序和服务。
|-
| {{Package|kde-apps/kdenetwork-meta}}
| 网络相关的程序和 VNC 服务。
|-
| {{Package|kde-apps/kdepim-meta}}
| 个人信息管理程序比如电子邮件客户端，组织，通讯录等等。
|-
| {{Package|kde-apps/kdesdk-meta}}
| 一些开发工具
|-
| {{Package|kde-apps/kdeutils-meta}}
| 基本的桌面程序，比如归档管理器，计算器等等。
|-
| {{Package|kde-apps/kdewebdev-meta}}
| 网络开发工具。
|}
</div>

=== 安装 ===

{{Package|kde-apps/kde-apps-meta}} 包提供完整的应用程序集合,但是可替代地，可以挑选来自上述列表的一个或多个较小的元包：

{{Emerge| kde-apps/kde-apps-meta}}

== 本地化 ==

Plasma-5 and Applications are shipping their [[localization]] per-package. Enable your localization in systemsettings.

=== KDE PIM ===

KDE PIM is a whole suite of applications to manage personal information including mail, calendar, contacts and more. It has several optional runtime dependencies to extend its functionality:

* Virus detection: {{Package|app-antivirus/clamav}}
* Spam filtering: {{Package|mail-filter/bogofilter}} or {{Package|mail-filter/spamassassin}}

== 框架（Frameworks） ==

<div class="mw-translate-fuzzy">
KDE Frameworks 5 是为KDE Plasma 5 和 KDE Applications 5 的运行库和软件框架的合集，但是可能会受到一些 Qt 程序的影响。
</div>

KDE 框架大部分是运行库，只提供少量的面对用户的功能。它不需要被手动安装 —— 需要的软件包会被作为别的软件包的依赖自动安装。

=== 可用版本 ===

{| {{{!}} class{{=}}"table table-striped table-condensed"
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | KDE
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Gentoo
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Ebuild repository
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Status
|-
| KDE Frameworks 5.52.0
| kde-frameworks/*-5.52.0
| gentoo
| Stable for {{Keyword|amd64}} and {{Keyword|x86}}, Testing for {{Keyword|arm}}
|-
| KDE Frameworks 5.53.0
| kde-frameworks/*-5.53.0
| gentoo
| Testing for {{Keyword|amd64}}, {{Keyword|arm}} and {{Keyword|x86}}
|-
| KDE Frameworks master branch
| kde-frameworks/*-9999
| [[KDE/Ebuild repository|KDE]]
| Live version
|}

== 更多KDE软件 ==

<div class="mw-translate-fuzzy">
最主要的 KDE 应用程序在 Porage 树的
[https://packages.gentoo.org/category/kde-apps kde-apps] 和[https://packages.gentoo.org/category/kde-misc kde-misc] 分类中。
</div>

== Troubleshooting ==

Refer to the [[KDE/Troubleshooting|Troubleshooting]] sub-article.

== 另请参阅 ==

<div class="mw-translate-fuzzy">
* [[KDE/Troubleshooting|KDE 疑难解答]] - 一篇额外的关于 KDE 的疑难解答的文章。
* [[KDE/Overlay|KDE Overlay]] - 介绍如何添加 Gentoo 的 KDE Overlay。
* [[KDE/Removal|KDE的删除和清理 ]] - 关于如何删除并清理 KDE 的一些介绍。
* [[Overlay:kde-sunset|kde-sunset overlay]] -对于已从主源中删除的旧KDE版本。
</div>

== 外部资源 ==

* [https://userbase.kde.org/  KDE 官方用户 wiki]
* [https://forum.kde.org/  KDE官方论坛]
* [https://store.kde.org/ KDE Store (themes, widgets, wallpapers, etc.)]

== References ==

<references />

[[Category:KDE]] [[Category:Desktop environment]]
