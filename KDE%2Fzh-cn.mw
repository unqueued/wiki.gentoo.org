<languages />


{{InfoBox stack
|{{InfoBox homepage|https://www.kde.org/|header=true}}
|{{InfoBox wikipedia}}
|{{InfoBox project|KDE}}
}}

'''KDE''' 是自由软件社区，提供的一组应用程序，包括流行的 Plasma 桌面环境。

Gentoo对KDE项目的支持非常好，包括对KDE Frameworks 5，Plasma 5和Applications 5的全面支持，以及其他各种各样基于KDE的软件。 

== 准备 ==

=== 配置 ===

选择一个适当的[[Profile (Portage)|Portage配置]]，尽管这不是必须的，但是我们仍建议这么做。因为这会设置一些全局或针对特定软件包的 USE 旗标来确保你能够获得顺畅的 KDE 使用体验。

为了选择适当的[[Profile (Portage)|Portage配置]]，首先需要列出有哪些可用的[[Profile (Portage)|Portage配置]]：

{{RootCmd|eselect profile list|output=<pre>
  [1]   default/linux/amd64/13.0
  [2]   default/linux/amd64/13.0/selinux
  [3]   default/linux/amd64/13.0/desktop
  [4]   default/linux/amd64/13.0/desktop/gnome
  [5]   default/linux/amd64/13.0/desktop/gnome/systemd
  [6]   default/linux/amd64/13.0/desktop/plasma
  [7]   default/linux/amd64/13.0/desktop/plasma/systemd
  ...
</pre>}}

然后选择正确的[[Profile (Portage)|Portage配置]]，把下面的命令中的<code>X</code>替换为合适的[[Profile (Portage)|Portage配置]]对应的数字：

{{RootCmd|eselect profile set X}}

 如果要使用 Plasma 5 桌面环境，请选择<code>desktop/plasma</code>  [[OpenRC]]或者 <code>desktop/plasma/systemd</code>  [[systemd/zh-cn]]。

=== 服务 ===

在安装 KDE 软件之前，建议先设置并启用几个别的服务。它们当中的一部分已经由 ''desktop/plasma'' 或 ''desktop'' 的 [[Profile (Portage)|Portage配置]]设定好了。这些服务是：
* [[D-Bus]]: 启用 D-Bus 信息总线系统（D-Bus message bus system）。
* [[polkit]]: 启用 polkit 框架以控制系统中的服务的权限。
* [[udev]]: 启用对 udev —— Linux 下的动态的、常驻后台的自动为设备命名的服务（dynamic and persistent device naming service） ——的支持。 
* [[udisks]]: 启用一些与存储相关的服务。

根据上面的链接中的信息来了解如何设置并启用那些服务。注意：别的 USE 旗标组合从技术上可能是可以让它们运行的，但是可能会出现不支持，或者是带来不可预期的功能缺失（特别是如果选择的 USE 旗标是与完整的 KDE plasma 桌面环境冲突的）。

===  X 服务 ===

阅读下列来自 [[X server]] 的介绍来设置 X 环境。

== Plasma ==

Plasma 5 是 KDE 正在发展的一代桌面环境，基于 Qt 5 和 KDE Framework 5 。

=== 可用版本 ===

{| {{{!}} class{{=}}"table table-striped table-condensed"
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | KDE
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Gentoo
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Repository
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Status
|-
| KDE Plasma 5.8.5 LTS
| kde-plasma/plasma-meta-5.8.5
| gentoo
| Stable for {{Keyword|amd64}} and {{Keyword|x86}}; Testing for {{Keyword|arm}}
|-
| KDE Plasma 5.8.6 LTS
| kde-plasma/plasma-meta-5.8.6
| gentoo
| Testing for {{Keyword|amd64}}, {{Keyword|arm}} and {{Keyword|x86}}
|-
| KDE Plasma 5.8 stable branch
| kde-plasma/plasma-meta-5.8.49.9999
| [[KDE/Overlay|kde overlay]]
| Live version
|-
| KDE Plasma 5.9.3
| kde-plasma/plasma-meta-5.9.3
| gentoo
| Testing for {{Keyword|amd64}}, {{Keyword|arm}} and {{Keyword|x86}}
|-
| KDE Plasma 5.9 stable branch
| kde-plasma/plasma-meta-5.9.49.9999
| [[KDE/Overlay|kde overlay]]
| Live version
|-
| KDE Plasma master branch
| kde-plasma/plasma-meta-9999
| [[KDE/Overlay|kde overlay]]
| Live version
|}

{{Note/zh-cn|在继续安装之前，请确保选择了一个 Plasma 的[[Profile (Portage)|Portage配置]]。 KDE 4 用户则需要一些额外的步骤。}}

==== 从 KDE 4 升级 ====

能在这个 [[KDE/Plasma_5_upgrade|升级页面]] 找到有关如何从 plasma 4 升级， 迁移和疑难解答的信息。

==== 安装 ====

 {{Package|kde-plasma/plasma-meta}} 包提供完整的 Plasma 5 套件，由以下 USE 旗标配置：
{{USEflag|package=kde-plasma/plasma-meta|desc=}}

{{Emerge|kde-plasma/plasma-meta}}

你也可以选择通过安装 {{Package|kde-plasma/plasma-desktop}} 获得一个基本的桌面环境，让你用户自己安装需要的软件：

{{Emerge|kde-plasma/plasma-desktop}}

{{Note/zh-cn|请注意这样的安装方式会导致一些重要的包缺失，比如 {{Package|kde-plasma/powerdevil}} （电源管理，睡眠和休眠选项）和 {{Package|kde-plasma/systemsettings}} ，如果你用了上面这种方式请手动安装这两个软件包。}}

==== 小工具 ====

{{Package|kde-plasma/kdeplasma-addons}} 提供了很多有用的小工具 (早就被 {{package|kde-plasma/plasma-meta}}作为依赖安装了)：

{{Emerge|kde-plasma/kdeplasma-addons}}

==== 显示管理器 ====

[[SDDM]] （Simple Desktop Display Manager） 是被推荐的登录管理器并且它默认会通过 {{package|kde-plasma/plasma-meta}} 被自动安装。 另外你也可以选择使用 [[LightDM]] ,这需要为 {{package|kde-plasma/plasma-meta}} 设置 <code>-sddm</code> 的 USE 旗标， 同时还要修改 {{Path| /etc/conf.d/xdm}} 中的设置。 同时在发生错误时请阅读 [[SDDM]] 页面。

=== KWallet 自动解锁 ===

许多用户被推荐使用 {{Package|kde-frameworks/kwallet}}， Plasma桌面的密码管理器， 再你登录桌面后连接（无线）网络。 在现在的很多发行版上还有第二个KWallet服务 - {{Package|kde-apps/kwalletd}} 为基于kdelibs4的程序提供相同的储存密码功能。 {{Package|kde-plasma/kwallet-pam}} 提供了避免用户在登录后需要再次输入密码访问kwallet的功能。

{{Emerge|kde-plasma/kwallet-pam}}

需要如下的配置：
* 为了KWallet的安全性，请使用比较传统的blowfish加密，而不是GPG
* 在kwallet和用户使用相同的密码
* 让登录管理器支持PAM特性 - {{Package|x11-misc/sddm}} 和 {{Package|x11-misc/lightdm}} 都支持

{{FileBox|filename=/etc/pam.d/sddm|title=Adding lines for KWallet PAM unlocking via SDDM|lang=bash|1=
-auth           optional        pam_kwallet5.so
-session        optional        pam_kwallet5.so auto_start
# 下面两行也会解锁基于kdelibs4的程序
-auth           optional        pam_kwallet.so kdehome=.kde4
-session        optional        pam_kwallet.so
}}

{{Note|对于LightDM， 需要自己编辑{{Path|/etc/pam.d/lightdm}} }}

对于管理kwallet，导入或导出密码，这里有个{{Package|kde-apps/kwalletmanager}}：

{{Emerge|kde-apps/kwalletmanager}}

用于管理基于kdelibs4的程序，比如 kopete 和 kmail4：

{{Emerge|kde-apps/kwalletmanager:4}}

=== SSH/GPG 密钥启动/关闭脚本 ===

ssh-agent scripts are located in {{Path|/etc/plasma/startup}} and {{Path|/etc/plasma/shutdown}}. The [[Keychain]] article provides more information about this.

=== 应用程序（Applications） ===

与很多基于 Qt 5/KDE Frameworks 5 和/或 基于 Qt 4/KDElibs 4 的应用程序和支持库一起发布（而后者依旧处于长期服务模式）。在Portage 树当中，使用slots <code>4</code> 和 <code>5</code> 来区分。 上游正在进行从 KDE 4 到 5 的迁移，这可以从每次主要版本更新当中看出。这之中即有已经成熟的 Plasma 5 程序，也有新迁移过来的程序。注意，这同时意味着大版本更新时可能会造成依赖的冲突。当两个不同的软件包依赖于 slot 4 和 5 的相同库的时候将无法被安装:无法同时安装的相同库 - 此类包从* -meta中删除。

=== 可用版本 ===

{| {{{!}} class{{=}}"table table-striped table-condensed"
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | KDE
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Gentoo
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Repository
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Status
|-
| KDE Applications 16.08.3
| kde-apps/kde-apps-meta-16.08.3
| gentoo
| Stable for {{Keyword|amd64}} and {{Keyword|x86}}
|-
| KDE Applications 16.12.2
| kde-apps/kde-apps-meta-16.12.2
| gentoo
| Testing for {{Keyword|amd64}} and {{Keyword|x86}}
|-
| KDE Applications 16.12 stable branch
| kde-apps/kde-apps-meta-16.12.49.9999
| [[KDE/Overlay|kde overlay]]
| Live version
|-
| KDE Applications master branch
| kde-apps/kde-apps-meta-9999
| [[KDE/Overlay|kde overlay]]
| Live version
|}

KDE Applications这个包会安装以下包：

{| {{{!}} class{{=}}"table table-striped table-condensed"
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Package name
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Description
|-
| {{Package|kde-apps/kdeaccessibility-meta}}
| Accessibility applications and utilities.
|-
| {{Package|kde-apps/kdeadmin-meta}}
| Administrative utilities, which helps in managing the system.
|-
| {{Package|kde-apps/kdecore-meta}}
| Basic applications such as file browser, editor, terminal emulator.
|-
| {{Package|kde-apps/kdeedu-meta}}
| Educational applications and games.
|-
| {{Package|kde-apps/kdegames-meta}}
| Standard desktop games.
|-
| {{Package|kde-apps/kdegraphics-meta}}
| Graphics applications such as image viewers, color pickers, etc.
|-
| {{Package|kde-apps/kdemultimedia-meta}}
| Audio and video playback applications and services.
|-
| {{Package|kde-apps/kdenetwork-meta}}
| Network applications and VNC services.
|-
| {{Package|kde-apps/kdepim-meta}}
| PIM applications such as emailer, addressbook, organizer, etc.
|-
| {{Package|kde-apps/kdesdk-meta}}
| Various development tools.
|-
| {{Package|kde-apps/kdeutils-meta}}
| Standard desktop utilities such as a archiver, a calculator, etc.
|-
| {{Package|kde-apps/kdewebdev-meta}}
| Web development tools.
|}

=== 安装 ===

{{Package|kde-apps/kde-apps-meta}} 包提供完整的应用程序集合,但是可替代地，可以挑选来自上述列表的一个或多个较小的元包：

{{Emerge| kde-apps/kde-apps-meta}}

== 本地化 ==

While Frameworks and Plasma are shipping their translations per-package, [[localization]] of KDE Applications is provided via separate <code>*-l10n</code> packages. The <code>nls</code> USE flag is enabled by default for linux [[Profile_(Portage)|profiles]], and it is used by KDE Applications meta packages to pull in the necessary dependencies.

If only a select few languages are desired, define the <var>L10N</var> variable in {{Path|/etc/portage/make.conf}}. E.g. to use the German language, set:

{{FileBox|filename=/etc/portage/make.conf|title=Setting the <var>L10N</var> variable for the German language|lang=bash|1=
L10N="de"
}}

To '''manually''' install these localization packages instead, use the following (complete) list or pick as desired:

{{Emerge|kde-l10n kde4-l10n kdepim-l10n}}

While the first two contain translations for the majority of KDE Applications (slot <code>5</code> and <code>4</code>), the latter  directly corresponds to - and is only relevant to users of - {{Package|kde-apps/kdepim-meta}} or its related packages.

=== KDE PIM ===

=== 可用版本 ===

In Portage, three variants of the KDE Personal Information Management (KDE PIM) suite (including {{Package|kde-apps/kmail}}, {{Package|kde-apps/kontact}}, and {{Package|kde-apps/korganizer}}) are available.

{| {{{!}} class{{=}}"table table-striped table-condensed"
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | KDE
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Gentoo
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Repository
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Status
|-
| KDE PIM 4.4.2016.01
| kde-apps/kdepim-meta-4.4.2016.01
| gentoo
| Stable for {{Keyword|amd64}} and {{Keyword|x86}}
|-
| KDE PIM 4.14.11_pre20160211
| kde-apps/kdepim-meta-4.14.11_pre20160211
| gentoo
| Stable for {{Keyword|amd64}} and {{Keyword|x86}}
|-
| KDE PIM 16.12.2
| kde-apps/kdepim-meta-16.12.2
| gentoo
| Testing for {{Keyword|amd64}} and {{Keyword|x86}}
|}

==== KDE PIM 4.14.11 and earlier ====

At the time of writing, the current stable version range is at 4.14.11, which includes an Akonadi-based kmail (also known as kmail2) and is still based on Qt 4/KDElibs 4.

In addition, a "[https://launchpad.net/~pali/+archive/ubuntu/kdepim-noakonadi noakonadi fork]" is available as version 4.4.2016.01 (also known as kmail1). Adding a [https://gitweb.gentoo.org/proj/kde.git/plain/Documentation/package.mask/kdepim-4.7 mask file] to {{Path|/etc/portage/package.mask}} is necessary to get it:

{{RootCmd|wget https://gitweb.gentoo.org/proj/kde.git/plain/Documentation/package.mask/kdepim-4.7 -O /etc/portage/package.mask/kdepim-4.7}}

Both variants are beginning to conflict with newer versions of packages. Adding certain per-package USE flag settings can solve some conflicts currently:

{{FileBox|filename=/etc/portage/package.use/kdepim-4|lang=bash|1=
>=app-crypt/gpgme-1.8.0 -cxx -qt5
app-office/kmymoney:4 pim
>=kde-apps/kwalletd-16.04.3-r1 -gpg
>=kde-frameworks/kwallet-5.29.0-r1 -gpg
}}

{{Emerge|kde-apps/kdepim-meta}}

==== KDE PIM 16.12 and later ====

The latest upstream release based on Qt 5/KF 5 remains testing until it is deemed suitable for stable use, but testing is appreciated.
 
Most, but not all of the codebase has been ported from {{Package|dev-qt/qtwebkit}} to {{Package|dev-qt/qtwebengine}} which is based on Chromium's Blink. By default, this package sets and uses the <code>system-ffmpeg</code> USE flag, which comes down to a {{Package|media-video/ffmpeg}} package dependency, so users preferring {{Package|media-video/libav}} for the rest of their system will need to switch off that USE flag.

Unfortunately, not all of the KDE Applications are compatible yet, with some packages still depending on Qt 4/KDElibs 4 based parts that can not be installed with modern KDE PIM at the same time. That includes {{Package|kde-apps/kopete}}, {{Package|kde-apps/klinkstatus}}, and possibly other packages outside of the kde-apps category. By default, these packages are no longer installed by {{Package|kde-apps/kde-apps-meta}}.

The following commands will deselect any packages from world that would still depend on these conflicting packages:

{{RootCmd|equery -q d kde-apps/kdepim-common-libs &#124; sed -e "s/-[0-9].*//" &#124; xargs emerge --deselect
|equery -q d kde-apps/kdepimlibs &#124; sed -e "s/-[0-9].*//" &#124; xargs emerge --deselect
|equery -q d kde-apps/akonadi &#124; sed -e "s/-[0-9].*//" &#124; xargs emerge --deselect}}

{{Note|This requires {{Package|app-portage/gentoolkit}} to be installed. The [[Gentoolkit]] article provides more information about this useful utility.}}

Some conflicts with older packages may be solved by adding per-package USE flag settings:

{{FileBox|filename=/etc/portage/package.use/kdepim-16.12|lang=bash|1=
app-accessibility/simon -pim
app-office/calligra:4 -pim
kde-apps/kget:4 -gpg
<=kde-apps/kwalletd-16.04.3:4 -gpg
kde-apps/pykde4 -akonadi
kde-misc/tellico:4 -addressbook
}}

With all that prepared, KDE PIM is ready to be installed:

{{Emerge|kde-apps/kdepim-meta}}

=== kdesu5 ===

该工具由 {{Package|kde-plasma/kde-cli-tools}} 提供，用于以 {{c|root}} 身份运行 GUI 程序。如果安装时启用了 <code>kdesu</code> 这个 USE 旗标，一个 {{Package|kde-frameworks/kdesu}} 的图形前端会被安装，你可以通过执行 {{c|kdesu5}} 来使用它。

请务必确保那条命令'''真的'''需要以 {{c|root}} 身份执行，而不是只需要添加普通用户到相关的用户组或者不需要特权也能运行。

== 框架（Frameworks） ==

KDE Frameworks 5 是为KDE Plasma 5 和 KDE Applications 5 的运行库和软件框架的合集，但是可能会受到一些 Qt 程序的影响。

KDE 框架大部分是运行库，只提供少量的面对用户的功能。它不需要被手动安装 —— 需要的软件包会被作为别的软件包的依赖自动安装。

=== 可用版本 ===

{| {{{!}} class{{=}}"table table-striped table-condensed"
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | KDE
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Gentoo
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Repository
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Status
|-
| KDE Frameworks 5.29.0
| kde-frameworks/*-5.29.0
| gentoo
| Stable for {{Keyword|amd64}} and {{Keyword|x86}}; Testing for {{Keyword|arm}}
|-
| KDE Frameworks 5.31.0
| kde-frameworks/*-5.31.0
| gentoo
| Testing for {{Keyword|amd64}}, {{Keyword|arm}} and {{Keyword|x86}}
|-
| KDE Frameworks master branch
| kde-frameworks/*-9999
| [[KDE/Overlay|kde overlay]]
| Live version
|}

== 更多KDE软件 ==

最主要的 KDE 应用程序在 Porage 树的
[https://packages.gentoo.org/category/kde-apps kde-apps] 和[https://packages.gentoo.org/category/kde-misc kde-misc] 分类中。

== 另请参阅 ==

* [[KDE/Troubleshooting|KDE 疑难解答]] - 一篇额外的关于 KDE 的疑难解答的文章。
* [[KDE/Overlay|KDE Overlay]] - 介绍如何添加 Gentoo 的 KDE Overlay。
* [[KDE/Removal|KDE的删除和清理 ]] - 关于如何删除并清理 KDE 的一些介绍。
* [[Overlay:kde-sunset|kde-sunset overlay]] -对于已从主源中删除的旧KDE版本。

== 外部资源 ==

* [https://userbase.kde.org/  KDE 官方用户 wiki]
* [https://forum.kde.org/  KDE官方论坛]
* [https://store.kde.org/ KDE Store (themes, widgets, wallpapers, etc.)]

[[Category:KDE]] [[Category:Desktop environment]]
