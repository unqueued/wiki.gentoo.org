<languages />
{{InfoBox stack
|{{InfoBox wikipedia|Java_(programming_language)|header=true}}
|{{InfoBox gdoc|Java}}
}}
{{Metadata|abstract=Это руководство знакомит читателя с Java и объясняется, как использовать Java в Gentoo Linux.}}
Это руководство знакомит читателя с Java и объясняется, как использовать Java в Gentoo Linux.

== Что такое Java? ==

=== Общий обзор ===

Java — это язык программирования, разрабатываемый инженерами Sun Microsystems. Язык является объектно-ориентированным и предназначен для запуска на различных платформах без необходимости перекомпиляции кода для каждой платформы. Хотя программа на Java и может быть скомпилирована в нативный код, изрядную долю популярности языку принесла портируемость, а также некоторые другие возможности, такие как сборка мусора. Чтобы сделать независимость от платформы возможной, компилятор Java компилирует Java-код в промежуточное представление, называемое «байт-кодом Java» (Java bytecode), которое запускается в JRE (среде выполнения Java), а не непосредственно в операционной системе. 

Для запуска байт-кода Java, необходимо наличие установленной JRE (Java Runtime Environment). JRE предоставляет доступ к основным библиотекам, зависящей от платформы виртуальной машине Java, плагинам для браузеров и другим вещам. JDK (Java Development Kit) добавляет программные инструменты, такие как компилятор в байт-код и отладчик. 

== Установка виртуальной машины ==

=== Выбор ===

Gentoo предоставляет различные (среды выполнения) Java Runtime Environments (JRE) и (пакеты средств для разработчиков) Java Development Kits (JDK). В числе текущих вариантов, имеются: 

{| class="table table-condensed table-striped" style="text-align: left;" 
|- 
! Vendor
! JDK
! JRE
|- 
| The IcedTea Open Java SE (ранее icedtea6-bin)
| {{Package|dev-java/icedtea}} и {{Package|dev-java/icedtea-bin}}
| 
|- 
| Oracle's Java 7 SE
| {{Package|dev-java/oracle-jdk-bin}}
| {{Package|dev-java/oracle-jre-bin}}
|- 
| The IBM Java SE
| {{Package|dev-java/ibm-jdk-bin}}
| {{Package|dev-java/ibm-jre-bin}}
|-
|}

=== Установка JRE/JDK ===

Для установки дефолтного '''JDK''' из профиля, запустите:

{{Emerge|virtual/jdk}}

Для установки дефолтного '''JRE''' из профиля, запустите

{{Emerge|virtual/jre}}

Некоторые JDK и JRE, включая пакеты Sun, требуют принятия пользовательского соглашения (End User License Agreement), или EULA. Если их лицензия (такая как dlj-1.1) не перечислена в переменной <var>ACCEPT_LICENSE</var> (в {{Path|/etc/portage/make.conf}}), в этом случае будет невозможно установить JDK/JRE. Чтобы получить больше информации о том, как добавить подходящие лицензии в {{Path|make.conf}}, пожалуйста, прочитайте [[Handbook:X86/Working/Portage/ru#Лицензии|главу лицензии]] настольной книги Portage. 

Чтобы избежать какой-либо суматохи с лицензионными ограничениями, рассмотрите установку icedtea-bin, который является открытой реализацией Java из проекта OpenJDK. 

{{Note|Имейте ввиду, что ''JDK'' также включает в себя ''JRE''; необязательно ставить JRE, если JDK уже был установлен.}}

=== Установка виртуальных машин с ограничениями на скачивание исходного кода ===

Some of the JDKs and JREs require a few extra steps in their configurations. Emerge the packages as normal. If additional steps are required the ebuilds will provide instruction for the user on where to go and what to download.

Download the indicated file(s) into {{Path|/usr/portage/distfiles}} Once the files are in the right directories, rerun the {{c|emerge}} command, at which point the JRE/JDK will be begin to install.

=== Setting up a headless JRE === 

Sometimes there is no need for a full JRE with all the capabilities of java. Using java on a server often does not require any GUI, graphical, sound or even printer related features. To install a simplified (sometimes also referred to as headless) JRE, a few USE flags need to be changed. 

{{FileBox|filename=/etc/portage/package.use|title=Требование изменение USE-флага|1=
virtual/jre headless-awt -alsa -cups
}}

Depending on the current Gentoo profile, this might already be the case. As usual, the USE flag settings that are applicable to a particular package can be checked by running {{c|emerge}} in pretend mode:

{{Cmd|emerge --pretend --verbose virtual/jre}}

== Настройка виртуальной машины java ==

=== Общий обзор ===

На Gentoo, возможна установка множества разных JDK и JRE без вызова конфликтов. 

Using the {{c|java-config}} tool with root privileges, a system-wide default java virtual machine (VM) can be set. Users can also use java-config to custom set their personal VM on a user-by-user basis. 

{{Note|Также, можете пользоваться командой {{c|eselect}} для изменения системной и пользовательской виртуальной машины. Обратитесь к {{c|eselect java-vm help}}.}}

=== Установка виртуальной машины по умолчанию ===

Запуск команды {{c|java-config}} с опцией <code>--list-available-vms</code> выведет список всех JRE и JDK, установленных в системе. Ниже приведен пример работы команды: 

{{RootCmd|java-config --list-available-vms|output=<pre>
The following VMs are available for generation-2:
1)      IcedTea JDK 7.2.6.3 [icedtea-7]
*)      IcedTea JDK 3.0.1 [icedtea-8]
</pre>
}}

{{Note|VMs marked as 'Build Only' may contain security vulnerabilities and/or be end of life (EOL). Gentoo recommends not setting these VMs as the system's ''or'' the user's VM. Please see [[Java#Build_Only_VM|Build Only VM]] for more information.}}

The ''*'' indicates this is the current active JVM (system-vm or user-vm when set). The name in the brackets ([]) is the handle or ID for that particular VM. The handle or the number to {{c|java-config --set-system-vm}} can be used to set the VM. The following text provides an example of how to set the system VM.

Установка системной виртуальной машины с использованием имени (рекомендуемый способ):

{{RootCmd|java-config --set-system-vm sun-jdk-1.6|output=<pre>
Now using sun-jdk-1.6 as your generation-2 system JVM
</pre>}}

Alternate method: select VM by number handle number:

{{RootCmd|java-config --set-system-vm 3|output=<pre>
Now using sun-jdk-1.6 as your generation-2 system JVM
</pre>
}}

As a regular user, use java-config <code>--set-user-vm</code>. 

{{Note|{{c|source}}-ing the profile for existing shell sessions is not usually needed when changing the user or system VM. The only exception is that variables such as <var>JAVA_HOME</var> will still point to the old location after setting a user VM for the first time or revert back to the system VM.}}

=== Build only VM ===

Некоторые виртуальные машины отмечены как build-only, вследствие завершения жизненного цикла (EOL) и/или содержащихся уязвимостей. Эти виртуальные машины не выбираются системой автоматически с использованием Gentoo Launchers (скрипт, созданный для переключения виртуальных машин в Java), но все еще доступны для использования средой сборки Gentoo, так как некоторые пакеты могут потребовать их для сборки. Настройка такой виртуальной машины в качестве системной или пользовательской машины строго не рекомендуется, так как в таком случае она будет использоваться для запуска {{Path|/usr/bin/{java,javac,...}}}, а также ее будут использовать пакеты, не использующие стандартные скрипты Gentoo для запуска Java-приложений.

== Установка переменной CLASSPATH по умолчанию ==

{{Warning|The options explained in this section should be considered deprecated and will most likely be removed in the future. It is strongly recommended against using these, because Java projects or applications should ideally manage their own classpaths. When choosing to specify a default <var>CLASSPATH</var>, some applications may behave unexpectedly, because classes they were not expecting to be on the classpath.}}

{{c|java-config}} can also be used to set a system-wide default <var>CLASSPATH</var>, as well a user-specific default <var>CLASSPATH</var>. 

First, list available Java libraries installed on the system to possibly put in the <var>CLASSPATH</var> variable. Here is an example of output: 

{{RootCmd|java-config --list-available-packages|output=<pre>
[xerces-2] The next generation of high performance, fully compliant XML parsers in the Apache Xerces family (/usr/share/xerces-2/package.env)
[junit] Simple framework to write repeatable tests (/usr/share/junit/package.env)
[bsh] BeanShell: A small embeddable Java source interpreter (/usr/share/bsh/package.env)
[bcel] The Byte Code Engineering Library: analyze, create, manipulate Java class files (/usr/share/bcel/package.env)
[log4j] A low-overhead robust logging package for Java (/usr/share/log4j/package.env)
...
</pre>
}}

Again, the names in brackets ([]) are the IDs to pass to {{c|java-config --set-system-classpath}}. Here is an example: 


{{RootCmd|java-config --set-system-classpath log4j,xerces-2}}

{{Note/ru|Текущий каталог ({{Path|.}}) не будет являться частью системного параметра classpath, так как это должно быть добавлено в профиль входа в систему.}}

Update the environment by logging out, then in again or by typing {{c|source {{Path|/etc/profile}}}} 

For users, java-config --set-user-classpath will create {{Path|~/.gentoo/java-env-classpath}}, which should then source from the shell's profile. 

{{CodeBox|title=Запуск команд пользовательского файла classpath|1=
if [[ -f "${HOME}/.gentoo/java-env-classpath" ]]; then
       source ${HOME}/.gentoo/java-env-classpath
fi
}}

If desiring a system wide or user default classpath add something like the following to the shell's profile. This is advised against: 

{{RootCmd|export CLASSPATH{{=}}"${CLASSPATH}:$(java-config --classpath log4j,xerces-2)"}}

== Java-плагины браузера ==

The Java browser plugin used to be managed via {{c|eselect java-nsplugin}}. This has now been removed in favor of a simpler out-of-the-box experience. For basic usage, simply emerge the chosen JVM with the <code>nsplugin</code> USE flag enabled. Note that Oracle's plugin is only available for {{Keyword|amd64}} and {{Keyword|x86}}.

Also note that Chromium-based browsers no longer support NPAPI-based plugins since the code was removed in September 2015. The list of supporting browsers is shrinking but still includes Firefox as of version 46.

For more information, including JVM selection, Web Start, and multilib, see [https://gitweb.gentoo.org/repo/gentoo.git/plain/dev-java/icedtea-web/files/README.gentoo-r1 the README installed with icedtea-web].

== USE-флаги для использования с Java ==

=== Настройка USE-флагов ===

For more information regarding [[USE flag]]s, refer to the USE flags chapter from the [[Handbook:X86/Working/USE|Gentoo Handbook]].

=== USE-флаги ===

* The [https://packages.gentoo.org/useflags/java <code>java</code>] flag adds support for Java in a variety of programs;
* The [https://packages.gentoo.org/useflags/nsplugin <code>nsplugin</code>] flag adds support for Mozilla-like browsers (including Firefox). This is needed for viewing Java applets in a Mozilla-like browser;
* The [https://packages.gentoo.org/useflags/jce <code>jce</code>] flag adds support for the Java Cryptography Engine;

Following USE flags go in [[Gentoo_Java_USE_flags|JAVA_PKG_IUSE]].
* The [https://packages.gentoo.org/useflags/source <code>source</code>] flag installs a zip of the source code of a package. This is traditionally used for IDEs to 'attach' source to the libraries that are being use;
* For Java packages, the [https://packages.gentoo.org/useflags/doc <code>doc</code>] flag will build API documentation using javadoc.

== Смотрите также ==

* [[Project:Java/User_Guide|Java руководство пользователя]] на Java project

== Ссылки ==

* The [http://news.gmane.org/gmane.linux.gentoo.java gentoo-java], [http://news.gmane.org/gmane.linux.gentoo.user gentoo-user], and [http://news.gmane.org/gmane.linux.gentoo.devel gentoo-dev] mailing list archives
* {{IRC|gentoo}} and {{IRC|gentoo-java}} on IRC
* [https://forums.gentoo.org/viewtopic-t-901036.html Java 7 and bootstrapping icedtea] on the Gentoo forums

More information can be found offline:

* {{c|man java-config}}
* {{c|java-config --help}}

For suggestions or questions regarding this document, please email the Gentoo Java team: {{Mail|java@gentoo.org}}

[[Category:Programming_language]]

{{Migrated|originalauthors=Joshua Nichols, Karl Trygve Kalleberg, Joshua Saddler}}
