Installing Gentoo on the Asus Transformer Prime (TF201) 

May 2, 2012: This is an initial introduction to installing gentoo on the Asus Transformer Prime (TF201).  At the moment, I can get it to boot and launch X, but there are quite a few problems.  Hopefully, this site will invite others to share their own experiences, and maybe even generate some solutions to these problems.  -pjh

INSTRUCTIONS

The basic steps are as follows:

1) Create a decent gentoo system via chroot on the current machine.  (You can also do a cross-compile installation on some other box.)  You should use the armv7a stage3.  Special steps:
  a) Grab the ubuntu.img[1] and mount it.  Steal the following files:
   * /lib/firmware/prime*
   * /lib/firmware/atmel* (I'm not sure if these are necessary.)
   * /etc/X11/xorg.conf
   * /usr/share/X11/xorg.conf.d/*
   * /lib/modules/*
   * /usr/sbin/brcm_patchram_plus
   * (TODO: I should just post these somewhere.)
  b) Edit /etc/conf.d/modules and add: bcm4329 iface_name=wlan0
  c) Edit /etc/make.conf and add: FEATURES="-userfetch" (This is a gentoo-specific 'feature/bug'.)
  d) Add the x11 layman and emerge tegra-drivers
  e) Edit /etc/local.d/mine.start and add: chmod 0666 /dev/nv* /dev/tegra_* (I'm not sure if this is necessary)

2) Flash prime-sdlinux.blob[2] to the TFP using the 'fastboot' utility.  Once this is finished, you should be able to reboot the TFP and it'll show four penguins and load a kernel.  It'll, of course, bail because it is trying to mount your microsd card.

3) Somehow get your gentoo system onto a microsd card.  I used rsync to transfer the system to another box with that microsd card.  

4) Insert the microsd card into the TFP, reboot, and enjoy.

KNOWN BUGS

* Problem: Screen blanks and never comes back in console.
  Solution: There is none.  
  Work-around: In .bashrc or in your /etc/local.d/ add: "setterm -blank 0 -powerdown 0"

* Problem: After I launch X and I kill X, the screen is blank.
  Solution: There is none.  Make sure you have sshd installed.

* Problem: No mouse in X.
  Solution: There is none.

* Problem: No touch responsivity in X.
  Solution: There is none.
  Notes: This seems to work in Ubuntu, so I'm looking into stealing whatever evdev magic they use.  Also note that evtest detects touches.



[1] TODO: add url
[2} TODO: add url

Please contact peter period hartman at utoronto period ca a.k.a. wart_ in #gentoo-embedded (and elsewhere)
