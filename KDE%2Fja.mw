<languages />

{{InfoBox stack
|{{InfoBox homepage|https://www.kde.org/|header=true}}
|{{InfoBox wikipedia}}
|{{InfoBox project|KDE}}
}}

'''KDE'''とは、[[Article description::人気のPlasmaデスクトップ環境を含む、豊富なアプリケーションを開発しているフリーソフトウェアコミュニティです。]]

GentooのKDEサポートは、大量のKDEベースのソフトウェアの他にも、KDE Frameworks 5、Plasma 5、Applicationsと多岐に渡って非常に優れています。 

== 必要条件 ===

=== プロファイル ===

必ずしも必要ではありませんが、容易なインストールと快適なKDEの利用ために適切な[[Profile (Portage)|profile]]を選択することを推奨します。[[Profile (Portage)|profile]]が多数のグローバルまたはパッケージ特有のUSEフラグをセットしてくれるためです。

最も適したプロファイルを選択するには、まず利用可能なものをリストします。

{{RootCmd|eselect profile list|output=<pre>
  ...
  [12]  default/linux/amd64/17.0 (stable)
  [13]  default/linux/amd64/17.0/selinux (stable)
  [14]  default/linux/amd64/17.0/hardened (stable)
  [15]  default/linux/amd64/17.0/hardened/selinux (stable)
  [16]  default/linux/amd64/17.0/desktop (stable)
  [17]  default/linux/amd64/17.0/desktop/gnome (stable)
  [18]  default/linux/amd64/17.0/desktop/gnome/systemd (stable)
  [19]  default/linux/amd64/17.0/desktop/plasma (stable)
  [20]  default/linux/amd64/17.0/desktop/plasma/systemd (stable)
  ...
</pre>}}

それから、<code>X</code> を適切なプロファイル番号で置き換えて正しいプロファイルを選択します:

{{RootCmd|eselect profile set X}}

Plasma 5デスクトップ環境には、[[OpenRC]] なら <code>desktop/plasma</code>、[[systemd]] なら <code>desktop/plasma/systemd</code> を選んでください。プロファイルでセットされるもの以外の USE フラグの組み合わせも(特に KDE Plasma デスクトップ環境全体ではなくて選択したアプリケーションを実行する場合は)技術的には可能かもしれませんが、サポートされていなかったり、検証されていなかったり、あるいは予期しない機能喪失を引き起こすかもしれないことに注意してください。

=== サービス ===

これらのサービスは、先ほど選んだ [[Profile (Portage)|profile]] によるデフォルトのものが - 以下の章でのインストール作業で - 自動的に導入されますが、それでも KDE Plasma を初めて開始する前に正しくセットアップする必要があります。デフォルトから外れたい場合には KDE Plasma や KDE Applications に先立って <code>emerge&nbsp;&#8209;&#8209;oneshot</code> を使ってそれらをインストールし、[[Portage]] がそれらを考慮に入れることができるようにすることをお勧めします。これらのサービスをセットアップする方法については以下のリンクをたどってください。

==== セッショントラッカー ====

これらのうち1つだけを選択します:

* [[elogind]]: systemd プロジェクトから抽出された、OpenRC やその他の init システムとともに使用するためのスタンドアローンの logind パッケージ。
* [[systemd]]: systemd の一部であるセッショントラッカーを使用します。systemd のユーザーは、ここではこの他のものに取り組む必要はありません。
* [[ConsoleKit|consolekit]]: ユーザー、ログインセッションおよび seat を定義、追跡するためのフレームワーク。これが {{Path|desktop/plasma}} プロファイルの現在のデフォルトです。

[[Wayland]] をサポートするには logind の実装が必要です。Gentoo は [[systemd]] への代替として [[elogind]] を提供しています。

==== デバイスマネージャー ====

これらのうち1つだけを選択します:

* [[eudev]]: よりよい互換性を得ることを目標としている、Gentoo による udev のフォーク。これが {{Path|desktop/plasma}} プロファイルの現在のデフォルトです。
* [[udev]]: udev による Linux の動的かつ一貫したデバイス命名のサポートを有功化します。
* [[systemd]]: systemd の一部であるデバイスマネージャーを使用します。systemd のユーザーは、ここではこの他のものに取り組む必要はありません。

==== その他 ====

* [[D-Bus]]: D-Bus メッセージバスシステムの使用を有効化します。
* [[polkit]]: システム全体のサービスへの権限を管理する polkit フレームワークを有功化します。
* [[udisks]]: ストレージ関係のいくつかのサービスのサポートを有効化します。

=== X サーバー ===

X 環境をセットアップするには [[X server]] の記事を読み、その手順に従ってください。

=== パッケージの衝突 ===

KDE Plasma や Applications には多くの依存関係があります。これらの依存関係のいくつかは選択されるパッケージをあらかじめ決定しますが、それ以外では複数の選択肢があります。

* [[FFmpeg]]: デフォルトでは {{Package|dev-qt/qtwebengine}} の <code>system-ffmpeg</code> USE フラグが有効化されており、{{Package|media-video/ffmpeg}} に依存するようになっています。システムの他の部分では {{Package|media-video/libav}} を使用したいユーザーはこのフラグをオフに切り替えてください。
* JPEG: 5.11.1以降、{{Package|dev-qt/qtwebengine}} は {{Package|media-libs/libjpeg-turbo}} に依存しています。いずれにせよ、Gentoo はデフォルトとしてこちらを {{Package|media-libs/jpeg}} よりもお勧めしています。

== Plasma ==

Plasma 5は現在の世代のKDEのデスクトップ環境で、Qt 5とKDE Framework 5に基づいています。

=== 入手可能なバージョン ===

{| {{{!}} class{{=}}"table table-striped table-condensed"
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | KDE
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Gentoo
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Ebuild repository
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Status
|-
| KDE Plasma 5.14.3
| kde-plasma/plasma-meta-5.14.3
| gentoo
| Stable for {{Keyword|amd64}} and {{Keyword|x86}}; Testing for {{Keyword|arm}} and {{Keyword|arm64}}
|-
| KDE Plasma 5.14.5
| kde-plasma/plasma-meta-5.14.5
| gentoo
| Testing for {{Keyword|amd64}}, {{Keyword|arm}}, {{Keyword|arm64}} and {{Keyword|x86}}
|-
| KDE Plasma master branch
| kde-plasma/plasma-meta-9999
| [[KDE/Ebuild repository|KDE]]
| Live version
|}

{{Note|続ける前に、Plasma プロファイルを選択していることを確認してください。}}

=== インストール ===

{{Package|kde-plasma/plasma-meta}} パッケージが完全な Plasma 5 デスクトップを提供しており、多数の USE フラグによって設定可能です:
{{USEflag|package=kde-plasma/plasma-meta|desc=}}

{{Emerge|kde-plasma/plasma-meta}}

代わりに、{{Package|kde-plasma/plasma-desktop}} はとても基本的なデスクトップを提供しており、ユーザーは必要な、あるいは自身が足りていないと気付いた機能の追加パッケージのみを自由にインストールすることができます:

{{Emerge|kde-plasma/plasma-desktop}}

{{Note|この代替インストールを使った場合、{{Package|kde-plasma/powerdevil}} (電源管理、サスペンドやハイバネートのオプション) や {{Package|kde-plasma/systemsettings}} といった重要なパッケージを欠いているかもしれないことに注意してください。}}

デフォルトでは {{package|kde-plasma/systemsettings}} のクラシックツリービューは有効化されていません。以下の USE フラグで有効化できます:
{{FileBox|filename=/etc/portage/package.use/systemsettings|title=クラシックツリービューを有功にする|lang=bash|1=
kde-plasma/systemsettings classic
}}

新しい USE フラグで systemsettings を再コンパイルします:
{{emerge|--changed-use kde-plasma/systemsettings}}

=== ウィジェット ===

Many useful widgets are in the {{Package|kde-plasma/kdeplasma-addons}} package (already pulled in by {{package|kde-plasma/plasma-meta}}):

{{Emerge|kde-plasma/kdeplasma-addons}}

=== Display manager ===

[[SDDM]] (Simple Desktop Display Manager) is the recommended login manager and is pulled in automatically via {{package|kde-plasma/plasma-meta}} by default. This is the preferred option. Alternatively, [[LightDM]] can be used and pulled in by setting USE flag <code>-sddm</code> for {{package|kde-plasma/plasma-meta}}. Change the setting accordingly in {{Path| /etc/conf.d/xdm}}. Also, be sure to read through the [[SDDM]] page if further issues appear.

[[SDDM]] does not yet support [[Multiseat|multiseat]], while [[LightDM]] does.

==== No display manager ====

Plasma can be started the old-fashioned way with {{c|startx}}, but extra care needs to be taken to ensure it gets a valid session. The following solution is limited to [[ConsoleKit]]:

{{FileBox|filename=~/.xinitrc|lang=bash|1=
#!/bin/sh
exec ck-launch-session dbus-launch --sh-syntax --exit-with-session startkde
}}

=== System tray ===

Plasma 5 uses the StatusNotifier specification for systray icons <ref>http://blog.martin-graesslin.com/blog/2014/03/system-tray-in-plasma-next/</ref>. As not all applications have been ported to the new system, some workarounds exist <ref>http://blog.martin-graesslin.com/blog/2014/06/where-are-my-systray-icons/</ref>, and Plasma 5 has a means to convert old xembed-based system tray icons to StatusNotifier icons.

Legacy support is enabled by activating <code>legacy-systray</code> for {{package|kde-plasma/plasma-meta}}, which is pulling in {{package|kde-plasma/xembed-sni-proxy}}.

{{RootCmd|echo "kde-plasma/plasma-meta legacy-systray" >> /etc/portage/package.use/plasma-systray}}

==== Pidgin ====

{{Package|net-im/pidgin}} requires {{Package|x11-plugins/pidgin-indicator}}. After install, the ''Ubuntu Indicator'' plugin can be found under ''Tools | Plugins''.

=== KWallet ===

Many users will be introduced to {{Package|kde-frameworks/kwallet}}, Plasma's encrypted password storage, while adding a (wireless) network connection after login or adding E-Mail accounts in {{Package|kde-apps/kmail}}.

For managing KWallets, importing and exporting passwords, there is {{Package|kde-apps/kwalletmanager}}:

{{Emerge|kde-apps/kwalletmanager}}

==== KWallet auto-unlocking ====

{{Package|kde-plasma/kwallet-pam}} provides a mechanism to avoid being subsequently asked for access to kwallet after login.

{{Emerge|kde-plasma/kwallet-pam}}

It requires the following setup:
* For KWallet security, use classic blowfish encryption instead of GPG
* Choose same password for login and kwallet
* Configure a display manager with support for PAM - both {{Package|x11-misc/sddm}} and {{Package|x11-misc/lightdm}} fulfill that requirement:

{{FileBox|filename=/etc/pam.d/sddm|title=Config lines for KWallet PAM unlocking via SDDM|lang=bash|1=
-auth           optional        pam_kwallet5.so
-session        optional        pam_kwallet5.so auto_start
}}

{{Note|For LightDM, {{Path|/etc/pam.d/lightdm}} needs to be edited instead.}}
{{Note|If the filesystem containing your user's KWallet files is mounted by [[pam_mount]] upon logging on, you may need to copy {{Path|~/.local/share/kwalletd/kdewallet.salt}} to the same path on your root filesystem. Otherwise, PAM attempts to unlock KWallet before the home directory is available and fails. The file {{Path|~/.local/share/kwalletd/kdewallet.kwl}} which actually contains the encrypted KWallet passwords does not need to be copied.}}

==== Disabling KWallet ====

To disable the KWallet subsystem completely, edit the following file:

{{FileBox|filename=~/.config/kwalletrc|lang=bash|1=
[Wallet]
Enabled=false
}}

=== SSH/GPG Agent startup/shutdown scripts ===

ssh-agent scripts are located in {{Path|/etc/plasma/startup}} and {{Path|/etc/plasma/shutdown}}. The [[Keychain]] article provides more information about this.

=== Run GUI applications with root privileges ===

{{Warning|It could be a ''very'' bad idea to start GUI applications with root privileges, versus adding the regular user to the relevant group or simply just running the command unprivileged. Only use {{c|kdesu}} when absolutely necessary.}}

KDE Plasma has a utility in order to start graphical programs with root privileges. It is provided by {{Package|kde-plasma/kde-cli-tools}} - if built with USE flag <code>kdesu</code>, a graphical frontend to {{Package|kde-frameworks/kdesu}} is installed, which can be used by invoking {{c|kdesu}}. This can be done either from KRunner or a terminal emulator:

{{Cmd|kdesu <program-name>}}

A message dialog will be displayed prompting for the root password.

{{Note|Some applications such as kwrite, dolphin etc. refuse to be opened with {{c|kdesu}} for security reasons.}}

== Applications ==

Releases consist of various applications and supporting libraries based on Qt 5/KDE Frameworks 5.

=== 入手可能なバージョン ===

{| {{{!}} class{{=}}"table table-striped table-condensed"
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | KDE
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Gentoo
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Ebuild repository
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Status
|-
| KDE Applications 18.08.3
| kde-apps/kde-apps-meta-18.08.3
| gentoo
| Stable for {{Keyword|amd64}} and {{Keyword|x86}}
|-
| KDE Applications 18.12.1
| kde-apps/kde-apps-meta-18.12.1
| gentoo
| Testing for {{Keyword|amd64}} and {{Keyword|x86}}
|-
| KDE Applications 18.12 stable branch
| kde-apps/kde-apps-meta-18.12.49.9999
| [[KDE/Ebuild repository|KDE]]
| Live version
|-
| KDE Applications master branch
| kde-apps/kde-apps-meta-9999
| [[KDE/Ebuild repository|KDE]]
| Live version
|}

KDE Applications is divided in the following meta packages:

{| {{{!}} class{{=}}"table table-striped table-condensed"
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Package name
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Description
|-
| {{Package|kde-apps/kdeaccessibility-meta}}
| Accessibility applications and utilities.
|-
| {{Package|kde-apps/kdeadmin-meta}}
| Administrative utilities, which helps in managing the system.
|-
| {{Package|kde-apps/kdecore-meta}}
| Basic applications such as file browser, editor, terminal emulator.
|-
| {{Package|kde-apps/kdeedu-meta}}
| Educational applications and games.
|-
| {{Package|kde-apps/kdegames-meta}}
| Standard desktop games.
|-
| {{Package|kde-apps/kdegraphics-meta}}
| Graphics applications such as image viewers, color pickers, etc.
|-
| {{Package|kde-apps/kdemultimedia-meta}}
| Audio and video playback applications and services.
|-
| {{Package|kde-apps/kdenetwork-meta}}
| Network applications and VNC services.
|-
| {{Package|kde-apps/kdepim-meta}}
| PIM applications such as emailer, addressbook, organizer, etc.
|-
| {{Package|kde-apps/kdesdk-meta}}
| Various development tools.
|-
| {{Package|kde-apps/kdeutils-meta}}
| Standard desktop utilities such as a archiver, a calculator, etc.
|}

=== Installation ===

The {{Package|kde-apps/kde-apps-meta}} package provides the full Applications bundle, but alternatively, one or several smaller meta packages from the list above may be picked instead:

{{Emerge| kde-apps/kde-apps-meta}}

=== ローカライゼーション ===

Plasma-5 and Applications are shipping their [[localization]] per-package. Enable your localization in systemsettings.

=== KDE PIM ===

KDE PIM is a whole suite of applications to manage personal information including mail, calendar, contacts and more. It has several optional runtime dependencies to extend its functionality:

* Virus detection: {{Package|app-antivirus/clamav}}
* Spam filtering: {{Package|mail-filter/bogofilter}} or {{Package|mail-filter/spamassassin}}

== Frameworks ==

KDE Frameworks 5 is a collection of libraries and software frameworks that provide the foundation for KDE Plasma 5 and KDE Applications, but may be leveraged by any Qt application.

As Frameworks are mostly libraries and provide little user functionality, it's not necessary to install them manually - the required packages will be pulled in automatically as dependencies.

=== Available versions ===

{| {{{!}} class{{=}}"table table-striped table-condensed"
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | KDE
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Gentoo
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Ebuild repository
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Status
|-
| KDE Frameworks 5.52.0
| kde-frameworks/*-5.52.0
| gentoo
| Stable for {{Keyword|amd64}} and {{Keyword|x86}}, Testing for {{Keyword|arm}}
|-
| KDE Frameworks 5.54.0
| kde-frameworks/*-5.54.0
| gentoo
| Testing for {{Keyword|amd64}}, {{Keyword|arm}} and {{Keyword|x86}}
|-
| KDE Frameworks master branch
| kde-frameworks/*-9999
| [[KDE/Ebuild repository|KDE]]
| Live version
|}

== More KDE software ==

The most important KDE applications are in the Gentoo ebuild repository and many are located in the [https://packages.gentoo.org/category/kde-apps kde-apps] and [https://packages.gentoo.org/category/kde-misc kde-misc] categories.

== Troubleshooting ==

Refer to the [[KDE/Troubleshooting|Troubleshooting]] sub-article.

== 参考 ==

* [[KDE/Plasma_5_upgrade|Plasma 4 to 5 upgrade page]] - Information on how to upgrade from Plasma 4, migration and troubleshooting.
* {{See also|KDE/Ebuild repository}}
* [[Overlay:kde-sunset|kde-sunset ebuild repository]] - For old KDE software that has been removed from the main ebuild repository.

<div class="mw-translate-fuzzy">
== 外部の情報 ==
</div>

* [https://userbase.kde.org/ Official KDE user wiki]
* [https://forum.kde.org/ Official KDE forum]
* [https://store.kde.org/ KDE Store (themes, widgets, wallpapers, etc.)]

== References ==

<references />

[[Category:KDE]] [[Category:Desktop environment]]
