<languages />

{{InfoBox stack
|{{InfoBox homepage|https://www.kde.org/|header=true}}
|{{InfoBox wikipedia}}
|{{InfoBox project|KDE}}
}}

'''KDE'''とは、[[Article description::人気のPlasmaデスクトップ環境を含む、豊富なアプリケーションを開発しているフリーソフトウェアコミュニティです。]]

GentooのKDEサポートは、大量のKDEベースのソフトウェアの他にも、KDE Frameworks 5、Plasma 5、Applicationsと多岐に渡って非常に優れています。 

== 必要条件 ===

=== プロファイル ===

必ずしも必要ではありませんが、容易なインストールと快適なKDEの利用ために適切な[[Profile (Portage)|profile]]を選択することを推奨します。[[Profile (Portage)|profile]]が多数のグローバルまたはパッケージ特有のUSEフラグをセットしてくれるためです。

最も適したプロファイルを選択するには、まず利用可能なものをリストします。

{{RootCmd|eselect profile list|output=<pre>
  ...
  [12]  default/linux/amd64/17.0 (stable)
  [13]  default/linux/amd64/17.0/selinux (stable)
  [14]  default/linux/amd64/17.0/hardened (stable)
  [15]  default/linux/amd64/17.0/hardened/selinux (stable)
  [16]  default/linux/amd64/17.0/desktop (stable)
  [17]  default/linux/amd64/17.0/desktop/gnome (stable)
  [18]  default/linux/amd64/17.0/desktop/gnome/systemd (stable)
  [19]  default/linux/amd64/17.0/desktop/plasma (stable)
  [20]  default/linux/amd64/17.0/desktop/plasma/systemd (stable)
  ...
</pre>}}

それから、<code>X</code> を適切なプロファイル番号で置き換えて正しいプロファイルを選択します:

{{RootCmd|eselect profile set X}}

Plasma 5デスクトップ環境には、[[OpenRC]] なら <code>desktop/plasma</code>、[[systemd]] なら <code>desktop/plasma/systemd</code> を選んでください。プロファイルでセットされるもの以外の USE フラグの組み合わせも(特に KDE Plasma デスクトップ環境全体ではなくて選択したアプリケーションを実行する場合は)技術的には可能かもしれませんが、サポートされていなかったり、検証されていなかったり、あるいは予期しない機能喪失を引き起こすかもしれないことに注意してください。

=== サービス ===

これらのサービスは、先ほど選んだ [[Profile (Portage)|profile]] によるデフォルトのものが - 以下の章でのインストール作業で - 自動的に導入されますが、それでも KDE Plasma を初めて開始する前に正しくセットアップする必要があります。デフォルトから外れたい場合には KDE Plasma や KDE Applications に先立って <code>emerge&nbsp;&#8209;&#8209;oneshot</code> を使ってそれらをインストールし、[[Portage]] がそれらを考慮に入れることができるようにすることをお勧めします。これらのサービスをセットアップする方法については以下のリンクをたどってください。

==== セッショントラッカー ====

これらのうち1つだけを選択します:

* [[elogind]]: systemd プロジェクトから抽出された、OpenRC やその他の init システムとともに使用するためのスタンドアローンの logind パッケージ。
* [[systemd]]: systemd の一部であるセッショントラッカーを使用します。systemd のユーザーは、ここではこの他のものに取り組む必要はありません。
* [[ConsoleKit|consolekit]]: ユーザー、ログインセッションおよび seat を定義、追跡するためのフレームワーク。これが {{Path|desktop/plasma}} プロファイルの現在のデフォルトです。

[[Wayland]] をサポートするには logind の実装が必要です。Gentoo は [[systemd]] への代替として [[elogind]] を提供しています。

==== デバイスマネージャー ====

これらのうち1つだけを選択します:

* [[eudev]]: よりよい互換性を得ることを目標としている、Gentoo による udev のフォーク。これが {{Path|desktop/plasma}} プロファイルの現在のデフォルトです。
* [[udev]]: udev による Linux の動的かつ一貫したデバイス命名のサポートを有功化します。
* [[systemd]]: systemd の一部であるデバイスマネージャーを使用します。systemd のユーザーは、ここではこの他のものに取り組む必要はありません。

==== その他 ====

* [[D-Bus]]: D-Bus メッセージバスシステムの使用を有効化します。
* [[polkit]]: システム全体のサービスへの権限を管理する polkit フレームワークを有功化します。
* [[udisks]]: ストレージ関係のいくつかのサービスのサポートを有効化します。

=== X サーバー ===

X 環境をセットアップするには [[X server]] の記事を読み、その手順に従ってください。

=== パッケージの衝突 ===

KDE Plasma や Applications には多くの依存関係があります。これらの依存関係のいくつかは選択されるパッケージをあらかじめ決定しますが、それ以外では複数の選択肢があります。

* [[FFmpeg]]: デフォルトでは {{Package|dev-qt/qtwebengine}} の <code>system-ffmpeg</code> USE フラグが有効化されており、{{Package|media-video/ffmpeg}} に依存するようになっています。システムの他の部分では {{Package|media-video/libav}} を使用したいユーザーはこのフラグをオフに切り替えてください。
* JPEG: 5.11.1以降、{{Package|dev-qt/qtwebengine}} は {{Package|media-libs/libjpeg-turbo}} に依存しています。いずれにせよ、Gentoo はデフォルトとしてこちらを {{Package|media-libs/jpeg}} よりもお勧めしています。

== Plasma ==

Plasma 5は現在の世代のKDEのデスクトップ環境で、Qt 5とKDE Framework 5に基づいています。

=== 入手可能なバージョン ===

{| {{{!}} class{{=}}"table table-striped table-condensed"
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | KDE
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Gentoo
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Ebuild repository
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Status
|-
| KDE Plasma 5.14.3
| kde-plasma/plasma-meta-5.14.3
| gentoo
| Stable for {{Keyword|amd64}} and {{Keyword|x86}}; Testing for {{Keyword|arm}} and {{Keyword|arm64}}
|-
| KDE Plasma 5.14.5
| kde-plasma/plasma-meta-5.14.5
| gentoo
| Testing for {{Keyword|amd64}}, {{Keyword|arm}}, {{Keyword|arm64}} and {{Keyword|x86}}
|-
| KDE Plasma master branch
| kde-plasma/plasma-meta-9999
| [[KDE/Ebuild repository|KDE]]
| Live version
|}

{{Note|続ける前に、Plasma プロファイルを選択していることを確認してください。}}

=== インストール ===

{{Package|kde-plasma/plasma-meta}} パッケージが完全な Plasma 5 デスクトップを提供しており、多数の USE フラグによって設定可能です:
{{USEflag|package=kde-plasma/plasma-meta|desc=}}

{{Emerge|kde-plasma/plasma-meta}}

代わりに、{{Package|kde-plasma/plasma-desktop}} はとても基本的なデスクトップを提供しており、ユーザーは必要な、あるいは自身が足りていないと気付いた機能の追加パッケージのみを自由にインストールすることができます:

{{Emerge|kde-plasma/plasma-desktop}}

{{Note|この代替インストールを使った場合、{{Package|kde-plasma/powerdevil}} (電源管理、サスペンドやハイバネートのオプション) や {{Package|kde-plasma/systemsettings}} といった重要なパッケージを欠いているかもしれないことに注意してください。}}

デフォルトでは {{package|kde-plasma/systemsettings}} のクラシックツリービューは有効化されていません。以下の USE フラグで有効化できます:
{{FileBox|filename=/etc/portage/package.use/systemsettings|title=クラシックツリービューを有功にする|lang=bash|1=
kde-plasma/systemsettings classic
}}

新しい USE フラグで systemsettings を再コンパイルします:
{{emerge|--changed-use kde-plasma/systemsettings}}

=== ウィジェット ===

{{Package|kde-plasma/kdeplasma-addons}} パッケージ({{package|kde-plasma/plasma-meta}} によって既に導入済み)には多くの有用なウィジェットが含まれています:

{{Emerge|kde-plasma/kdeplasma-addons}}

=== ディスプレイマネージャー ===

[[SDDM]] (Simple Desktop Display Manager) がおすすめのログインマネージャーで、デフォルトで {{package|kde-plasma/plasma-meta}} を通じて自動的に導入されます。これが推奨のオプションです。代わりに、<code>-sddm</code> USE フラグを {{package|kde-plasma/plasma-meta}} に設定することで導入される [[LightDM]] を使用することもできます。選択に応じて適切に {{Path| /etc/conf.d/xdm}} の設定を変更してください。さらなる問題が起こった場合には [[SDDM]] のページを読んでください。

[[SDDM]] は [[Multiseat|multiseat]] をまだサポートしていませんが、[[LightDM]] はサポートしています。

==== ディスプレイマネージャーを使用しない ====

Plasma は {{c|startx}} を使った昔ながらの方法で開始することもできますが、有効なセッションを確実に得られるようにするために追加の手順を踏む必要があります。以下の解決策は [[ConsoleKit]] 限定です:

{{FileBox|filename=~/.xinitrc|lang=bash|1=
#!/bin/sh
exec ck-launch-session dbus-launch --sh-syntax --exit-with-session startkde
}}

=== システムトレイ ===

Plasma 5は systray アイコンについて StatusNotifier 仕様を使用しています <ref>http://blog.martin-graesslin.com/blog/2014/03/system-tray-in-plasma-next/</ref>。すべてのアプリケーションがこの新しいシステムに移植されているわけではないためいくつかの回避策 <ref>http://blog.martin-graesslin.com/blog/2014/06/where-are-my-systray-icons/</ref> があり、また Plasma 5は古い xembed ベースのシステムトレイアイコンを StatusNotifier のアイコンに変換する手段も持っています。

レガシーサポートは、{{package|kde-plasma/xembed-sni-proxy}} を導入する <code>legacy-systray</code> を {{package|kde-plasma/plasma-meta}} でセットすることで有効になります。

{{RootCmd|echo "kde-plasma/plasma-meta legacy-systray" >> /etc/portage/package.use/plasma-systray}}

==== Pidgin ====

{{Package|net-im/pidgin}} は {{Package|x11-plugins/pidgin-indicator}} を必要とします。インストールが終わると ''Ubuntu Indicator'' プラグインが ''Tools | Plugins'' に表示されます。

=== KWallet ===

多くのユーザーは、ログイン後に(無線)ネットワーク接続を追加する時や {{Package|kde-apps/kmail}} でEメールアカウントを追加する時に Plasma の暗号化されたパスワードストレージである {{Package|kde-frameworks/kwallet}} を紹介されるでしょう。

Kwallets の管理やパスワードのインポート、エクスポートが行える、{{Package|kde-apps/kwalletmanager}} があります:

{{Emerge|kde-apps/kwalletmanager}}

==== KWallet の自動アンロック ====

{{Package|kde-plasma/kwallet-pam}} はログインの後に続いて kwallet へのアクセスのためにパスワードを尋ねられないようにする仕組みを提供します。

{{Emerge|kde-plasma/kwallet-pam}}

以下のセットアップが必要です:
* Kwallet のセキュリティのため、GPG ではなく古典的な blowfish 暗号を使用する
* ログインと kwallet で同じパスワードを選ぶ
* ディスプレイマネージャーを PAM をサポートするように設定する - {{Package|x11-misc/sddm}} と {{Package|x11-misc/lightdm}} はどちらもこの要件を満たします:

{{FileBox|filename=/etc/pam.d/sddm|title=SDDM を通じた KWallet PAM アンロックの設定|lang=bash|1=
-auth           optional        pam_kwallet5.so
-session        optional        pam_kwallet5.so auto_start
}}

{{Note|LightDM では代わりに {{Path|/etc/pam.d/lightdm}} を編集する必要があります。}}
{{Note|ユーザーの KWallet ファイルを含むファイルシステムがログオンの際に [[pam_mount]] によってマウントされている場合、{{Path|~/.local/share/kwalletd/kdewallet.salt}} を root ファイルシステムの同じパスにコピーしておく必要があるでしょう。そうしないと、PAM はホームディレクトリーが利用可能になる前に KWallet をアンロックしようとして失敗します。暗号化された KWallet パスワードを実際に格納している {{Path|~/.local/share/kwalletd/kdewallet.kwl}} ファイルについてはコピーする必要はありません。}}

==== KWallet の無効化 ====

KWallet サブシステムを完全に無効化するには以下のファイルを編集します:

{{FileBox|filename=~/.config/kwalletrc|lang=bash|1=
[Wallet]
Enabled=false
}}

=== SSH/GPG エージェントの開始/終了スクリプト ===

ssh-agent のスクリプトは {{Path|/etc/plasma/startup}} と {{Path|/etc/plasma/shutdown}} に置かれています。これについては [[Keychain]] の記事により詳しい情報があります。

=== GUI アプリケーションを root 権限で実行する ===

{{Warning|通常ユーザーを関連グループに追加したりコマンドを単に特権なしで実行したりすることに比べて、GUI アプリケーションを root 権限で実行するのは''とても''悪い考えです。{{c|kdesu}} は絶対に必要な時にのみ使用するようにしてください。}}

KDE Plasma にはグラフィカルなプログラムを root 権限で開始するためのユーティリティーがあります。{{Package|kde-plasma/kde-cli-tools}} で提供されています - これを <code>kdesu</code> USE フラグとともにビルドすると {{Package|kde-frameworks/kdesu}} へのグラフィカルフロントエンドがインストールされ、{{c|kdesu}} を実行することで使用できます。これは KRunner と端末エミュレーターのどちらからでも行えます:

{{Cmd|kdesu <program-name>}}

root パスワードを尋ねるメッセージダイアログが表示されます。

{{Note|kwrite や dolphin などいくつかのアプリケーションは、セキュリティ上の理由から {{c|kdesu}} によって開かれるのを拒否します。}}

== Applications ==

各リリースは Qt 5/KDE Frameworks 5 に基づく様々なアプリケーションとサポートライブラリからなっています。

=== 入手可能なバージョン ===

{| {{{!}} class{{=}}"table table-striped table-condensed"
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | KDE
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Gentoo
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Ebuild repository
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Status
|-
| KDE Applications 18.08.3
| kde-apps/kde-apps-meta-18.08.3
| gentoo
| Stable for {{Keyword|amd64}} and {{Keyword|x86}}
|-
| KDE Applications 18.12.1
| kde-apps/kde-apps-meta-18.12.1
| gentoo
| Testing for {{Keyword|amd64}} and {{Keyword|x86}}
|-
| KDE Applications 18.12 stable branch
| kde-apps/kde-apps-meta-18.12.49.9999
| [[KDE/Ebuild repository|KDE]]
| Live version
|-
| KDE Applications master branch
| kde-apps/kde-apps-meta-9999
| [[KDE/Ebuild repository|KDE]]
| Live version
|}

KDE Applications は以下のメタパッケージに分かれています:

{| {{{!}} class{{=}}"table table-striped table-condensed"
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Package name
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Description
|-
| {{Package|kde-apps/kdeaccessibility-meta}}
| アクセシビリティアプリケーションおよびユーティリティー。
|-
| {{Package|kde-apps/kdeadmin-meta}}
| システムの管理に役立つ管理用ユーティリティー。
|-
| {{Package|kde-apps/kdecore-meta}}
| ファイルブラウザ、エディタ、端末エミュレーターなどの基本的なアプリケーション。
|-
| {{Package|kde-apps/kdeedu-meta}}
| 教育用アプリケーションとゲーム。
|-
| {{Package|kde-apps/kdegames-meta}}
| 標準的なデスクトップゲーム。
|-
| {{Package|kde-apps/kdegraphics-meta}}
| 画像ビューワー、カラーピッカーなどのグラフィックアプリケーション。
|-
| {{Package|kde-apps/kdemultimedia-meta}}
| オーディオおよびビデオの再生アプリケーション、サービス。
|-
| {{Package|kde-apps/kdenetwork-meta}}
| ネットワークアプリケーションや VNC サービス。
|-
| {{Package|kde-apps/kdepim-meta}}
| メーラー、アドレス帳、予定管理などの PIM アプリケーション。
|-
| {{Package|kde-apps/kdesdk-meta}}
| さまざまな開発ツール。
|-
| {{Package|kde-apps/kdeutils-meta}}
| アーカイバー、電卓などの標準的なデスクトップユーティリティー。
|}

=== インストール ===

{{Package|kde-apps/kde-apps-meta}} パッケージが完全な Applications バンドルを提供しますが、代わりに上のリストから1つまたは複数のより小さなメタパッケージを選ぶこともできます:

{{Emerge| kde-apps/kde-apps-meta}}

=== ローカライゼーション ===

Plasma-5 や Applications はパッケージ毎に [[localization|ローカライゼーション]] を含んでいます。ローカライゼーションは systemsettings で有効にできます。

=== KDE PIM ===

KDE PIM はメール、カレンダー、連絡先その他を含む個人的な情報を管理するためのアプリケーションスイートです。これにはいくつかのオプションの実行時依存関係があり、機能を拡張することができます:

* ウイルス検出: {{Package|app-antivirus/clamav}}
* スパムフィルター: {{Package|mail-filter/bogofilter}} または {{Package|mail-filter/spamassassin}}

== Frameworks ==

KDE Frameworks 5は KDE Plasma 5や KDE Applications の基礎を提供するライブラリやソフトウェアフレームワークの集まりですが、どのような Qt アプリケーションからでも活用できます。

Frameworks はその大部分がライブラリーでありユーザー向けの機能をほとんど提供しないため、手動でインストールする必要はありません - 必要なパッケージは依存関係として自動的に導入されます。

=== 入手可能なバージョン ===

{| {{{!}} class{{=}}"table table-striped table-condensed"
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | KDE
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Gentoo
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Ebuild repository
! style{{=}}"background: #31206C; color: white; white-space: nowrap;" | Status
|-
| KDE Frameworks 5.52.0
| kde-frameworks/*-5.52.0
| gentoo
| Stable for {{Keyword|amd64}} and {{Keyword|x86}}, Testing for {{Keyword|arm}}
|-
| KDE Frameworks 5.54.0
| kde-frameworks/*-5.54.0
| gentoo
| Testing for {{Keyword|amd64}}, {{Keyword|arm}} and {{Keyword|x86}}
|-
| KDE Frameworks master branch
| kde-frameworks/*-9999
| [[KDE/Ebuild repository|KDE]]
| Live version
|}

== さらなる KDE ソフトウェア ==

The most important KDE applications are in the Gentoo ebuild repository and many are located in the [https://packages.gentoo.org/category/kde-apps kde-apps] and [https://packages.gentoo.org/category/kde-misc kde-misc] categories.

== Troubleshooting ==

Refer to the [[KDE/Troubleshooting|Troubleshooting]] sub-article.

== 参考 ==

* [[KDE/Plasma_5_upgrade|Plasma 4 to 5 upgrade page]] - Information on how to upgrade from Plasma 4, migration and troubleshooting.
* {{See also|KDE/Ebuild repository}}
* [[Overlay:kde-sunset|kde-sunset ebuild repository]] - For old KDE software that has been removed from the main ebuild repository.

<div class="mw-translate-fuzzy">
== 外部の情報 ==
</div>

* [https://userbase.kde.org/ Official KDE user wiki]
* [https://forum.kde.org/ Official KDE forum]
* [https://store.kde.org/ KDE Store (themes, widgets, wallpapers, etc.)]

== References ==

<references />

[[Category:KDE]] [[Category:Desktop environment]]
