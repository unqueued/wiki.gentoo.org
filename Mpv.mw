{{Lowercase title}}
{{InfoBox stack
|{{InfoBox homepage|https://mpv.io/|header=true}}
|{{InfoBox wikipedia|Mpv_(media_player)}}
|{{InfoBox github|mpv-player/mpv}}
|{{InfoBox odoc|https://mpv.io/manual/}}
}}
'''mpv''' is a free and open source command-line media player. It is based on mplayer2, which in turn is based on the original [[MPlayer]]. Many changes have been made, a large part of which is incompatible or completely changes how the player behaves. Although there are still many similarities to its ancestors, mpv should generally be treated as a completely different program.

== Installation ==

=== USE flags ===

Default USE configuration provides the following core features: CLI player, [[Xorg|X11]] support, audio and video playback, On-Screen Display (OSD) and On-Screen Controller (OSC), and [//en.wikipedia.org/wiki/Lua_(programming_language) Lua] scripting interface.

Hardware video decoding is often desired. mpv supports both [[VAAPI]] and [[VDPAU]] hardware decoding APIs via <code>vaapi</code> and <code>vdpau</code> USE flags respectively. You need to manually enable the API available on your system.

For a complete set of features please refer to the list of USE flags below.

{{USEflag|package=media-video/mpv}}

=== Emerge ===

{{Emerge|media-video/mpv}}

=== Additional software ===

Install {{Package|net-misc/youtube-dl}} to directly play URLs from YouTube and other popular streaming websites:

{{Emerge|net-misc/youtube-dl}}

Install {{Package|media-video/smplayer}} to get a GUI frontend:

{{Emerge|media-video/smplayer}}

== Configuration ==

mpv doesn't normally require any configuration after installation. However, almost all aspects of the default behaviour can be changed.
Two most important parts of the configuration are player settings and key bindings. Both are briefly discussed below.

=== Player settings ===

Player settings should be put into {{Path|~/.config/mpv/mpv.conf}} file using the INI syntax, i.e. <tt>option=value</tt>.
Everything after the {{c|#}} is considered a comment.

Most command line options can be player settings. The equivalent of <tt>--option=value</tt> command line argument is <tt>option=value</tt> setting, where {{c|value}} can contain suboptions or be a quoted string. Options that work without values can be enabled by setting them to {{c|yes}} and disabled by setting them to {{c|no}}.

To ease working with different configurations, profiles can be defined in the configuration file. A profile starts with its name in square brackets, e.g. {{c|[my-profile]}}. All following options will be a part of this profile. To end the profile, start another one or use the profile name {{c|default}} to continue with normal options.

For a complete list of available options please refer to [//mpv.io/manual/stable/#options the manual].

{{FileBox|title=Player settings example|filename=~/.config/mpv/mpv.conf|lang=ini|1=
# Always save the current playback position on exit
save-position-on-quit=yes
# Keep player open when end of playlist is reached
keep-open=yes

# Create 'high-quality' profile
[high-quality]
# Describe this profile
profile-desc="High quality rendering"
# Include all settings from default 'opengl-hq' profile
profile=opengl-hq
# Enable debanding for even better quality
deband=yes
}}

=== Key bindings ===

Key bindings should be put into {{Path|~/.config/mpv/input.conf}} file. The syntax is {{c|<key> <command>}}.
Everything after the {{c|#}} is considered a comment. To bind commands to the {{c|#}} key use {{c|SHARP}}.

For a complete list of available commands please refer to [//mpv.io/manual/stable/#list-of-input-commands the manual].

{{FileBox|title=Key bindings example|filename=~/.config/mpv/input.conf|lang=ini|1=
# Ctrl+q closes player
Ctrl+q quit
# Shift+d removes the currently played file from playlist
Shift+d playlist-remove current
# Shift+c toggles infinite looping of the currently played file
Shift+c cycle-values loop-file "inf" "no"
}}

=== Examples ===

Advanced real-world configurations from mpv contributors: [//github.com/pigoz/dotfiles/tree/master/mpv], [//github.com/Argon-/mpv-config].

== Usage ==

=== Lua scripts ===

Core mpv functionality can be extended with [//en.wikipedia.org/wiki/Lua_(programming_language) Lua] scripts. All scripts from {{Path|~/.config/mpv/scripts/}} directory are loaded automatically. Alternatively you can load a script manually via command line, e.g. <tt>--script=/path/to/your/script.lua</tt>.

Several Lua scripts are shipped with mpv and installed into {{Path|/usr/share/mpv/lua/}} directory.
Upstream wiki also has an extensive list of 3rd party scripts: [//github.com/mpv-player/mpv/wiki/User-Scripts].

== Troubleshooting ==

{{Important|If you have any problems, enable verbose logging via <code>-v</code> command line option.}}

=== Broken playback/crashes after updating FFmpeg/Libav/libass/etc. ===

'''TLDR''': report a Gentoo bug, then rebuild mpv.

FFmpeg/Libav/libass are all known to introduce from time to time incompatible, ABI-breaking changes between minor releases.
Usually SLOTs of these libraries remain the same between minor releases, i.e. an automatic mpv rebuild isn't triggered.
This causes problems with mpv compiled against previous versions of these libraries. These problems vary from broken pieces of functionality to sudden crashes.

Upstream's answer in such cases is similar to <nowiki>''it's not our problem that others can't maintain proper ABI-compatibility, rebuild mpv''</nowiki>. Please first report a Gentoo bug to notify maintainers about the existing breakage, then rebuild mpv.

=== 'mpv was compiled against a different version of FFmpeg...' message ===

If you don't have any problems with mpv, you can safely ignore this message. Otherwise, please follow  [[Mpv#Broken_playback.2Fcrashes_after_updating_FFmpeg.2FLibav.2Flibass.2Fetc.|these instructions]].

=== Broken hardware video decoding/high CPU usage ===

Sometimes mpv fails to enable hardware video decoding. Always consult mpv log for any problems regarding hardware decoding.

{{Note|High CPU usage during video playback is a symptom of a broken hardware decoding. Intel drivers are notoriously bad at this.}}

Firstly, make sure that your hardware supports the required video codec. The list of codecs supported by your GPU is available via <code>vainfo</code> and <code>vdpauinfo</code> commands for [[VAAPI]] and [[VDPAU]] decoding APIs respectively. The codec used in your video is available in mpv log.

Secondly, make sure that you have the latest non-live (not 9999) mpv version available in tree. If the update to the latest version solves your problem, please report a Gentoo bug.

Now there are several things you can try:
* Enable copy-back for your hardware decoder via <code>--hwdec=auto-copy</code> (not available on some GPUs).
* Intel GPUs only: use {{c|vaapi}} output via <code>--vo=vaapi</code> with <code>--hwdec=vaapi</code> or <code>--hwdec=vaapi-copy</code>.
* Intel GPUs only: use {{c|modesetting}} Xorg driver from {{Package|x11-base/xorg-server}}.
* Enable dumb-mode for {{c|opengl}} output via <code>--opengl-dumb-mode=yes</code>.
* Use {{c|xv}} output via <code>--vo=xv --hwdec=auto-copy</code>.

=== Tearing ===

[//en.wikipedia.org/wiki/Screen_tearing Tearing] is a video playback defect when displayed objects aren't properly lined up horizontally.
Please refer to [//github.com/mpv-player/mpv/wiki/FAQ#Tearing the upstream FAQ].

=== Feature X is broken/not available with Libav ===

Quote from upstream: <nowiki>''Libav is basically unsupported by mpv, except it still sort of compiles and many things work''</nowiki>[//github.com/mpv-player/mpv/issues/3923#issuecomment-268120303]. Patches are welcome for any issues regarding Libav.

== Update notes ==

Upstream maintains a list of user-visible changes: [//github.com/mpv-player/mpv/blob/master/DOCS/interface-changes.rst].
The most important ones are discussed below.

=== Volume in 0.18.1 ===

Since version 0.18.1 the software volume control is always enabled.
This means that volume controls don't change the system volume, e.g. per-application volume with [[PulseAudio]].

If you want to restore the previous behaviour, define the following [[Mpv#Key_bindings|key bindings]]:
{{FileBox|filename=~/.config/mpv/input.conf|lang=ini|1=
MOUSE_BTN5 add ao-volume -2
MOUSE_BTN6 add ao-volume +2
9 add ao-volume -2
0 add ao-volume +2
/ add ao-volume -2
* add ao-volume +2
m cycle ao-mute
VOLUME_DOWN add ao-volume -2
VOLUME_UP add ao-volume +2
MUTE cycle ao-mute
}}
{{Note|This only covers the default volume key bindings as of version 0.18.0.}}

=== OSC in 0.21.0 ===

Since version 0.21.0 the default OSC layout was changed to {{c|bottombar}}[//raw.githubusercontent.com/mpv-player/mpv.io/master/source/images/mpv-screenshot.jpg].

If you want to restore the previous layout, add the following OSC settings:
{{FileBox|filename=~/.config/mpv/lua-settings/osc.conf|lang=ini|1=
layout=box
seekbarstyle=slider
deadzonesize=0
minmousemove=3
}}

== See also ==

* [[MPlayer]] - A (older, once powerful) command-line media player.
* [[VLC]] - A media player capable of playing just about anything.

== External resources ==

* [//github.com/mpv-player/mpv/wiki mpv wiki]
* [//github.com/mpv-player/mpv/blob/master/DOCS/mplayer-changes.rst List of changes between mpv and mplayer]

[[Category:Multimedia]]
