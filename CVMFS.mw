{{InfoBox stack
|{{InfoBox homepage|http://cernvm.cern.ch/portal/filesystem|header=true}}
}}

CVMFS is a FUSE module which implements an HTTP read-only filesystem.

== Concepts ==

==CVMFS Server Setup ==
To get an cvmfs server system working you will need the following steps.

=== Kernel with aufs options enabled ===

The {{Package|sys-kernel/aufs-sources}} contains Linux Kernel with the aufs support module. First, you must install this package:

{{RootCmd|emerge -av sys-kernel/aufs-sources}}

Note that in order to use genkernel to generate Linux kernel and initramfs, you must:

{{RootCmd|cd /usr/src
| rm -fr linux
{{Note| linux is a symbol link to the real Linux source.}}
| ln -s linux-aufs-3.10 linux
| genkernel --menuconfig all}}

{{Kernel||<pre>
Device Drivers  --->
      [*] Network device support  --->
       <M>   MAC-VLAN support (EXPERIMENTAL)
       <M>   Virtual ethernet pair device
      Character devices  --->
       -*- Unix98 PTY support
       [*]   Support multiple instances of devpts
</pre>}}

=== Config Apache server ===

The cvmfs server utility will /srv/cvmfs as storage location. Therefore, the DocumentRoot should be config to the /srv.

Config '''/etc/apache2/vhosts.d/default_vhost.include'''

<pre>
DocumentRoot "/srv"

<Directory "/srv">
    ....
</Directory>
</pre>

{{RootCmd|/etc/init.d/apache2 restart}}

=== Create CVMFS repository ===
1. Build&&Install cvmfs

Download cvmfs code from github [https://github.com/cvmfs/cvmfs cvmfs].

The cvmfs build system uses cmake.  In order to compile and install, run from the source directory.

{{RootCmd| mkdir -p build
| cd build
| cmake ../
| make
| make install}}

2. Create the two directories and ensure adequate sapce.
* /cvmfs
* /srv

3. Create a new cvmfs server "file system" and repository structure:
{{RootCmd| cvmfs_server mkfs my.test.repo}}

If there is an error in creation, remove the repository:
{{RootCmd| cvmfs_server rmfs my.test.repo}}
