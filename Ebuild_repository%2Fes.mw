<languages />
{{InfoBox stack
|{{InfoBox project|Overlays|header=true}}
}}

Dentro de Gentoo Linux, los usuarios ya disponen de un [https://gitweb.gentoo.org/repo/gentoo.git/tree/ repositorio de paquetes "principal"]. El [https://gitweb.gentoo.org/repo/gentoo.git/tree/ repositorio principal] contiene todos los paquetes de software (llamados ebuilds) que mantienen los desarrolladores de Gentoo. Los árboles de paquetes adicionales se hospedan en ''repositories''. Los usuarios pueden añadir estos repositorios adicionales a sus sistemas.

== Repositorios ==

Los repositorios de paquetes no son más (o menos) que un [[Repository format|conjunto de ficheros]] (ebuilds, ficheros de metadatos, entradas en el registro de cambios, ...). Éstos se pueden obtener de repositorios públicos ([[Project:Portage/Sync#Portage_configuration|git, CVS, SVN ...]]) o descargarse como ficheros empaquetados (tarballs) y desempaquetarse manualmente en el sistema. Se recomienda utilizar repositorios gestionados por terceros [https://overlays.gentoo.org de confianza]. Cualquier repositorio de ebuilds instalado causará que Portage mire en los ficheros de overlay para decidir qué software instalar. Si se obtiene código comprometido desde un repositorio de ebuilds, entonces se podrían instalar paquetes comprometidos en el sistema.

La forma actual por defecto para gestionar repositorios es a través de {{Path|[[:/etc/portage/repos.conf]]}} que, como otras localizaciones de Portage, también puede ser un directorio.

Las definiciones de repositorio dentro de {{Path|/etc/portage/repos.conf/}} también informan a Portage si el repositorio se puede actualizar y cómo se puede realizar. Con todo esto, la lanzar {{c|emerge --sync}} se actualizarán todos los repositorios.

Un método ya obsoleto pero aún permitido es utilizar la variable <var>PORTDIR_OVERLAY</var> dentro de  {{Path|/etc/portage/make.conf}}. Esta variable puede apuntar a más de una localización adicional en el sistema de ficheros donde se pueden localizar repositorios. Sin embargo es preferible utilizar el directorio {{Path|[[:/etc/portage/repos.conf]]/}}.

Para más información leer sobre [[:/etc/portage/repos.conf|/etc/portage/repos.conf]] y el  [[Project:Portage/Sync#Operation|artículo de Portage/Sync]].

=== Prioridades ===

Cada repositorio de ebuilds tiene su propia prioridad única. Esto asegura que en el caso de que una versión en particular se encuentre en varios repositorios de ebuilds, la resolución de la misma no es ambigua. Los ebuilds de los repositorios con números de prioridad más altos (por ejemplo 60) tienen preferencia sobre los ebuilds de repositorios con menores prioridades (por ejemplo 50).

Se puede obtener la lista de repositorio de ebuilds y sus prioridades consultando la salida de las siguientes ordenes (Buscar la palabra "Repositories"):

{{Cmd|emerge --info --verbose}}

{{Cmd|portageq repos_config /}}

El repositorio de Gentoo tendrá una prioridad de -1000. Esto implica que, por lo general, el resto de repositorios de ebuilds tienen mayor precedencia ya que se les asigna un prioridad mayor. Este es el comportamiento por defecto ya que los repositorios de ebuilds se han diseñado para "colocarse encima" del repositorio de Gentoo.

== Herramientas disponibles ==

Existen algunas herramientas de soporte para integrar los repositorios de ebuilds.

=== Layman ===

The {{c|layman}} application makes it easier to manage and update multiple additional ebuild repositories. It is a command-line application 
through which publicly available ebuild repositories can be listed, subscribed to and unsubscribed from, as well as update those repositories. 

Se ofrece soporte tanto para el método {{Path|[[Layman#make.conf_method_.28force_old_method.29|make.conf]]}} como para el método {{Path|[[Layman#Using_.27repos.conf_method_.28default.29|repos.conf]]}}.
* Cuando se utiliza el método {{Path|[[Layman#make.conf_method_.28force_old_method.29|make.conf]]}}, {{c|layman}} gestiona un archivo dedicado de configuración que debe ser cargado por {{Path|make.conf}}
* Cuando se utiliza {{Path|[[Layman#Using_.27repos.conf_method_.28default.29|repos.conf]]}}, {{c|layman}} gestiona el fichero {{Path|[[Layman#Using_.27repos.conf_method_.28default.29|/etc/portage/repos.conf/layman.conf]]}} directamente.

Para más información, consultar [[Layman]] y [[Project:Portage/Sync#Layman_configuration]].

=== emaint ===

Lea el artículo [[Project:Portage/Sync#Operation|Sync (Portage project)]] y {{c|man 1 emaint}}.

=== eix ===

{{c|eix-sync}} es un envoltorio para {{c|emerge --sync}} (que de hecho arranca {{c|emaint sync --auto}}) seguido de {{c|eix-update}}. Para más detalles, leer el artículo sobre [[Eix]] y su página del manual {{c|man 1 eix}}.

== Utilización ==

=== Hacer emerge de un paquete duplicado ===

When working with ebuild repositories it is possible to encounter a situation where multiple versions of the same package are available from different ebuild repositories. Instruct [[Portage]] to install a specific package from a specific ebuild repository with the <code>::</code> notation:

{{Emerge|category/atom::ebuild repository-name}}

== Buenas prácticas ==

=== Generación de cache ===

When large ebuild repositories are installed, portage may take a long time to perform operations like dependency resolution. This is because ebuild repositories do not usually contain a metadata cache.

Generate a local metadata cache by running {{c|emerge --regen}} after syncing the ebuild repositories:

{{RootCmd
|layman -S
|( ulimit -n 4096 && emerge --regen )}}

Be careful, because {{c|emerge --regen}} takes a lot of time and it's not recommended for rsync users as rsync updates the cache using server-side caches (most of users of portage are rsync users). Rsync users should simply run {{c|emerge --sync}} (or {{c|eix-sync}}) to regenerate the cache. It's probably only users of very large ebuild repositories should try {{c|emerge --regen}}.

=== Masking when using unsafe ebuild repositories ===

When using huge ebuild repositories or those with unknown/low quality it is best practice to hardmask the whole ebuild repository.

{{FileBox|filename=/etc/portage/package.mask|title=Mask all packages in an ebuild repository|lang=bash|1=
*/*::ebuild repository-name
}}

Después de esto, desenmascarar los paquetes que se instalarán.

{{FileBox|filename=/etc/portage/package.unmask|title=Desenmascarar un paquete específico en un repositorio de ebuilds|lang=bash|1=
foo/bar::nombre-del-repositorios-de-ebuilds
}}

== Véase también ==

* [[Project:Overlays|Overlays project]] - The official Gentoo project for ebuild repositories' support.
* [[Project:Overlays/Overlays guide|Overlays guide (Overlay project)]] - A user guide written by the Overlay project.
* [[Project:Overlays/Dev Guide|Developer's guide to Gentoo overlays]] - This document is kept only for historical purposes. The current guide is maintained as [[Project:Overlays/Overlays guide]].
* [[Handbook:Parts/Portage/CustomTree#Defining_a_custom_repository|Defining a custom repository]] - Section in the Gentoo Handbook

== Recursos externos ==

* https://overlays.gentoo.org
* https://github.com/gentoo/


[[Category:Portage]]
