<languages />
{{InfoBox stack
|{{InfoBox gdoc|Overlays|text=Proyecto de Overlays de Gentoo|header=true}}
}}

Dentro de Gentoo Linux, los usuarios disponen de un [https://gitweb.gentoo.org/repo/gentoo.git/tree/ repositorio de paquetes "principal"], en el pasado se denominaba [https://devmanual.gentoo.org/general-concepts/tree/ el "Árbol de Portage"], aunque este término ya no debería utilizarse ya que hay otros [[Package Manager Specification|gestores de paquetes]] aparte de [[Portage]] que pueden interactuar con los repositorios de paquetes de Gentoo. El [https://gitweb.gentoo.org/repo/gentoo.git/tree/ repositorio principal] contiene todos los paquetes de software (llamados ebuilds) que mantienen los desarrolladores de Gentoo. Los árboles de paquetes adicionales se hospedan en ''repositories''. Los usuarios pueden añadir estos repositorios adicionales al árbol que "cubren" el árbol principal, de ahí el nombre: Overlays (Revestimientos).

== Repositorios ==

Los repositorios de paquetes no son más (o menos) que un [[Repository format|conjunto de ficheros]] (ebuilds, ficheros de metadatos, entradas en el registro de cambios, ...). Éstos se pueden obtener de repositorios públicos ([[Project:Portage/Sync#Portage_configuration|git, cvs, svn ...]]) o descargarse como ficheros empaquetados (tarballs) y desempaquetarse manualmente en el sistema. Se recomienda utilizar repositorios gestionados por terceros de confianza. Cualquier overlay instalado causará que Portage mire en los ficheros de overlay para decidir qué software instalar. Si se obtiene código comprometido desde un overlay, entonces se podrían instalar paquetes comprometidos en el sistema.

La forma actual por defecto para gestionar repositorios es a través de {{Path|[[:/etc/portage/repos.conf]]}} que, como otras localizaciones de Portage, también puede ser un directorio.

Las definiciones de repositorio dentro de {{Path|/etc/portage/repos.conf/}} también informan a Portage si el repositorio se puede actualizar y cómo se puede realizar. Con todo esto, la lanzar {{c|emerge --sync}} se actualizarán todos los repositorios.

Un método ya obsoleto pero aún permitido es utilizar la variable <var>PORTDIR_OVERLAY</var> dentro de  {{Path|/etc/portage/make.conf}}. Esta variable puede apuntar a más de una localización adicional en el sistema de ficheros donde se pueden localizar repositorios. Sin embargo es preferible utilizar el directorio {{Path|[[:/etc/portage/repos.conf]]/}}.

Para más información leer sobre [[:/etc/portage/repos.conf|/etc/portage/repos.conf]] y el  [[Project:Portage/Sync#Operation|artículo de Portage/Sync]].

=== Prioridades ===

Cada overlay tiene su propia prioridad única. Esto asegura que en el caso de que una versión en particular se encuentre en varios overalys, la resolución de la misma no es ambigua. Los ebuilds de los overalys con números de prioridad más altos (por ejemplo 60) tienen preferencia sobre los ebuilds con menores prioridades (por ejemplo 50).

Se puede obtener sa lista de overalys y sus prioridades consultando la salida de las siguientes ordenes (Buscar la palabra "Repositories"):

{{Cmd|emerge --info --verbose}}

{{Cmd|portageq repos_config /}}

El árbol Portage por defecto de Gentoo tiene una prioridad de -1000. Esto implica que, por lo general, el resto de overlays tienen mayor precedencia ya que se les asigna un prioridad mayor. Este es el comportamiento por defecto ya que los overlays se han diseñado para "colocarse encima" del árbol portage.

== Herramientas de soporte ==

Existen algunas herramientas de soporte para integrar los overlays.

=== Layman ===

La aplicación {{c|layman}} facilita la gestión y actualización de múltiples overlays adicionales. Se trata de una aplicación de la línea de órdenes a través de la cual se pueden listar los overlays disponibles al público, suscritos o no suscritos así como la actualización de esos repositorios. 

Se ofrece soporte tanto para el método {{Path|[[Layman#Using_.27make.conf.27_method_.28older_method.29|make.conf]]}} como para el método {{Path|[[Layman#Using_.27repos.conf.27_method_.28default_method_for_app-portage.2Flayman-2.3.0_or_later_.29|repos.conf]]}}.
* Cuando se utiliza el método {{Path|[[Layman#Using_.27make.conf.27_method_.28older_method.29|make.conf]]}}, {{c|layman}} gestiona un archivo dedicado de configuración que debe ser cargado por {{Path|make.conf}}
* Cuando se utiliza {{Path|[[Layman#Using_.27repos.conf.27_method_.28default_method_for_app-portage.2Flayman-2.3.0_or_later_.29|repos.conf]]}}, {{c|layman}} gestiona el fichero {{Path|[[Layman#Using_.27repos.conf.27_method_.28default_method_for_app-portage.2Flayman-2.3.0_or_later_.29|/etc/portage/repos.conf/layman.conf]]}} directamente.

Para más información, consultar [[Layman]] y [[Project:Portage/Sync#Layman_configuration]].

=== emaint ===

Echar un vistazo a [[Project:Portage/Sync#Operation]] y a {{c|man 1 emaint}}.

=== eix ===

{{c|eix-sync}} es un envoltorio para {{c|emerge --sync}} (que de hecho arranca {{c|emaint sync --auto}}) seguido de {{c|eix-update}}. Para más detalles, leer el artículo sobre [[Eix]] y su página del manual {{c|man 1 eix}}.

== Buenas prácticas ==

=== Generación de cache ===

Cuando se instalan overlays muy voluminosos, a portage le puede llevar mucho tiempo realizar operaciones como la resolución de dependencias. Esto es debido a que los overlays no suelen contener una caché para los metadatos.

Generar una caché local para metadatos lanzando {{c|emerge --regen}} después de sincronizar los overlays:

{{RootCmd
|layman -S
|( ulimit -n 4096 && emerge --regen )}}

Hay que ser cuidadoso ya que {{c|emerge --regen}} lleva bastante tiempo y no se recomienda a los usuarios de rsync ya que rsync actualiza la caché usando caché del servidor (la mayoría de los usuarios de portage son usuarios rsync). Estos usuarios deberían simplemente lanzar {{c|emerge --sync}} (o {{c|eix-sync}}) para regenerar la caché. Probablemente solo los usuarios de overlays muy voluminosos deberían correr {{c|emerge --regen}}.

=== Enmascaramiento cuando se utilicen overlays no seguros ===

Cuando se utilizan overlays con muchos paquetes o se cree que son de baja o desconocida calidad, es una buena práctica enmascarar todo el overlay.

{{FileBox|filename=/etc/portage/package.mask|title=Enmascarar todos los paquetes de un overlay|lang=bash|1=
*/*::overlay-name
}}

Después de esto, desenmascarar los paquetes que se instalarán.

{{FileBox|filename=/etc/portage/package.unmask|title=Desenmascarar un paquete específico en un overlay|lang=bash|1=
foo/bar::overlay-name
}}

== Véase también ==

* [[Project:Overlays]]. El proyecto oficial de Gentoo de soporte de overlays.
* [[Project:Overlays/Overlays_guide]]. Una guía de usuario escrita por el proyecto Overlay.
* [[Project:Overlays/Dev_Guide|Guía del desarrollador de Overlays en Gentoo]]

== Recursos externos ==

* https://overlays.gentoo.org
* https://github.com/gentoo/


[[Category:Portage]]
