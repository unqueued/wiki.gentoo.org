<languages />
{{InfoBox stack
|{{InfoBox gdoc|Overlays|text=Proyecto de Overlays de Gentoo|header=true}}
}}

Dentro de Gentoo Linux, los usuarios disponen de un repositorio de paquetes "principal", en el pasado se denominaba "Árbol de Portage", aunque este término ya no debería utilizarse ya que hay otros gestores de paquetes aparte de Portage que pueden interactuar con los repositorios de paquetes de Gentoo. El repositorio principal contiene todos los paquetes de software (llamados ebuilds) que mantienen los desarrolladores de Gentoo. Los usuarios pueden añadir repositorios adicionales al árbol que "cubren" el árbol principal, de ahí el nombre: Overlays (Revestimientos).

Debido a que los repositorios de paquetes no son más (o menos) que un conjunto de ficheros (ebuilds, ficheros metadata, entradas en el registro de cambios, ...), éstos se pueden obtener de repositorios públicos (git, cvs, svn ...) o descargarse como ficheros empaquetados (tarballs) y desempaquetarse manualmente en el sistema. Se recomienda utilizar repositorios gestionados por terceros de confianza. Cualquier overaly instalado causará que Portage mire en los ficheros de overlay para decidir qué software instalar. Si se obtiene código comprometido desde un overlay, entonces se instalarían paquetes comprometidos en el sistema.

== Repositorios ==

Los paquetes adicionales normalmente se mantienen en ''repositorios''. Éstos son overlays que ya están preparados para incorporarse en sistemas Gentoo. La forma actual por defecto para gestionar repositorios es a través de {{Path|[[:/etc/portage/repos.conf]]}} que, como otras localizaciones de Portage, también puede ser un directorio.

A deprecated, yet still supported method is to use the <code>PORTDIR_OVERLAY</code> variable inside {{Path|/etc/portage/make.conf}}. This variable can point to one or more additional locations on the file system where repositories are available. The use of the {{Path|/etc/portage/repos.conf/}} directory is highly preferred.

Repository definitions inside {{Path|/etc/portage/repos.conf/}} also inform Portage if and how the repository can be updated. With it, calling <tt>emerge --sync</tt> will automatically update the repositories as well.

Para más información leer sobre [[:/etc/portage/repos.conf|/etc/portage/repos.conf]] y el  [[Project:Portage/Sync#Operation|artículo de Portage/Sync]].

=== Priorities ===

Each overlay has its unique priority. This makes sure that in the case of a specific version being found in several overlays, the resolution is unambiguous. Ebuilds from overlays with higher priorities take precedence over ebuilds from overlays with lower priorities.

The list of overlays with their priorities can be obtained through the output of the following command (look for the "Repositories" string):

{{Cmd|emerge --info --verbose}}

The default Gentoo Portage tree will have a priority of -1000. That means that all other overlays generally take precedence as they are assigned a higher priority. That is the default behavior, because overlays are designed to "lay over/on top" of the portage tree.

== Supporting tools ==

A number of tools support or integrate with overlays.

=== Layman ===

The <tt>layman</tt> application makes it easier to manage and update multiple additional overlays. It is a command-line application 
through which publicly available overlays can be listed, subscribed to and unsubscribed from, as well as update those repositories. 

It supports both the {{Path|[[Layman#Using_.27make.conf.27_method_.28older_method.29|make.conf]]}} as well as {{Path|[[Layman#Using_.27repos.conf.27_method_.28default_method_for_app-portage.2Flayman-2.3.0_or_later_.29|repos.conf]]}} method.
* When using the {{Path|[[Layman#Using_.27make.conf.27_method_.28older_method.29|make.conf]]}} method, <tt>layman</tt> manages a dedicated configuration file which should be sourced in by {{Path|make.conf}}
* When using {{Path|[[Layman#Using_.27repos.conf.27_method_.28default_method_for_app-portage.2Flayman-2.3.0_or_later_.29|repos.conf]]}}, <tt>layman</tt> manages the {{Path|[[Layman#Using_.27repos.conf.27_method_.28default_method_for_app-portage.2Flayman-2.3.0_or_later_.29|/etc/portage/repos.conf/layman.conf]]}} file directly

For more information, see [[Layman]] and [[Project:Portage/Sync#Layman_configuration]].

=== emaint ===

See [[Project:Portage/Sync#Operation]] and <kbd>man 1 emaint</kbd>.

=== eix ===

<tt>eix-sync</tt> is a wrapper starting <tt>emerge --sync</tt> (which in turn starts <tt>emaint sync --auto</tt>) followed by <tt>eix-update</tt>.  For further details see the [[Eix]] article and <kbd>man 1 eix</kbd>.

Buenas prácticas

=== Generación de cache ===

When large overlays are installed, portage may take a long time to perform operations like dependency resolution. This is because overlays do not usually contain a metadata cache.

Generate a local metadata cache by running <tt>emerge --regen</tt> after syncing the overlays:

{{RootCmd
|layman -S
|( ulimit -n 4096 && emerge --regen )}}

Be careful, because <tt>emerge --regen</tt> takes a lot of time and it's not recommended for rsync users as rsync updates the cache using server-side caches (most of users of portage are rsync users). Rsync users should simply run <tt>emerge --sync</tt> (or <tt>eix-sync</tt>) to regenerate the cache. It's probably only users of very large overlays should try <tt>emerge --regen</tt>.

=== Enmascaramiento cuando se utilicen overlays no seguros ===

Cuando se utilizan overlays con muchos paquetes o se cree que son de baja o desconocida calidad, es una buena práctica enmascarar todo el overlay.

{{FileBox|filename=/etc/portage/package.mask|title=Enmascarar todos los paquetes de un overlay|lang=bash|1=
*/*::overlay-name
}}

Después de esto, desenmascarar los paquetes que se instalarán.

{{FileBox|filename=/etc/portage/package.unmask|title=Desenmascarar un paquete específico en un overlay|lang=bash|1=
foo/bar::overlay-name
}}

== Véase también ==

* [[Project:Overlays]]. El proyecto oficial de Gentoo de soporte de overlays.
* [[Project:Overlays/User_Guide]]. Una guía de usuario escrita por el proyecto Overlay.
* [[Project:Overlays/Dev_Guide|Guía del desarrollador de Overlays en Gentoo]]

== Recursos externos ==

* https://overlays.gentoo.org


[[Category:Portage]]
