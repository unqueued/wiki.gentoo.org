<languages />
{{InfoBox stack
|{{InfoBox project|Overlays|header=true}}
}}

Dentro de Gentoo Linux, los usuarios ya disponen de un [https://gitweb.gentoo.org/repo/gentoo.git/tree/ repositorio de paquetes "principal"]. El [https://gitweb.gentoo.org/repo/gentoo.git/tree/ repositorio principal] contiene todos los paquetes de software (llamados ebuilds) que mantienen los desarrolladores de Gentoo. Los árboles de paquetes adicionales se hospedan en ''repositories''. Los usuarios pueden añadir estos repositorios adicionales al árbol que "cubren" el árbol principal, de ahí el nombre: Overlays (Revestimientos).

== Repositorios ==

Package repositories are nothing more (or less) than a [[Repository format|set of files]] (ebuilds, metadata files, ChangeLog entries ...). These can be pulled in from public repositories ([[Project:Portage/Sync#Portage_configuration|git, CVS, SVN ...]]) or downloaded as tarballs and extracted manually onto the system. It is advised to use managed repositories by [https://overlays.gentoo.org trusted] third parties; any installed overlay will cause Portage to look through the overlaid files when deciding which software to install. If compromised code is in the overlay, then compromised packages could be installed on the system.

La forma actual por defecto para gestionar repositorios es a través de {{Path|[[:/etc/portage/repos.conf]]}} que, como otras localizaciones de Portage, también puede ser un directorio.

Las definiciones de repositorio dentro de {{Path|/etc/portage/repos.conf/}} también informan a Portage si el repositorio se puede actualizar y cómo se puede realizar. Con todo esto, la lanzar {{c|emerge --sync}} se actualizarán todos los repositorios.

Un método ya obsoleto pero aún permitido es utilizar la variable <var>PORTDIR_OVERLAY</var> dentro de  {{Path|/etc/portage/make.conf}}. Esta variable puede apuntar a más de una localización adicional en el sistema de ficheros donde se pueden localizar repositorios. Sin embargo es preferible utilizar el directorio {{Path|[[:/etc/portage/repos.conf]]/}}.

Para más información leer sobre [[:/etc/portage/repos.conf|/etc/portage/repos.conf]] y el  [[Project:Portage/Sync#Operation|artículo de Portage/Sync]].

=== Prioridades ===

Cada overlay tiene su propia prioridad única. Esto asegura que en el caso de que una versión en particular se encuentre en varios overalys, la resolución de la misma no es ambigua. Los ebuilds de los overalys con números de prioridad más altos (por ejemplo 60) tienen preferencia sobre los ebuilds con menores prioridades (por ejemplo 50).

Se puede obtener sa lista de overalys y sus prioridades consultando la salida de las siguientes ordenes (Buscar la palabra "Repositories"):

{{Cmd|emerge --info --verbose}}

{{Cmd|portageq repos_config /}}

The Gentoo repository will have a priority of -1000. That means that all other overlays generally take precedence as they are assigned a higher priority. That is the default behavior, because overlays are designed to "lay over/on top" of the Gentoo repository.

== Herramientas disponibles ==

Existen algunas herramientas de soporte para integrar los overlays.

=== Layman ===

La aplicación {{c|layman}} facilita la gestión y actualización de múltiples overlays adicionales. Se trata de una aplicación de la línea de órdenes a través de la cual se pueden listar los overlays disponibles al público, suscritos o no suscritos así como la actualización de esos repositorios. 

It supports both the {{Path|[[Layman#make.conf_method_.28force_old_method.29|make.conf]]}} as well as {{Path|[[Layman#repos.conf_method_.28default.29|repos.conf]]}} method.
* When using the {{Path|[[Layman#make.conf_method_.28force_old_method.29|make.conf]]}} method, {{c|layman}} manages a dedicated configuration file which should be sourced in by {{Path|make.conf}}
* When using {{Path|[[Layman#repos.conf_method_.28default.29|repos.conf]]}}, {{c|layman}} manages the {{Path|[[Layman#repos.conf_method_.28default.29|/etc/portage/repos.conf/layman.conf]]}} file directly

Para más información, consultar [[Layman]] y [[Project:Portage/Sync#Layman_configuration]].

=== emaint ===

Lea el artículo [[Project:Portage/Sync#Operation|Sync (Portage project)]] y {{c|man 1 emaint}}.

=== eix ===

{{c|eix-sync}} es un envoltorio para {{c|emerge --sync}} (que de hecho arranca {{c|emaint sync --auto}}) seguido de {{c|eix-update}}. Para más detalles, leer el artículo sobre [[Eix]] y su página del manual {{c|man 1 eix}}.

== Utilización ==

=== Hacer emerge de un paquete duplicado ===

Cuando se trabaja con overlays es posible encontrarse en la situación en que existen varias versiones del mismo paquete en diferentes overlays. Se puede indicar a [[Portage]] que instale paquetes específicos desde un overlay específico usando la notación <code>::</code>:

{{Emerge|category/atom::overlay-name}}

== Buenas prácticas ==

=== Generación de cache ===

Cuando se instalan overlays muy voluminosos, a portage le puede llevar mucho tiempo realizar operaciones como la resolución de dependencias. Esto es debido a que los overlays no suelen contener una caché para los metadatos.

Generar una caché local para metadatos lanzando {{c|emerge --regen}} después de sincronizar los overlays:

{{RootCmd
|layman -S
|( ulimit -n 4096 && emerge --regen )}}

Hay que ser cuidadoso ya que {{c|emerge --regen}} lleva bastante tiempo y no se recomienda a los usuarios de rsync ya que rsync actualiza la caché usando caché del servidor (la mayoría de los usuarios de portage son usuarios rsync). Estos usuarios deberían simplemente lanzar {{c|emerge --sync}} (o {{c|eix-sync}}) para regenerar la caché. Probablemente solo los usuarios de overlays muy voluminosos deberían correr {{c|emerge --regen}}.

=== Enmascaramiento cuando se utilicen overlays no seguros ===

Cuando se utilizan overlays con muchos paquetes o se cree que son de baja o desconocida calidad, es una buena práctica enmascarar todo el overlay.

{{FileBox|filename=/etc/portage/package.mask|title=Enmascarar todos los paquetes de un overlay|lang=bash|1=
*/*::overlay-name
}}

Después de esto, desenmascarar los paquetes que se instalarán.

{{FileBox|filename=/etc/portage/package.unmask|title=Desenmascarar un paquete específico en un overlay|lang=bash|1=
foo/bar::overlay-name
}}

== Véase también ==

* [[Project:Overlays|Overlays project]] - The official Gentoo project for overlays support.
* [[Project:Overlays/Overlays guide|Overlays guide (Overlay project)]] - A user guide written by the Overlay project.
* [[Project:Overlays/Dev Guide|Developer's guide to Gentoo overlays]] - This document is kept only for historical purposes. The current guide is maintained as [[Project:Overlays/Overlays guide]].
* [[Handbook:Parts/Portage/CustomTree#Defining_a_custom_repository|Defining a custom repository]] - Section in the Gentoo Handbook

== Recursos externos ==

* https://overlays.gentoo.org
* https://github.com/gentoo/


[[Category:Portage]]
