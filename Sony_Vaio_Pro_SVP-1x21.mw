How to setup Gentoo Linux on the Sony Vaio Pro Haswell based ultrabooks.

== Preparation ==
It's recommended you back up your disk so that you can keep the windows recovery partition in-case you ever need it.

Since most live usb sticks do not support the WiFi card (Intel(R) Dual Band Wireless N 7260) of these laptops, you will likely be without Internet while setting up the laptop until you can compile a kernel which contains the support (3.11.x or newer). The easiest way to bootstrap the laptop into a WiFi capable kernel is to use USB tethering with an internet capable phone. Alternatively if you do not own a tethering capable phone, you can download the following (or newer) packages from a [http://www.gentoo.org/main/en/mirrors2.xml Gentoo Mirror]. Or, if you have a working Gentoo machine already, simply copying them from that machine's {{Path|/usr/portage/distfiles}}. Be sure also to get the latest firmware for the Intel 7260 WiFi card [http://intellinuxwireless.org].

{{RootCmd
| cd /usr/portage/distfiles
| cp autogen* bc* busybox* cpio* dmraid* efibootmgr* fuse* gcc-*-specs* gcc-*-patches* gcc-*-piepatches* gcc-* gcc-*-uclibc-patches* genkernel* genpatches-*.base* genpatches-*.extras* gnupg* grub* guile* hwids* libnl* linux* LVM2* mdadm* open-iscsi* pciutils* unifont* unionfs-fuse* wireless_tools* wpa_supplicant* /mnt/usbkey
}}

These are all the source packages required to install efibootmgr, gentoo-sources, grub, wireless-tools, and wpa_supplicant. With all this in hand you should be able to install Gentoo, build the newest kernel with support for the Intel 7260, and all the wireless tools necessary to connect to a wireless access point.

You will also need an appropriate stage3 tarball and the portage-latest tarball, so get those from your favourite mirror: [http://www.gentoo.org/main/en/mirrors2.xml Gentoo Mirrors].

Another alternative is preparing your own live usb stick that has the necessary support for the Intel 7260.
== Kernel Configuration ==
It's highly recommended you start from a kernel seed from [http://kernel-seeds.org/ Pappy's Kernel Seeds]. Follow the guide for [http://kernel-seeds.org/working.html Working with Kernel Seeds]. The guide will take you through all the important steps of preparing your kernel. In the following sections, recommended configurations for '''most''' the Vaio Pro's hardware are included, as well as tips for getting some things working correctly. For those remaining pieces of hardware not listed, just follow the Working with Kernel Seeds guide.

=== CPU ===
{{Kernel||<pre>
Processor type and features --->
  Processor family (Core 2/newer Xeon)  --->                                                                                                                        
  [ ] IBM Calgary IOMMU support                                                                                                                                         
  [ ] Enable Maximum number of SMP Processors and NUMA Nodes                                                                                                            
  (8) Maximum number of CPUs                                                                                                                                            
</pre>}}

=== SATA ===
Works with the generic ahci driver.

{{Kernel||<pre>
Device Drivers --->
<*> Serial ATA and Parallel ATA Drivers --->
<*>  AHCI SATA Support
</pre>}}

=== Network ===
{{Kernel||<pre>
Networking Support --->
-*- Wireless --->
<M>   cfg80211 - wireless configuration API
[*]     enable powersave by default
[*]     cfg80211 DebugFS entries
[*]     cfg80211 wireless extensions compatibility
<M>   Generic IEEE 802.11 Networking Stack (mac80211)
      Default rate control algorithm (Minstrel)  --->
-*-   Enable LED triggers
[*]   Export mac80211 internals in DebugFS
</pre>}}

{{Kernel||<pre>
Device Drivers  --->
[*] Network device support  --->
[*]  Wireless LAN  --->
<M>  Intel Wireless WiFi Next Gen AGN - Wireless-N/Advanced-N/Ultimate-N (iwlwifi)
< >     Intel Wireless WiFi DVM Firmware support                                   
<M>     Intel Wireless WiFi MVM Firmware support                                   
</pre>}}

=== I2C Support ===
{{Kernel||<pre>
Device Drivers --->
{*} I2C Support --->
I2C Hardware Bus support --->
<M> Intel 82801 (ICH/PCH)                                                                                                                                             │ │
</pre>}}

=== Graphics ===

== Sound ==
Using ALSA alone doesn't produce very good sound. It's recommended that you use [[PulseAudio]] with this laptop.
