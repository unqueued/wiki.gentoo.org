{{Warning|Under construction}}

This page details how to build Firefox OS and flash your phone

==Requirements==
===Phone===
* Obviously, you will need a smartphone supported by Firefox OS, see list [https://developer.mozilla.org/en-US/Firefox_OS/Developer_phone_guide/Phone_specs here].
* fastboot must be enabled, you may need to unlock the bootloader for that. This operation is out of the scope of this document.
===Computer===
* 64bit install 
* 4GB of RAM
* 30GB of disk space (sources alone take 14GB)

==Packages==
Firefox OS requires gcc 4.6, it will not build with any other version.

Quite a few other packages are required, so we might as well create a set.

{{file|/etc/portage/sets/firefox_os|@firefox_os set|<pre>
# see https://developer.mozilla.org/en-US/Firefox_OS/Firefox_OS_build_prerequisites
=sys-devel/autoconf-2.13
sys-devel/bison
app-arch/bzip2
dev-util/ccache 
net-misc/curl
sys-devel/flex
sys-apps/gawk
dev-vcs/git
=sys-devel/gcc-4.6.3  # or any other 4.6
sys-devel/make
sys-devel/patch
media-libs/mesa
x11-libs/libX11
sys-libs/ncurses 
sys-libs/zlib
dev-util/android-tools 
</pre>}}

You also need the 32bit versions of ncurses and zlib
{{file|/etc/portage/package.use/firefox_os||<pre>sys-libs/ncurses abi_x86_32
sys-libs/zlib abi_x86_32</pre>}}

{{Emerge|@firefox_os}}

==Udev==
Unless you want to use adb/fastboot as root, you may need to add a rule to udev (and have your user be part of the plugdev group)
{{file|/etc/udev/rules.d/firefox_os.rules||<pre>SUBSYSTEM=="usb", ATTR{idVendor}=="19d2", ATTR{idProduct}=="1351", MODE="0666", GROUP="plugdev"</pre>}}
{{note|replace ''19d2'' and ''1351'' (ZTE Open) by the values of your phone, they can be obtained with lsusb}}
{{RootCmd|/etc/init.d/udev restart}}


Now adb should be able to detect your phone
{{Cmd|adb devices|output=<pre>
* daemon not running. starting it now on port 5037 *
* daemon started successfully *
List of devices attached 
roamer2 device</pre>}}


You won't be able to flash your phone via USB if adb/fastboot is not working.<br/>You can also flash the phone from an archive in the sdcard but this is beyond the scope of this document

==Backing up your data==
TODO

==Fetching the sources==
===Find your phone's codename===
See [https://developer.mozilla.org/en-US/Firefox_OS/Developer_phone_guide/Phone_specs this table].

===Choose a Firefox OS version===
The list of versions available can be seen [https://github.com/mozilla-b2g/b2g-manifest/branches here].
As of this writing, ''v1.3'' is the lastest stable version but you can build any version you want.

===Python===
Firefox OS uses python to fetch the sources, unfortunatly it only works with python2, if your default python interpreter is python3, you will need this small hack
{{Cmd
|mkdir B2G
|ln -s `which python2` B2G/python
|export PATH&#x3d;"${PWD}/B2G:${PATH}"
}}
{{note|You could also set python2 as your default interpreter with eselect python, but this may cause problems with other python programs)}}

===Fetching===
{{Cmd
|git clone git://github.com/mozilla-b2g/B2G.git
|cd B2G
|BRANCH&#x3d;v1.4 ./config.sh inari
}}

{{note|Replace ''v1.4'' by the version you want, and ''inari'' by the codename of your phone (inari &#x3d; ZTE Open) }}

The last command will start fetching the sources, this will take a '''very long time''', possibly hours since it basically downloads 14GB of data.

==Building==
===GCC===
Building requires gcc-4.6, it won't work with gcc 4.7 which is the current version used by Gentoo
{{Cmd
|export CC&#x3d;gcc-4.6.3
[export CXX&#x3d;g++-4.6.3
}}
{{note|Replace 4.6.3 with the 4.6 version you have installed}}

===Build===
{{Cmd| ./build.sh}}
{{important|You need to have the phone connected via USB while building, the build script needs some non-free files present on the phone}}

Building takes quite some time and displays a ''lot'' of warnings.

==Flashing==
TODO
