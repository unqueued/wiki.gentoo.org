An alternative to [[SSH tunneling]] to access internal machines trough gateway is using [http://glandium.org/blog/?p=308 jump hosts].

== Prerequisites ==
* SSH access to the gateway machine and the internal one
* Gateway machine has Netcat installed

== Setup ==
{{File|~/.ssh/config|Add this text|<pre>
Host *+*
ProxyCommand ssh $(echo %h | sed 's/+[^+]*$//;s/\([^+%%]*\)%%\([^+]*\)$/\2 -l \1/;s/:/ -p /') nc -w1 $(echo %h | sed 's/^.*+//;/:/!s/$/ %p/;s/:/ /')
</pre>}}

== Usage ==
{{Cmd|ssh host1+host2}}
If usernames on machines differ, specify them:
{{Cmd|ssh user1%host1+host2 -l user2}}
{{Note|The login name for the last hop has to be given using -l flag.}}
You can give also port numbers if needed:
{{Cmd|ssh host1:port1+host2}}
It works with scp command, too:
{{Cmd|scp filename host1+host2:~/}}
{{Note|The column and path at the end is needed so that scp recognizes it as remote.}}

=== Tips ===
To ease the connecting even further:
* Set these commands as [http://en.wikipedia.org/wiki/Alias_%28command%29 shell aliases]
* To avoid typing passwords use [http://www.gentoo.org/doc/en/articles/openssh-key-management-p1.xml OpenSSH keys]

=== Multiple jumps ===
The same syntax can used to make jumps over multiple machines:
{{Cmd|ssh host1+host2+host3}}
{{Note|All but the last jump host need the ProxyCommand set in its SSH configuration.}}

== Links ==
* [http://glandium.org/blog/?p=308 SSH through jump hosts]

[[Category:Server and Security]]
