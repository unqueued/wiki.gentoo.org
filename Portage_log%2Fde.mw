<languages />
Wenn Sie <tt>emerge</tt> zum Bau eines Paketes verwenden, ist es nicht ungewöhnlich Meldungen die von Portage selbst kommen zu bemerken. Weil sie wichtige Informationen von Gentoo Entwicklern beinhalten können, ist es eine gute Idee sie zu lesen. Das ist aber oft nicht sofort möglich, weil sie schnell aus dem Bildbereich scrollen. Dies kann leicht durch die Aktivierung einer Portage Funktion genannt elog gelöst werden, deren Zweck es ist Meldungen zur späteren Durchsicht auf Festplatte zu speichern. Es bestehen aber auch noch andere Aufzeichnungsmöglichkeiten ...

== Portage elog Teilsystem ==

Das Portage elog Teilsystem behält bestimmte von ebuild gelieferte Log-Meldungen im Auge, die von Entwicklern in die ebuilds gepackt wurden um die Aufmerksamkeit des Administrators oder der Benutzer auf sich zu ziehen. Diese Meldungen beinhalten oft wichtige oder interessante Informationen in Bezug zu den genannten Paketen.

=== Einrichtung ===

Wählen Sie durch die Variable <code>PORTAGE_ELOG_CLASSES</code> welche Art von Informationen geloggt werden sollen. Mögliche Werte sind <code>info</code>, <code>warn</code>, <code>error</code>, <code>log</code> und <code>qa</code>:

{{FileBox|filename=/etc/portage/make.conf|lang=bash|1=
PORTAGE_ELOG_CLASSES="log warn error"
}}

=== Konfiguration für Datei-basierte Speicherung ===

Portage kann die elog Ereignisse auf mehrere Arten handhaben.

Um die elog Ereignisse auf Festplatte zu speichern aktivieren Sie das <code>save</code> Modul in der Variable <code>PORTAGE_ELOG_SYSTEM</code>:

{{FileBox|filename=/etc/portage/make.conf|lang=bash|1=
PORTAGE_ELOG_SYSTEM="save"
}}

Die Meldungen werden in {{Path|/var/log/portage/elog}} oder {{Path|${PORT_LOGDIR}/elog}} gespeichert, wenn die genannte Variable gesetzt ist.

Um in Kategorien unterteilte elog Dateien zu erzeugen, aktivieren Sie die Portage Funktion <code>split-elog</code>. Sie wird Portage dazu bringen Kategorie-basierte Unterverzeichnisse im Verzeichnis {{Path|/var/log/portage/elog}} zu erzeugen.

=== Für E-Mail Konfigurieren ===

To mail logs to a recipient, enable the <code>mail</code> module. The mail option requires some additional variables to be set. Read {{Path|/usr/share/portage/config/make.conf.example}} for more information.

Below, an example setup is shown which is hopefully self-explanatory:

{{FileBox|filename=/etc/portage/make.conf|lang=bash|1=
PORTAGE_ELOG_SYSTEM="mail"
# First the mail-to address, then the SMTP server
PORTAGE_ELOG_MAILURI="log-intake@example.com mail.example.com"
PORTAGE_ELOG_MAILFROM="portage@$(hostname).example.com"
PORTAGE_ELOG_MAILSUBJECT="${PACKAGE} is ${ACTION} on ${HOST}"
}}

Another example with nullmailer or sendmail:

{{FileBox|filename=/etc/portage/make.conf|lang=bash|1=
PORTAGE_ELOG_SYSTEM="mail"
# First the mail-to address, then the SMTP server
PORTAGE_ELOG_MAILURI="users@host /usr/sbin/sendmail"
PORTAGE_ELOG_MAILFROM="portage@$(hostname).example.com"
PORTAGE_ELOG_MAILSUBJECT="${PACKAGE} is ${ACTION} on ${HOST}"
}}

=== Related software ===

The following is a list of elog-related software packages:

* {{Package|app-portage/elogv}} - Curses based utility to parse the contents of elogs
* {{Package|app-portage/elogviewer}} - Python based elog viewer
* {{Package|app-portage/portage-mod_jabber}} - Module to support XMPP (Jabber) protocol for elog events

== Build logs ==

With the Portage elog subsystem, package build logs are saved on disk or mailed to a remote recipient, regardless of failure or success. This allows for administrators to review builds later or retrieve build logs for support tickets.

=== Setup ===

To enable Portage logging, edit {{Path|/etc/portage/make.conf}} and set <code>PORT_LOGDIR</code> to a location where the log files should be stored. By default, Portage will use {{Path|/var/log/portage}}:

{{FileBox|filename=/etc/portage/make.conf|lang=bash|1=
PORT_LOGDIR="/var/log/portage"
}}

Next, a number of <code>FEATURES</code> settings influence how Portage handles build logs.

* With <code>binpkg-logs</code> set, even binary package deployments will have their logs saved
* When <code>clean-logs</code> is set, regular log file clean operations are executed. The command that is executed is defined by <code>PORT_LOGDIR_CLEAN</code> and defaults to a retention of the files of 7 days.
* With <code>split-log</code> set, build logs are stored in category-named subdirectories of <code>${PORT_LOGDIR}/build</code>

=== Cleaning up ===

When <code>clean-logs</code> is set, Portage will execute the command defined by <code>PORT_LOGDIR_CLEAN</code> after every build or unmerge operation. By default, the following command is used:

{{FileBox|filename=/usr/share/portage/config/make.globals|lang=bash|1=
PORT_LOGDIR_CLEAN="find \"\${PORT_LOGDIR}\" -type f ! -name \"summary.log*\" -mtime +7 -delete"
}}

When defining a custom command, do not forget to ''escape'' the <code>${PORT_LOGDIR}</code> variable (or immediately hardcode the right location).

== External resources ==

* [http://blog.siphos.be/2013/09/underestimated-or-underused-portage-elogging/ Underestimated or underused: Portage (e)logging] on ([[User:SwifT|Sven Vermeulen]]'s blog)

[[Category:Portage]]
