<languages />


{{Metadata|abstract=Esta guía tiene como objetivo presentar Java al lector y explicar como utilizar Java en Gentoo Linux.}}

Esta guía tiene como objetivo presentar Java al lector y explicar como utilizar Java en Gentoo Linux.

== ¿Que es Java? ==

=== Visión general ===

Java es un lenguaje de programación desarrollado por ingenieros de Sun Microsystems. El lenguaje es totalmente orientado a objetos y diseñado para ser ejecutado en múltiples plataformas sin la necesidad de recompilar el código para cada una de ellas. Aunque Java puede ser compilado como un lenguaje nativo, mucha de la popularidad de Java se atribuye a su portabilidad, junto con otras características como recolección de basura. Para hacer posible esta independencia de plataforma, el compilador de Java compila el codigo Java hacia una representación intermedia denominada "Java bytecode" que es ejecutado en un JRE (Java Runtime Environment) y no directamente sobre el sistema operativo. 

Para ejecutar Java bytecode, es necesario tener un entorno JRE (Java Runtime Environment) instalado. Un JRE proporciona bibliotecas centrales, una maquina virtual de Java dependiente de plataforma, y extensiones para navegadores web entre otras cosas. Por otro lado un JDK (Java Development Kit) agrega herramientas de programación, tales como compilador de bytecode y un depurador de codigo. 

== Instalando una Máquina Virtual ==

=== Opciones ===

Gentoo proporciona una variedad de entornos de ejecución (JREs) y kits de desarrollo (JDKs). Las opciones actuales incluyen: 

{| class="table" style="text-align: left;" 
|- 
! Vendor
! JDK
! JRE
|- 
| Open Java SE de IcedTea (anteriormente icedtea6-bin)
| {{Package|dev-java/icedtea-bin}}
| 
|- 
| Java 7 SE de Oracle
| {{Package|dev-java/oracle-jdk-bin}}
| {{Package|dev-java/oracle-jre-bin}}
|- 
| Java 6 SE de Sun (enmascarado, inactivo después de la adquisición de Sun por parte de Oracle)
| {{Package|dev-java/sun-jdk}}
| {{Package|dev-java/sun-jre-bin}}
|- 
| Java SE de IBM
| {{Package|dev-java/ibm-jdk-bin}}
| {{Package|dev-java/ibm-jre-bin}}
|-
|}

=== Instalando un JRE/JDK ===

Para instalar el '''JDK''' por defecto del perfil lance <kbd>emerge virtual/jdk</kbd>. O lance <kbd>emerge virtual/jre</kbd> para instalar el '''JRE''' por defecto del perfil. 

Algunos JDKs y JREs, incluyendo los paquetes de Sun, requieren que el usuario acepte un Acuerdo de Licencia de Usuario o Eula. En el caso que esta licencia (por ejemplo dlj-1.1) no este incluida en la variable <code>ACCEPT_LICENSE</code> dentro de {{Path|/etc/portage/make.conf}} no será posible instalar el JDK/JRE. Para mayor información de como agregar licencias aceptadas en {{Path|make.conf}} puede consultarse el [[Handbook:X86/Working/Portage/es#Licencias|capítulo de licencias]] del manual de Portage. 

Para evitar cualquier restricción de licencias, considérese instalar icedtea-bin, el cual es una implementación abierta de Java del proyecto OpenJDK. 

{{Note|Tenga en cuenta que cada ''JDK'' incluye un ''JRE''. Por tanto no es necesario instalar un JRE si se ha hecho emerge de un JDK.}}

=== Instalando maquinas virtuales con descarga restringida ===

Some of the JDKs and JREs require a few extra steps in their configurations. Emerge the packages as normal. If additional steps are required the ebuilds will provide instruction for the user on where to go and what to download.

Descargar el archivo o archivos indicados en {{Path|/usr/portage/distfiles}}. Una vez los archivos están en el lugar indicado, lanzar de nuevo la orden <tt>emerge</tt>. En este punto la instalación de JRE/JDK se iniciará.

=== Configurar un JRE sin monitor ni teclado === 

Sometimes there is no need for a full JRE with all the capabilities of java. Using java on a server often does not require any GUI, graphical, sound or even printer related features. To install a simplified (sometimes also referred to as headless) JRE 3 USE flags need to be unset. 

{{FileBox|filename=/etc/portage/package.use|title=Cambios necesarios en los ajustes USE|1=
virtual/jre -X -alsa -cups
}}

Dependiendo del perfil de Gentoo profile, este podría ser el caso. Como es habitual, se pueden comprobar los ajustes USE que se aplican a un determinado paquete lanzado <tt>emerge</tt> en el modo pretensión:

{{Cmd|emerge -pv virtual/jre}}

== Configurar la máquina virtual de Java ==

=== Visión general ===

Gentoo posee la habilidad de instalar multiples JDKs y JREs sin causar conflictos. 

Using the <tt>java-config</tt> tool with root privileges, a system-wide default java virtual machine (VM) can be set. Users can also use java-config to custom set their personal VM on a user-by-user basis. 

{{Note|Es posible tambien utilizar <tt>eselect</tt> para cambiar la VM del sistema y del usuario. Lea <kbd>eselect java-vm help</kbd>.}}

=== Estableciendo una maquina virtual por defecto ===

Running the <kbd>java-config --list-available-vms</kbd> command will output a list of all JREs and JDKs installed on the system. Here is an example of the output: 

{{RootCmd|java-config --list-available-vms|output=<pre>
The following VMs are available for generation-2:
1&#41;      IcedTea-bin 1.10.4 [icedtea-bin]
2&#41;      Sun JDK 1.5.0.20 [sun-jdk-1.5] (Build Only)
*&#41;      Sun JDK 1.6.0.16 [sun-jdk-1.6]
</pre>
}}

{{Note|VMs marked as 'Build Only' may contain security vulnerabilities and/or be end of life (EOL). Gentoo recommends not setting these VMs as the system's ''or'' the user's VM. Please see [[Java#Build_Only_VM|Build Only VM]] for more information.}}

The ''*'' indicates this is the current active JVM (system-vm or user-vm when set). The name in the brackets (''[]'') is the handle or ID for that particular VM. The handle or the number to <kbd>java-config --set-system-vm</kbd> can be used to set the VM. The following text provides an example of how to set the system VM.

Estableciendo la maquina virtual manualmente (modo preferido):

{{RootCmd|java-config --set-system-vm sun-jdk-1.6|output=<pre> Now using sun-jdk-1.6 as your generation-2 system JVM </pre>}}

Método alternativo: seleccionar VM por número:

{{RootCmd|java-config --set-system-vm 3|output=<pre> Now using sun-jdk-1.6 as your generation-2 system JVM </pre> }}

Como usuario normal, utilizar java-config <code>--set-user-vm</code>. 

{{Note|<tt>source</tt>-ing the profile is no longer needed for updates to the user's or the system's VM.}}

=== Maquina virtual marcada como Build Only ===

Some virtual machines are flagged as build-only due to being EOL and/or containing security vulnerabilities. These virtual machines will not automatically be used by Gentoo for the running of applications using Gentoo launchers (run-java-tool script designed for switching VMs), but will still be available for use by Gentoo's build environment as some packages may require them for building. The setting of these virtual machines as either the system or user VM is strongly discouraged as these VMs will then be used when running the {{Path|/usr/bin/{java,javac,..}}} executables, as well as used by any packages not using Gentoo's launcher scripts. 

=== Maquina virtual preferida para compilación ===

Al instalar paquetes Java, la máquina virtual utilizada puede ser diferente de la configurada actualmente como máquina virtual del sistema. 

This merge time VM switching is needed when, for example, the system-vm is set to a 1.6 VM and the package being merge requires a 1.5 VM. While merging it will select and use a 1.5 VM, leaving the system-vm choice intact. 

To define which VM is selected when a switch is needed, a list of ''default/supported VMs'' per arch has been created. It can be found in {{Path|/usr/share/java-config-2/config/jdk-defaults.conf}}. 

These defaults can be over written (even the selected system VM) in {{Path|/etc/java-config-2/build/jdk.conf}} for complete control over which VM will get used for merging.

For example, to always use a sun-jdk:

{{FileBox|filename=/etc/java-config-2/build/jdk.conf|title=Requerir sun-jdk|1=
*=sun-jdk
}}

Or, to always use sun-jdk-1.5 wherever possible, except for when a 1.4 or 1.3 VM is explicitly required:

{{FileBox|filename=/etc/java-config-2/build/jdk.conf|title=Requiring sun-jdk-1.5 for 1.5 VMs|1=
*=sun-jdk-1.5
}}

Or to use different providers for different versions, such as requiring <code>sun-jdk-1.4</code> if a 1.3 (yes, 1.3) VM is asked, and fall back to ibm-jdk-bin otherwise:

{{FileBox|filename=/etc/java-config-2/build/jdk.conf|title=Utilizar expresiones múltiples|1=
1.3=sun-jdk-1.4 ibm-jdk-bin
1.5=sun-jdk
}}


{{Warning|This file does not ''have'' to be edited. If these options are changed to use a unsupported VM, things could possibly break. Because of the wide variety of available VMs, the resources are not available to test and verify every package works on all of them. Bugs reported with a unsupported VM will not be prioritized as much as bugs present within supported VMs.}}

== Compiladores ==

The standard Java compiler used for building is <tt>javac</tt>, which comes with each JDK. In addition to configuring the VM used at build time, it is also possible configure which compiler is used. Essentially, define a list with preference for which compiler to use in {{Path|/etc/java-config-2/build/compilers.conf}}. 

{{FileBox|filename=/etc/java-config-2/build/compilers.conf|title=Configurar las preferencias del compilador|1=
COMPILERS="ecj-X.Y jikes javac"
}}

Some compilers do not support all possible <code>-target</code> and <code>-source</code> arguments. Therefore, each compiler in the list is checked to see if it can support the desired <code>-source</code>/<code>-target</code>. javac will work in all cases, so if no other suitable compiler is found, it will be used instead. 

Más detalles acerca de los compiladores son descritos a seguir: 

{| class="table" style="text-align: left;" 
|- 
! Name
! Handle
! Package
! Description
|- 
| javac
| javac
| N/A
| This is the default compiler that will be used, and comes with each JDK.
|- 
| jikes
| jikes
| dev-java/jikes
| Jikes was originally developed by IBM. Anecdotally, it is generally quicker than javac. Note however, that it is more pedantic, and will fail under a few circumstances where javac has no issue. It also does not support Java 1.5 syntax yet.
|- 
| Eclipse Compiler for Java
| ecj
| dev-java/eclipse-ecj
| ECJ is the compiler used by the Eclipse software development kit. It is very full featured, and is pretty fast. It does support Java 1.5 syntax.
|-
|}

== Estableciendo un CLASSPATH por defecto ==

{{Warning|The options explained in this section should be considered deprecated and will most likely be removed in the future. It is strongly recommended against using these, because Java projects or applications should ideally manage their own classpaths. When choosing to specify a default CLASSPATH, some applications may behave unexpectedly, because classes they were not expecting to be on the classpath.}}

<tt>java-config</tt> can also be used to set a system-wide default CLASSPATH, as well a user-specific default CLASSPATH. 

First, list available Java libraries installed on the system to possibly put in the <code>CLASSPATH</code> variable. Here is an example of output: 

{{RootCmd|java-config --list-available-packages|output=<pre>
[xerces-2] The next generation of high performance, fully compliant XML parsers in the Apache Xerces family (/usr/share/xerces-2/package.env)
[junit] Simple framework to write repeatable tests (/usr/share/junit/package.env)
[bsh] BeanShell: A small embeddable Java source interpreter (/usr/share/bsh/package.env)
[bcel] The Byte Code Engineering Library: analyze, create, manipulate Java class files (/usr/share/bcel/package.env)
[log4j] A low-overhead robust logging package for Java (/usr/share/log4j/package.env)
...
</pre>
}}

Again, the names in brackets ([]) are the IDs to pass to java-config --set-system-classpath. Here is an example: 


{{RootCmd|java-config --set-system-classpath log4j,xerces-2}}

{{Note|The current directory ({{Path|.}}) will not be part of the system classpath, as that should be added to the system's login profile.}}

Update the environment by logging out, then in again or by typing <kbd>source {{Path|/etc/profile}}</kbd>. 

For users, java-config --set-user-classpath will create {{Path|~/.gentoo/java-env-classpath}}, which should then source from the shell's profile. 

{{CodeBox|title=Sourcing user specific classpath|1=
if [[ -f "${HOME}/.gentoo/java-env-classpath" ]]; then
       source ${HOME}/.gentoo/java-env-classpath
fi
}}

If desiring a system wide or user default classpath add something like the following to the shell's profile. This is advised against: 

{{RootCmd|export CLASSPATH{{=}}"${CLASSPATH}:$(java-config --classpath log4j,xerces-2)"}}

== Complementos de Navegador Web de Java ==

=== Instalando un complemento ===

It is possible to install a Java plugins for a web browsers by emerging a Java VM with the <code>nsplugin</code> USE flag set.

{{Note|<code>nsplugin</code> is not available for all architectures. Check for available plugins for the specific arch before trying to install a VM by running <kbd>emerge -pv <java-vm></kbd>.}}

Portage will allow installations of multiple Java plugins versions, though only one will be used by the web browser. Check the list of available plugins by running: 

{{RootCmd|eselect java-nsplugin list|output=<pre>
   [1]   sun-jre-bin-1.6
   [2]   icedtea-bin
</pre>
}}

In this example, <tt>sun-jre-bin</tt> is selected for the browser plugin. 

{{RootCmd|eselect java-nsplugin set sun-jre-bin-1.6}}

Luego, se verifica si el complemento correcto fue seleccionado: 

{{RootCmd|eselect java-nsplugin list|output=<pre>
   [1]   sun-jre-bin-1.6  current
   [2]   icedtea-bin
</pre>
}}

Java.com also provides a link to [http://java.com/en/download/installed.jsp verify the installed plugin]. Additionally, if a Mozilla-based browser is being used, verification of the Java plugin can be performed by typing <kbd>about:plugins</kbd> into the address bar.

=== Complementos en sistemas multilib ===

If running a mixed 64-bit and 32-bit multilib system (for example, on AMD64), use both 64-bit and 32-bit Java plugins. Unless there is a pressing need to run 32-bit Java applications, users have been recommended to use native 64-bit plugins on 64-bit web browsers. 

There are several native 64-bit browser plugins available. The default JDK/JRE pair, <code>sun-jdk</code> and <code>sun-jre-bin</code>, both include browser plugins. Just emerge one of them with <code>nsplugin</code> USE enabled. 

{{RootCmd|echo "dev-java/sun-jre-bin nsplugin" >> /etc/portage/package.use
|emerge sun-jre-bin}}

To use a 32-bit plugin on a 32-bit browser, the {{Package|app-emulation/emul-linux-x86-java}} package will need to be emerged with <code>nsplugin</code> USE enabled. 

{{RootCmd|echo "app-emulation/emul-linux-x86-java nsplugin" >> /etc/portage/package.use
|emerge emul-linux-x86-java}}

Luego, deben verificarse cuales complementos están disponibles: 

{{RootCmd|eselect java-nsplugin list|output=<pre>
Available 32-bit Java browser plugins
  [1]   emul-linux-x86-java-1.5
  [2]   emul-linux-x86-java-1.6
Available 64-bit Java browser plugins
  [1]   icedtea-bin
  [2]   sun-jre-bin-1.6
</pre>
}}

Now select the right plugin for the browser: 

{{RootCmd|eselect java-nsplugin set 32bit emul-linux-x86-java-1.6
|eselect java-nsplugin set 64bit sun-jre-bin-1.6}}

Por ultimo, debe verificarse que el complemento correcto haya sido seleccionado: 

{{RootCmd|eselect java-nsplugin list|output=<pre>
Available 32-bit Java browser plugins
  [1]   emul-linux-x86-java-1.5
  [2]   emul-linux-x86-java-1.6  current
Available 64-bit Java browser plugins
  [1]   icedtea-bin
  [2]   sun-jre-bin-1.6  current
</pre>
}}

== USE flags para ser utilizadas con Java ==

=== Estableciendo USE flags ===

For more information regarding USE flags, refer to the [[Handbook:X86/Working/USE|USE flags]] chapter from the Gentoo Handbook. 

=== Los ajustes USE ===

* The <code>java</code> flag adds support for Java in a variety of programs;
* The <code>nsplugin</code> flag adds support for Mozilla-like browsers (including Firefox). This is needed for viewing Java applets in a Mozilla-like browser;
* The <code>source</code> flag installs a zip of the source code of a package. This is traditionally used for IDEs to 'attach' source to the libraries that are being use;
* The <code>jce</code> flag adds support for the Java Cryptography Engine;
* For Java packages, the <code>doc</code> flag will build API documentation using javadoc.

== Ver también ==

* La [[Project:Java|página del proyecto Java]].
* La [[Project:Java/User_Guide|guía del usuario de Java]] en el proyecto Java.

== Recursos externos ==

* The [http://news.gmane.org/gmane.linux.gentoo.java gentoo-java], [http://news.gmane.org/gmane.linux.gentoo.user gentoo-user], and [http://news.gmane.org/gmane.linux.gentoo.devel gentoo-dev] mailing list archives
* [irc://chat.freenode.net/gentoo #gentoo] and [irc://chat.freenode.net/gentoo-java #gentoo-java] on IRC
* [[Wikipedia:Java_programming_language|Wikipedia's entry for Java]]
* [https://forums.gentoo.org/viewtopic-t-901036.html Java 7 and bootstrapping icedtea] on the Gentoo forums

Se puede encontrar más información fuera de línea:
* <kbd>man java-config</kbd>
* <kbd>java-config --help</kbd>

Para aportar sugerencias o realizar preguntas acerca de este documento, por favor envíe un mensaje de correo electrónico al equipo Java de Gentoo: {{Mail|java@gentoo.org}}

[[Category:Programming_language]]

{{Migrated|originalauthors=Joshua Nichols, Karl Trygve Kalleberg, Joshua Saddler}}
