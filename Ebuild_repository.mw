'''An overlay is an additional repository that Portage takes into account when dealing with software.'''

Within Gentoo Linux, users already have one "main" package repository, called the ''Portage tree''. This main repository contains all the software packages (called [[Ebuild|ebuilds]]) maintained by Gentoo developers. But users can add additional repositories to the tree that are "layed over" the main tree - hence the name, ''overlays''.

Since package repositories are nothing more (or less) than a set of files (ebuilds, metadata files, ChangeLog entries ...) these repositories can be pulled in from public repositories (git, cvs, svn ...) or downloaded as tarballs and extracted manyally on the system. It is however well advised to use managed repositories by ''trusted'' third parties as any installed overlay will cause Portage to look into those files as well when deciding which software to install.

== Treatment of overlays ==

Portage uses the <code>PORTDIR_OVERLAY</code> variable to link to the installed overlays on the system. This variable uses a space-delimited list of paths on the system where Portage can find the roots of the additional repositories.

=== Manually setting overlay locations ===

When you want to create an overlay yourself, create a location (say <code>/home/user/overlay</code>) in which you will put the packages you want Portage to look into as well. Then add <code>PORTDIR_OVERLAY="/home/user/overlay"</code> to your /etc/make.conf file:
{{File|/etc/make.conf|Adding an overlay manually|<pre>PORTDIR_OVERLAY="/home/user/overlay"</pre>}}

=== Using layman ===

To make management of multiple overlays simple, a tool called '''layman''' is developed. This tool knows about popular user- and developer managed overlays and is able to install & synchronize them as well as add them to the <code>PORTDIR_OVERLAY</code> location. If you use layman, you need to add in the following line to /etc/make.conf and also make sure that you never reset <code>PORTDIR_OVERLAY</code> later in the file:
{{File|/etc/make.conf|Setting up layman|<pre>source /var/lib/layman/make.conf
# The following does not reset the PORTDIR_OVERLAY variable but extends it
PORTDIR_OVERLAY="${PORTDIR_OVERLAY} /home/user/overlay"</pre>}}

To have a list of all the overlays, type:
{{RootCmd|layman -L}}

To add an overlay in the list, type:
{{RootCmd|layman -a <name>}}

To remove an overlay from the local list, type:
{{RootCmd|layman -d <name>}}

To update all overlays, type:
{{RootCmd|layman -S}}
