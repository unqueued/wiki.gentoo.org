{{InfoBox stack
|{{InfoBox homepage|http://www.mediawiki.org|header=true}}
|{{InfoBox wikipedia}}
}}
'''MediaWiki''' is a powerful wiki application used by the Gentoo Wiki and the various Wikimedia Project websites (including Wikipedia).

== Installation ==

=== Prerequisites ===
* Install [[PHP]]. Enable the ''xmlreader'' USE flag, because MediaWiki requires it:
: {{RootCmd|echo "dev-lang/php xmlreader" >> /etc/portage/package.use}}

* Install a web server and set it up for use of PHP:
** [[Apache]]
** [[Lighttpd]]

* Install [[MySQL]] ([[MariaDB]] is a suitable alternative). Create a database for MediaWiki:
{{RootCmd
|mysql -u root -p
|output=<pre>
mysql> CREATE DATABASE IF NOT EXISTS `mediawiki` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`;
mysql> CREATE USER 'mediawiki'@'localhost' IDENTIFIED BY 'changeme';
mysql> GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, INDEX, ALTER ON `mediawiki`.* TO 'mediawiki'@'localhost' IDENTIFIED BY 'changeme';
mysql> \q
</pre>}}

=== www-apps/mediawiki ===

{{USEflag|package=www-apps/mediawiki}}

Install {{Package|www-apps/mediawiki}}:

{{Emerge|www-apps/mediawiki}}

== Setup ==
* Copy mediawiki files from /usr/share/webapps/mediawiki/{version}/htdocs to /var/www/localhost/htdocs/mediawiki
* Point your browser at http://127.0.0.1/mediawiki and follow the instructions.
* Page "Welcome to MediaWiki!":
** "Database name" is "mediawiki"
** "Database username" is "mediawiki"
** "Database password" is "changeme" (or what else you have setup)
* Page "Connect to database":
** Database character set" should be "UTF-8"
* Page "Name"
** "Name of wiki" has to be set
** Setup admin user and password
* Page "Complete!"
** Download your {{Path|LocalSettings.php}} configuration and move it to {{Path|/var/www/localhost/htdocs/mediawiki/LocalSettings.php}}.
* Point your browser at http://127.0.0.1/mediawiki/ to see your installed and configured wiki.

== Advanced configuration ==
* To use a [https://www.mediawiki.org/wiki/Manual:Short_URL/Apache shorter URL] make the following modifications:
add this somewhere (does not matter exactly where):
{{FileBox|filename=/var/www/localhost/htdocs/mediawiki/LocalSettings.php|lang=php|1=$wgArticlePath = "/wiki/$1"; 
$wgUsePathInfo = true;}}
and add this between <nowiki><Directory></nowiki> tags:
{{FileBox|filename=/etc/apache2/vhosts.d/default_vhost.include|lang=apache|1=RewriteEngine On
RewriteRule ^/?wiki(/.*)?$ %{DOCUMENT_ROOT}/mediawiki/index.php [L]}}
* By default the landing page in MediaWiki is unlocked for anyone to edit. Login as admin. By the top right of the page is an arrow that points down, click it and the 3rd option down is "protect" to lock down the page.

* Set an avatar for your wiki. Add to the bottom of {{Path|/var/www/localhost/htdocs/mediawiki/LocalSettings.php}}:
: {{FileBox|filename=/var/www/localhost/htdocs/mediawiki/LocalSettings.php|lang=php|1=$wgLogo {{=}} "/mediawiki/wiki.png";}}

== External Resources ==
*[http://www.mediawiki.org/wiki/Manual MediaWiki manual for developers and administrators]
*[http://www.mediawiki.org/wiki/Manual:Combating_spam spam combat manual]
*[http://www.mediawiki.org/wiki/Extensions MediaWiki Extensions]

[[Category:Web application]]
