Someone handed you an ebuild, and you don't know what to do with it? Fear not, for here be instructions!

== Creating a local overlay ==

You can create a local overlay with a few easy steps.

{{RootCmd
| mkdir -p /usr/local/portage/{metadata,profiles}
| echo 'NameOfYourOverlay' > /usr/local/portage/profiles/repo_name
| echo 'masters {{=}}  gentoo' > /usr/local/portage/metadata/layout.conf
| chown -R portage:portage /usr/local/portage}}

Next, tell portage about the overlay.

{{RootCmd | mkdir -p /etc/portage/repos.conf}}
{{:/etc/portage/repos.conf/local.conf}}

{{Note|<code>NameOfYourOverlay</code> is an example and you should change it to something meaningful in all locations.}}

{{Note|The old method of setting the <var>PORTDIR_OVERLAY</var> variable in {{Path|make.conf}} is deprecated and should not be used.}}

== Adding an ebuild to the overlay ==

Now that the basic layout is in order, you can add an ebuild to the overlay. In this example, app-dicts/artha-1.0.2 (available at [https://bugs.gentoo.org/show_bug.cgi?id=312313]). We will assume the ebuild is in the homedir of the user {{c|myuser}}, and named '''artha-1.0.2.ebuild'''.

{{RootCmd
| mkdir -p /usr/local/portage/app-dicts/artha
| cp ~myuser/artha-1.0.2.ebuild /usr/local/portage/app-dicts/artha/artha-1.0.2.ebuild
| chown -R portage:portage /usr/local/portage
| pushd /usr/local/portage/app-dicts/artha
| repoman manifest
| popd
}}

You should now be able to install the package from your overlay with emerge.

{{RootCmd|emerge -av1 app-dicts/artha}}

== Crossdev ==

[[crossdev]] will automatically place the ebuilds/categories it generates into the highest priority overlay found in {{Path|/etc/portage/repos.conf/}}. In order to do this you must set the priority number to something low. Most users will want to prevent [[crossdev]] from disturbing [[layman]]'s overlays or the user's personal per-machine overlay (normally created at {{Path|/usr/local/portage}}). Create an overlay specifically for [[crossdev]]'s use:

{{RootCmd
| mkdir -p /usr/local/portage-crossdev/{profiles,metadata}
| echo 'local-crossdev' > /usr/local/portage-crossdev/profiles/repo_name
| echo 'masters {{=}} gentoo' > /usr/local/portage-crossdev/metadata/layout.conf
| chown -R portage:portage /usr/local/portage-crossdev
}}

If the main Portage tree is synchronized using Git, or any other method with Manifest files that do not include checksums for ebuilds, prevent "masked by: corruption" errors with:

{{FileBox
| filename=/usr/local/portage-crossdev/metadata/layout.conf|lang=text|1=
masters = gentoo
thin-manifests = true
}}

Then instruct Portage and crossdev to use this overlay:

{{FileBox
| filename=/etc/portage/repos.conf/crossdev.conf|lang=bash|1=
[local-crossdev]
location = /usr/local/portage-crossdev
priority = 10
masters = gentoo
auto-sync = no
}}
