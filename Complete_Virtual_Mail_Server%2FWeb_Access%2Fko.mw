<languages/>

== 도입부 ==

전자메일 기능 중에 가장 많이 사용하는 기능은 웹 메일 접근입니다. 일부 사용자는 접속할 때 웹메일만 사용하지만, 다른 어떤 사용자의 경우는 백업 용도로 사용하든지 사용자 자신이 보유한 시스템을 못쓸 때 사용합니다. 여러 선택지가 있는데, 그 중에 가장 많이 쓰는건 {{Package|mail-client/squirrelmail}}과 {{Package|mail-client/roundcube}}입니다. Squirrelmail은 대역폭(통신량)이 너무 클때 사용할 수 있고, roundcude는 그밖의 경우에 추천하며, 이 글에서는 roundcube를 중점적으로 다룹니다.

== roundcube 설치 ==

Roundcube에는 데이터베이스에 설정을 저장할 수 있습니다. 로컬 주소록, 신원 정보 등 여러가지 정보도 마찬가지로 저장할 수 있습니다.

Here there are several options available. Use a local, per vhost based SQLite storage pool, use a postgres/mysql database per vhost or have all vhosts share the same database. There can be advantages for any of the above options. If webmail, for various domains, is on the same host as the imap server, then using one database for all domains is fine and can be an advantage. It could be desired that each domain, each vhost gets its own webmail interface (different skin and plugins) where all users could still log in. Meaning in the event of one of the vhosts webmail being broken, they can still access their e-mail normally using a different vhost. Whether the users settings 'live' in all vhosts or not, is based on the imap server. Roundcube bases its user id on the <code>mail_host</code> e.g. the imap server and thus when using localhost the user 'profile' is identical everywhere.

{{USEflag
|ldap+
|mysql+yes
|postgres+
|spell+
|sqlite
|ssl+yes
|vhosts+
}}

{{Note|Only postgres or mysql is required when not using SQLite.}}

After choosing the appropiate USE flags, roundcube should be emerged:

{{Emerge|mail-client/roundcube}}

This only installs roundcube to the host, but not into the vhost.

{{RootCmd|webapp-config -I -h webmail.example.com -d roundcube roundcube 1.0.5}}

=== Using Postgres ===

Unless there is some serious security concern, only one database user is required to access all databases used by roundcube:

{{RootCmd|createuser -U postgres -D -P -R -S roundcube|output=<pre>
Enter password for new role: $password
Enter it again: $password
</pre>}}

Roundcube will also need a database. Different names will have to be chosen when using different databases per domain:

{{RootCmd|createdb -U postgres roundcubemail -O roundcube}}

{{Note|Having roundcube in a separate directory is incredibly useful. Installing (and testing) a second webmail client, for example, or migrating to a new one, can be so much easier having it on the same host. However, the standard URL, webmail.example.com won't open up roundcube anymore. To fix this, create the following file as index.php in the root of htdocs directory.
{{FileBox|filename=index.php|1=<pre>
<?php
	header("Location: roundcube/");
?>
</pre>}}
}}

== Configuring Roundcube ==

Configuring roundcube has become incredible easy. Just visit http://webmail.example.com/roundcube/installer/ and follow the on screen instructions, correcting any issues as they pop up.

Below are the old instructions when manually creating the {{Path|config.inc.php}} file. The installer should still be used to create the database, which it has a button for.

=== Configuring Roundcube (manually) ===

Configuring roundcube is as simple as editing two configuration files in {{Path|/var/www/webmail.example.com/htdocs/roundcube/config/}}.

To access the database only the following line needs to be changed. The user name chosen earlier is ''roundcube''.  Replace ''pass'' in this line with the password chosen earlier:

{{FileBox|filename=/var/www/webmail.example.com/htdocs/roundcube/config/db.inc.php|title=Database access|lang=php|1=
$rcmail_config['db_dsnw'] = 'pgsql://roundcube:pass@localhost/roundcubemail';
}}

Next listed are the essential changes required for roundcube operation. More can be done to personalize the setup:

{{FileBox|filename=/var/www/webmail.example.com/htdocs/roundcube/config/main.inc.php|title=Roundcube configuration|lang=diff|1=
-$rcmail_config['default_host'] = '';
+$rcmail_config['default_host'] = 'localhost';
 
-$rcmail_config['smtp_server'] = '';
+$rcmail_config['smtp_server'] = 'localhost';
 
 // SMTP username (if required) if you use %u as the username Roundcube
 // will use the current username for login
+$rcmail_config['smtp_user'] = '';
-$rcmail_config['smtp_user'] = '%u';
 
 // SMTP password (if required) if you use %p as the password Roundcube
 // will use the current user's password for login
-$rcmail_config['smtp_pass'] = '';
+$rcmail_config['smtp_pass'] = '%p';
 
 // this key is used to encrypt the users imap password which is stored
 // in the session record (and the client cookie if remember password is enabled).
 // please provide a string of exactly 24 chars.
-$rcmail_config['des_key'] = 'rcmail-!24ByteDESkey*Str';
+$rcmail_config['des_key'] = '$supersecret24bytestring';
}}

Starting with Roundcube version 0.6, Roundcube needs to have the fully qualified names for the default storage folders, such as Trash, Drafts etc:

{{FileBox|filename=/var/www/webmail.example.com/htdocs/roundcube/config/main.inc.php|title=Setup fully qualified folder names|lang=diff|1=
// NOTE: Use folder names with namespace prefix (INBOX. on Courier-IMAP)
-$rcmail_config['drafts_mbox'] = 'Drafts';
+$rcmail_config['drafts_mbox'] = 'INBOX.Drafts';
 
// NOTE: Use folder names with namespace prefix (INBOX. on Courier-IMAP)
-$rcmail_config['junk_mbox'] = 'Junk';
+$rcmail_config['junk_mbox'] = 'INBOX.Junk';
 
// NOTE: Use folder names with namespace prefix (INBOX. on Courier-IMAP)
-$rcmail_config['sent_mbox'] = 'Sent';
+$rcmail_config['sent_mbox'] = 'INBOX.Sent';
 
// NOTE: Use folder names with namespace prefix (INBOX. on Courier-IMAP)
-$rcmail_config['trash_mbox'] = 'Trash';
+$rcmail_config['trash_mbox'] = 'INBOX.Trash';
 
// NOTE: Use folder names with namespace prefix (INBOX. on Courier-IMAP)
-$rcmail_config['default_imap_folders'] = array('INBOX', 'Drafts', 'Sent', 'Junk', 'Trash');
+$rcmail_config['default_imap_folders'] = array('INBOX', 'INBOX.Drafts', 'INBOX.Sent', 'INBOX.Junk', 'INBOX.Trash');
}}

== Testing roundcube ==

Log into webmail via http://webmail.example.com/ and the test mailbox should show. Also sending mail should be working correctly.

[[Category:Mail Servers]]
