The Libre Computer Renegade is an ARMv8-A (Cortex-A53) based single board computer. It's essentially a relabeled Firefly ROC-RK3328-CC.

== Hardware ==

{| class="table table-condensed table-striped" style="width: auto;"
! scope="col" width="15%" | Device
! scope="col" width="20%" | Make/model
! scope="col" width="10%" | Status
! scope="col" width="10%" | Kernel driver(s)
! scope="col" width="10%" | Kernel version
! scope="col" width="40%" | Notes
|-
| SoC
| Rockchip RK3328
| {{Partial|Works}}
|
| 4.20
|
|-
| CPU
| 4 x ARM Cortex-A53
| {{Partial|Works}}
|
| 4.20
| current max @1,3GHz, specified max @1,4GHz
|-
| GPU
| 2G + 2P Mali-450
| {{Partial|WIP}}
| Lima
| 5.2
| [https://gitlab.freedesktop.org/lima/web/wikis/home Status], specified max @500MHz
|-
| Board
| ROC-RK3328-CC
| {{Yes|N/A}}
|
| 4.20
| rk3328-roc-cc.dtb (filename of device tree binary)
|-
| RAM
| DDR4 2GB/4GB
| {{Yes|Works}}
|
| 4.20
| 4GB recommended
|-
| LAN
| RTL8XXX
| {{Yes|Works}}
| STMicroelectronics
| 4.20
| 1 GBit
|-
| USB 2.0
| 
| {{Partial}}
|
| 4.20
| 1 of the 2 ports works
|-
| USB 3.0
|
| {{No}}
|
| 5.2
| 1 port
|-
| HDMI
|
| {{Yes|Works}}
|
| 4.20
| xorg-server via fbdev works
|-
| Analog Audio
| I2S
| {{No}}
|
| 5.2
|
|-
| Storage
| eMMC or SDXC
| {{Yes|Works}}
|
| 4.20
| supports eMMC 5.0
|}

== What works and what doesn't ==

{| class="wikitable"
|-
! !! On >=sys-kernel/gentoo-sources-5.2
|-
| '''Suspend/Resume''' || untested
|-
| '''LAN''' || works
|-
| '''X''' || works
|-
| '''HDMI''' || works
|-
| '''Analog audio''' || no
|-
| '''HDMI-Audio''' || untested
|-
| '''GPU hardware acceleration''' || partial ([https://gitlab.freedesktop.org/lima/web/wikis/home Lima], WIP)
|}

== Installing Gentoo ==
See [[Libre Computer Renegade/Installing Gentoo]] for instructions on how to install Gentoo on the Libre Computer Renegade.

== Software development kit ==

The parts of Firefly's Linux SDK that are essential to get started with the Libre Computer Renegade can be obtained and installed as follows<ref>Firefly Team, [https://roc-rk3328-cc.readthedocs.io/en/latest/linux_compile_firmware.html Compiling linux firmware], [https://roc-rk3328-cc.readthedocs.io/en/latest ROC-RK3328-CC Manual]. Retrieved on May 31st, 2019</ref>:

First, assemble the DDR init binary {{Path|rk3328_loader_ddr786_v1.06.243.bin}} needed for flashing to the eMMC:

{{Cmd
|git clone -b roc-rk3328-cc https://github.com/FireflyTeam/u-boot
|git clone -b debian https://github.com/FireflyTeam/build
|git clone -b master https://github.com/FireflyTeam/rkbin
|./build/mk-uboot.sh roc-rk3328-cc
}}

Then install rkdeveloptool:

{{Cmd
|git clone https://github.com/rockchip-linux/rkdeveloptool
|./build/mk-uboot.sh roc-rk3328-cc
|cd rkdeveloptool
|autoreconf -i
|./configure
|make
}}
{{RootCmd
|make install
}}

== Maskrom Mode ==

To be able to flash to an eMMC installed on the Libre Computer Renegade the latter needs to be forced into the so called {{c|Maskrom Mode}}<ref>Firefly Team, [https://roc-rk3328-cc.readthedocs.io/en/latest/flash_emmc.html#maskrom-mode Flashing to the eMMC - Maskrom Mode], [https://roc-rk3328-cc.readthedocs.io/en/latest ROC-RK3328-CC Manual]. Retrieved on Jun 1st, 2019</ref>:

*Pull all the USB cables (including micro USB cable and male to male USB cable) out of the board to keep the board powered off and if applicable pull out the SD card
*Use a male to male USB cable to connect the host system and the USB OTG port (lower one of double-decker, white) of the target device, for pictures see the [https://roc-rk3328-cc.readthedocs.io/en/latest/flash_emmc.html#maskrom-mode ROC-RK3328-CC Manual]
*Connect the eMMC {{c|CLK}} and {{c|GND}} pads with metal tweezers while plugging in the micro USB cable to power on the board. Wait about 1 second before breaking the connection of the two pads

== Flashing to eMMC ==

With rkdeveloptool data (in the following example the {{c|INPUT_FILE}}), can be flashed to an arbitrary offset ({{c|0x0}} in the example) on an eMMC installed on the Libe Computer Renegade<ref>Firefly Team, [https://roc-rk3328-cc.readthedocs.io/en/latest/flash_emmc.html#rkdeveloptool Flashing to the eMMC - rkdeveloptool], [https://roc-rk3328-cc.readthedocs.io/en/latest ROC-RK3328-CC Manual]. Retrieved on Jun 1st, 2019</ref>:

{{RootCmd
|rkdeveloptool db      out/u-boot/rk3328_loader_ddr786_v1.06.243.bin
|rkdeveloptool wl 0x0  INPUT_FILE
|rkdeveloptool rd
}}

== Recovery ==

If a kernel upgrade goes wrong and a backup is at hand the boot partition can be restored by forcing the device into {{c|Maskrom Mode}} and flashing the backup boot partition to the eMMC:

{{RootCmd
|rkdeveloptool db         out/uboot/rk3328_loader_ddr786_v1.06.243.bin
|rkdeveloptool wl 0x8000  /PATH/TO/ARBITRARY_BACKUP_LOCATION/rk3328-roc-cc-boot.img
|rkdeveloptool rd
}}

== Recommended partition layout with offsets ==

{| class="wikitable"
|-
! !! Purpose !! Start (Bytes) !! End (Bytes) !! Size (Bytes) !! Partition Offset<ref>[http://opensource.rock-chips.com/wiki_Partitions Default storage map], [http://opensource.rock-chips.com/wiki_Main_Page Rockchip wiki]. Retrieved on Jun 1st, 2019</ref>
|-
| Partition 1 || preloader (miniloader or U-Boot SPL) || 32768 || 4128767 || 4096000 || 0x40
|-
| Partition 2 || U-Boot || 8388608 || 12582911 || 4194304 || 0x4000
|-
| Partition 3 || trusted OS (atf) || 12582912 || 16777215 || 4194304 || 0x6000
|-
| Partition 4 || boot partition || 16777216 || 134217727 || 117440512 || 0x8000
|-
| Partition 5 || root partition || 134217728 || arbitrary || depends || 0x40000
|}

== References ==

[[Category:Embedded systems]]
