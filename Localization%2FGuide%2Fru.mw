<languages />

{{Metadata|abstract=This guide should help users localize their Gentoo Linux distribution to any European locale. It uses Germany as a case-study, since it is translated from the German doc. Includes configuration for use of the euro currency symbol.}}

== Часовой пояс ==

Для того чтобы сохранить время в соответствии с вашим месторасположением нужно настроить часовой пояс. Инструкции как сделать это для [[System_time/ru#OpenRC|OpenRC]] и [[System_time/ru#systemd|systemd]] можно найти в статье [[System_time/ru|системное время]].

== Системная локаль ==

=== Что такое локаль? ===

A locale is a set of information that most programs use for determining country and language specific settings. The locales and their data are part of the system library and can be found at {{Path|/usr/share/i18n/locales/}} on most systems. A locale name is generally named <code>ab_CD</code> where <code>ab</code> is your two (or three) letter language code (as specified in ISO-639) and <code>CD</code> is your two letter country code (as specified in ISO-3166). Variants are often appended to locale names, e.g. <code>en_GB.UTF-8</code> or <code>de_DE@euro</code>. Please explore [http://en.wikipedia.org/wiki/Locale Wikipedia] to read more about locales and related articles.

=== Переменное окружение локали ===

Переменные, контролирующие различные аспекты настроек локали приведены в таблице ниже. Все они принимают одно  из имен локали в формате <code>ab_CD</code> о котором рассказывалось ранее. 

{| class="table table-striped" style="text-align: left;" 
|- 
! scope=col width=25% | Название переменной
! scope=col width=75% | Описание
|- 
| <var>LANG</var>
| Defines all locale settings at once, while allowing further individual customization via the LC_* settings below.
|- 
| <var>LC_COLLATE</var>
| Define alphabetical ordering of strings. This affects e.g. output of sorted directory listing.
|- 
| <var>LC_CTYPE</var>
| Define the character handling properties for the system. This determines which characters are seen as part of alphabet, numeric and so on. This also determines the character set used, if applicable.
|- 
| <var>LC_MESSAGES</var>
| Programs' localizations stored in {{Path|/usr/share/locale/}} for applications that use message based localization scheme (majority of Gnu programs, see next chapters for closer information which do, and how to get the programs, that don't, to work).
|- 
| <var>LC_MONETARY</var>
| Defines currency units and formatting of currency type numeric values.
|- 
| <var>LC_NUMERIC</var>
| Defines formatting of numeric values which aren't monetary. Affects things such as thousand separator and decimal separator.
|- 
| <var>LC_TIME</var>
| Defines formatting of dates and times.
|- 
| <var>LC_PAPER</var>
| Defines default paper size.
|- 
| <var>LC_ALL</var>
| A special variable for overriding all other settings.
|-
|}

{{Note|Некоторые программы написаны таким образом, что ожидают традиционный английский порядок алфавита, в то время как некоторые другие локали, одна из них Эстонская, используйте другой порядок. Поэтому рекомендуется явно установить <var>LC_COLLATE</var> в C при работе с общесистемными настройками.}}

{{Warning|Using <var>LC_ALL</var> is strongly discouraged as it automatically overrides all other <var>LC_*</var> variables (<var>LANG</var> is not affected). This means that changes made by other means will be hidden until <var>LC_ALL</var> is set to a null string. It is probably best not to set it in a startup file.}}

Most typically users only set the <var>LANG</var> variable on the global basis.

=== Генерация нужных локалей ===

Скорей всего вам требуется одна или две локали для вашей системы. Вы можете перечислить нужные вам локали в {{Path|/etc/locale.gen}}. 

{{CodeBox|title=Добавление локалей в /etc/locale.gen|1=
en_GB ISO-8859-1
en_GB.UTF-8 UTF-8
de_DE ISO-8859-1
de_DE@euro ISO-8859-15
}}

Далее запустите {{c|locale-gen}}. Это сгенерирует все локали перечисленные в файле {{Path|/etc/locale.gen}} и запишет их в архив локалей ({{Path|/usr/lib/locale/locale-archive}}). 

{{RootCmd|locale-gen|output=<pre>
 * Generating 4 locales (this might take a while) with 1 jobs
 *  (1/4) Generating en_GB.ISO-8859-1 ...                       [ ok ]
 *  (2/4) Generating en_GB.UTF-8 ...                            [ ok ]
 *  (3/4) Generating de_DE.ISO-8859-1 ...                       [ ok ]
 *  (4/4) Generating de_DE.ISO-8859-15@euro ...                 [ ok ]
 * Generation complete
</pre>}}

{{Note|{{c|locale-gen}} доступен с <code>glibc-2.3.6-r4</code> и выше. Если у вас старая версия glibc обновите ее сейчас.}}

Можно проверить какие локали доступны запустив {{c|locale -a}}.

{{Cmd|locale -a|output=<pre>
C
POSIX
de_DE
de_DE.iso88591
de_DE.iso885915@euro
de_DE@euro
deutsch
en_GB
en_GB.iso88591
en_GB.utf8
german
</pre>}}

Просмотреть файл {{Path|/usr/lib/locale/locale-archive}} можно с помощью команды {{c|strings}}.

{{Cmd|strings /usr/lib/locale/locale-archive {{!}} less}}

=== Настройка локали ===

==== OpenRC ==== 

Когда используется OpenRC настройки локали сохраняются в переменном окружении. Они, как правило, настраиваются в {{Path|/etc/env.d/02locale}} (для всей системы) и {{Path|~/.bashrc}} (для конкретного пользователя) файлах. Больше информации можно найти в статье [[UTF-8/ru#Настройка локали|UTF-8]]. Системные настройки локали ({{Path|/etc/env.d/02locale}}) можно изменять с помощью {{c|eselect locale}}. Например, так можно установить <var>LANG</var> в значение <code>C</code>:

{{RootCmd|eselect locale list|output=<pre>
Available targets for the LANG variable:
  [1]   C 
  [2]   POSIX
  [3]   en_US
  [4]   en_US.iso885915
  [5]   en_US.utf8
  [ ]   (free form)
</pre>}}

{{RootCmd|eselect locale set 1}}

Конечно, вы можете отредактировать файл вручную и более точно настроить переменные для локали.

{{FileBox|filename=/etc/env.d/02locale|title=Настройка системной локали в файле /etc/env.d/02locale|lang=bash|1=
LANG="de_DE.UTF-8"
LC_COLLATE="C"
}}

{{Note|Use <code>de_DE@euro</code> as your LANG if you want to use the Euro currency symbol (â‚¬) on non UTF-8 based locales.}}

It's also possible, and pretty common especially in a more traditional UNIX environment, to leave the global settings unchanged, i.e. in the "<code>C</code>" locale. Users can still specify their preferred locale in their own shell RC file: 

{{FileBox|filename=~/.bashrc|title=Настройка локали для пользователя|lang=bash|1=
export LANG="ru_RU.utf8"
export LC_COLLATE="C"
}}

Another way of configuring system is to leave it in the default C locale, but enable UTF-8 character representation at the same time. This option is achieved using the following settings in {{Path|/etc/env.d/02locale}}: 

{{CodeBox|title=Using traditional C locale while specifying UTF-8|lang=bash|1=
LC_CTYPE=de_DE.UTF-8
}}

Using the above snippet, users will be able to see localized file names properly, while not being forced to your preferred language. 

После того, как вы настроили нужную локаль, не забудьте обновить переменное окружение, чтобы ваша система была вкурсе изменений.

Для общистемной локали:

{{RootCmd|env-update && source /etc/profile}}

Для пользовательской локали:

{{Cmd|source ~/.bashrc}}

После этого убейте процесс X-сервера нажав {{Key|Ctrl}}+{{Key|Alt}}+{{Key|Backspace}}, выйдите из системы, а затем зайдите под учетною записью пользователя. 

Теперь, убедитесь, что изменения вступили в силу: 

{{Cmd|locale}}

==== systemd ====

If you use systemd set locale with the {{c|localectl}} command. Check the list of available locales with:

{{RootCmd|localectl list-locales}}

Then set the desired locale:

{{RootCmd|<nowiki>localectl set-locale LANG=de_DE.utf8</nowiki>}}

Finally check if the result is good:

{{RootCmd|<nowiki>localectl | grep "System Locale"</nowiki>|output=<pre>
   System Locale: LANG=de_DE.utf8
</pre>}}

== Раскладка клавиатуры для консоли ==

=== OpenRC ===

The keyboard layout used by the console is set in {{Path|/etc/conf.d/keymaps}} by the <var>keymap</var> variable. Valid values can be found in {{Path|/usr/share/keymaps/YOUR_ARCH/}}. {{Path|i386}} has further subdivisions into layout ({{Path|qwerty/}}, {{Path|azerty/}}, etc.). Some languages have multiple options, so you may wish to experiment to decide which one fits your needs best. 

{{FileBox|filename=/etc/conf.d/keymaps|title=Setting the console keymap|lang=bash|1=
keymap="de"
#keymap="de-latin1"
#keymap="de-latin1-nodeadkeys"
}}

=== systemd ===

With systemd the keymap layout used for your console can be set using the {{c|localectl}} command. First check the available keymap layouts:

{{RootCmd|localectl list-keymaps}}

Then set the console keymap layout you want:

{{RootCmd|localectl set-keymap it}}

Finally check if the console keymap layout was set correctly:

{{RootCmd|<nowiki>localectl | grep "VC Keymap"</nowiki>|output=<pre>
       VC Keymap: it
</pre>}}

== Раскладка клавиатуры для X сервера ==

=== OpenRC ===

The keyboard layout to be used by the X server is specified in {{Path|/etc/X11/xorg.conf.d/30-keyboard.conf}} by the <var>XkbLayout</var> option. For details visit the [[Xorg/Guide#Configuring_the_keyboard|Xorg guide]].

=== systemd ===

With systemd the keymap layout for the X11 server can be set using the {{c|localectl}} command. First check the available X11 keymap layouts:

{{RootCmd|localectl list-x11-keymap-layouts}}

Then set the X11 keymap layout you want:

{{RootCmd|localectl set-x11-keymap it}}

Finally check if the X11 keymap layout was set correctly:

{{RootCmd|<nowiki>localectl | grep "X11 Layout"</nowiki>|output=<pre>
      X11 Layout: it
</pre>}}

== The Euro symbol for the console ==

=== OpenRC ===

In order to get your console to display the Euro symbol, you will need to set the <var>consolefont</var> variable in {{Path|/etc/conf.d/consolefont}} to a file found in {{Path|/usr/share/consolefonts/}} (without the <code>.psfu.gz</code>). <code>lat9w-16</code> has the Euro symbol. 

{{FileBox|filename=/etc/conf.d/consolefont|title=Setting the console font|lang=bash|1=
consolefont="lat9w-16"
}}

You should verify that the {{c|consolefont}} service is in the boot runlevel: 

{{RootCmd|rc-update -v show {{!}} grep consolefont}}

If no runlevel is displayed for {{c|consolefont}}, then add it to the proper level: 

{{RootCmd|rc-update add consolefont boot}}

== The Euro symbol in X ==

=== Most applications ===

Getting the Euro symbol to work properly in X is a little bit tougher. The first thing you should do is change the <var>fixed</var> and <var>variable</var> definitions in {{Path|/usr/share/fonts/misc/fonts.alias}} to end in <code>iso8859-15</code> instead of <code>iso8859-1</code>. 

{{CodeBox|filename=/etc/X11/xorg.conf|title=Setting default X fonts|1=
fixed        -misc-fixed-medium-r-semicondensed--13-120-75-75-c-60-iso8859-15
variable     -*-helvetica-bold-r-normal-*-*-120-*-*-*-*-iso8859-15
}}

Some applications use their own font, and you will have to tell them separately to use a font with the Euro symbol. You can do this at a user-specific level in {{Path|.Xdefaults}} (you can copy this file to {{Path|/etc/skel/}} for use by new users), or at a global level for any application with a resource file in {{Path|/usr/share/X11/app-defaults/}} (like xterm). In these files you generally have to change an existing line, rather than adding a new one. To change our xterm font, for instance: 

{{Cmd|echo 'XTerm*font: fixed' >> ~/.Xresources 
|xrdb -merge ~/.Xresources}}

=== The Euro symbol in (X)Emacs ===

To use the Euro symbol in (X)Emacs, add the following to {{Path|.Xdefaults}} : 

{{FileBox|filename=~/.Xdefaults|title=Setting the font for emacs|1=
Emacs.default.attributeFont: -*-courier-medium-r-*-*-*-120-*-*-*-*-iso8859-15
}}

For XEmacs (not plain Emacs), you have to do a little more. In {{Path|/home/user/.xemacs/init.el}} , add: 

{{FileBox|filename=~/.xemacs/init.el|title=Setting the font for xemacs|1=
(define-key global-map '(EuroSign) '[€])
}}

== NLS ==

For message based localization to work in programs that support it and have the <code>nls</code> (Native language support) USE flag, you will probably need to have the programs compiled with this flag set. Message strings are installed in {{Path|/usr/share/locale/<locale>/LC_MESSAGES/<package>.mo}} files. Most of the programs using nls also need the gettext library to extract and use localized messages. Of course, Portage will automatically install it when needed.

After enabling the <code>nls</code> USE flag you may need to re-emerge some packages:

{{Emerge|params+=--newuse --deep --with-bdeps=y|@world}}

== LINGUAS ==

There is also an additional localization variable called <var>[https://devmanual.gentoo.org/general-concepts/linguas/ LINGUAS]</var>, which affects the localization files that get installed in gettext-based programs, and decides which GUI language packs should be downloaded and installed for some specific software packages, such as [[Firefox]], [[Thunderbird]], [[KDE#Localization|kde-base/kde-l10n]] or [[LibreOffice|app-office/libreoffice-l10n]]. The variable takes in ''space''-separated list of language codes, and a suggested place to set it is {{Path|[[:/etc/portage/make.conf]]}}: 

{{RootCmd|nano -w /etc/portage/make.conf|output=<pre>
## (Add in the LINGUAS variable. For instance, for German, Finnish and English:)
LINGUAS="de fi en"
</pre>}}

With <code>LINGUAS=""</code>, most ebuilds would install only the packages' default language but none of the <code>LC_MESSAGES</code> files. They would also not download and install any of the further language packs. For instance, the currently stable [[LibreOffice|app-office/libreoffice]] receives further language support through {{Package|app-office/libreoffice-l10n}} which supports download and installation of the language packs defined in <code>LINGUAS</code>. Since the origin language of libreoffice is <code>en_US</code>, it does not have <code>en_US</code> flag in {{Package|app-office/libreoffice-l10n}}. So with <code>LINGUAS=""</code>, libreoffice still supports <code>en_US</code>.

To see the status of GUI translation, hyphenation, spell checking and other localisations on your language, please refer to the [https://translations.documentfoundation.org/ LibreOffice translation web site].

For finer grained control it can be set per package in {{Path|[[:/etc/portage/package.use]]}}: 

{{FileBox|filename=/etc/portage/package.use|lang=bash|1=
www-client/firefox linguas_de linguas_pt_BR linguas_en_GB
}}

A list of installed programs making use of the <var>LINGUAS</var> variable and their supported languages can be shown as follows:

{{Cmd|eix -I -U linguas}}

A list of <var>LINGUAS</var> values that can be used is provided as {{Path|/usr/portage/profiles/desc/linguas.desc}}: 

{{Cmd|grep -i french /usr/portage/profiles/desc/linguas.desc|output=<pre>
fr - French locale
fr_CA - French locale for Canada
fr_FR - French locale for France
</pre>
}}

After setting the <code>linguas</code> USE flag it may be necessary to re-emerge some packages:

{{Emerge|params+=--newuse --deep --with-bdeps=y|@world}}

== Смотрите также ==


* [[Handbook:AMD64/Installation/Base#Configure_locales|Configuring locales]] (Gentoo Handbooks)
* [[Evdev#Keyboard_layout|Keyboard layout]] inside the Evdev article
* [[X resources]]

== Ссылки == 

* [http://www.gnu.org/software/libc/manual/html_node/Locales.html Локализация и интернационализация] (gnu.org)

[[Category:Localization]] {{Migrated|originalauthors=Alexander Holler, Steven Lucy, Benny Chuang, Lars Weiler, Tobias Scherbaum, Flammie Pirinen, nightmorph, klondike}}
