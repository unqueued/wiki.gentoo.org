<languages />

{{Metadata|abstract=Это руководство должно помочь пользователям локализовать их дистрибутив Gentoo Linux с помощью любой известной локали. В этом руководстве используется немецкий язык в качестве тематического исследования, так как этот документ в переводе с немецкого языка. Также описывается конфигурация для использования символа валюты евро.}}

== Часовой пояс ==

Для того чтобы сохранить время в соответствии с вашим месторасположением нужно настроить часовой пояс. Инструкции как сделать это для [[System_time/ru#OpenRC|OpenRC]] и [[System_time/ru#systemd|systemd]] можно найти в статье [[System_time/ru|системное время]].

== Системная локаль ==

=== Что такое локаль? ===

A locale is a set of information that most programs use for determining country and language specific settings. The locales and their data are part of the system library and can be found at {{Path|/usr/share/i18n/locales/}} on most systems. A locale name is generally named <code>ab_CD</code> where <code>ab</code> is the two (or three) letter language code (as specified in [[wikipedia:ISO_639|ISO-639]]) and <code>CD</code> is the two letter country code (as specified in [[wikipedia:ISO_3166|ISO-3166]]). Variants like <code>@euro</code> or <code>@latin</code> are often appended to locale names, e.g. <code>de_DE@euro</code> or <code>nan_TW@latin</code>. Please explore [[wikipedia:Locale_(computer_software)|wikipedia]] to read more about locales and related articles.

=== Переменное окружение локали ===

Переменные, контролирующие различные аспекты настроек локали приведены в таблице ниже. Все они принимают одно  из имен локали в формате <code>ab_CD</code> о котором рассказывалось ранее. 

{| class="table table-striped" style="text-align: left;" 
|- 
! scope=col width=25% | Название переменной
! scope=col width=75% | Описание
|- 
| <var>LANG</var>
| Определяет все настройки локали сразу, при этом дальнейшую индивидуальную настройку можно настроить через LC_ * настройки ниже.
|- 
| <var>LC_COLLATE</var>
| Определяет порядок следование алфавита. Эта настройка повлияет, например, как будет отображаться отсортированный список каталога.
|- 
| <var>LC_CTYPE</var>
| Определяет свойства обрабатываемых символов для системы. Это определяет, какие символы рассматриваются как часть алфавита, цифры и так далее. Это также определяет используемый набор символов, если это применимо.
|- 
| <var>LC_MESSAGES</var>
| Programs' localizations stored in {{Path|/usr/share/locale/}} for applications that use message based localization scheme (majority of Gnu programs, see next chapters for closer information which do, and how to get the programs, that don't, to work).
|- 
| <var>LC_MONETARY</var>
| Defines currency units and formatting of currency type numeric values.
|- 
| <var>LC_NUMERIC</var>
| Defines formatting of numeric values which aren't monetary. Affects things such as thousand separator and decimal separator.
|- 
| <var>LC_TIME</var>
| Определяет формат даты и времени.
|- 
| <var>LC_PAPER</var>
| Определяет размер листа, который будет использоватся по умолчанию.
|- 
| <var>LC_ALL</var>
| Специальная переменная, которая переопределяет все другие переменные.
|-
|}

{{Note|Некоторые программы написаны таким образом, что ожидают традиционный английский порядок алфавита, в то время как некоторые другие локали, одна из них Эстонская, использует другой порядок. Поэтому рекомендуется явно установить <var>LC_COLLATE</var> в C при работе с общесистемными настройками.}}

{{Warning|Using <var>LC_ALL</var> is strongly discouraged as it automatically overrides all other <var>LC_*</var> variables (<var>LANG</var> is not affected). This means that changes made by other means will be hidden until <var>LC_ALL</var> is set to a null string. It is probably best not to set it in a startup file.}}

Наиболее типично, когда пользователи задают только <var>LANG</var> глобально.

=== Генерация нужных локалей ===

Большинству пользователей скорей всего потребуется одна или две локали для их системы. Добавление дополнительных локалей указывается в файле {{Path|/etc/locale.gen}}. 

{{CodeBox|title=Добавление локалей в /etc/locale.gen|1=
en_GB ISO-8859-1
en_GB.UTF-8 UTF-8
de_DE ISO-8859-1
de_DE@euro ISO-8859-15
}}

{{Note|Use an <code>@euro</code> value from {{Path|/usr/share/i18n/SUPPORTED/}} as the locale when using the Euro currency symbol (€) on non UTF-8 based locales.}}

Далее запустите {{c|locale-gen}}. Это сгенерирует все локали перечисленные в файле {{Path|/etc/locale.gen}} и запишет их в архив локалей ({{Path|/usr/lib/locale/locale-archive}}). 

{{RootCmd|locale-gen|output=<pre>
 * Generating 4 locales (this might take a while) with 1 jobs
 *  (1/4) Generating en_GB.ISO-8859-1 ...                       [ ok ]
 *  (2/4) Generating en_GB.UTF-8 ...                            [ ok ]
 *  (3/4) Generating de_DE.ISO-8859-1 ...                       [ ok ]
 *  (4/4) Generating de_DE.ISO-8859-15@euro ...                 [ ok ]
 * Generation complete
</pre>}}

Убедитесь в том, что выбранные локали действительно доступны, запустив {{c|locale -a}}.

{{Cmd|locale -a|output=<pre>
C
POSIX
de_DE
de_DE.iso88591
de_DE.iso885915@euro
de_DE@euro
deutsch
en_GB
en_GB.iso88591
en_GB.utf8
german
</pre>}}

Просмотреть файл {{Path|/usr/lib/locale/locale-archive}} можно с помощью команды {{c|localedef}}.

{{Cmd|localedef --list-archive}}

Его содержимое без изменений можно отобразить с помощью команды {{c|strings}}.

{{Cmd|strings /usr/lib/locale/locale-archive {{!}} less}}

=== Настройка локали ===

==== OpenRC ==== 

Когда используется OpenRC настройки локали сохраняются в переменном окружении. Они, как правило, настраиваются в {{Path|/etc/env.d/02locale}} (для всей системы) и {{Path|~/.bashrc}} (для конкретного пользователя) файлах. Больше информации можно найти в статье [[UTF-8/ru#Настройка локали|UTF-8]]. Системные настройки локали ({{Path|/etc/env.d/02locale}}) можно изменять с помощью {{c|eselect locale}}. Например, так можно установить <var>LANG</var> в значение <code>C</code>:

{{RootCmd|eselect locale list|output=<pre>
Available targets for the LANG variable:
  [1]   C 
  [2]   POSIX
  [3]   en_US
  [4]   en_US.iso885915
  [5]   en_US.utf8
  [ ]   (free form)
</pre>}}

{{RootCmd|eselect locale set 1}}

Конечно, можно отредактировать файл вручную для более точной настройки переменных локали.

{{FileBox|filename=/etc/env.d/02locale|title=Настройка системной локали в файле /etc/env.d/02locale|lang=bash|1=
LANG="de_DE.UTF-8"
LC_COLLATE="C"
}}

It's also possible, and pretty common especially in a more traditional UNIX environment, to leave the global settings unchanged, i.e. in the "<code>C</code>" locale. Users can still specify their preferred locale in their own shell RC file: 

{{FileBox|filename=~/.bashrc|title=Настройка локали для пользователя|lang=bash|1=
export LANG="de_DE.UTF-8"
export LC_COLLATE="C"
}}

Another way of configuring system is to leave it in the default C locale, but enable UTF-8 character representation at the same time. This option is achieved using the following settings in {{Path|/etc/env.d/02locale}}: 

{{CodeBox|title=Using traditional C locale while specifying UTF-8|lang=bash|1=
LC_CTYPE=de_DE.UTF-8
}}

Using the above snippet, users will be able to see localized file names properly, while not being forced to completely use the selected language. 

После того, как настроите нужную локаль, не забудьте обновить переменное окружение, чтобы система была в курсе изменений.

Для общесистемной локали:

{{RootCmd|env-update && source /etc/profile}}

Для пользовательской локали:

{{Cmd|source ~/.bashrc}}

После этого убейте процесс X-сервера нажав {{Key|Ctrl}}+{{Key|Alt}}+{{Key|Backspace}}, выйдите из системы, а затем зайдите под учетной записью пользователя. 

Теперь, убедитесь, что изменения вступили в силу: 

{{Cmd|locale}}

==== systemd ====

В systemd локаль настраивается с помощью команды {{c|localectl}}. Поверьте список доступных локалей:

{{RootCmd|localectl list-locales}}

Затем установите требуемую локаль:

{{RootCmd|<nowiki>localectl set-locale LANG=de_DE.utf8</nowiki>}}

И в конце проверьте результат:

{{RootCmd|<nowiki>localectl | grep "System Locale"</nowiki>|output=<pre>
   System Locale: LANG=de_DE.utf8
</pre>}}

== Раскладка клавиатуры для консоли ==

=== OpenRC ===

The keyboard layout used by the console is set in {{Path|/etc/conf.d/keymaps}} by the <var>keymap</var> variable. Valid values can be found in {{Path|/usr/share/keymaps/YOUR_ARCH/}}. {{Path|i386}} has further subdivisions into layout ({{Path|qwerty/}}, {{Path|azerty/}}, etc.). Some languages have multiple options - experiment with the various options to decide which one fits the needs best. 

{{FileBox|filename=/etc/conf.d/keymaps|title=Setting the console keymap|lang=bash|1=
keymap="de"
#keymap="de-latin1"
#keymap="de-latin1-nodeadkeys"
}}

=== systemd ===

В systemd раскладка для консоли может быть установлена с помощью команды {{c|localectl}}. Сперва проверьте доступные раскладки:

{{RootCmd|localectl list-keymaps}}

Далее установите необходимую раскладку для консоли:

{{RootCmd|localectl set-keymap it}}

В конце проверьте, что раскладка для консоли была установлена правильно:

{{RootCmd|<nowiki>localectl | grep "VC Keymap"</nowiki>|output=<pre>
       VC Keymap: it
</pre>}}

== Раскладка клавиатуры для X сервера ==

=== OpenRC ===

The keyboard layout to be used by the X server is specified in {{Path|/etc/X11/xorg.conf.d/30-keyboard.conf}} by the <var>XkbLayout</var> option. For details visit the [[Xorg/Guide#Configuring_the_keyboard|Xorg guide]] and the article about [[Keyboard_layout_switching#X11|Keyboard layout switching]].

=== systemd ===

В systemd раскладка для сервера X11 может быть установлена с помощью команды {{c|localectl}}. Сперва проверьте доступные раскладки для X11:

{{RootCmd|localectl list-x11-keymap-layouts}}

Далее установите необходимую раскладку для X11:

{{RootCmd|localectl set-x11-keymap it}}

В конце проверьте, что раскладка для X11 была установлена правильно:

{{RootCmd|<nowiki>localectl | grep "X11 Layout"</nowiki>|output=<pre>
      X11 Layout: it
</pre>}}

== NLS ==

For message based localization to work in programs that support it and have the [https://packages.gentoo.org/useflags/nls <code>nls</code> (Native language support) USE flag], compile the programs with this flag set. Message strings are installed in {{Path|/usr/share/locale/<locale>/LC_MESSAGES/<package>.mo}} files. Most of the programs using nls also need the gettext library to extract and use localized messages. Of course, Portage will automatically install it when needed.

After enabling the <code>nls</code> USE flag some packages might need to be re-emerged:

{{Emerge|params+=--changed-use --deep --with-bdeps=y|@world}}

== LINGUAS ==

There is also an additional <var>USE_EXPAND</var> flag called <var>[https://packages.gentoo.org/useflags/linguas_en LINGUAS]</var> <ref>[https://devmanual.gentoo.org/general-concepts/linguas/ LINGUAS] in Gentoo Development Guide</ref>, which affects the localization files that get installed in gettext-based programs, and decides which GUI language packs should be downloaded and installed for some specific software packages, such as [[Firefox]], [[Thunderbird]], [[KDE#Localization|kde-base/kde-l10n]] or [[LibreOffice|app-office/libreoffice-l10n]]. The variable takes in ''space''-separated list of language codes, and a suggested place to set it is {{Path|[[:/etc/portage/make.conf#LINGUAS|/etc/portage/make.conf]]}}: 

{{RootCmd|nano -w /etc/portage/make.conf|output=<pre>
## (Настройка переменной LINGUAS. Например, для германского, финского и английского:)
LINGUAS="de fi en"
</pre>}}

With <code>LINGUAS=""</code>, most ebuilds would install only the packages' default language but none of the <code>LC_MESSAGES</code> files. They would also not download and install any of the further language packs. For instance, the currently stable [[LibreOffice|app-office/libreoffice]] receives further language support through {{Package|app-office/libreoffice-l10n}} which supports download and installation of the language packs defined in <code>LINGUAS</code>. Since the origin language of libreoffice is <code>en_US</code>, it does not have <code>en_US</code> flag in {{Package|app-office/libreoffice-l10n}}. So with <code>LINGUAS=""</code>, libreoffice still supports <code>en_US</code>.

To see the status of GUI translation, hyphenation, spell checking and other localizations on the language, please refer to the [https://translations.documentfoundation.org/ LibreOffice translation web site].

For finer grained control the <var>USE_EXPAND</var> variables can be set per package in {{Path|[[:/etc/portage/package.use]]}}: 

{{FileBox|filename=/etc/portage/package.use|lang=bash|1=
www-client/firefox linguas_de linguas_pt_BR linguas_en_GB
}}

A list of installed programs making use of the <var>[https://packages.gentoo.org/useflags/linguas_en LINGUAS]</var> <var>USE_EXPAND</var> flag and their supported languages can be shown as follows:

{{Cmd|eix -I -U linguas}}

Список значений <var>LINGUAS</var>, которые возможно использовать предоставлен в {{Path|/usr/portage/profiles/desc/linguas.desc}}: 

{{Cmd|grep -i french /usr/portage/profiles/desc/linguas.desc|output=<pre>
fr - Французкая локаль
fr_CA - Французкая локаль для Канады
fr_FR - Французкая локаль для Франции
</pre>
}}

After setting the <var>[https://packages.gentoo.org/useflags/linguas_en LINGUAS]</var> <var>USE_EXPAND</var> flag it may be necessary to re-emerge some packages:

{{Emerge|params+=--changed-use --deep --with-bdeps=y|@world}}

== Смотрите также ==


* [[Handbook:AMD64/Installation/Base/ru#Настройка_локалей|Настройка локалей]] (Gentoo Handbooks)
* [[Evdev#Keyboard_layout|Keyboard layout]] в статье Evdev
* [[X resources]]
* [[Localization/Guide/The_Euro_symbol|The Euro symbol]] ([http://unicode-table.com/en/20AC/ €]) в консоли и X

== Внешние ресурсы == 

* [http://www.gnu.org/software/libc/manual/html_node/Locales.html Locales and Internationalization] (gnu.org)
* [https://blogs.gentoo.org/mgorny/2016/05/16/how-linguas-are-thrice-wrong/ Michał Górny:How LINGUAS are thrice wrong!]

== Ссылки ==

{{reflist}}


[[Category:Localization]] {{Migrated|originalauthors=Alexander Holler, Steven Lucy, Benny Chuang, Lars Weiler, Tobias Scherbaum, Flammie Pirinen, nightmorph, klondike}}
