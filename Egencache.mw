{{stub}}
{{InfoBox stack
|{{InfoBox gdoc|Portage|header=true}}
}}

'''egencache''' is a software tool that rebuilds metadata information for the Portage tree.

Metadata for the Portage tree comes included in Portage tarballs and can be re-downloaded with {{c|emerge --sync}}, but will not be downloaded when using cvs checkout as the Portage sync method.

== Installation ==

Since every Gentoo install comes with Portage by default, every system will also have {{c|egencache}} installed. Run a quick test by issuing the the <code>--help</code> option as seen in the [[#Usage|usage section]] below. If usage instructions are not displayed to the terminal there is certainly a problem. It is possible install Portage by [[Portage#Installation|following the installation instructions]].

== Usage ==

Use the <code>-h</code>/<code>--help</code> option to see the capabilities of {{c|egencache}}:

{{RootCmd|egencache --help|output=<pre>
usage: egencache [options] <action> ... [atom] ...

optional arguments:
  -h, --help            show this help message and exit

Actions:
  --update              update metadata/md5-cache/ (generate as necessary)
  --update-use-local-desc
                        update the use.local.desc file from metadata.xml
  --update-changelogs   update the ChangeLog files from SCM logs
  --update-pkg-desc-index
                        update package description index
  --update-manifests    update manifests

Common options:
  --repo REPO           name of repo to operate on
  --config-root PORTAGE_CONFIGROOT
                        location of portage config files
  --gpg-dir GPG_DIR     override the PORTAGE_GPG_DIR variable
  --gpg-key GPG_KEY     override the PORTAGE_GPG_KEY variable
  --portdir PORTDIR     override the PORTDIR variable (deprecated in favor of
                        --repositories-configuration)
  --portdir-overlay PORTDIR_OVERLAY
                        override the PORTDIR_OVERLAY variable (deprecated in
                        favor of --repositories-configuration)
  --repositories-configuration REPOSITORIES_CONFIGURATION
                        override configuration of repositories (in format of
                        repos.conf)
  --sign-manifests <y|n>
                        manually override layout.conf sign-manifests setting
  --strict-manifests <y|n>
                        manually override "strict" FEATURES setting
  --thin-manifests <y|n>
                        manually override layout.conf thin-manifests setting
  --tolerant            exit successfully if only minor errors occurred
  --ignore-default-opts
                        do not use the EGENCACHE_DEFAULT_OPTS environment
                        variable
  --write-timestamp     write metadata/timestamp.chk as required for rsync
                        repositories

--update options:
  --cache-dir CACHE_DIR
                        location of the metadata cache
  -j JOBS, --jobs JOBS  max ebuild processes to spawn
  --load-average LOAD_AVERAGE
                        max load allowed when spawning multiple jobs
  --rsync               enable rsync stat collision workaround for bug 139134
                        (use with --update)

--update-use-local-desc options:
  --preserve-comments   preserve the comments from the existing use.local.desc
                        file
  --use-local-desc-output ULD_OUTPUT
                        output file for use.local.desc data (or '-' for
                        stdout)
</pre>}}

=== Rebuilding the metadata cache ===

In order to rebuild the metadata cache on a system you can issue this command:
{{RootCmd|egencache --jobs{{=}}8 --update --repo gentoo}}

Adjust the number of jobs to be appropriate to each system. The "safe" metric to use with jobs will depend on the processor and system load. In the example above <code>8</code> jobs are used as an example.

[[Category:Portage]]
