{{InfoBox stack
|{{InfoBox wikipedia|Media Transfer Protocol|header=true}}
}}

'''MTP''' ('''M'''edia '''T'''ransfer '''P'''rotocol) is a protocol to allow the transfer of files to external devices. It is provided by several programs, most of them depending on [[FUSE]]. 

== Installation ==

=== Kernel ===

Prepare for MTP implementations by activating <var>CONFIG_FUSE_FS</var> in the [[Kernel/Configuration|Linux kernel]].

{{KernelBox|title=Enable FUSE for MTP implementations:|1=<pre>
File systems  ---> 
   <*> FUSE (Filesystem in Userspace) support
</pre>}}

== Available software ==

Here are some MTP packages available in Gentoo:

{| class="table table-condensed table-striped" style="width: auto;"
|-
! scope="col" width="10%" | Name
! scope="col" width="20%" | Package
! Homepage
! Description
|-
| [[MTPfs]] || {{Package|sys-fs/mtpfs}} || https://www.adebenham.com/mtpfs/ || A FUSE-based filesystem providing access to MTP devices. More mature than some of the alternatives.
|-
| [[Go-mtpfs]] || {{Package|sys-fs/go-mtpfs}} || https://github.com/hanwen/go-mtpfs || A simple FUSE-based filesystem written in Go language.
|-
| [[gphotofs]] || {{Package|media-gfx/gphotofs}} || http://www.something.com || gphotofs is a FUSE-based file system for interfacing with digital cameras using the gphoto2 application.
|-
| [[simple-mtpfs]] || {{Package|sys-fs/simple-mtpfs}} || https://github.com/phatina/simple-mtpfs || Like the others: a simple MTP FUSE filesystem driver written in C++.
|-
| [[Gnome]] || {{Package|gnome-base/gvfs}} || https://www.xfce.org/ || Install {{Package|gnome-base/gvfs}} with the <code>mtp</code> USE flag enabled. This can be either globally in {{Path|make.conf}}'s USE flag or for {{Package|gnome-base/gvfs}} in {{Path|package.use}}.
|-
| [[Thunar]] || {{Package|xfce-extra/thunar-volman}} || https://goodies.xfce.org/projects/thunar-plugins/thunar-volman || To have Thunar automount MTP devices (and other volumes), install the {{Package|xfce-extra/thunar-volman}} package.
|}

=== KDE ===

==== KDE SC 4 ====

'''kio-mtp''' is a slave for [[KDE]]'s KIO framework. It is still unstable, but it is in the main repository.

First, install:

{{Emerge|kde-misc/kio-mtp}}

Quit KDE, and (re)launch it again. Now the MTP devices should appear in Dolphin.

==== KDE 5 ====

'''kio-extras''' contains MTP support, but it requires the <code>mtp</code> USE flag.

Enable the global <code>mtp</code> use flag:

{{FileBox|filename=/etc/portage/make.conf|1=
USE="$USE mtp"
}}

Alternatively, enable it in kio-extras:

{{FileBox|filename=/etc/portage/package.use|1=
kde-apps/kio-extras mtp
}}

Then emerge:

{{Emerge|kde-apps/kio-extras}}

After this, quitting KDE and restarting is probably sufficient to get it working.

If that does not work, please try restarting the system.

=== gMTP ===

'''gMTP''' is a simple MTP client for Solaris and Linux.

It is sufficient to just install and run {{Package|media-sound/gmtp}}:

{{Emerge|media-sound/gmtp}}

{{Cmd|gmtp}}

Click on connect. A few second later, the file hierarchy on the device should appear. It is now possible to manipulate the files on the device. It support features like Album Artwork and playlists.

== Troubleshooting ==

* If the device is not recognized by libmtp, try upgrading to latest (or even live) version - (presently v1.1.12).
* Some ROMs (e.g. PAC ROM) require the unlocking of the screen of the device before files will appear. If the screen is not unlocked the device will appear empty.
* Sometimes (specifically on HTC One X) USB debugging automatically activates when device is connected to a PC. USB debugging must be disabled, otherwise libmtp can't recognize device.
* Make sure the Android device is not going to sleep and the screen is not getting locked. Set screen timeout to very long values, or enable in Development section flag "Do not turn off the screen".
* Lumia devices might require {{Package|media-libs/libmtp}} version 1.1.9 and {{Package|sys-fs/simple-mtpfs}} to be mounted properly.
** Lumia devices must be unlocked to be able to connect (enter the user's PIN).

[[Category:Software]]
[[Category:Meta]]
