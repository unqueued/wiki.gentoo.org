The {{Path|/etc/portage/make.conf}} (formerly {{Path|/etc/make.conf}}) file is used to customize the Portage environment on a global level. Settings here will apply to every package that is emerged; they control many elements of Portage functionality such as global USE flags, language (linguas) options, Portage mirrors, etc.

An example setup can be found at {{Path|/usr/share/portage/config/make.conf.example}}

== Precedence == 

Portage configuration is not limited to {{path|make.conf}}, global settings defined in this file are refined on a per-package basis in the {{path|/etc/portage/package.*}} files, as well as the local environment.

{{Path|make.conf}} may exist as {{Path|/etc/portage/make.conf}} or {{Path|/etc/make.conf}}, however the latter is deprecated for the former. Therefore if settings exist in {{Path|/etc/make.conf}} should be migrated to {{Path|/etc/portage/make.conf}}. Settings from {{Path|/etc/portage/make.conf}} precedence over those in {{Path|/etc/make.conf}}.

== Variables ==

There are many possible variables to customize in {{Path|make.conf}}, but only the most commonly used are explained in detail within this article. For more information, and the full list of variables, consult the {{Path|make.conf}} [[man page]] by running:

{{Cmd|man make.conf}}

{{Note|Different configurations will require different variables to be set up. Do not treat the following examples as a definitive list, or a minimum set of requirements.}}

=== CHOST ===

This variable is passed through the configure step of ebuilds to set the build-host of the system. See the [[CHOST|CHOST article]]. Note that the profile already should have defined the appropriate <var>CHOST</var> value.

=== CFLAGS and CXXFLAGS ===

For example:
{{FileBox|filename=[[:/etc/portage/make.conf]]|lang=bash|1=
CFLAGS="-march=native -O2 -pipe"
CXXFLAGS="${CFLAGS}"
}}

For details see the [[CFLAGS]] article and [[Handbook:Parts/Installation/Stage#CFLAGS_and_CXXFLAGS]].

=== CONFIG_PROTECT ===

{{:CONFIG_PROTECT/en}}

=== FEATURES === 
{{:FEATURES}}

=== GENTOO_MIRRORS ===

{{FileBox|filename=/etc/portage/make.conf|lang=bash|1=
GENTOO_MIRRORS="URIs"
}}

This variable defines a list of [[GENTOO_MIRRORS|Gentoo mirrors]] to check before downloading from the source defined in the ebuild. Properly chosen mirrors will generally be able to offer faster download speeds. Try using <tt>[[mirrorselect]]</tt> to find the fastest mirror server. 

See the [https://www.gentoo.org/downloads/mirrors/ Mirrors page on the main site] for available URLs.

=== MAKEOPTS ===

This variable is used to specify arguments passed to make when packages are built from source. Make can be told to run multiple jobs in parallel (a potentially substantial speed increase, depending on processor). This is done via <code>-jN</code>, which will allow make to spawn up to N threads per invocation (job). A widely used rule of thumb for <code>N</code> is to take the number of available cores (hyperthreaded cores count as 2) and add one. So a hyperthreaded dual-core would use a value of <code>5</code> for <code>N</code>. This rule is optimized for a single job running at a time with a large number of threads.

This value may need to be changed if <code>EMERGE_DEFAULT_OPTIONS</code> job control is used. See below.

=== EMERGE_DEFAULT_OPTIONS ===

Entries here are appended to the emerge command line. Two particular options are of interest, specifically <code>--jobs N</code> and <code>--load-average X.Y</code>, which run parallel emerge jobs subject to the load-average limit.

<code>--jobs N</code> (short form: <code>-jN</code>), runs <code>N</code> (number) jobs at a time (without an argument, <code>-j</code> will flood the processor with as many jobs as possible, and is not recommended). For example, to run up to three jobs in parallel:

{{RootCmd|emerge --jobs 3 package/atom}}

A typical value for N would be equal to the number of cores. (see below)

When used with <code>--load-average X.Y</code> (short form <code>-lX.Y</code>), emerge will try to keep the load average of the system less than <code>X.Y</code>, a floating point number. If <code>--jobs</code> is set as well, then it will run up to the limit indicated by that parameter.

The load average value is the same as displayed by <code>top</code> and for an N-core system, a load average of <code>N.0</code> would be a 100% load. Another rule of thumb here is to set <code>X.Y=(cores)*0.9</code> which will limit the load to 90%, thus maintaining responsiveness.

NOTE: When <code>MAKEOPTS="-jN"</code> is used with <code>EMERGE_DEFAULT_OPTIONS="--jobs K --load-average X.Y"</code> the number of possible threads created would be up to <code>N*K</code> threads. Therefore, both variables need to be set with each other in mind as they create up to K jobs each with up to N threads.

These two settings are better suited for long emerges including multiple files to make the most of the <code>--jobs</code> parameter. They can also cause emerge errors in some cases, so use with caution and be prepared to comment these out if problems arise.

=== PORTAGE_TMPDIR ===

The <var>PORTAGE_TMPDIR</var> variable defines the location of the temporary build directories. The value defaults to {{Path|/var/tmp}}. 

{{FileBox|filename=/etc/portage/make.conf|lang=bash|1=
PORTAGE_TMPDIR="/var/tmp"
}}

<var>PORTAGE_TMPDIR</var> should not be set to point anywhere under the location of a repository.

=== PORTDIR ===

The <var>[[PORTDIR]]</var> variable has been deprecated in favor of settings in [[:/etc/portage/repos.conf|repos.conf]]

=== PORTDIR_OVERLAY ===

This variable has been deprecated in favor of settings in [[:/etc/portage/repos.conf|repos.conf]].

[[Layman#Using_.27make.conf.27_method_.28older_method.29|Layman]] versions <2.3.0 still use it.

=== SYNC ===

See [[SYNC]].

=== USE ===

The <var>USE</var> variable allows the system wide setting or deactivation of [[USE flag|USE flags]] in a space separated list. 

{{FileBox|filename=[[:/etc/portage/make.conf]]|title=[[Handbook:Parts/Working/USE#Declare_permanent_USE_flags|Example]]|lang=bash|1=
USE="-kde -qt4 ldap"
}}

For a fine grained [[Handbook:Parts/Working/USE#Declaring_USE_flags_for_individual_packages|per package control]] of [[USE flag|USE flags]], the file {{Path|[[:/etc/portage/package.use]]}} should be used instead.

=== ACCEPT_LICENSE ===

{{FileBox|filename=/etc/portage/make.conf|title=To accept all [[:/usr/portage/licenses|licenses]] on all packages (not a good idea)|lang=bash|1=
ACCEPT_LICENSE="*"
}}

{{FileBox|filename=/etc/portage/make.conf|title=To accept free software only|lang=bash|1=
ACCEPT_LICENSE="-* @FREE"
}}

== USE_EXPAND ==

The USE_EXPAND list is set in [https://gitweb.gentoo.org/repo/gentoo.git/tree/profiles/base/make.defaults profiles/base/make.defaults as of Portage 2.0.51.20.]<ref>https://devmanual.gentoo.org/general-concepts/use-flags/#use_expand-and-arch-use-flags</ref>

=== CPU_FLAGS_X86 ===

See [https://www.gentoo.org/support/news-items/2015-01-28-cpu_flags_x86-introduction.html this news item.] and [[CPU_FLAGS_X86]].

{{FileBox|filename=/etc/portage/make.conf|lang=bash|1=
CPU_FLAGS_X86="mmx mmxext sse sse2 sse3 ssse3"
}}

=== INPUT_DEVICES ===

For possible values of this USE_EXPAND variable see <var>[https://packages.gentoo.org/useflags/input_devices_evdev INPUT_DEVICES]</var>.

{{INPUT_DEVICES|evdev synaptics}}

=== LINGUAS ===

See [[Localization/Guide#LINGUAS|LINGUAS in the Localization guide.]] For possible values of this USE_EXPAND variable see <var>[https://packages.gentoo.org/useflags/linguas_en LINGUAS]</var>.

{{FileBox|filename=/etc/portage/make.conf|lang=bash|1=
LINGUAS="de pt_BR en en_US en_GB"
}}

=== VIDEO_CARDS ===

For possible values of this USE_EXPAND variable see <var>[https://packages.gentoo.org/useflags/video_cards_vesa VIDEO_CARDS]</var>.

{{VIDEO_CARDS|intel nvidia radeon vesa}}

== See also ==

* [[Handbook:AMD64/Working/Features|Gentoo Linux AMD64 Handbook - Portage features]]
* [[Handbook:AMD64/Working/EnvVar|Gentoo Linux AMD64 Handbook - Environment variables]]
* [[Handbook:AMD64/Portage/Advanced|Gentoo Linux AMD64 Handbook - Advanced Portage features]]

== External resources ==

* https://devmanual.gentoo.org/general-concepts/features/

== References ==

{{reflist}}

[[Category:Portage]]
