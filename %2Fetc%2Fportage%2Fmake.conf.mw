<languages />
<translate>

The {{Path|/etc/portage/make.conf}} file (previously at {{Path|/etc/make.conf}}) is used to customize the Portage environment on a global level. Settings here will apply to every package that is emerged. They control many elements of Portage functionality such as global USE flags, language (linguas) options, Portage mirrors, etc.

An example setup can be found at {{Path|/usr/share/portage/config/make.conf.example}}

== Precedence == 

The final Portage configuration is not only based on {{path|make.conf}}. Global settings defined in this file can be refined on a per-package basis in the {{path|/etc/portage/package.*}} files, as well as through environment variables. Default settings, managed by the distribution, are available as well (partially through the Portage package defaults, partially through the Gentoo profile that is in use).

{{Note|Although Portage still supports the old {{Path|/etc/make.conf}} file, its use is discouraged in favor of {{Path|/etc/portage/make.conf}}. When both files are available, the settings in {{Path|/etc/portage/make.conf}} take precedence over those in {{Path|/etc/make.conf}}.}}

== Variables ==

There are many possible variables to customize in {{Path|make.conf}}. Only the most commonly used ones are explained further within this article, with an example and a link to a more detailed article (if applicable). For more information, and the full list of variables, consult the {{Path|make.conf}} [[man page]] by running:

{{Cmd|man make.conf}}

{{Note|Different configurations will require different variables to be set up. Do not treat the following examples as a definitive list, or a minimum set of requirements.}}

=== CHOST ===

The <var>CHOST</var> variable is passed through the configure step of ebuilds to set the build-host of the system. Note that the Gentoo profile already sets the appropriate <var>CHOST</var> value, and updating it requires insight and experience in build chains.

See the <var>[[CHOST]]</var> article for more information.

=== CFLAGS and CXXFLAGS ===

The <var>CFLAGS</var> and <var>CXXFLAGS</var> variables define the build and compile flags that will be used for all package deployments (some exceptions notwithstanding who filter out flags known to cause problems with the package). The <var>CFLAGS</var> variable is for C based applications, while <var>CXXFLAGS</var> is meant for C++ based applications. Most users will keep the content of both variables the same.

{{FileBox|filename=[[:/etc/portage/make.conf]]|lang=bash|title=Commonly used sane setting for CFLAGS and CXXFLAGS|1=
CFLAGS="-march=native -O2 -pipe"
CXXFLAGS="${CFLAGS}"
}}

For more information see the <var>[[CFLAGS]]</var> article and [[Handbook:Parts/Installation/Stage#CFLAGS_and_CXXFLAGS|CFLAGS and CXXFLAGS]] in the Gentoo Handbook.

=== CONFIG_PROTECT ===

<!-- The text in this section is trancluded the CONFIG_PROTECT article. -->

{{:CONFIG_PROTECT/en}}

=== FEATURES ===

<!-- The text in this section is trancluded the FEATURES article. -->

{{:FEATURES/en}}

=== GENTOO_MIRRORS ===

The <var>GENTOO_MIRRORS</var> variable defines a list of [[GENTOO_MIRRORS|Gentoo mirrors]] to check before downloading from the source defined in the ebuild. Properly chosen mirrors will generally be able to offer faster download speeds. Try using the {{c|[[mirrorselect]]}} command to find the fastest mirror server. 

{{FileBox|filename=/etc/portage/make.conf|lang=bash|1=
GENTOO_MIRRORS="URIs"
}}

See the [https://www.gentoo.org/downloads/mirrors/ Mirrors page on the main site] for available URLs.

=== MAKEOPTS ===

The <var>MAKEOPTS</var> variable is used to specify arguments passed to make when packages are built from source. Make can be told to run multiple jobs in parallel (a potentially substantial speed increase, depending on processor). This is done via <code>-jN</code>, which will allow make to spawn up to N tasks per invocation (which it calls jobs). A widely used rule of thumb for <code>N</code> is to take the number of available cores (hyperthreaded cores count as 2) and add one. So a hyperthreaded dual-core would use a value of <code>5</code> for <code>N</code>. This rule is optimized for a single job running at a time with a large number of threads.

This value may need to be changed if <code>EMERGE_DEFAULT_OPTS</code> job control is used. See below.

See the [[MAKEOPTS]] article for more information.

=== EMERGE_DEFAULT_OPTS ===

The <var>EMERGE_DEFAULT_OPTS</var> variable entries are appended to the emerge command line. Two particular options are of interest, specifically <code>--jobs N</code> and <code>--load-average X.Y</code>, which run parallel emerge jobs subject to the load-average limit.

<code>--jobs N</code> (short form: <code>-jN</code>), runs <code>N</code> (number) jobs at a time (without an argument, <code>-j</code> will flood the processor with as many jobs as possible, and is not recommended). For example, to run up to three jobs in parallel:

{{RootCmd|emerge --jobs 3 package/atom}}

A typical value for N would be equal to the number of cores (see below).

When used with <code>--load-average X.Y</code> (short form <code>-lX.Y</code>), emerge will try to keep the load average of the system less than <code>X.Y</code>, a floating point number. If <code>--jobs</code> is set as well, then it will run up to the limit indicated by that parameter.

The load average value is the same as displayed by <code>top</code> and for an N-core system, a load average of <code>N.0</code> would be a 100% load. Another rule of thumb here is to set <code>X.Y=(cores)*0.9</code> which will limit the load to 90%, thus maintaining responsiveness.

{{Note|When <code>MAKEOPTS{{=}}"-jN"</code> is used with <code>EMERGE_DEFAULT_OPTS{{=}}"--jobs K --load-average X.Y"</code> the number of possible tasks created would be up to <code>N*K</code> threads. Therefore, both variables need to be set with each other in mind as they create up to K jobs each with up to N tasks.}}

These two settings are better suited for long emerges which include multiple source code files to make the most of the <code>--jobs</code> parameter. They can also cause emerge errors in some cases, so use with caution and be prepared to comment these out if problems arise.

=== PORTAGE_TMPDIR ===

The <var>PORTAGE_TMPDIR</var> variable defines the location of the temporary build directories. The value defaults to {{Path|/var/tmp}}. 

{{FileBox|filename=/etc/portage/make.conf|lang=bash|1=
PORTAGE_TMPDIR="/var/tmp"
}}

=== DISTDIR ===

See the <var>[[DISTDIR]]</var> article.

=== PORTDIR ===

This variable has been deprecated in favor of the {{Path|[[:/etc/portage/repos.conf|repos.conf]]}} file.

See the [[PORTDIR]] article for more information.

=== PORTDIR_OVERLAY ===

The <var>PORTDIR_OVERLAY</var> variable has been deprecated in favor of the {{Path|[[:/etc/portage/repos.conf|repos.conf]]}} file.

[[Layman#Using_.27make.conf.27_method_.28older_method.29|Layman]] versions less than 2.3.0 still use the <var>PORTDIR_OVERLAY</var> variable.

=== SYNC ===

See the [[SYNC]] article.

=== USE ===

The <var>USE</var> variable allows the system wide setting or deactivation of [[USE flag|USE flags]] in a space separated list. 

{{FileBox|filename=[[:/etc/portage/make.conf]]|title=[[Handbook:Parts/Working/USE#Declare_permanent_USE_flags|Example]]|lang=bash|1=
USE="-kde -qt4 ldap"
}}

For a fine grained [[Handbook:Parts/Working/USE#Declaring_USE_flags_for_individual_packages|per package control]] of [[USE flag|USE flags]], the file {{Path|[[:/etc/portage/package.use]]}} should be used instead.

=== ACCEPT_LICENSE ===

The <var>ACCEPT_LICENSE</var> variable tells Portage which software licenses are allowed. Packages who have a license that is not accepted cannot be installed on the system.

{{FileBox|filename=/etc/portage/make.conf|title=To accept all [[:/usr/portage/licenses|licenses]] on all packages (not a good idea)|lang=bash|1=
ACCEPT_LICENSE="*"
}}

{{FileBox|filename=/etc/portage/make.conf|title=To accept free software only|lang=bash|1=
ACCEPT_LICENSE="-* @FREE"
}}

== USE_EXPAND ==

The <var>USE_EXPAND</var> variable is a list set in [https://gitweb.gentoo.org/repo/gentoo.git/tree/profiles/base/make.defaults profiles/base/make.defaults as of Portage 2.0.51.20.]<ref>https://devmanual.gentoo.org/general-concepts/use-flags/#use_expand-and-arch-use-flags</ref>

=== CPU_FLAGS_X86 ===

The <var>CPU_FLAGS_X86</var> variable informs Portage about the CPU flags (features) that the system allows. This information is used to optimize package builds specifically for the targeted features.

{{FileBox|filename=/etc/portage/make.conf|lang=bash|1=
CPU_FLAGS_X86="mmx mmxext sse sse2 sse3 ssse3"
}}

See [https://www.gentoo.org/support/news-items/2015-01-28-cpu_flags_x86-introduction.html this news item.] and [[CPU_FLAGS_X86]] for more information.

=== INPUT_DEVICES ===

For possible values of this USE_EXPAND variable see <var>[https://packages.gentoo.org/useflags/input_devices_evdev INPUT_DEVICES]</var>.

{{INPUT_DEVICES|evdev synaptics}}

=== L10N ===

See [[Localization/Guide#L10N|L10N in the Localization guide]] and this [https://gentoo.org/support/news-items/2016-06-23-l10n-use_expand.html Repository News Item]. For possible values of this <var>USE_EXPAND</var> variable see <var>[https://packages.gentoo.org/useflags/l10n_en L10N]</var>.

{{FileBox|filename=/etc/portage/make.conf|lang=bash|1=
L10N="de pt_BR en en_US en_GB"
}}

=== VIDEO_CARDS ===

For possible values of this <var>USE_EXPAND</var> variable see <var>[https://packages.gentoo.org/useflags/video_cards_vesa VIDEO_CARDS]</var>.

{{VIDEO_CARDS|intel nvidia radeon vesa}}

For the average user, if a graphical desktop environment is to be used this variable ''should'' be explicitly defined. For further information see [[Xorg/Guide#make.conf_configuration]].

== See also ==

* [[Handbook:AMD64/Portage/Variables|Gentoo Linux AMD64 Handbook - Portage variables]]
* [[Handbook:AMD64/Working/Features|Gentoo Linux AMD64 Handbook - Portage features]]
* [[Handbook:AMD64/Working/EnvVar|Gentoo Linux AMD64 Handbook - Environment variables]]
* [[Handbook:AMD64/Portage/Advanced|Gentoo Linux AMD64 Handbook - Advanced Portage features]]

== External resources ==

* https://devmanual.gentoo.org/general-concepts/features/

== References ==

{{reflist}}

</translate>
[[Category:Portage]]
