This article provides information on how to get up and running with '''GRUB2''' in the simplest configurations. For more comprehensive information, see [[GRUB2]].

== Gentoo GRUB Legacy (0.97) to GRUB2 Migration Guide ==

The guide is available [[GRUB2 Migration|here]].

== GRUB Slots ==
The {{Package|sys-boot/grub}} package is slotted; both grub-0.97 and grub-2.00 may be installed at the same time.

'''If you want to install grub-0.97 or keep it installed after an upgrade''', call emerge with the "0" slot on the end of the package atom. This will add sys-boot/grub:0 to the system's world file. For example:
{{emerge|params=--noreplace|sys-boot/grub:0}}

{{Note|While both versions of GRUB can be install on the system at the same time, only one version of GRUB may be installed in the MBR at one time.}}

== Installing the Software ==
First set the <code>GRUB_PLATFORMS</code> variable in {{Path|make.conf}} (optional). If unset, GRUB2 will guess which platform you want. It guesses "pc" (which is not UEFI; see examples below) for X86/AMD64 architecture.

{{FileBox|filename=/etc/portage/make.conf|title=GRUB_PLATFORMS example|lang=bash|1=
# Standard PC (BIOS)
GRUB_PLATFORMS="pc"

# UEFI on amd64
GRUB_PLATFORMS="efi-64"

# UEFI and PC
GRUB_PLATFORMS="efi-64 pc"
}}

After the variable is get, then emerge the software:
{{emerge|sys-boot/grub:2}}

== Installing a Bootable Image ==
Mount your {{Path|/boot}} volume if you have one.
{{RootCmd|mount /boot}}

If you are using an EFI platform, mount your EFI system volume at {{Path|/boot/efi}}. This should be a FAT formatted volume containing an EFI subdirectory.
{{RootCmd|mount /boot/efi}}

Run the grub2-install utility to copy the relevant files to {{Path|/boot/grub}}. On the PC platform, this also installs a boot image to the Master Boot Record (MBR) or a partition's boot sector.

The grub2-install command accepts a <tt>--target</tt> option to specify which CPU/Platform to install. If unspecified, grub2-install will make a guess; on X86/AMD64 it will use "i386-pc" by default.

Installing GRUB2 to the MBR:
{{RootCmd|grub2-install /dev/sda
|output=Installation finished. No error reported.}}

Installing GRUB2 to a partition (not recommended):
{{RootCmd|grub2-install /dev/sda1
|output=Installation finished. No error reported.}}

Installing GRUB2 on an EFI capable system:
{{RootCmd|grub2-install --target{{=}}x86_64-efi
|output=Installation finished. No error reported.}}

{{Important|If having difficulty installing GRUB2 to an EFI capable system (like the example above), make sure the <code>GRUB_PLATFORMS</code> variable is properly set in {{Path|/etc/portage/make.conf}}}}

== Automatic Configuration ==
GRUB2 is traditionally configured by using the grub2-mkconfig program to generate a configuration file.

grub2-mkconfig generates the configuration file based on template sections located in {{Path|/etc/grub.d}}. The default templates should cover most common boot setups.

{{Cmd|ls /etc/grub.d|lang=bash|
|output=00_header  10_linux  20_linux_xen  30_os-prober  40_custom  41_custom  README}}

The behavior of these templates can be controlled by setting variables in {{Path|/etc/default/grub}}. See the [http://www.gnu.org/software/grub/manual/html_node/Simple-configuration.html GRUB manual] for reference.

=== Kernel Naming Schemes ===
In order for grub2-mkconfig to detect your Linux kernel(s), they must be named vmlinuz-''version'' or kernel-''version''. 

For example:
 /boot/vmlinuz-3.4.3
 /boot/kernel-2.6.39-gentoo
 /boot/kernel-genkernel-x86_64-3.17.1-gentoo-r1

If you use an [[initramfs]], it should be named initramfs-''version''.img or initrd-''version''.img. File names generated by genkernel will also work.

For example:
 /boot/initramfs-3.4.3.img
 /boot/initramfs-genkernel-x86_64-2.6.39-gentoo

Generate the {{Path|grub.cfg}} file:
{{RootCmd|mount /boot
|grub2-mkconfig -o /boot/grub/grub.cfg
|output=Generating grub.cfg ...
Found linux image: /boot/vmlinuz-3.2.9
done}}

=== Silent Kernel Decompression ===

To silence kernel decompression make your line in {{Path|/etc/default/grub}} look like this.

{{FileBox|filename=/etc/default/grub|title=Silent decompression example|lang=bash|1=
GRUB_CMDLINE_LINUX_DEFAULT="quiet"
}}

=== Systemd ===

To boot systemd while using GRUB2 make the <code>GRUB_CMDLINE_LINUX</code> variable look like this:

{{FileBox|filename=/etc/default/grub|title=Systemd example|lang=bash|1=
GRUB_CMDLINE_LINUX="init=/usr/lib/systemd/systemd"
}}

=== Loading Another Operating System ===

grub2-mkconfig can also generate configurations to load ''other'' operating systems. To do this requires the {{Package|sys-boot/os-prober}} package.

To boot Windows, the {{Package|sys-fs/ntfs3g}} also needs to be installed. It allows for the grub2-mkconfig utility to probe NTFS filesystems.

== Manual Configuration ==
Instead of using <kbd>grub2-mkconfig</kbd>, a typical simple {{Path|grub.conf}} (the configuration file used for '''GRUB''') can easily be converted to be suitable for use in {{Path|grub.cfg}}.
{|
! style="text-align: left;" | <code>grub.conf</code> (GRUB Legacy)
|
! style="text-align: left;" | <code>grub.cfg</code> (GRUB 2)
|-
| style="background: rgb(250,250,250); vertical-align: top; border: 1px solid black; padding: 5px 7px;" | <code style="color: gray; margin: 0; padding: 0; border: 0; background: transparent; line-height: normal;">timeout 5<br />
<br />
<span style="font-weight: bold; color: maroon;">title</span> Gentoo Linux 3.2.12<br />
root <span style="font-weight: bold; color: maroon;">(</span>hd0,<span style="font-weight: bold; color: maroon;">0)</span><br />
<span style="font-weight: bold; color: maroon;">kernel</span> /boot/kernel-3.2.12-gentoo root=/dev/sda3</code>
| style="vertical-align: middle; font-size: 50px; color: gray;" | â‡¨
| style="background: rgb(250,250,250); vertical-align: top; border: 1px solid black; padding: 5px 7px;" | <code style="color: gray; margin: 0; padding: 0; border: 0; background: transparent; line-height: normal;">timeout<span style="font-weight: bold; color: green;">=</span>5<br />
<br />
<span style="font-weight: bold; color: green;">menuentry</span> <span style="font-weight: bold; color: green;">'</span>Gentoo Linux 3.2.12<span style="font-weight: bold; color: green;">'</span> <span style="font-weight: bold; color: green;">{</span><br />
<span style="display: inline-block; width: 4ex; overflow: hidden;">	</span>root<span style="font-weight: bold; color: green;">=</span>hd0,<span style="font-weight: bold; color: green;">1</span><br />
<span style="display: inline-block; width: 4ex; overflow: hidden;">	</span><span style="font-weight: bold; color: green;">linux</span> /boot/kernel-3.2.12-gentoo root=/dev/sda3<br />
<span style="font-weight: bold; color: green;">}</span>
|}

[[Category:Bootloaders]]
