<languages/>
{{InfoBox stack
|{{InfoBox github|rhinstaller/efibootmgr|header=true}}
|{{InfoBox package|sys-boot/efibootmgr}}
|{{InfoBox odoc|https://github.com/rhboot/efibootmgr/blob/master/README.md|text=README}}
{{InfoBox manpage|https://linux.die.net/man/8/efibootmgr|text=EFIBOOTMGR(8)|raw=true}}
}}

{{Metadata|abstract=Приложение efibootmgr взаимодействует с прошивкой UEFI в системе, и это популярное приложение для изменения настроек EFI с целью создания и изменения загрузочных записей, с помощью которых можно загрузить Linux (или другие операционные системы).}}

The {{c|efibootmgr}} application interacts with the UEFI firmware on the system. It is a popular [[Article description::tool for manipulating the EFI settings in order to create and manage boot entries]] capable of booting Linux (or any other EFI operating system).

Приложение {{Package|sys-boot/efibootmgr}} это '''не''' загрузчик. Это утилита, которая взаимодействует с прошивкой EFI в системе, которая работает в качестве загрузчика. С помощью {{c|efibootmgr}} можно создавать, менять местами, обновлять и удалять загрузочные записи.

== Установка ==

=== Ядро ===

Необходимо включить поддержку <var>CONFIG_EFI_VARS</var>:

{{KernelBox|title=Включение поддержки переменной EFI|1=
Firmware Drivers  --->
   EFI (Extensible Firmware Interface) Support  --->
       <*> EFI Variable Support via sysfs
}}

=== Emerge ===

У пакета {{Package|sys-boot/efibootmgr}} нет каких-либо USE-флагов. Все что нужно сделать - это установить его:

{{Emerge|sys-boot/efibootmgr}}

== Конфигурация ==

=== EFI vars ===

Для того, чтобы успешно использовать {{c|efibootmgr}}, должна быть доступна файловая система переменных EFI. Следовательно система должна быть уже загружена в режиме EFI (а не через BIOS в режиме MBR), так как иначе переменные EFI сами по себе не будут доступны. Если система загружена в режиме MBR, перезагрузитесь и настройте все необходимое для загрузки EFI режиме. Обычно, для этого нужно, либо настроить встроенное ПО (BIOS), либо выбор в меню загрузки запись содержащую EFI.

When the system is in EFI mode, run the following command to check for the existence of [[Filesystem#Disk_filesystems|efivarfs]]:

{{RootCmd|mount {{!}} grep efivars|output=<pre>
efivarfs on /sys/firmware/efi/efivars type efivarfs (rw,nosuid,nodev,noexec,relatime)
</pre>}}

Если данная файловая система не смонтирована (она должна быть смонтирована через скрипт инициализации {{Path|sysfs}}), можно смонтировать ее вручную следующей командой:

{{RootCmd|mount -t efivarfs efivarfs /sys/firmware/efi/efivars}}

See [https://github.com/OpenRC/openrc/commit/3fd3bfc76dccc3752f4af949ad4076dab26357fb#diff-8312ad0561ef661716b48d09478362f3R6 OpenRC-0.28 news].

== Preconditions ==

If an EFI System Partition (ESP) does not exist, one needs to be created, see [[EFI System Partition]]

== Использование ==

=== Получение списка загрузочных записей ===

Чтобы получить список текущих загрузочных записей, используйте опцию <code>--verbose (-v)</code>:

{{RootCmd|efibootmgr -v|output=<pre>
BootCurrent: 0002
Timeout: 3 seconds
BootOrder: 0003,0003,0002,0000,0004
Boot0000* CD/DVD Drive  BIOS(3,0,00)
Boot0001* Hard Drive    BIOS(2,0,00)
Boot0002* Gentoo        HD(1,800,61800,6d98f360-cb3e-4727-8fed-5ce0c040365d)File(\EFI\boot\bootx64.efi)
Boot0003* Hard Drive    BIOS(2,0,00)P0: ST1500DM003-9YN16G
</pre>}}

=== Создание загрузочной записи ===

Чтобы создать загрузочную запись EFI, нужно передать несколько аргументов программе {{c|efibootmgr}}:

* <code>--create (-c)</code> to create a new entry;
* <code>--part (-p)</code> followed by the partition number on which the [[EFI System Partition]] is hosted;
* <code>--disk (-d)</code> followed by the disk on which the EFI System Partition is hosted;
* <code>--label (-L)</code> followed by the label to use as the boot entry;
* <code>--loader (-l)</code> followed by the path of the EFI image to boot

{{Important|Путь к образу EFI для загрузки ''должен'' в качестве разделителя в путях содержать {{Key|\}} (обратный слеш) вместо {{Key|/}} (передний слеш).}}

Например:

{{RootCmd|efibootmgr -c -d /dev/sda -p 2 -L "Gentoo" -l "\efi\boot\bootx64.efi"}}

Optionally, additional kernels can be installed and made known to the UEFI firmware. This is especially useful when wanting to test more kernels or to dual-boot with another operating system. These will be shown in the boot selection prompt, normally after a keyboard hotkey is pressed at the right time during system initialization. The latest added entry always gets highest boot priority, so it will be default. If the hotkey combination is unknown, search for official documentation from the computer manufacturer. This information is usually not difficult to find.

=== Удаление загрузочной записи ===

Перед удалением записи, сначала определите, какой ID был у записи.

Чтобы удалить запись Gentoo, которая была показана выше (и имеет идентификатор ''Boot0002''), попросите {{c|efibootmgr}} удалить запись с идентификатором 2, передав в качестве аргументов следующие значения: <code>--bootnum (-b)</code> это идентификатор, и опция <code>--delete-bootnum (-B)</code>, означающая, что нужно удалить запись:

{{RootCmd|efibootmgr -b 2 -B}}

== Удаление ==

=== Unmerge ===

{{Unmerge|sys-boot/efibootmgr}}

== Смотрите также ==

* {{See also|rEFInd}}
* Статья [[EFI_stub_kernel|EFI stub kernel]] объясняет, как настроить ядро Linux, чтобы его можно было загрузить непосредственно из EFI
* [[Handbook:AMD64/Installation/Bootloader/ru#Альтернативный метод 2: efibootmgr|Альтернативный метод 2: efibootmgr]] в Gentoo Handbook
