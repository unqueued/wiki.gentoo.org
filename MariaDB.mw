{{InfoBox stack
|{{InfoBox homepage|http://www.mariadb.org|header="true"}}
|{{InfoBox odoc|https://mariadb.com/kb/en/library/documentation/}}
|{{InfoBox wikipedia}}
|{{InfoBox irc|maria}}
}}

'''MariaDB''' [[Article description::is an enhanced, drop-in [[MySQL]] replacement.]]

In Gentoo, {{Package|dev-db/mariadb}} is the default package for items that depend on {{Package|virtual/mysql}}.

== Installation ==

=== USE flags ===

{{USEflag|package=dev-db/mariadb}}

=== Emerge ===

Install {{Package|dev-db/mariadb}}:

{{Emerge|mariadb}}

=== Service ===

==== OpenRC ====

To have MariaDB started automatically at boot, add it to the default runlevel:

{{RootCmd|rc-update add mysql default}}

If MariaDB is configured, start the service:

{{RootCmd|rc-service mysql start}}

==== Systemd ====

* With MariaDB < 10.1

{{RootCmd|systemctl enable mysqld.service}}

* With MariaDB >= 10.1.8

{{RootCmd|systemctl enable mariadb.service}}

{{Note|MariaDB 10.1.8 includes a unit named {{C|mariadb.service}} that uses notify instead of a script to check if the system is alive.}}

== Configuration ==

=== Preliminary configuration ===

Gentoo MariaDB package maintainers will help you set up MariaDB through the configuration option in the ebuild.

{{Emerge|dev-db/mariadb|params=--config}}

The configuration will create a database, set proper permissions, and assist you in creating a secure root password (this is for the MariaDB root account, which is not related to the Linux root account).

{{Note|When configuring MariaDB on a system with 'localhost' as its hostname, the "Your machine must NOT be named localhost" error is produced. The following steps will allow configuration by changing the hostname.}}

In the event MariaDB configuration fails due to 'localhost' as hostname, update the system hostname variable to a name other than 'localhost' in /etc/conf.d/hostname:

{{RootCmd|sed -i 's/localhost/larry/g' /etc/conf.d/hostname}}

Restart the hostname service:

{{RootCmd|rc-service hostname restart}}

Then, run the configuration command:

{{Emerge|dev-db/mariadb|params=--config}}

=== In-database configuration ===

When the database is set up and running, connect to MariaDB using the {{c|mysql}} client application.

{{Cmd|mysql -u root -p -h localhost|output=<pre>
Enter root password: 
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 86415
Server version: 5.5.32-MariaDB-log Source distribution

Copyright (c) 2000, 2013, Oracle, Monty Program Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MariaDB [(none)]></pre>}}

=== Custom options ===

Beginning with MariaDB 10.2, the configuration file {{Path|my.cnf}}, includes a single directive to include {{Path|/etc/mysql/mariadb.d}} and all files located within.  Gentoo includes a file for server settings and one for client settings.  Create your own files in this directory and they will be added together in alphabetical order.  The base configuration accepts almost all the defaults and only tweaks paths.  Tune your server to your liking.

== Troubleshooting ==

=== Compiling against libmariadb.so ===

Beginning with MariaDB 10.2, a new LGPL client library is included.

With MariaDB 10.2.8, the server and client headers were separated.  This causes compilation errors in some programs which previously relied on server features.

==== MYSQL_SERVER_VERSION ====

One example is MYSQL_SERVER_VERSION.
A quick fix can be:
<pre>
#if defined MARIADB_CLIENT_VERSION_STR && !defined MYSQL_SERVER_VERSION
  #define MYSQL_SERVER_VERSION MARIADB_CLIENT_VERSION_STR
#endif
</pre>
Ultimately, MYSQL_SERVER_VERSION should be removed and use the MYSQL_VERSION_ID integer for version identification.

== See also ==

* [[MySQL/Startup_Guide|MySQL Startup Guide]]

== External resources ==

* [https://mariadb.com/kb/en/mariadb-vs-mysql-features/ MariaDB VS MySQL features]
* [https://mariadb.com/kb/en/mariadb-vs-mysql-compatibility/ MariaDB VS MySQL compatibility]
* [https://mariadb.com/kb/en/moving-from-mysql/ Moving from MySQL]

[[Category:Server]]
[[Category:Database]]
