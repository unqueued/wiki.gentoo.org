= using OpenRC on Prefix =
The following guideline applies to a Gentoo Prefix on RHEL-5.6 amd64, for other setups it should be similar. Feel free to documents corners cases here.
== getting baselayout-2 emerged on prefix ==
OpenRC is designed with baselayout-2, while baselayout-prefix corresponds to =baselayout-1.12.* when it was first initiated. Emerging baselayout-2.1 is not out of box:

{{GenericCmd|<pre>$ emerge -avt baselayout

These are the packages that would be merged, in reverse order:

Calculating dependencies... done!
[nomerge       ] sys-apps/baselayout-2.1  USE="-build"  [1]
[ebuild  N    *]  sys-apps/openrc-9999  USE="ncurses unicode -debug (-pam) (-selinux) -static-libs" 0 kB [1]
[ebuild  N    *]   sys-libs/glibc-9999  USE="-debug -gd -glibc-omitfp (-hardened) (-multilib) -profile (-selinux) -vanilla" 0 kB [2]
[ebuild  N    *]   sys-apps/baselayout-2.1  USE="-build" 40 kB [1]
[ebuild  N    *]   virtual/init-0  0 kB [0]
[ebuild  N    *]    sys-apps/sysvinit-2.88-r3  USE="(-ibm) (-selinux) -static" 104 kB [0]
[nomerge       ] sys-libs/glibc-9999  USE="-debug -gd -glibc-omitfp (-hardened) (-multilib) -profile (-selinux) -vanilla"  [2]
[ebuild  N     ]  sys-libs/timezone-data-2012c  USE="nls" 334 kB [0]
[blocks B      ] <sys-apps/util-linux-2.20 ("<sys-apps/util-linux-2.20" is blocking sys-apps/sysvinit-2.88-r3)
</pre>}}

We are going to document the recommended way in the following sections.

=== glibc and sysvinit ===
In Gentoo Prefix, glibc and sysvinit are supposed to be provided outside Prefix by host OS. Let's tell portage that we have any version of glibc and sysvinit she wants:

{{File|${EPREFIX}/etc/portage/profile/package.provided|Example for providing glibc and sysvinit from outside|<pre>
sys-libs/glibc-9999
sys-apps/sysvinit-9999
</pre>}}

now it becomes,

{{GenericCmd|<pre>$ emerge --autounmask-write -avt baselayout

These are the packages that would be merged, in reverse order:

Calculating dependencies... done!
[nomerge       ] sys-apps/baselayout-2.1  USE="-build"  [1]
[ebuild  N    *]  sys-apps/openrc-9999  USE="ncurses unicode -debug (-pam) (-selinux) -static-libs" 0 kB [1]
[ebuild  N     ]   sys-apps/baselayout-2.1  USE="-build" 0 kB [1]
[ebuild  N    *]   virtual/init-0  0 kB [0]

Total: 3 packages (3 new), Size of downloads: 0 kB
Portage tree and overlays:
 [0] /home/benda/gentoo/usr/portage
 [1] /home/benda/art/openrc/overlay

The following keyword changes are necessary to proceed:
#required by sys-apps/openrc-9999, required by sys-apps/baselayout-2.1, required by baselayout (argument)
=virtual/init-0 **
#required by sys-apps/baselayout-2.1, required by baselayout (argument)
=sys-apps/openrc-9999 **
</pre>}}

=== replace baselayout-prefix with baselayout ===
{{GenericCmd|<pre>$ emerge -C baselayout-prefix

 * This action can remove important packages! In order to be safer, use
 * `emerge -pv --depclean <atom>` to check for reverse dependencies before
 * removing packages.

!!! 'sys-apps/baselayout-prefix' is part of your system profile.
!!! Unmerging it may be damaging to your system.
...
</pre>}}
Ignore the warnings.

Finally emerge baselayout-2 and openrc.
{{GenericCmd|$ emerge --autounmask-write -avt baselayout}}

== Example: nginx ==
=== prefixify init script ===
{{RootCmd|for d in usr var etc; do sed -i "s,/${d},${EPREFIX}/${d}," ${EPREFIX}/etc/init.d/nginx; done}}
{{RootCmd|sed -i "s,\!/sbin,\!${EPREFIX}/sbin," ${EPREFIX}/etc/init.d/nginx}}
=== prefixify nginx.conf ===
{{RootCmd|for d in usr var etc; do sed -i "s,/${d},${EPREFIX}/${d}," ${EPREFIX}/etc/nginx/nginx.conf; done}}
