<languages />
Les équipementiers peuvent mettre à disposition les mises à jours des microprogrammes et du [[BIOS/fr|BIOS]]. Ces mises à jour sont parfois plus difficiles à effectuer (pour l'utilisateur) via les systèmes GNU/Linux qu'avec des systèmes d'exploitation propriétaires <ref>La mise à jour est effectuée en effaçant la mémoire puis en enregistrant la nouvelle version du microprogramme.</ref>. Leur réalisation peut parfois nécessiter davantage d'opérations.

{{Warning/fr|Souvent, le BIOS n'est mis à jour qu'en cas de dysfonctionnement matériel. On peut endommager irrémédiablement l'ordinateur, lors de la mise à jour, en provoquant des dysfonctionnements irréversibles, par rapport au BIOS, et aboutir à l'annulation de la garantie. Procédez avec précaution.}}

== Obtenir des informations sur le microprogramme ==

Vous devez d'abord identifier le fabricant et le modèle de la carte mère. Consultez les documents relatifs à la carte mère ou à l'ordinateur. En général, les informations nécessaires se trouveront dans ces documents.

Le paquet {{package|sys-apps/dmidecode}} contient des utilitaires permettant d'obtenir des informations sur le système (nom du constructeur, numéro de série, version du BIOS, etc.). Plus précisément, {{c|dmidecode}} reprend les informations qui sont contenues dans la table DMI <ref>Les informations de la table DMI peuvent être incorrectes bien que la table soit réalisée par le fabricant.</ref>.

{{RootCmd|dmidecode -t bios -t baseboard}}

En dernier recours, on peut consulter les inscriptions sur la carte mère.

{{Warning/fr|Accéder à la carte mère d'un ordinateur peut aboutir à l'annulation de la garantie !}}

Le site web du fabricant propose éventuellement des mises à jour. Normalement, lorsqu'on sélectionne une mise à jour, un fichier ou un répertoire au format .zip, .exe ou .iso est proposé en téléchargement. 

{{Cmd|unzip 7235v1A.zip
|output=<pre>Archive:  7235v1A.zip
   creating: 7235v1A/
inflating: 7235v1A/7235v1x.txt
inflating: 7235v1A/AWFL865.EXE
inflating: 7235v1A/How to flash the BIOS.DOC
inflating: 7235v1A/W7235IMS.1A0
</pre>}}

== Configuration du BIOS  ==

La plupart des BIOS permettent l'amorçage de l'ordinateur à partir d'un support externe, comme une clé USB ou un DVD. On doit configurer l'ordre d'amorçage (cf. [[BIOS/fr]]) pour pouvoir démarrer sur le support externe et effectuer la mise à jour. En cas de difficultés, on peut reprendre la lecture à la section suivante.

== CD de démarrage ==

Les fabricants proposent souvent les mises à jour du BIOS, sous la forme d'une image disque (extensions .iso, .img, etc.). Cette image disque peut être gravée sur un CD-ROM et être ensuite exécutée à chaque lecture du CD-ROM. On peut graver l'image avec {{c|cdrecord}} :

{{RootCmd|cdrecord BOOT-CD.iso}}

{{Note|cdrecord est fourni par deux paquets (un seul parquet suffit): {{Package|app-cdr/cdrtools}} et {{Package|app-cdr/cdrkit}}}}

Dès à présent, si ce n'est pas déjà fait, il faut configurer le BIOS afin de démarrer sur le CD-ROM. Ensuite, on suit normalement les instructions indiquées sur le site web du fabricant.

== FreeDOS environment ==

FreeDOS can be used to run DOS-based BIOS update utilities. A "custom" FreeDOS image which includes the necessary BIOS tools must be created. After the custom image has been generated, boot the image via one of the methods shown below.

Télécharger FreeDOS et les outils :

* [http://www.ibiblio.org/pub/micro/pc-stuff/freedos/files/distributions/1.0/ FreeDOS] - Download the {{Path|fdboot.img}} file.
* [http://www.ibiblio.org/pub/micro/pc-stuff/freedos/files/dos/sys/sys-freedos-linux/ FreeDOS bootsector] - Download the {{Path|sys-freedos-linux.zip}} file.
* The DOS-Flash program and new BIOS from the manufacturers website.

=== Create a custom FreeDOS image ===

First download the required software and enable the loopback device in the kernel:

{{KernelBox|title=enable loopback device|1=
Device Drivers  --->
    [*] Block devices  --->
        <M>   Loopback device support
}}

If the module has not been loaded use {{c|modprobe}} to load it:

{{RootCmd|modprobe loop}}

Install the required software:

{{Emerge|dev-lang/nasm app-arch/unzip sys-fs/dosfstools}}

Create an image file of ~20MB using the {{c|dd}} command. The name needs to be {{Path|freedos.img}} when replacing the one on the SystemRescueCD:

{{RootCmd|dd if{{=}}/dev/null of{{=}}freedos.img bs{{=}}1024 seek{{=}}20480}}

Placez un système de fichiers sur l'image :

{{RootCmd|mkfs.msdos freedos.img}}

Écrivez le secteur d'amorçage sur le fichier image :

{{RootCmd|unzip sys-freedos-linux.zip && ./sys-freedos.pl --disk{{=}}freedos.img}}

Maintenant, il faut copier les fichiers FreeDOS sur la nouvelle image.

Créez les points de montage :

{{RootCmd|mkdir -p /mnt/freedos /mnt/freedos_new}}

Montez l'image originale :

{{RootCmd|mount -o loop fdboot.img /mnt/freedos}}

Montez la nouvelle image :

{{RootCmd|mount -o loop freedos.img /mnt/freedos_new}}

Copiez les fichiers systèmes de FreeDOS sur la nouvelle image :

{{RootCmd|cp -ar /mnt/freedos/* /mnt/freedos_new/}}

Maintenant copier le programme flash et le nouveau BIOS sur le fichier image :

{{RootCmd|cp -ar FLASH-PROGRAM BIOS-UPDATE /mnt/freedos_new}}

Démontez les deux images :

{{RootCmd|umount /mnt/freedos_new /mnt/freedos}}

{{Note|DOS can only display names up to a length of 8 characters. It is a good idea to rename some of the files if their filenames are longer than this limit.}}

=== Utiliser SystemRescueCD pour démarrer sur FreeDOS ===

The SystemRescueCD comes with a version of FreeDOS. This version can replace the original image and create a bootable memory stick which contains the needed programs to flash the firmware.

==== Télécharger le  SystemRescueCD et préparer une clé LiveUSB ====

* [http://www.sysresccd.org/Download SystemRescueCD] - Download the normal ISO image.

==== Create a bootable memory stick ====

Use the default method to create the SystemRescueCD boot medium, the script {{Path|usb_inst.sh}} will provide guidance through the installation.

{{Warning|This will delete any data on the memory stick! Be sure all data has been properly backed up before using the memory stick for this task!}}

Créez le répertoire dans {{Path|/mnt}} :

{{RootCmd|mkdir /mnt/SysRescueCD}}

Montez l'image CD :

{{RootCmd|mount -o loop systemrescuecd-x86-VERSION.iso /mnt/SysRescueCD}}

Lancez le script d'installation :

{{RootCmd|/mnt/SysRescueCD/usb_inst.sh}}

Démontez l'image CD :

{{RootCmd|umount /mnt/SysRescueCD}}

==== Remplacez l'image FreeDOS ====

It is time to replace the original FreeDOS image on the SystemRescueCD memory stick.

Mount the SystemRescueCD memory stick ({{Path|/dev/sdX1}} needs to be replaced by the device name of the memory stick):

{{RootCmd|mount /dev/sdX1 /mnt/SysRescueCD}}

Remplacer le fichier {{Path|freedos.img}}:

{{RootCmd|cp freedos.img /mnt/SysRescueCD/bootdisk/}}

Démontez la clé USB SystemRescueCD :

{{RootCmd|umount /mnt/SysRescueCD}}

=== Démarrer sur l'image  FreeDOS directement à partir de GRUB ===

To boot FreeDOS without any external media use the {{c|memdisk}} tool from syslinux to allow grub (or another bootloader) to boot the FreeDOS image directly.

{{Emerge|sys-boot/syslinux}}

Mount the {{Path|/boot}} partition (if needed):

{{RootCmd|mount /boot}}

Copy the {{c|memdisk}} binary and the newly built FreeDOS image to {{Path|/boot}}:

{{RootCmd|cp /usr/share/syslinux/memdisk /boot}}
{{RootCmd|cp freedos.img /boot}}

Éditez {{Path|/boot/grub/grub.conf}} et ajoutez-y une entrée pour FreeDOS :

{{FileBox|filename=/boot/grub/grub.conf|title=Exemple d'entrée grub.conf|1=
title FreeDOS (BIOS update)
kernel /boot/memdisk floppy
initrd /boot/freedos.img
}}

=== BIOS update ===

Restart and choose to boot from the USB memory stick ''or'' the new grub entry. When using SystemRescueCD, in the GRUB command line type:

{{GenericCmd|freedos}}

This should boot into the new FreeDOS image. The DOS prompt should appear:

{{CodeBox|C:\}}

Now start the BIOS update by following the manufacturers instructions. Some useful commands in DOS:

; {{c|cd <dir>}}
: Change to the directory.

; {{c|dir}}
: List the files in the current directory.

; {{c|type [drive][path]filename}}
: Display the contents of a file.

== Flashrom ==

Some motherboards can support flashing (via the {{Package|sys-apps/flashrom}} package) directly from the system. In this case the only needed component is the BIOS image. Before continuing this path, first check the list of [http://flashrom.org/Supported_hardware supported hardware].

If the hardware is supported, verify the new BIOS image:

{{RootCmd|flashrom -v W7235IMS.1A0}}

If everything checks out, then flash it:

{{RootCmd|flashrom -vw W7235IMS.1A0}}

== Voir aussi ==

* [[BIOS]]
* [[Bootable DOS USB stick]]

[[Category:Core system]]
