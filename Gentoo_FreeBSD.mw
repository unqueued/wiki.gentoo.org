{{InfoBox stack
|{{InfoBox homepage|https://www.freebsd.org/|header=true}}
|{{InfoBox wikipedia|FreeBSD}}
}}

{{Important|Sometimes, Gentoo FreeBSD's <code>@system</code> is broken.
Please get latest information from "Depends on" of {{Bug|462580}}.
}}

Gentoo FreeBSD was [[Article description::a Gentoo system based on FreeBSD.]] Gentoo FreeBSD is no longer maintained by any active Gentoo developers.

It was FreeBSD with the following changes:

* Portage replaces ports.
* The base system is managed by Portage.
* Software in {{Path|./contrib}} and {{Path|./crypto}} is replaced with Gentoo versions.
* The rc system is replaced with [[OpenRC]].
* {{c|python}}, {{c|wget}} and {{c|bash}} are included in the base system to support Portage.
* FreeBSD's bootloader is removed from the base system (useful for jails).

{{Note|Gentoo FreeBSD is not 100% binary-compatibility with regular FreeBSD due to <var>SONAME</var> differences. It is possible to workaround that by running regular FreeBSD in either a jail or chroot on Gentoo FreeBSD or vice versa.

Gentoo FreeBSD is also not 100% script-compatible with regular FreeBSD by default. Script compatibility can be restored by installing {{Package|sys-freebsd/ubin-wrappers}}. This makes it possible to use *BSD software like pkgsrc.
}}

== Introduction to FreeBSD ==

=== What is FreeBSD? ===

[https://www.freebsd.org/ FreeBSD] is a free ([https://www.freebsd.org/copyright/freebsd-license.html license]) Unix-like operating system. Back in 1993 when development of [https://www.386bsd.org/ 386BSD] stopped, two projects were born: [https://www.netbsd.org/ NetBSD], commonly known to run on a huge number of architectures, and FreeBSD which supports the x86, amd64, ia64, sparc64 and alpha platforms. FreeBSD is renowned for its stability, performance and security, thus being used from small to huge companies all over the world.

FreeBSD's current production release is version 11.0. Gentoo/FreeBSD is based on version 11.0 and older versions of Gentoo/FreeBSD are discontinued and no longer supported.

=== What is Gentoo/FreeBSD? ===

[[Project:FreeBSD|FreeBSD project]] is a sub-project of the [[Project:Prefix|Prefix project]] project, with the goal of providing a fully-capable FreeBSD operating system featuring design sensibilities taken from Gentoo Linux, such as the init system and the Portage package management system.

=== FreeBSD and Linux ===

Users migrating from Linux to FreeBSD commonly consider the two operating systems "almost the same". In fact, FreeBSD really shares a lot of similarities with Linux distributions in general. Nevertheless, it has some key differences that are worth noting:

* Contrary to Linux, which actually only refers to the kernel, FreeBSD is a complete operating system, consisting of a C library, userland tools and much more. This development approach makes the overall system very consistent.
* Contrary to the Linux kernel, FreeBSD development is not led by one person, but instead managed by a small group of people called the [https://www.freebsd.org/doc/en_US.ISO8859-1/articles/contributors/staff-committers.html Core Team].

Besides, FreeBSD also has some technical differences which set it apart from Linux. Some of them are very important to know, even if you don't plan on joining the Gentoo/FreeBSD development effort:

* To get run-time dynamic linking functions like dlopen(), programs do not need to be linked against libdl like on GNU/Linux. Instead they are linked against libc.
* FreeBSD doesn't have an official tool for kernel compilation, thus you'll have to resolve feature dependencies on your own.
* FreeBSD supports [[UFS]]/[[UFS2]] and [[ZFS]] as native file systems.
* FreeBSD also supports Linux filesystems, but you cannot install your system on them. ext2/ext3 supports read/write access. ReiserFS, [[XFS]] are read-only support. details please see FreeBSD's handbook [https://www.freebsd.org/doc/handbook/filesystems-linux.html 21.3. LinuxÂ® Filesystems]

== Installation ==

{{Important|Part of x86-fbsd is out of date.
Please install amd64-fbsd.}}

=== Caution ===

This guide provides minimal information about Gentoo/FreeBSD. You need specialized knowledge of Gentoo/Linux and FreeBSD. The [[Handbook:Main Page|Gentoo Linux Handbook]] and [https://www.freebsd.org/handbook/ FreeBSD Handbook] should be close friends.

=== Preparation ===

Gentoo/FreeBSD doesn't have the installation media. Instead, you can use vanilla FreeBSD 9.0 or later version one.
Please get [http://ftp-archive.freebsd.org/pub/FreeBSD-Archive/old-releases/i386/ISO-IMAGES/9.0/ i386] or [http://ftp-archive.freebsd.org/pub/FreeBSD-Archive/old-releases/amd64/ISO-IMAGES/9.1/ amd64] from ftp-archive.freebsd.org. Some ISO images are available from the ftp server, but please get -bootonly.iso image. Because you can install Gentoo/FreeBSD with the smallest media. If you want to use a memory stick, please get -memstick.img. If necessary, burn it to a CD or write it to a memory stick.

Boot your PC with the installation media. Wait for display a Welcome dialog. Please choose Shell.

{{Note|If you have 4KB/sector HDD (aka AFT Drive)

Please select "2. [Esc]ape to loader prompt" at boot time if you have a 4KB/sector HDD.

Set the device name of your HDD with 4KB sectors in the boot loader. ada1 and ada2... to increase if you have more than one.

<pre>
set kern.cam.ada.0.quirks="1"
boot
</pre>
}}

==== Optional: Setting keymap  ====

If your keyboard is not an English 101 keyboard, set the keymap:

{{RootCmd|kbdcontrol -l uk.iso}}

A list of the keymap is available with the following command:

{{RootCmd|ls -1 /usr/share/syscons/keymaps {{!}} less}}

==== Network setting ====

First, create a directory {{Path|/tmp/bsdinstall_etc}} to rewrite the {{Path|resolv.conf}}:

{{RootCmd|mkdir -p /tmp/bsdinstall_etc}}

Identify your network devices. In this example the network interface is <code>em0</code>:

{{RootCmd|ifconfig|output=
<pre>em0: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        options=209b&lt;RXCSUM,TXCSUM,VLAN_MTU,VLAN_HWTAGGING,VLAN_HWCSUM,WOL_MAGIC&gt;
        ether 00:00:00:00:00:00
        nd6 options=29&lt;PERFORMNUD,IFDISABLED,AUTO_LINKLOCAL&gt;
        media: Ethernet autoselect (1000baseT &lt;full-duplex&gt;)
        status: active
lo0: flags=8049&lt;UP,LOOPBACK,RUNNING,MULTICAST&gt; metric 0 mtu 16384
        options=3&lt;RXCSUM,TXCSUM&gt;
        inet6 ::1 prefixlen 128
        inet6 fe80::1%lo0 prefixlen 64 scopeid 0x3
        inet 127.0.0.1 netmask 0xff000000
        nd6 options=21&lt;PERFORMNUD,AUTO_LINKLOCAL&gt;</pre>}}

Set the default gateway and IP address. 

When setting a static address:

{{RootCmd|ifconfig em0 192.168.0.100
|route add default 192.168.0.1
|echo "nameserver 8.8.8.8" > /etc/resolv.conf
}}

When using DHCP:

{{RootCmd|dhclient em0}}

==== Optional: Installing via ssh ====

{{RootCmd
|mkdir -p /tmp/etc
|mount -t tmpfs tmpfs /tmp/etc
|mount -t unionfs /tmp/etc /etc
|passwd
|echo "PermitRootLogin yes" &gt;&gt; /etc/ssh/sshd_config
|/etc/rc.d/sshd onestart
}}

Please connect with any ssh client. The username is root.

==== Setting the partition ====

{{Important|{{Package|sys-boot/grub2}} doesn't have KEYWORDS{{=}}"~amd64-fbsd ~x86-fbsd" yet. {{Package|sys-freebsd/boot0}} is recommended for bootloader on Gentoo/FreeBSD.}}

{{Note|If you want to use grub2, you need 1 MB free space at the beginning of the disk (MBR) or bios-boot partition (GPT). grub2 cannot find freebsd-boot partition. Please set the bios-boot (GPT).}}

You need to find out the device name to install. You can get it with <code>ls /dev/*da*</code> or <code>dmesg | grep 'da[0-9]'</code>. In this case, it's ada0:

{{Note|If you are using serial ATA & IDE drives, the device name is /dev/ada*. If you are using SCSI & USB drives, it's /dev/da*.}}

{{RootCmd|dmesg {{!}} grep 'da[0-9]'|output=<pre>
ada0 at ata0 bus 0 scbus0 target 0 lun 0
ada0: <QEMU HARDDISK 0.15.> ATA-7 device
ada0: 16.700MB/s transfers (WDMA2, PIO 8192bytes)
ada0: 12288MB (25165824 512 byte sectors: 16H 63S/T 16383C)
ada0: Previously was known as ad0
</pre>}}

===== Using the UFS2 file system (GPT) =====

{{Note|GPT partition is the standard FreeBSD 9.0. Please read the next MBR section if using a MBR partition.}}

If you follow this example, you will create simple two partitions. If necessary, you can split {{Path|/}}, {{Path|/usr}}, {{Path|/var}}, {{Path|/tmp}}, and {{Path|/home}}. Please set with the gpart. 

{| class="wikitable"
! Partition
! Filesystem
! Size
! Description
|-
|{{Path|/dev/ada0p1}}
|none
|just a bit
|Reserved for bootloader
|-
|{{Path|/dev/ada0p2}}
|UFS2 + SU
|entire disk - swap space
|Root partition
|-
|{{Path|/dev/ada0p3}}
|swap
|Rest of the disk
|Swap partition
|}

{{Note|Please add options -a 4k to gpart add command of all, if you have AFT drive (4096 bytes/sector). The start of the partition is properly configured, you can get the best performance.}}

====== Using FreeBSD's default bootloader. [Recommend] ======

{{RootCmd
|gpart create -s GPT ada0
|gpart add -s 64k -t freebsd-boot ada0
|gpart add -s 10G -t freebsd-ufs -l root ada0
|gpart add -t freebsd-swap -l swap ada0
}}

Please run gpart show in order to confirm results. 

{{RootCmd|gpart show|output=
<pre>
=&gt;      34  25165757  ada0  GPT  (12G)
        34       128     1  freebsd-boot  (64k)
       162  20971520     2  freebsd-ufs  (10G)
  20971682   4194109     3  freebsd-swap  (2G)</pre>}}

Results when you create a partition with option -a 4k.

{{RootCmd|gpart show|output=
<pre>
=&gt;      34  25165757  ada0  GPT  (12G)
        34         6        - free -  (3.0k)
        40       128     1  freebsd-boot  (64k)
       168  20971520     2  freebsd-ufs  (10G)
  20971688   4194096     3  freebsd-swap  (2G)
  25165784         7        - free -  (3.5k)
</pre>}}

====== Using grub2. [Experimental] ======

{{RootCmd
|gpart create -s GPT ada0
|gpart add -s 1024k -t bios-boot ada0 
|gpart add -s 10G -t freebsd-ufs -l root ada0
|gpart add -t freebsd-swap -l swap ada0
}}

===== Using the UFS2 file system (MBR) =====

{| class="table table-striped table-condensed"
! Partition
! Filesystem
! Size
! Description
|-
|{{Path|/dev/ada0s1a}}
|UFS2 + SU
|entire disk - swap space
|Root partition
|-
|{{Path|/dev/ada0s1b}}
|swap
|Rest of the disk
|Swap partition
|}

====== Using FreeBSD's default bootloader. [Recommend] ======

{{RootCmd
|gpart create -s mbr ada0
|gpart add -t freebsd ada0
|gpart set -a active -i 1 ada0
|gpart create -s bsd ada0s1
|gpart add -s 10G -t freebsd-ufs ada0s1
|gpart add -t freebsd-swap ada0s1
}}

====== Using grub2. [Experimental] ======

{{RootCmd
|gpart create -s mbr ada0
|gpart add -b 1024k -t freebsd ada0
|gpart set -a active -i 1 ada0
|gpart create -s bsd ada0s1
|gpart add -s 10G -t freebsd-ufs ada0s1
|gpart add -t freebsd-swap ada0s1
}}

===== Using the ZFS file system (experimental) / (GPT) =====

====== Using FreeBSD's default bootloader. [Recommend] ======

{{RootCmd
|gpart create -s GPT ada0
|gpart add -s 64k -t freebsd-boot ada0
|gpart add -t freebsd-zfs -l zfs-system ada0
}}

====== Using grub2. [Experimental] ======

{{RootCmd
|gpart create -s GPT ada0
|gpart add -s 1024k -t bios-boot ada0
|gpart add -t freebsd-zfs -l zfs-system ada0
}}

==== Creating and mounting a file system ====

===== Using the UFS2 file system =====

Please don't forget newfs <code>-L</code> option to label. 

{{Note|Add option <code>-j</code> to newfs to enable soft updates journaling. Add option <code>-t</code> to enable TRIM.}}

Your choice GPT:

{{RootCmd|newfs -L gfbsdroot -U /dev/ada0p2}}

Your choice MBR:

{{RootCmd|newfs -L gfbsdroot -U /dev/ada0s1a}}

And mount it:

{{RootCmd
|mount /dev/ufs/gfbsdroot /mnt
|swapon /dev/gpt/swap (GPT)
|swapon /dev/ada0s1b (MBR)
}}

===== Using the ZFS file system (experimental) =====

Load the kernel module in order to enable ZFS:

{{RootCmd|kldload zfs}}

Prepare the RAM disk to write {{Path|/boot/zfs/zpool.cache}}:

{{RootCmd|mount -t tmpfs tmpfs /boot/zfs}}

Please use gnop if you have 4KB/sector HDD. You can get the best performance:

{{RootCmd|gnop create -S 4096 /dev/gpt/zfs-system}}

Creates a new storage pool. If you are using gnop, please specify {{Path|/dev/gpt/zfs-system.nop}} instead of {{Path|/dev/gpt/zfs-system}}.

{{RootCmd|zpool create zsys /dev/gpt/zfs-system
|zfs set mountpoint{{=}}none zsys}}

Creates a new ZFS file system:

{{RootCmd
|zfs create zsys/root
|zfs set mountpoint{{=}}/mnt zsys/root
|zfs mount -a
|zfs create zsys/root/usr
|zfs create zsys/root/var}}
{{RootCmd|zfs create zsys/root/tmp
|zfs create zsys/home
|zfs create -V 8gb zsys/swap
|zfs set org.freebsd:swap{{=}}on zsys/swap
|zfs set checksum{{=}}off zsys/swap
}}

{{RootCmd
|mkdir /mnt/home
|mount -t zfs zsys/home /mnt/home
}}

==== Downloading the stage3 tarball and Portage snapshot ====

Now, Gentoo/FreeBSD 9.0 [[stage3]] is available for x86-fbsd. And Gentoo/FreeBSD 9.1 [[stage3]] is available for amd64-fbsd.

{{Important|If you want to use amd64-fbsd, please upgrade to 10.3 after the installation is complete. FreeBSD 9.1 is EOL on December 31, 2014. If you want to use x86-fbsd, please upgrade to 10.3 after the installation is complete. FreeBSD 9.0 is EOL on March 31, 2013.}}

{{RootCmd
|cd /mnt
|fetch http://dev.gentoo.org/~aballier/fbsd9.0/x86/stage3-i686-freebsd-9.0.tar.bz2 (for x86-fbsd users)
|fetch http://distfiles.gentoo.org/experimental/bsd/freebsd/stages/amd64-fbsd-9.1/stage3-amd64-freebsd-9.1.tar.bz2 (for amd64-fbsd users)
|fetch http://distfiles.gentoo.org/snapshots/portage-latest.tar.bz2
}}

==== Unpacking stage3 and Portage snapshot ====

{{Important|The following error may be displayed. Don't worry, please continue the installation. This problem will be fixed in 9.2. Details, see {{Bug|469454}}
<pre>./bin/fuser: Can't create 'bin/fuser'
tar: Error exit delayed from previous errors.
</pre>}}

{{RootCmd|cd /mnt
|setenv LANG "en_US.UTF-8"
|tar xjpf stage3-*.tar.bz2 -C /mnt
|tar xjf portage-latest.tar.bz2 -C /mnt/usr
}}

==== Entering the new environment ====

{{RootCmd|mount -t devfs devfs /mnt/dev
|cp /etc/resolv.conf /mnt/etc/
|chroot /mnt /bin/bash}}

=== Settings and install more in chroot environment ===

==== The first settings and time zone settings ====

env-update and time zone settings. Of course, you can modify {{Path|/etc/portage/make.conf}}. 

{{RootCmd|env-update && source /etc/profile
|cp /usr/share/zoneinfo/GMT /etc/localtime (please select your time zone)
|emerge -u sys-apps/portage ; emerge sys-devel/libtool app-admin/eselect
|emerge app-editors/nano
|mv /etc/make.conf /etc/portage/ (if /etc/make.conf is exist.)
|nano -w /etc/portage/make.conf (if necessary)
|prompt=(chroot) root #}}

==== Bug fixes (for x86-fbsd users, 9.0 stage3 only) ====

Bugs have been fixed in several packages. Please upgrade them. For details, see {{Bug|324445}}, {{Bug|412319}}, {{Bug|417031}} and {{Bug|421191}}.

{{RootCmd|emerge sys-devel/gcc-config
|emerge sys-freebsd/freebsd-mk-defs sys-freebsd/freebsd-lib app-arch/libarchive dev-libs/libedit
|prompt=(chroot) root #}}

==== Special settings for ZFS ====

If you select ZFS file system, the following additional work is required.

{{RootCmd|emerge flaggie
|flaggie +zfs
|emerge sys-devel/flex
|emerge sys-freebsd/freebsd-cddl
|emerge sys-freebsd/freebsd-lib sys-freebsd/freebsd-ubin sys-freebsd/boot0
|prompt=(chroot) root #}}

==== Installing a kernel source ====

Unlike Gentoo/Linux, freebsd-sources package is the only sources.

{{RootCmd|USE{{=}}symlink emerge freebsd-sources
|prompt=(chroot) root #}}

==== Compiling and installing kernel ====

Now let's compile the kernel.
For more information see the [https://www.freebsd.org/doc/handbook/kernelconfig.html FreeBSD Handbook].

{{RootCmd|emerge -u sys-devel/flex
|cd /usr/src/sys/i386/conf (case of x86-fbsd)
|cd /usr/src/sys/amd64/conf (case of amd64-fbsd)
|cp GENERIC.hints /boot/device.hints
|prompt=(chroot) root #}}
{{RootCmd|config GENERIC
|cd ../compile/GENERIC
|make cleandepend &amp;&amp; make depend &amp;&amp; make -j3 &amp;&amp; make install
|prompt=(chroot) root #}}

==== System settings ====

Familiar setting. 
Please refer to [[Gentoo Handbook]] if you need more information.

If you select UFS2:

{{RootCmd|nano -w /etc/fstab|output=
<pre># Device	Mountpoint	FStype	Options	Dump	Pass#
/dev/ufs/gfbsdroot	/		ufs	rw	1	1

#your choice GPT (don't forget comment out)
#/dev/gpt/swap	none		swap	sw	0	0

#your choice MBR (don't forget comment out)
#/dev/ada0s1b	none		swap	sw	0	0
</pre>
|prompt=(chroot) root #}}

If you select ZFS.  Note that the Pass# column should be zero for ZFS, because it cannot be checked by fsck.
{{RootCmd|nano -w /etc/fstab|output=
<pre># Device	Mountpoint	FStype	Options	Dump	Pass#
#/dev/ad0s1a	/		ufs	rw	1	1
#/dev/ad0s1b	none		swap	sw	0	0
zsys/root	/		zfs	rw	0	0
</pre>
|prompt=(chroot) root #}}

Setting the host name
{{RootCmd|nano -w /etc/conf.d/hostname|output=
<pre># (Set the hostname variable to your host name.  On BSD this is expected to be the FQDN.)
hostname="daemon.homenetwork"
</pre>
|prompt=(chroot) root #}}

Editing network setting
{{RootCmd|nano -w /etc/conf.d/net|output=
<pre># (Set the dns_domain variable to your domain name)
dns_domain_lo="homenetwork"

# Manually setting)
config_em0="192.168.0.100 netmask 255.255.255.0"
routes_em0="default via 192.168.0.1"

# Using DHCP)
config_em0="dhcp"
</pre>
|prompt=(chroot) root #}}

Adding net.em0 to the default runlevel
{{RootCmd|cd /etc/init.d
|ln -s net.lo0 net.em0
|rc-update add net.em0 default
|prompt=(chroot) root #}}

Setting keymap

Please edit {{Path|/etc/conf.d/syscons}} if you want to change the keymap.
{{RootCmd|nano -w /etc/conf.d/syscons
|prompt=(chroot) root #}}

A list of the keymap is available with the following command.
{{RootCmd|ls -1 /usr/share/syscons/keymaps {{!}} less
|prompt=(chroot) root #}}

Setting the root password

{{RootCmd|passwd
|prompt=(chroot) root #}}

Adding a user for daily use (sample)

{{RootCmd|adduser
|output=
<pre>Username: yournickname
Full name:
Uid (Leave empty for default):
Login group [yournickname]:
Login group is yournickname. Invite yournickname into other groups? []: wheel
Login class [default]:
Shell (bash csh esh fish ksh sash sh tcsh zsh nologin) [sh]: bash
Home directory [/home/yournickname]:
Home directory permissions (Leave empty for default):
Use password-based authentication? [yes]:
Use an empty password? (yes/no) [no]:
Use a random password? (yes/no) [no]:
Enter password:
Enter password again:
Lock out the account after creation? [no]:
Username   : yournickname
Password   : *****
Full Name  :
Uid        : 1001
Class      :
Groups     : yournickname wheel
Home       : /home/yournickname
Home Mode  :
Shell      : /bin/bash
Locked     : no
OK? (yes/no): yes
adduser: INFO: Successfully added (yournickname) to the user database.
Add another user? (yes/no): no
Goodbye!
</pre>
|prompt=(chroot) root #}}

You can run at startup <i>sshd</i>:

{{RootCmd
|emerge -u net-misc/openssh
|rc-update add sshd default
|prompt=(chroot) root #
}}

===== Special settings for ZFS =====

If you select ZFS file system, the following additional work is required:

{{RootCmd|rc-update add zfs boot
|rc-update add zvol default
|echo 'zfs_load{{=}}"YES"' >> /boot/loader.conf
|echo 'vfs.root.mountfrom{{=}}"zfs:zsys/root"' >> /boot/loader.conf
|prompt=(chroot) root #}}

===== Special settings for virtual machine =====

If you are installing on a virtual machine, the following additional configuration is required:

{{RootCmd|echo 'kern.hz{{=}}100' >> /boot/loader.conf
|prompt=(chroot) root #}}

==== Installing the required packages ====

{{Package|net-misc/dhcpcd}} is required if you want use DHCP:

{{RootCmd|emerge net-misc/dhcpcd
|prompt=(chroot) root #}}

==== Installing the boot loader ====

Let's install a boot loader to boot the Gentoo/FreeBSD:

{{RootCmd|emerge sys-freebsd/boot0
|prompt=(chroot) root #}}

Please see [[Gentoo_FreeBSD/Experimental#How to use sys-boot/grub2|this section]] if you want to use grub2. But it is experimental!

==== Setting boot loader ====

Let's prepare for using {{Package|sys-freebsd/boot0}}.

If you select UFS2 (GPT):

{{RootCmd|gpart bootcode -b /boot/pmbr ada0
|gpart bootcode -p /boot/gptboot -i 1 ada0
|prompt=(chroot) root #}}

If you select UFS2 (MBR):

{{RootCmd|gpart bootcode -b /boot/boot0 ada0
|gpart bootcode -b /boot/boot ada0s1
|prompt=(chroot) root #}}

If you select ZFS (GPT):

{{RootCmd|gpart bootcode -b /boot/pmbr ada0
|gpart bootcode -p /boot/gptzfsboot -i 1 ada0
|prompt=(chroot) root #}}

==== Exit from the chroot environment ====
Exit from the chroot environment: 
{{RootCmd|exit
|prompt=(chroot) root #}}

=== Cleaning up and setting the remaining ===

Do you want to reboot now ? Just a minute. ZFS user must have setting a little more.

==== Special settings for ZFS ====

If you select ZFS file system, the following additional work is required.

{{RootCmd|umount /mnt/dev
|cd /
|zpool set bootfs{{=}}zsys/root zsys
|zpool export zsys
|gnop destroy /dev/gpt/zfs-system.nop (please run if you are using gnop)}}
{{RootCmd|zpool import zsys
|mkdir /mnt/boot/zfs
|cp /boot/zfs/zpool.cache /mnt/boot/zfs/
|zfs unmount -a}}
{{RootCmd|zfs set mountpoint{{=}}none zsys
|zfs set mountpoint{{=}}/usr zsys/root/usr
|zfs set mountpoint{{=}}/var zsys/root/var
|zfs set mountpoint{{=}}/tmp zsys/root/tmp
|zfs set mountpoint{{=}}/home zsys/home
|zfs set mountpoint{{=}}legacy zsys/root}}

==== Reboot! ====

Don't have a problem? Now restart.

Don't forget to remove the installation media.

{{RootCmd|shutdown -r now}}

== Howto run G/FBSD in vanilla FreeBSD's jail ==

Details of jail, please see the [https://www.freebsd.org/handbook/jails.html FreeBSD Handbook].

=== Preparing directory ===

{{RootCmd
|mkdir -p /usr/jail/gfbsd
|cd /usr/jail/gfbsd}}

=== Downloading and Unpacking the stage3 tarball and Portage snapshot ===

{{RootCmd
|fetch http://dev.gentoo.org/~aballier/fbsd9.0/x86/stage3-i686-freebsd-9.0.tar.bz2 (for x86-fbsd users)
|fetch http://distfiles.gentoo.org/experimental/bsd/freebsd/stages/amd64-fbsd-9.1/stage3-amd64-freebsd-9.1.tar.bz2 (for amd64-fbsd users)
|fetch http://distfiles.gentoo.org/snapshots/portage-latest.tar.bz2
|tar xjpf stage3-*.tar.bz2
|tar xjf portage-latest.tar.bz2 -C /usr/jail/gfbsd/usr
}}

=== Setting ===

Configure the jail to start with FreeBSD:

{{FileBox|filename=/etc/rc.conf|title=Example for starting the jail at boot time|lang=bash|1=
jail_enable="YES"
jail_list="gfbsd"

jail_gfbsd_rootdir="/usr/jail/gfbsd"
jail_gfbsd_hostname="gfbsd.example.org"
jail_gfbsd_devfs_enable="YES"

# You will need to add the following line if you want network access.
# Please specify your network devices instead of em0.
jail_gfbsd_interface="em0"
jail_gfbsd_ip="192.168.0.10"
}}

Setting to operate Gentoo/FreeBSD in the jail:

{{RootCmd|echo 'rc_sys{{=}}"jail"' >> /usr/jail/gfbsd/etc/rc.conf
|echo 'hostname{{=}}"gfbsd"' > /usr/jail/gfbsd/etc/conf.d/hostname
|echo 'syslogd_args{{=}}"-ss"' >> /usr/jail/gfbsd/etc/conf.d/syslogd}}

{{RootCmd|chroot /usr/jail/gfbsd /bin/bash}}

{{RootCmd
|rc-update add vixie-cron default
|exit
|prompt=(chroot) root #}}

=== Run jail ===

Let's run jail:

{{RootCmd|/etc/rc.d/jail start}}

You can check that it worked:

{{RootCmd|jls|output=
<pre>
   JID  IP Address      Hostname                      Path
     1  192.168.0.10    gfbsd                         /usr/jail/gfbsd
</pre>}}

You can enter the jail environment with the jexec command:

{{RootCmd|jexec 1 /bin/bash}}

== Developing for Gentoo/FreeBSD ==

=== How to help ===

There are many things you could help with, depending on your skill level and spare time:

* Working on current ebuilds: this means working closely with ebuild maintainers in order to create patches or modify ebuilds in a way that can be accepted into the main tree.
* Security: if you are into security, we need you! Although security advisories from the FreeBSD project are tracked and fixed, we can always use help in this area.
* Contacts: we need people who can get in touch with FreeBSD developers to maintain contacts between us and the original project to exchange patches and discuss various problems and their solutions. Note that this should never involve any kind of spamming of mailing lists or IRC channels.
* Testing: the more people are actively using Gentoo/FreeBSD, the more bugs will be discovered, which helps us improving the quality of the port. If you are good at describing bugs or problems, we definitely want to hear from you.
* Other areas where we need help include: system ebuilds, creation of installation CDs, documentation, kernel hacking.

== Troubleshooting ==

=== Architecture independent issues ===

==== Emerge fails app-misc/screen ====

For details see {{Bug|393039}} and {{Bug|409819}}.

Please use {{Package|app-misc/tmux}} instead of {{Package|app-misc/screen}}.

==== lex: not found ====

{{emerge|sys-devel/flex}}

==== cc: not found ====

For details see {{Bug|412319}}:

{{RootCmd|emerge '>{{=}}sys-devel/gcc-config-1.7.1'}}

== Contacts ==

* gentoo-bsd mailing list ([https://archives.gentoo.org/gentoo-bsd/ Gentoo Mailing Lists])
* IRC channel {{IRC|gentoo-bsd}} on Freenode ([https://gentoo.org/get-involved/irc-channels/all-channels.html Gentoo Linux IRC channels list])

== See also ==

* [[Gentoo FreeBSD/Upgrade Guide]] - A sub-article on upgrading a G/FBSD system.
* [[Gentoo FreeBSD/Experimental]] - A sub-article that contains attempts to implement some uncommon features.
* [[Gentoo FreeBSD/Developers Note]] - A sub-article of developers note.
* [[Gentoo Alt/Contributor's Guide]] - A Gentoo Alt contributor's guide (deprecated).
* [[Project:Gentoo/Staffing_Needs]] - An article that lists the ways users can help.
* [[Handbook:Main Page|Gentoo Linux Handbook]]
* [https://www.freebsd.org/handbook/ FreeBSD Handbook]
* [https://www.freebsd.org/cgi/man.cgi FreeBSD Man Pages]
* [https://wiki.freebsd.org/ZFSTuningGuide ZFSTuningGuide - FreeBSD Wiki]
* [https://wiki.freebsd.org/ FreeBSD Wiki]

[[Category:Core system]]
