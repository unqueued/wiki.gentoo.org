<languages />

{{InfoBox stack
|{{InfoBox homepage|http://www.sshguard.net/|header=true}}
|{{InfoBox ohloh}}
}}

{{Metadata|abstract=sshguard es un sistema de prevención de intrusiones que analiza los registros del servidor, determina la actividad maliciosa y utiliza el cortafuegos del sistema para bloquear las direcciones IP de las conexiones maliciosas.}}

'''sshguard''' es un sistema de prevención de intrusiones que analiza los registros del servidor, determina la actividad maliciosa y utiliza el cortafuegos del sistema para bloquear las direcciones IP de las conexiones maliciosas. sshguard está escrito en C, así que no supone una carga para el sistema.

== Cómo funciona ==

sshguard es un demonio sencillo que hace un seguimiento continuo de uno o más ficheros de registro. Analiza los eventos del registro que los demonios envían en caso de intentos de conexión fallidos y entonces bloquea cualquier intento de esas conexiones mediante la actualización del cortafuegos del sistema.

A diferencia de lo que su nombre indica, sshguard no solamente analiza los registros de SSH. También es compatible con muchos sistemas de correo, así como unos pocos FTP. Una lista completa de los servicios soportados se puede encontrar en el [http://www.sshguard.net sitio web sshguard.net].

== Instalación ==

=== Emerge ===

Instale {{Package|app-admin/sshguard}}:

{{Emerge|app-admin/sshguard}}

Asegúrese también de que está instalado el paquete {{Package|net-firewall/iptables}} y que el mismo se utiliza como el cortafuegos del sistema. Al momento de escribir (este artículo), sshguard todavía no soporta {{Package|net-firewall/nftables}}.

{{Emerge|net-firewall/iptables}}

También se puede encontrar más información sobre el uso y configuración de IPtables en el [[Iptables|artículo IPtables]].

== Configuración ==

=== Preparar el cortafuegos ===

Cuando sshguard bloquea a cualquier usuario malintencionado (mediante el bloqueo de sus direcciones IP), utilizará la cadena <tt>sshguard</tt>.

Por tanto, prepare la cadena, y asegúrese también de que dicha cadena actúa cuando se detectan nuevas conexiones entrantes:

{{RootCmd|iptables -N sshguard
|iptables -A INPUT -j sshguard}}

=== Supervisar los ficheros de registro ===

The basic idea behind sshguard is that the administrator passes on the log file(s) to watch as options to the application - there is no native sshguard configuration file.

On Gentoo, the options can be best configured in the {{Path|/etc/conf.d/sshguard}} file:

{{FileBox|filename=/etc/conf.d/sshguard|title=Configuring sshguard to read /var/log/messages|lang=bash|1=
PARDONTIME="3600" # Blocks last at least 1 hour (3600 seconds)
WATCHTIME="360"   # Track IP addresses for 5 minutes (360 seconds)
THRESHOLD="10"    # How many problematic attempts trigger a block
  
LOGFILES="-l /var/log/messages"                      # Watch this file...
LOGFILES="${LOGFILES} -l /var/log/auth.log"          # And this one
  
SSHGUARD_OPTS="-p ${PARDONTIME} -s ${WATCHTIME} -a ${THRESHOLD} ${LOGFILES}"
}}

Make sure that the log files are accessible for the runtime user that sshguard uses.

=== Service ===

Have sshguard be started by default by adding it to the default runlevel, and then start it:

{{RootCmd|rc-update add sshguard default
|rc-service sshguard start}}

== See also ==

* [[Iptables]], for installing and configuring <tt>iptables</tt> on Gentoo

== External resources ==

La [http://www.sshguard.net/docs/ documentación de sshguard] proporciona toda la información necesaria para afinar aún más la aplicación.


[[Category:Security]]
[[Category:Server]]
