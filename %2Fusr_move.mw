''The /usr move'' is a concept of moving various applications installed into the filesystem root to /usr prefix in order to unify the filesystem layout.

== Prerequisites ==

=== initramfs (for system packages) ===

In order to perform the /usr move on packages required to boot the system, it is necessary that all users having separate /usr partition have an enabled and working initramfs. Such an initramfs would need to mount the /usr filesystem in order to execute the system init.

=== /usr remount in system RC ===

Considering that initramfs would mount /usr read-only (alike / is mounted now), OpenRC or any other RC used in Gentoo would need to be able to perform fsck on mounted /usr and re-mount it read/write afterwards. In other words, /usr would need to be handled alike / is handled now.

== The process ==

=== Modifying package install prefixes ===

The most important process in the /usr move is updating the packages to not use / prefix. In most cases, this simply involves removing the ''--prefix'' argument to configure calls since /usr is the default prefix used by ''econf''.

Some packages install files to rootfs directories explicitly. Those packages may require actually modifying the build system or specifying the prefix some other way.

=== Adding necessary symlinks ===

To maintain compatibility with various packages, a symlinks to various binaries or libraries may need to be created on rootfs. However, it is preferred that packages in question are checked for possibility of fixing first.

For example, if a script calls ''/bin/foo'', it is preferred that it is fixed to just call ''foo'' and let the shell handle ''${PATH}'' resolution rather than creating an unnecessary symlink.

== The /usr move in other distributions ==

A [http://fedoraproject.org/wiki/Features/UsrMove similar concept is being considered in Fedora] yet it assumes that the rootfs directories would become symlinks to /usr counterparts. In Gentoo we are rather considering creating the symlinks for necessary files only.
