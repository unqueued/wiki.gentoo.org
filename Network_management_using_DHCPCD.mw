== Abstract ==
It is possible to have a working network stack without resorting to Gentoo net.* scripts at all on simple configuration.

*Only hardware interfaces are needed, i.e. no virtual interfaces;
*IP addresses delivered through DHCP (eventually APIPA)

In such conditions all hardware interfaces can be configured, even the loopback interface, lo. 

== Basic configuration ==
Install dhcpcd
{{RootCmd|emerge  --ask net-misc/dhcpcd}}
Remove all network scripts from all runlevels
{{RootCmd|rc-update del net.lo}}
{{RootCmd|rc-update del net.eth0}}
{{RootCmd|rc-update del net.wlan0}}
<br />
Add dhcpcd to the default runlevel: 
{{RootCmd|rc-update add dhcpcd default}}

== Wireless ==
When you need wireless support also install wpa_supplicant and add the ctrl_interface on top of its configuration. To make it work you need wext compatibility enabled in your kernel.
{{RootCmd|emerge  --ask net-wireless/wpa_supplicant}}
{{File|/etc/wpa_supplicant/wpa_supplicant.conf||<pre>ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=wheel</pre>}}
{{File|/usr/src/linux/.config||<pre>CONFIG_CFG80211_WEXT=y</pre>}}
There is no need for having wpa_supplicant in the runlevel as dhcpcd will detect the interface, whatever it is called and set its IP address automatically. Also note a nice thing Linux does when having wired and wireless interfaces together on the same network is that the one with the lowest metric takes precedence over existing connections. 
<br />
Suppose for instance you have an ongoing transfer of a very large file over your wireless interface to an existing network mountpoint. Plug the cable and wait for dhcpcd to set the IP address of the ethernet interface and you'll see the network activity switch to the fastest interface. You don't even need to interrupt and restart the transfer. That feature comes handy when you cannot bond interfaces, especially with wireless.
<br />
For more details see [[wpa_supplicant]].

== Cleanup ==
When the net setup is working well you might want to remove the old netifrc setup.  So disable the netifrc useflag and reemerge openrc.
{{File|/etc/portage/package.use||<pre>sys-apps/openrc -netifrc</pre>}}
{{RootCmd|emerge --ask --newuse --oneshot sys-apps/openrc}}
Now you can remove netifrc.
{{RootCmd|emerge -C net-misc/netifrc}}
<br />
Also the old config files and symlinks can be removed
{{RootCmd|rm /etc/conf.d/net}}
{{RootCmd|rm /etc/init.d/net.eth0}}
{{RootCmd|rm /etc/init.d/net.wlan0}}
{{RootCmd|rm /etc/init.d/net.lo}}

[[Category:Network_management]]
