<languages />
<translate>
<!--T:1-->
This article is based on a [https://forums.gentoo.org/viewtopic-t-965190.html posting in the Gentoo Forums] and explains how to use dhcpcd for complete network stack management.

== Setup == <!--T:2-->

<!--T:3-->
Make sure [[Dhcpcd|dhcpcd]] is installed. Next, add it to the default runlevel and start the service:

<!--T:4-->
{{RootCmd
|rc-update add dhcpcd default
|/etc/init.d/dhcpcd start
}}

<!--T:5-->
This setup deviates from the default networking instructions in the Gentoo Handbook, but has the advantage that it provides automatic switching between wired and wireless network interfaces.

== Wireless == <!--T:6-->

<!--T:7-->
Dhcpcd has a hook for {{c|wpa_supplicant}}, so it is a good idea to install {{Package|net-wireless/wpa_supplicant}}.  However, since dhcpcd-6.10.0, this hook is no longer installed in {{Path|/lib/dhcpcd/dhcpcd-hooks}} by default<ref>[https://gentoo.org/support/news-items/2016-01-08-some-dhcpcd-hooks-are-now-examples.html News Items -  Some dhcpcd hooks are now examples], January 8th, 2016. Retrieved on January 11th, 2016.</ref>. After the [[Wpa_supplicant#Emerge|installation of wpa_supplicant]], copy the hook (now located inside {{Path|/usr/share/dhcpcd/hooks}}) and restart dhcpcd:

<!--T:8-->
{{RootCmd|cp /usr/share/dhcpcd/hooks/10-wpa_supplicant /lib/dhcpcd/dhcpcd-hooks|/etc/init.d/dhcpcd restart}}

<!--T:9-->
{{Important|Don't add wpa_supplicant to any runlevel.}}

<!--T:10-->
For more information or troubleshooting of {{c|wpa_supplicant}}, see the [[Wpa_supplicant|wpa_supplicant's Gentoo wiki page]] as well as its [http://hostap.epitest.fi/wpa_supplicant/ main site].

== Testing == <!--T:11-->

<!--T:12-->
Stop {{c|dhcpcd}} and {{c|wpa_supplicant}}, then start {{c|dhcpcd}} with debugging enabled and in the foreground to see {{c|dhcpcd}} starting the connection.

<!--T:13-->
{{RootCmd|/etc/init.d/dhcpcd stop
|killall wpa_supplicant
|dhcpcd -dB
|output=<pre>
dhcpcd[23772]: version 6.4.5 starting
dhcpcd[23772]: udev: starting
dhcpcd[23772]: dev: loaded udev
...
...
</pre>}}

== Static IP address == <!--T:14-->

<!--T:15-->
In case the network interface card should be configured with a [[Static_Routing|static IP address]], type it into the [[dhcpcd-ui#Usage|graphical user interface]].  Without the [[dhcpcd-ui#Usage|graphical user interface]], entries can also be [http://roy.marples.name/man/html5/dhcpcd.conf.html manually added] to {{Path|/etc/dhcpcd.conf}} as described in [[Dhcpcd#Static_IP_addresses]].

== Migration from Gentoo net.* scripts == <!--T:16-->

<!--T:17-->
When migrating from [[netifrc|Gentoo's net.* scripts]] it is essential to remove {{c|wpa_supplicant}} and the {{Path|net.*}} scripts from the runlevels.

<!--T:18-->
{{Cmd|rc-config list {{!}} grep 'wpa_supplicant\{{!}}dhcpcd\{{!}}net.'|output=<pre>
  net.wlp8s0                default
  dhcpcd                    default
  wpa_supplicant</pre>}}

<!--T:19-->
Any match starting with <code>net.</code> must not have a runlevel assigned. In the above example, {{Path|net.wlp8s0}} needs to be removed.

<!--T:20-->
{{RootCmd|rc-update del net.wlp8s0
|/etc/init.d/net.wlp8s0 stop}}

<!--T:21-->
Once the network setup works well, it is possible to completely remove the old Gentoo {{Path|net.*}} scripts (although this is not necessary). Disable the <code>netifrc</code> useflag, re-emerge OpenRC and finally unmerge {{Package|net-misc/netifrc}}:

<!--T:22-->
{{RootCmd|echo 'sys-apps/openrc -netifrc' >> /etc/portage/package.use
|emerge --ask --newuse --oneshot sys-apps/openrc
|emerge -C net-misc/netifrc}}

<!--T:23-->
Also the old configuration files and symlinks can be removed:

<!--T:24-->
{{RootCmd|rm /etc/conf.d/net
|rm /etc/init.d/net.*}}

== Network dependent services == <!--T:25-->

<!--T:26-->
Manipulating [[Network_dependent_services|network dependent services]] by {{c|dhcpcd}} is no longer supported since openrc-0.16.4.

== Graphical User interface == <!--T:27-->

<!--T:28-->
A [[dhcpcd-ui|dhcpcd graphical user interface]] is provided by {{Package|net-misc/dhcpcd-ui}}.

== See also == <!--T:29-->

<!--T:30-->
* [[Dhcpcd]]
* [[dhcpcd-ui]]

== External resources == <!--T:31-->

<!--T:32-->
* [https://forums.gentoo.org/viewtopic-t-965190-start-93.html Post 93 of Gentoo Forums :: View topic - TIP: Complete network stack without net.* scripts]

== References == <!--T:33-->

<!--T:34-->
{{reflist}}

</translate>

[[Category:Network_management]]
