{{InfoBox stack
|{{InfoBox homepage|https://www.varnish-cache.org/|header=true}}
|{{InfoBox wikipedia|Varnish_(software)}}
|{{InfoBox ohloh}}
}}

'''Varnish''' is [[Article description::a webcache and HTTP accelerator.]] It can either serve cached content, or retrieve content from a server and cache it. This helps to reduce I/O pressure for web servers that are serving many clients or have many requests.

== Installation ==

=== USE flags ===

{{USEflag|package=www-servers/varnish}}

=== Emerge ===

Install {{Package|www-servers/varnish}}

{{emerge|www-servers/varnish}}

== Configuration ==

=== Files ===

==== Global ====

Configuration is controlled by the {{Path|/etc/varnish/default.vcl}} file.

{{FileBox|filename=/etc/varnish/default.vcl|tile=Example configuration file|1=
# backend default {
#     .host = "127.0.0.1";
#     .port = "8080";
# }
}}

Any traffic pointed at port 8080 will be through varnish.

=== Service ===

==== OpenRC ====

To start varnish immediately:

{{RootCmd|rc-service varnishd start}}

To start varnish at boot:

{{RootCmd|rc-update add varnishd default}}

==== systemd ====

To start varnish on boot:

{{RootCmd|systemctl enable varnishd}}

To start varnish immediately:

{{RootCmd|systemctl start lightdm}}

== Troubleshooting ==

=== Verification ===

The {{c|curl}} command ({{Package|net-misc/curl}}) can be used to verify that HTTP traffic is successfully traveling through the varnish proxy:

{{Cmd|curl -I <nowiki>https://wiki.gentoo.org/wiki</nowiki>}}

[[Category:Server]]
[[Category:Daemons]]
