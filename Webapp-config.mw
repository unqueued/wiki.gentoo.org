{{Lowercase title}}
{{Stub}}
{{InfoBox stack
|{{InfoBox homepage|http://www.gentoo.org/|header=true}}
}}

'''webapp-config''' is Gentoo's installer for web-based applications. It is used for automatic setup of web applications in virtual hosting environments. Originally written as a bash script, webapp-config is now python-based and available in the Portage Tree.

__TOC__

== Concepts ==
<tt>webapp-config</tt> is aimed at providing the package management functionality that you need if you are running multiple web sites off of the same computer (virtual hosting).

=== Two-Stage Install ===
Package managers such as rpm and emerge are designed to install one copy of a package, and to install it onto one fixed location. This conflicts with the needs of a virtual hosting environment, where you need to be able to install a package in multiple places, so that it can be part of more than just the one website. But package managers are essential for maintaining a computer over time - so how can we have both?

The answer is a two-stage install. The traditional package manager installs a master copy into /usr/share/webapps/. This master copy isn't fit to run - but it is ready to then be used by webapp-config to install the package multiple times in multiple places.

=== Multiple Installations Of The Same Package ===
webapp-config allows you to install multiple copies of the same package on the same computer at the same time. You choose which directory to install each separate copy into.

We call these multiple installations "virtual copies".

You can also have different versions of the same package installed at the same time. This allows you to gradually roll out a new version of a package across your sites; you are not forced to upgrade every single website at once.

webapp-config minimises the number of duplicated files to the absolute minimum possible, to keep disk space usage low. The majority of files are hard linked to the master copy; only configuration files, and any files that the package needs to write to, are copied into the virtual copy.

=== File Ownership And Permissions ===
If you are used to installing web-based applications by hand, you'll appreciate that it can be a pain to get every file owned by the correct user, and with the correct permissions. Some files need to be owned by the user that the webserver runs as. Others need to be owned by specific shell accounts, so that those users can login and edit the configuration files. If your Linux distribution offers you a choice of web servers - each running under a different user - even the installers can struggle to get it right.

With webapp-config, you tell the installer which web server you are going to be using, and which shell account needs to be able to edit the configuration files. webapp-config then installs your files with the correct ownership and permissions.

=== Protected Configuration Files ===
webapp-config automatically ensures that your configuration files are never overwritten during an upgrade - even if you have not edited the files at all. Additionally, webapp-config will never overwrite any file that it did not install, or that has been changed since it was installed by webapp-config. webapp-config uses md5 checksums to determine whether a file has been changed or not. In the case of symbolic links, webapp-config will not replace a symlink that points to a different file.

When an upgrade does attempt to overwrite a protected file, webapp-config creates a ._cfg file with the new file inside. You can use etc-update to complete the install, just as you would with the regular emerge.

=== File Copying Options ===
A virtual copy is built mostly by creating hard links to files under /usr/share/webapps. If a hard link cannot be created, the file is copied from /usr/share/webapps instead.

Hard links can only be created to files on the same filesystem. If you keep /usr/share/webapps and /var/www on different filesystems, webapp-config cannot use hard links, and will be forced to copy the files instead.

There are three ways to get around the hard link problem.

The easiest way is to make /usr/share/webapps a symlink to a directory under /var/www. For most people, this will ensure that everything is on the same filesystem.

However, if you keep the websites you host on separate filesystems (like I do), then webapp-config is never going to be able to hard-link files for you.

As an alternative you can choose to use the --soft command-line switch. This switch tells webapp-config to create symbolic links instead of hard links. Symbolic links work across filesystems.

The problem with using symbolic links is that some packages do not work when the virtual copy is made from symbolic links. Many users - and system administrators alas - have also complained that they find directories full of symbolic links confusing. For these reasons, symbolic links are not used by default in webapp-config any more.

You may also choose the --copy command-line switch. This particular switch tells webapp-config to directly copy the files from /usr/share/webapps/ instead of hard links. Copying directly works across filesystems with the drawback of using more space but if you are going to use it across file systems you may want this instead of symbolic links, as this means that the files in /usr/share/webapps/ will not be touched when the files in the location of your virtualhost are altered.

=== Virtual File Voodoo ===
By default, the master copy contains the metadata that decides which files get linked into a virtual copy and which files do not. Files are either owned by the web server (server-owned), are configuration files (config-owned), or are linked in (virtual). Directories can be server-ownedor config-owned, but most of the time they need to be just plain directories (default-owned) created inside the installation directory (set with the -d switch).  webapp-config provides a number of switches which allows you to override the master copy's metadata - if you ever find that you need to.

The --default-dirs and --virtual-files switches allow you to decide what webapp-config will do if (respectively) a directory or a file is marked as being default or virtual. You can tell webapp-config to make the directory or file any of the other choices - server-owned or config-owned - instead.

=== <nowiki>${ROOT}</nowiki> ===
webapp-config is intended to fully support ${ROOT}. If you are unsure what that means, consult [[emerge]].

== Features ==
Using the <code>vhost</code> USE flag <tt>webapp-config</tt> is capable of managing the following applications:

{| class="wikitable sortable"
|-
! Application !! Package !! Homepage !! Description
|-
| ampache || {{Package|www-apps/ampache}} || http://www.ampache.org/ || Ampache is a PHP-based tool for managing, updating and playing your audio files via a web interface
|-
| b2evolution || {{Package|www-apps/b2evolution}} || http://www.b2evolution.net || Multilingual multiuser multi-blog engine
|-
| bugzilla || {{Package|www-apps/bugzilla}} || http://www.bugzilla.org ||  Bugzilla is the Bug-Tracking System from the Mozilla project
|-
| cgit || {{Package|www-apps/cgit}} || http://git.zx2c4.com/cgit/about
 || a fast web-interface for git repositories
|-
| coppermine || {{Package|www-apps/coppermine}} || http://coppermine.sourceforge.net/ || Web picture gallery written in PHP with a MySQL backend
|-
| cvsweb || {{Package|www-apps/cvsweb}} || http://www.freebsd.org/projects/cvsweb.html || WWW interface to a CVS tree
|-
| dokuwiki || {{Package|www-apps/dokuwiki}} || http://wiki.splitbrain.org/wiki:dokuwiki || DokuWiki is a simple to use Wiki aimed at a small company's documentation needs.
|-
| dragonflycms || {{Package|www-apps/dragonflycms}} || http://dragonflycms.org || A feature-rich open source content management system based off of PHP-Nuke 6.5
|-
| drupal || {{Package|www-apps/drupal}} || http://drupal.org/
 ||  PHP-based open-source platform and content management system
|-
| egroupware || {{Package|www-apps/egroupware}} || http://www.egroupware.org/ || Web-based GroupWare suite
|-
| eyeos || {{Package|www-apps/eyeos}} || http://www.eyeos.org || AJAX web-based desktop environment
|-
| gallery || {{Package|www-apps/gallery}} || http://gallery.menalto.com/ || Web based (PHP Script) photo album viewer/creator
|-
| groupoffice || {{Package|www-apps/groupoffice}} || http://group-office.sourceforge.net/ ||  Group-Office is a powerful modular Intranet application framework
|-
| joomla || {{Package|www-apps/joomla}} || http://www.joomla.org/ || Joomla is a powerful Open Source Content Management System
|-
| mantisbt || {{Package|www-apps/mantisbt}} || http://www.mantisbt.org/ || PHP/MySQL/Web based bugtracking system
|-
| mediawiki || {{Package|www-apps/mediawiki}} || http://www.mediawiki.org || The MediaWiki wiki web application (as used on wikipedia.org)
|-
| mirmon || {{Package|www-apps/mirmon}} || http://people.cs.uu.nl/henkp/mirmon/ || Simple webapp to monitor the status of mirrors
|-
| moodle || {{Package|www-apps/moodle}} || http://moodle.org || The Moodle Course Management System
|-
| mythweb || {{Package|www-apps/mythweb}} || http://www.mythtv.org || PHP scripts intended to manage MythTV from a web browser
|-
| otrs || {{Package|www-apps/otrs}} || http://otrs.org/ || OTRS is an Open source Ticket Request System
|-
| owncloud || {{Package|www-apps/owncloud}} ||  http://owncloud.org || Web-based storage application where all your data is under your own control
|-
| phpBB || {{Package|www-apps/phpBB}} ||  http://www.phpbb.com/ || phpBB is an open-source bulletin board package
|-
| phpmp || {{Package|www-apps/phpmp}} || http://www.musicpd.org/ || phpMp is a client program for Music Player Daemon (mpd)
|-
| phpsysinfo || {{Package|www-apps/phpsysinfo}} || http://rk4an.github.com/phpsysinfo/ || phpSysInfo is a nice package that will display your system stats via PHP
|-
| postfixadmin || {{Package|www-apps/postfixadmin}} ||  http://postfixadmin.sourceforge.net || Web Based Management tool for Postfix style virtual domains and users
|-
| rutorrent || {{Package|www-apps/rutorrent}} || http://code.google.com/p/rutorrent/ || ruTorrent is a front-end for the popular Bittorrent client rTorrent
|-
| trac || {{Package|www-apps/trac}} || http://trac.edgewall.com/ || Trac is a minimalistic web-based project management, wiki and bug/issue tracking system
|-
| tt-rss || {{Package|www-apps/tt-rss}} ||  http://tt-rss.org/ || Tiny Tiny RSS - A web-based news feed (RSS/Atom) aggregator using AJAX
|-
| venus || {{Package|www-apps/venus}} || http://intertwingly.net/code/venus/ || A feed aggregator application
|-
| viewvc || {{Package|www-apps/viewvc}} || http://viewvc.org/ ||  ViewVC, a web interface to CVS and Subversion
|-
| wiliki || {{Package|www-apps/wiliki}} || http://practical-scheme.net/wiliki/ || WiLiKi is a lightweight Wiki engine written in and running on Gauche Scheme
|-
| wordpress || {{Package|www-apps/wordpress}} || http://wordpress.org/ || Wordpress php and mysql based content management system (CMS)
|}

== Installation ==
Install webapp-config by running emerge:
{{Emerge|app-admin/webapp-config}}

== Usage ==

=== Actions ===

;<tt>-I, --install</tt>
: Activate install mode.

;<tt>-U, --upgrade</tt>
: Activate upgrade mode.

;<tt>-C, --clean</tt>
: Activate remove mode.

=== Examples ===
{{Note|For the following examples owncloud will be used as the web application. Owncloud can be substituted with any of the applications listed in the table above.}}

To install a webapp:
{{RootCmd|webapp-config -I owncloud}}

To list installed webapps:
{{RootCmd|webapp-config --list-installs}}

To show installed webapps:
{{RootCmd|webapp-config --show-installed}}

To update a previously installed webapp:
{{RootCmd|webapp-config -U owncloud }}

To remove an installed webapp:
{{RootCmd|webapp-config -C owncloud }}

== See also ==

== External resources ==

* The webapp-config source code repository
