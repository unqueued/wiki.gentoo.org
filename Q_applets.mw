<languages />
<translate>

<!--T:67-->
{{Lowercase title}}
{{InfoBox stack
|{{InfoBox project|Portage-Tools|header=true}}
|{{InfoBox github|gentoo/portage-utils}}
|{{InfoBox gitweb|portage-utils.git}}
}}

<!--T:49-->
{{Metadata|abstract=The q applets are [[Article description::a collection of small and fast Portage helper tools written in C.]] This guide covers some common uses of these helper tools, also known as the app-portage/portage-utils package.}}

<!--T:53-->
The {{Package|app-portage/portage-utils}} package is a collection of very fast utilities written in C, which are meant to offer a faster but more limited alternative to their {{Package|app-portage/gentoolkit}} counterparts. Please note that q applets are not meant to replace [[Gentoolkit|gentoolkit]]. The utilities may be much more efficient than the equivalent ones from [[Gentoolkit|gentoolkit]] and might be better suited to be used in scripts that need to call Portage repeatedly, but they ''do not'' offer the same functionality. q applets do not consider [https://devmanual.gentoo.org/ebuild-writing/using-eclasses/index.html eclasses] and do not provide tools like {{c|revdep-rebuild}} or {{c|glsa-check}}. 

<!--T:54-->
__TOC__

== Installation == <!--T:2-->

=== USE flags === <!--T:62-->

<!--T:63-->
{{USEflag|package=app-portage/portage-utils}}

=== Emerge === <!--T:55-->

<!--T:3-->
Install the q applets:

<!--T:4-->
{{Emerge|app-portage/portage-utils}}

== Configuration == <!--T:56-->

=== Build the cache === <!--T:68-->

<!--T:7-->
Before using the applets first initialize the cache:

<!--T:8-->
{{RootCmd|q -r}}

== Usage == <!--T:57-->

=== Invocation === <!--T:58-->

<!--T:59-->
The complete list of applications that are provided by {{Package|app-portage/portage-utils}} can be listed by typing {{c|man q}} or {{c|q --help}}. Please read the man page for each utility described, as this guide is only meant to be a short reference for the most useful functions and does not include all the information about each application.

<!--T:60-->
To see the available applets with a short description of their function, use {{c|q --help}}:

<!--T:61-->
{{Invocation|q --help|output=<pre>
Usage: q <applet> <args>  : invoke a portage utility applet
  
Currently defined applets:
        q <applet> <args> : virtual applet
    qatom <pkg>           : split atom strings
   qcache <action> <args> : search the metadata cache
   qcheck <pkgname>       : verify integrity of installed packages
 qdepends <pkgname>       : show dependency info
    qfile <filename>      : list all pkgs owning files
    qgrep <misc args>     : grep in ebuilds
    qlist <pkgname>       : list files owned by pkgname
     qlop <pkgname>       : emerge log analyzer
   qmerge <pkgnames>      : fetch and merge binary package
     qpkg <misc args>     : manipulate Gentoo binpkgs
  qsearch <regex>         : search pkgname/desc
    qsize <pkgname>       : calculate size usage
    qtbz2 <misc args>     : manipulate tbz2 packages
     quse <useflag>       : find pkgs using useflags
    qxpak <misc args>     : manipulate xpak archives
  
Options: -[irmM:vqChV]
  -i, --install        * Install symlinks for applets
  -r, --reinitialize   * Reinitialize ebuild cache
  -m, --metacache      * Reinitialize metadata cache
  -M, --modpath  <arg> * Module path
  -v, --verbose        * Make a lot of noise
  -q, --quiet          * Tighter output; suppress warnings
  -C, --nocolor        * Don't output color
  -h, --help           * Print this help and exit
  -V, --version        * Print version and exit</pre>
}}

=== How to find a package to which a file belongs (qfile) === <!--T:14-->

<!--T:15-->
The {{c|qfile}} command finds the package to which a file belongs: 

<!--T:16-->
{{Cmd|qfile /etc/fonts/fonts.conf|output=<pre>
media-libs/fontconfig (/etc/fonts/fonts.conf)
</pre>}}

<!--T:17-->
{{Cmd|qfile /usr/share/keymaps/atari/atari-uk-falcon.map.gz|output=<pre>
sys-apps/kbd (/usr/share/keymaps/atari/atari-uk-falcon.map.gz)
</pre>}}

=== Verifying package integrity (qcheck) === <!--T:18-->

<!--T:19-->
To check the MD5 checksums or modification times of the files installed by some package, use the {{c|qcheck}} application: 

<!--T:20-->
{{Cmd|qcheck portage-utils|output=<pre>
Checking app-portage/portage-utils-0.1.13 ...
  * 36 out of 36 files are good
</pre>}}

<!--T:21-->
All the files which were changed after installation will be reported here. Configuration files which have been manually edited after installation are reported too.  Most packages do not require root permissions. However, if a package has files that are only accessible to root {{c|qcheck}} should be run as root.  

To check the integrity of all packages installed, enter:

{{RootCmd|qcheck}}

=== Listing package dependencies (qdepends) === <!--T:22-->

<!--T:23-->
{{c|qdepends}} can list the dependencies of a package in either direction.  Use the <code>-a</code> option to list all the <var>DEPEND</var>, <var>RDEPEND</var>, and <var>PDEPEND</var> installed dependencies needed by a package. 

<!--T:24-->
{{Invocation|qdepends -a xorg-server|output=<pre>
 * DEPEND
x11-base/xorg-server-1.20.4: >=app-eselect/eselect-opengl-1.3.0 dev-libs/openssl:0/0= >=x11-apps/iceauth-1.0.2 >=x11-apps/rgb-1.0.3 >=x11-apps/xauth-1.0.3 x11-apps/xkbcomp >=x11-libs/libdrm-2.4.89 >=x11-libs/libpciaccess-0.12.901 >=x11-libs/libXau-1.0.4 >=x11-libs/libXdmcp-1.0.2 >=x11-libs/libXfont2-2.0.1 >=x11-libs/libxkbfile-1.0.4 >=x11-libs/libxshmfence-1.1 >=x11-libs/pixman-0.27.2 >=x11-libs/xtrans-1.3.5 >=x11-misc/xbitmaps-1.0.1 >=x11-misc/xkeyboard-config-2.4.1-r3 media-libs/libepoxy[X] >=media-libs/mesa-18[egl,gbm] !x11-libs/glamor >=x11-libs/libX11-1.1.5 >=x11-libs/libXext-1.0.5 >=media-libs/mesa-18 virtual/libudev:0/1= >=x11-apps/xinit-1.3.3-r1 sys-devel/flex >=x11-base/xorg-proto-2018.3
 * RDEPEND
x11-base/xorg-server-1.20.4: >=app-eselect/eselect-opengl-1.3.0 dev-libs/openssl:0/0= >=x11-apps/iceauth-1.0.2 >=x11-apps/rgb-1.0.3 >=x11-apps/xauth-1.0.3 x11-apps/xkbcomp >=x11-libs/libdrm-2.4.89 >=x11-libs/libpciaccess-0.12.901 >=x11-libs/libXau-1.0.4 >=x11-libs/libXdmcp-1.0.2 >=x11-libs/libXfont2-2.0.1 >=x11-libs/libxkbfile-1.0.4 >=x11-libs/libxshmfence-1.1 >=x11-libs/pixman-0.27.2 >=x11-libs/xtrans-1.3.5 >=x11-misc/xbitmaps-1.0.1 >=x11-misc/xkeyboard-config-2.4.1-r3 media-libs/libepoxy[X] >=media-libs/mesa-18[egl,gbm] !x11-libs/glamor >=x11-libs/libX11-1.1.5 >=x11-libs/libXext-1.0.5 >=media-libs/mesa-18 virtual/libudev:0/1= >=x11-apps/xinit-1.3.3-r1 !x11-drivers/xf86-video-modesetting
 * PDEPEND
x11-base/xorg-server-1.20.4: >=x11-base/xorg-drivers-1.20
</pre>}}

To list all of the installed packages that depend on a package use the <code>-Q</code> option.

{{Invocation|qdepends -aQ xorg-server|output=<pre>
 * DEPEND
x11-drivers/xf86-input-keyboard-1.9.0
x11-drivers/xf86-input-mouse-1.9.3
x11-drivers/xf86-video-intel-2.99.917_p20180214-r2
x11-drivers/xf86-input-evdev-2.10.6
x11-drivers/xf86-input-libinput-0.28.2
x11-libs/libpciaccess-0.14
x11-base/xorg-x11-7.4-r3
x11-apps/xinit-1.4.0-r1
x11-misc/sddm-0.18.0
 * RDEPEND
x11-drivers/xf86-input-keyboard-1.9.0
x11-drivers/xf86-input-mouse-1.9.3
x11-drivers/xf86-video-intel-2.99.917_p20180214-r2
x11-drivers/xf86-input-evdev-2.10.6
x11-drivers/xf86-input-libinput-0.28.2
app-eselect/eselect-opengl-1.3.1-r4
x11-libs/libpciaccess-0.14
x11-base/xorg-x11-7.4-r3
x11-apps/xinit-1.4.0-r1
x11-misc/sddm-0.18.0
 * PDEPEND
x11-base/xorg-drivers-1.20
</pre>}}

=== Search ebuilds or eclasses for a pattern (qgrep) === <!--T:64-->

<!--T:65-->
{{c|qgrep}} can be used to find ebuilds that mention an ebuild's name ("libechonest" is used in the example below) which will list all packages (installed or not) which depend on some package:

<!--T:66-->
{{Invocation|<nowiki>qgrep -H libechonest | cut -f1 -d":" | uniq</nowiki>|output=<pre>
media-libs/libechonest/libechonest-2.0.2.ebuild
media-libs/libechonest/libechonest-2.2.0-r1.ebuild
media-libs/libechonest/libechonest-2.3.0.ebuild
media-libs/libechonest/libechonest-2.3.1.ebuild
media-libs/libechonest/libechonest-2.3.1-r1.ebuild
media-libs/libechonest/libechonest-9999.ebuild
media-sound/clementine/clementine-1.2.3.ebuild
media-sound/clementine/clementine-1.2.3-r1.ebuild
media-sound/clementine/clementine-1.3.1-r1.ebuild
media-sound/tomahawk/tomahawk-0.8.4-r3.ebuild
media-sound/tomahawk/tomahawk-9999.ebuild
</pre>}}

The <code>-J</code> option will limit the search to installed packages.

{{Invocation|qgrep -NJ net-print/cups|output=<pre>
app-office/libreoffice-6.1.5.2: cups? ( net-print/cups )
dev-qt/qtprintsupport-5.11.3:   cups? ( >=net-print/cups-1.4 )
net-print/hplip-3.18.6: net-print/cups
net-print/hplip-3.18.6: hpijs? ( net-print/cups-filters[foomatic] )
net-print/cups-2.2.7:PDEPEND=">=net-print/cups-filters-1.0.43"
net-print/cups-filters-1.21.6:  >=net-print/cups-1.7.3
net-print/cups-filters-1.21.6:  !<=net-print/cups-1.5.9999
dev-java/icedtea-bin-3.10.0-r1: cups? ( >=net-print/cups-2.0% )
net-wireless/bluez-5.50-r2:     cups? ( net-print/cups:= )
app-text/ghostscript-gpl-9.26:  cups? ( >=net-print/cups-1.3.8 )
x11-libs/gtk+-2.24.32-r1:       cups? ( >=net-print/cups-1.7.1-r2:=[${MULTILIB_USEDEP}] )
x11-libs/gtk+-3.24.4-r1:        cups? ( >=net-print/cups-1.2[${MULTILIB_USEDEP}] )
</pre>}}

=== Listing files that belong to an ebuild (qlist) === <!--T:25-->

<!--T:26-->
The {{c|qlist}} command gives a list of all files that belong to an ebuild. 

<!--T:27-->
{{Cmd|qlist vim|output=<pre>
/usr/bin/gvim
/usr/bin/gvimdiff
/usr/bin/evim
/usr/bin/eview
/usr/bin/gview
/usr/bin/rgvim
[...]
</pre>}}

=== Looking for packages that use some USE flag (quse) === <!--T:28-->

<!--T:29-->
Listing used USE flags is done with {{c|quse}}, which must be run with root permissions. It may take some time to first create/update the ebuild cache. 

<!--T:30-->
{{Cmd|quse firefox|output=<pre>
app-misc/tracker/tracker-0.12.10-r1.ebuild applet doc eds elibc_glibc exif firefox-bookmarks flac flickr gif
[...]
</pre>}}

=== Finding package sizes (qsize) === <!--T:31-->

<!--T:32-->
To show the size of a package, use the {{c|qsize}} application: 

<!--T:33-->
{{Cmd|qsize vim|output=<pre>
app-editors/gvim-6.4: 10 files, 7 non-files, 2327.516 KB
app-editors/vim-6.4: 6 files, 2 non-files, 2058.14 KB
app-editors/vim-core-6.4: 1024 files, 68 non-files, 10950.984 KB
[...]
</pre>}}

=== Searching the Portage tree (qsearch) === <!--T:34-->

<!--T:35-->
One of the most powerful tools of {{Package|app-portage/portage-utils}} is {{c|qsearch}}. This tool allows to search the Portage tree much faster than using the {{c|emerge -s}} command. 

<!--T:36-->
Here are some examples of its usage: 

<!--T:37-->
{{Cmd|qsearch terminus|output=<pre>
media-fonts/terminus-font A clean fixed font for the console and X11
</pre>}}

<!--T:38-->
The homepage of packages can be queried using the <code>-H</code> option:

<!--T:50-->
{{Cmd|qsearch -H terminus|output=<pre>
media-fonts/terminus-font http://www.is-vn.bg/hamster/jimmy-en.html
</pre>}}

<!--T:39-->
In another example, let's look for a jabber client:

<!--T:40-->
{{Cmd|qsearch -S "jabber client"|output=<pre>
app-emacs/emacs-jabber A Jabber client for Emacs.
net-im/gajim Jabber client written in PyGTK
net-im/gnome-jabber Gnome Jabber Client
net-im/gossip Lightweight Jabber client for GNOME
net-im/imcom Python commandline Jabber Client
net-im/psi QT 3.x Jabber Client, with Licq-like interface
net-im/tkabber Featureful Jabber client for tcl/tk.
x11-themes/psi-themes Iconsets for Psi, a QT 3.x Jabber Client
</pre>}}

=== Extracting information from emerge logs (qlop) === <!--T:41-->

<!--T:42-->
{{c|qlop}} allows to extract useful information from the {{Path|emerge.log}} file. It can be useful when package compilation times need to be estimated or to compare build times with other systems. It also allows to check what is compiling at the moment and how long it will probably take - which is handy when working in the console and don't have any other means to check it. 

<!--T:43-->
Estimate how long a {{Package|dev-lang/perl}} build takes:

<!--T:44-->
{{Cmd|qlop -tH perl|output=<pre>
perl: 7 minutes, 52 seconds for 4 merges
</pre>}}

<!--T:45-->
See what is emerging at the moment and how long the process has been running already:

<!--T:46-->
{{Cmd|qlop -c|output=<pre>
* perl-5.8.8-r23
    started: Mon May 21 12:41:11 2007
    elapsed: 19 seconds
</pre>}}

== See also == <!--T:51-->

<!--T:52-->
* {{See also|Portage}}
* {{See also|Gentoolkit}}
* {{See also|Useful_Portage_tools}}
</translate>
{{Migrated|originalauthors=Åukasz Damentko, {{Dev|nightmorph}}, and Marcelo Góes}}

[[Category:Portage tools]]
