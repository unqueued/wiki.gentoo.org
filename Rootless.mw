== Rootless Gentoo Installations ==

Gentoo can be installed in root-less mode.
The packages will be installed as a regular user, for instance in ~/root/.
The user can add the binary/library paths from there and run programs that could not be installed on the system otherwise.

Certain packages will fail to install, because they have not been thought to be installed this way.
The most common reasons are:
* usage of 'install' with root uid/gid
* RESTRICT=userpriv

=== Portage ===

Usage of portage is documented on the gentoo/prefix project.

=== Paludis ===

The steps are:
* install stage3 archive
* install paludis
* edit paludis/distributions/gentoo/e.conf
 diff --git a/paludis/distributions/gentoo/e.conf b/paludis/distributions/gentoo/e.conf
 index 215977a..ac115b7 100644
 --- a/paludis/distributions/gentoo/e.conf
 +++ b/paludis/distributions/gentoo/e.conf
 @@ -1,4 +1,4 @@
 -default_buildroot = /var/tmp/paludis
 +default_buildroot = /home/user/root/var/paludis/tmp
  default_distdir = distfiles
  default_eapi_when_unknown = 0
  default_eapi_when_unspecified = 0
* create ~/root/bin/cave, a cave wrapper to contain a few environment variables
 #!/usr/bin/env python
 # Cave wrapper
 import sys, os
 
 libdirs=[os.path.expanduser(x) for x in ["~/root/usr/lib", "~/root/lib"]]
 os.environ["LD_LIBRARY_PATH"] = ":".join(libdirs)
 
 from subprocess import Popen
 
 os.environ["PALUDIS_NO_GLOBAL_HOOKS"] = "1"
 #os.environ["PALUDIS_DO_NOTHING_SANDBOXY"] = "1"
 os.environ["PALUDIS_DISTRIBUTIONS_DIR"] = os.path.expanduser("~/root/etc/paludis/distributions")
 os.environ["PALUDIS_NO_CHOWN"] = "1"
 
 def main():
   x = Popen([os.path.expanduser("~/root/usr/bin/cave"), "--environment", "paludis:test"] + sys.argv[1:])
   return x.wait()
 
 if __name__ == '__main__':
   main()

* add bin/library paths to the environment
* edit ~/.paludis-prefix/specpath.conf
* edit ~/root/etc/paludis/*
* create paludis folders in ~/root/
* cave resolve system -/ n ...
