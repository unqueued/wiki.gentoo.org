== Rootless Gentoo Installations ==

Gentoo can be installed in root-less mode.
The packages will be installed as a regular user, for instance in ~/root/.
The user can add the binary/library paths from there and run programs that could not be installed on the system otherwise.

Certain packages will fail to install, because they have not been thought to be installed this way.
The most common reasons are:
* usage of 'install' with root uid/gid
* RESTRICT=userpriv

=== Portage ===

Usage of portage is documented on the gentoo/prefix project.

=== Paludis ===

WIP

Throughout this section we will consider that the prefix will be ~/root.

The steps are:
* install stage3 archive
* install paludis manually (don't use emerge, unless you proceed as in the above section)
 cd ~/root
 git clone git:/.../paludis.git
 cd paludis
 ./auto..
 make
* create paludis files
 * create paludis folders in ~/root/
 * edit ~/.paludis-prefix/specpath.conf
 * edit ~/root/etc/paludis/*
  * configure repositories (buildroot, location), and paths
 * use minimal use flags at start
* create ~/root/paludis/cave wrapper for ~/root/paludis/src/clients/cave/.libs/cave
 TODO
* ./cave resolve paludis -/ n
* create ~/root/bin/cave, a cave wrapper to the properly installed paludis
 #!/usr/bin/env python
 # Cave wrapper
 import sys, os
 
 os.environ["PALUDIS_NO_GLOBAL_HOOKS"] = "1"
 #os.environ["PALUDIS_DO_NOTHING_SANDBOXY"] = "1"
 os.environ["PALUDIS_DISTRIBUTIONS_DIR"] = os.path.expanduser("~/root/etc/paludis/distributions")
 os.environ["PALUDIS_NO_CHOWN"] = "1"
 
 from subprocess import Popen
 
 def main():
   x = Popen([os.path.expanduser("~/root/usr/bin/cave"), "--environment", "paludis:test"] + sys.argv[1:])
   return x.wait()
 
 if __name__ == '__main__':
   main()

* add bin/library paths to the environment
* cave resolve system -/ n ...
