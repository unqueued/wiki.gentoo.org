{{InfoBox stack
|{{InfoBox homepage|http://unity.ubuntu.com|header=true}}
|{{InfoBox wikipedia|Unity (user interface)}}
}}

'''Unity''' is an alternative shell for the [[GNOME]] desktop environment, developed by Canonical in its Ayatana project.

It consists of several components including the Launcher, Dash, Lenses, Panel and Indicators.

More info about its individual components can be found at [https://wiki.ubuntu.com/Unity ''https://wiki.ubuntu.com/Unity'']

Unity is currently a plugin of the [http://wikipedia.org/wiki/Compiz ''Compiz''] window manager.

Under Canonical's developing convergence plans it will soon be a QT5 QML Desktop using their Mir [[display server]].

Mir is being developed as an alternative display server to X or Wayland, more info about it can be found at [https://wiki.ubuntu.com/Mir ''https://wiki.ubuntu.com/Mir'']

== Installation ==

You can install Unity by adding the [https://github.com/shiznix/unity-gentoo ''unity-gentoo''] [[ebuild repository]] in [[layman]]:

{{RootCmd|layman -a unity-gentoo}}

Select one of the 'unity-gentoo' profiles:

{{RootCmd|eselect profile list}}

Emerge ''unity-base/unity-build-env'':

{{RootCmd|emerge -av unity-build-env}}

Prepare your build toolchain for the new compiler.  This command should pull in a version 5 GCC Compiler.

{{RootCmd|emerge -av sys-devel/gcc}}

Please read [[Upgrading_GCC|Upgrading GCC]], and switch compilers accordingly.  After doing so (This will build a sane toolchain):

{{RootCmd|emerge -eav @systm}}

Add the QT ebuild repository:

{{RootCmd|layman -a qt}}

Emerge QT5 from the repo (This step lets you pre-select QT5, as the system-wide QT Library). See also [https://harishnavnit.wordpress.com/2014/03/24/handling-multiple-versions-of-qt/ Handling multiple versions of Qt]:

{{RootCmd|emerge -av @qt5-essentials @qt5-addons qtchooser}}

Finally, emerge ''unity-base/unity-meta'':

{{RootCmd|emerge -uDNavt unity-meta}}

== Usage ==

You should be starting it via a [[display manager]] or by ''XSESSION=unity'' variable for '''startx'''

{{RootCmd|systemctl start lightdm}}

{{Cmd|XSESSION{{=}}unity startx }}

== Technical ==

At its core Unity uses a lot of Gnome, and since >=gnome-3.8 systemd is required.

https://wiki.gentoo.org/wiki/Project:GNOME/GNOME3-Upgrade-guide#Systemd

GNOME 3 requires systemd to be running to get it working properly, otherwise, you will get broken power management and multiseat handling, and also some more problems because upstream has moved away from the obsolete consolekit to logind (that needs systemd to be running to work).

=== Startup files ===

1. The display manager (lightdm) or XSESSION=unity and 'startx' uses the ''sys-apps/upstart'' desktop services daemon to start 'gnome-session --session=unity'
* This executes /usr/share/gnome-session/sessions/unity.session which starts compiz as the window manager.
2. /etc/X11/xinit/xinitrc.d/65compiz_profile-on-session is sourced at Xsession startup and if $DESKTOP_SESSION=unity, it sets the COMPIZ_CONFIG_PROFILE=ubuntu variable.
* When compiz starts it checks the value of $COMPIZ_CONFIG_PROFILE and uses the 'ubuntu' entry located in /etc/compizconfig/config
** This 'ubuntu' entry sets the compiz profile to 'unity' and sets the compizconfig backend to use gsettings (dconf) which reads the compiz settings from the dconf registry.
3. Default compizconfig settings find their way into the desktop user's dconf registry by way of /etc/xdg/autostart/compiz-migrate-to-dconf.desktop
* This is auto started at Xsession startup and actually copies the settings from the global gconf registry to the desktop user's dconf registry.
4. Default compizconfig settings find their way into the global gconf registry when compiz is emerged.
* At src_install() time the compiz ebuild uses the 'update-gconf-defaults' tool to read all files in /usr/share/gconf/defaults/ and write them out to a gconf registry file located in /etc/gconf/gconf.xml.unity/
** It then updates /etc/gconf/2/local-defaults.path to include the new /etc/gconf/gconf.xml.unity/ directory

== External resources ==

* [https://github.com/shiznix/unity-gentoo unity-gentoo ebuild repository]
* [http://forums.gentoo.org/viewtopic-p-7091922.html#7091922 Overlay unity-gentoo thread on Gentoo Forum]
* [https://wiki.archlinux.org/index.php/Unity Unity article in Arch Linux Wiki]

[[Category:Desktop environment]]
