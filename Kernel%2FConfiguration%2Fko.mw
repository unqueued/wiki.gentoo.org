<languages />

{{Metadata|abstract=이 글에서는 리눅스 커널을 직접 설정하고 설치하는 방법을 설명합니다. 검증된 방법을 찾으신다면, genkernel 글을 살펴보십시오.}}

이 글에서는 [[Kernel/ko|리눅스 커널]]을 직접 설정하고 설치하는 방법을 설명합니다. 검증된 방법을 찾으신다면, [[genkernel/ko|genkernel]] 글을 살펴보십시오.

== 심볼릭 링크 설정 ==

{{Path|/usr/src/linux}} 심볼릭 링크는 언제든  현재 사용하는 커널 소스를 가리킵니다. 다음 세가지 방법 중 하나로 끝낼 수 있습니다:

; 1. 활성 ''symlink'' [[USE flag]]로 커널 소스를 설치합니다
: {{Path|/usr/src/linux}}가 가리키는 곳을 새로 설치한 커널 소스로 가도록 합니다. 필요하다면 다음의 수정된 두가지 방식으로 나중에 수정할 수 있습니다:

; 2. '''eselect'''로 심볼릭 링크를 선택합니다:

{{RootCmd|eselect kernel list|output=<pre>
Available kernel symlink targets:
[1] linux-3.3.8-gentoo
[2] linux-3.4.9-gentoo
</pre>}}

: 이 출력 내용은 사용할 수 있는 커널 소스를 포함합니다. 별표 기호는 선택한 소스를 나타냅니다. 커널 소스를 바꾸려면 (예: 두번째 항목) 다음처럼 하십시오:

{{RootCmd|eselect kernel set 2}}

; 3. 직접 심볼릭 링크를 설정합니다:

{{RootCmd|ln -sf /usr/src/linux-3.4.9-gentoo /usr/src/linux |
|ls -l /usr/src/linux |
|output=lrwxrwxrwx 1 root root 11 Aug 29 22:10 /usr/src/linux -> /usr/src/linux-3.4.9-gentoo
}}

<!-- The output is the same as the target file in the ln command. -->

=== 설정 파일 ===

커널에서는 자체를 설정할 수 있는 몇가지 도구를 제공합니다:

{| class="table"
|-
! Command
! Description
|-
| <tt>make config</tt>
| Text based configuration. The options are prompted one after another. All options need to be answered, and out-of-order access to former options is not possible.
|-
| <tt>make menuconfig</tt>
| An ncurses-based graphical menu (only text input). Navigate through the menu to modify the desired options.
|-
| <tt>make defconfig</tt>
| Generates a new config with default from the ARCH supplied defconfig file. Use this option to get back the default configuration file that came with the sources.
|-
| <tt>make nconfig</tt>
| Graphical menu based on ncurses. Requires {{Package|sys-libs/ncurses}} to be installed.
|-
| <tt>make xconfig</tt>
| Graphical menu using Qt4. Requires {{Package|dev-qt/qtgui}} to be installed.
|-
| <tt>make gconfig</tt>
| Graphical menu using GTK+. Requires {{Package|x11-libs/gtk+}}, {{Package|dev-libs/glib}}, and {{Package|gnome-base/libglade}} to be installed.
|-
| <tt>make oldconfig</tt>
| Review changes between kernel versions and update to create a new {{Path|.config}} for the kernel.
|-
| <tt>make allyesconfig</tt>
| Enables all configuration options in the kernel. target will set ''all'' kernel options to <code>*</code>. Make sure a backup of the current kernel configuration is acquired before experimentally using it!
|}

기타 기본 설정을 만들 몇가지 스크립트도 있습니다. 다음을 보십시오:

{{RootCmd|make help}}

== 설정 ==

이 글에서는 '''make menuconfig'''를 사용하여 설정하는 방법을 설명합니다만, 절차는 다른 메뉴랑 비슷합니다.

{{RootCmd|cd /usr/src/linux
|make menuconfig}}

=== 사용법 ===

In the shown menu the blue bar indicates the position of the cursor. With the {{Key|↑}} and {{Key|↓}} arrow keys change the position of the cursor. The {{Key|←}} and {{Key|→}}  arrow keys traverse the menu bar in the bottom and define what happens when the {{Key|Enter}} key is pressed. For the menu bar below, '''Select''' switches to a sub menu for the menu entries ending with <tt>---></tt> while '''Exit''' exits a sub menu. As an alternative the {{Key|Esc}} key can be pressed twice to exit the application.

Pressing an associated letter key {{Key|A}}-{{Key|Z}} will move the position of the cursor lines that have characters in bold. The {{Key|Y}}, {{Key|M}}, {{Key|N}} keys are excluded from navigation in this way; they are sanctified for other purposes. If a line begins with a Y, M, or N, the next character will be bold and capable of being jumped to. For example, relative to the cursor's current position, if the next line reads "N'''e'''twork Device Support --->" pressing the {{Key|E}} key will move the cursor to that line.

각괄호로 시작하는 메뉴 항목은 드라이버이거나 활성화 할 수 있는 기능입니다:

게다가 어떤 항목은 마지막에 이런 표시를 붙였습니다:

{| class="table"
|-
! Tag
! Description
|-
| <code>(NEW)</code>
| This driver is new in the kernel and is maybe not stable enough.
|-
| <code>(EXPERIMENTAL)</code>
| This driver is experimental and most likely not stable enough.
|-
| <code>(DEPRECATED)</code>
| This driver is deprecated and not needed for most systems.
|-
| <code>(OBSOLETE)</code>
| This driver is obsolete and should not be activated.
|}

대부분 옵션에는 {{Key|H}} 키를 누르거나 메뉴 표시줄의 '''Help'''를 선택하면 뜨는 설명이 붙어있습니다.

=== 드라이버 선택 ===

[[:Category:Hardware|하드웨어]] 분류의 [[hardware detection|하드웨어 감지]] 글을 보십시오.

=== 모듈 검색 ===
''menuconfig''에서 모듈을 이름으로 검색하려면 {{Key|/}} 키를 사용할 수 있습니다.

Within <tt>menuconfig</tt>, use the {{Key|/}} key to search modules by name.

As shown below, the search result will show numbers in front of the matches. Pressing {{Key|1}} in the example below would make <tt>menuconfig</tt> jump straight to the option ''Bluetooth device drivers'' in the menu structure.

{{KernelBox|title=Example output after searching for HCIBTUSB|1=
Symbol: BT_HCIBTUSB [{{=}}m]                       
Type  : tristate                               
Prompt: HCI USB driver                         
  Location:                                    
    -> Networking support (NET [{{=}}y])           
      -> Bluetooth subsystem support (BT [{{=}}y]) 
(1)     -> Bluetooth device drivers            
  Defined at drivers/bluetooth/Kconfig:5       
  Depends on: NET [{{=}}y] && BT [{{=}}y] && USB [{{=}}m]
}}

=== 젠투 리눅스 일반 설정 활성화 ===

{{Package|sys-kernel/gentoo-sources}}와 젠투에서 관리하는 다른 [[Project:Kernel|커널 프로젝트]] 에서만 나타나는 <code>CONFIG_GENTOO_LINUX</code> 커널 설정 옵션이 있습니다. 자체적으론 하는 일이 없지만, 일반 설치 과정에서 필요한 다양한 설정 옵션을 설정합니다.

이 설정은 젠투 리눅스에서 {{Path|/dev}}를 처리하는데 필요한 tmpfs와 devtmpfs 지원을 자동으로 선택하지만, 젠투 리눅스 시스템의 다른 필수적 설정을 차후에 활성화하기 위해 확장됩니다. 더 많은 내용을 알아보려면, 이 안내서에 앞서 설명한 커널 설정 시스템을 통해 제공하는 도움말 정보를 읽어보십시오.

== 빌드 ==

커널을 설정한 다음 컴파일해야 합니다:

{{RootCmd|make}}

프로세서 코어가 여러개 있다면 모든 코어가 동작할 수 있게 할 수 있습니다. 이렇게 하려면 '''-j(NUMBER_CORES +1)''' 매개 변수를 추가하십시오. 듀얼 코어 프로세서에 대해서는 다음과 같습니다:

{{RootCmd|make -j3}}

== 설치 ==

드라이버를 모듈로 활성화 했다면, 설치해야 합니다:

{{RootCmd|make modules_install}}

모듈은 {{Path|/lib/modules}}의 하위 디렉터리에 복사합니다.

실제 커널을 설치하려면:

{{RootCmd|make install}}

이 명령은 {{Package|sys-apps/debianutils}} 꾸러미의 일부인 '''/sbin/installkernel''' 을 실행합니다. ''새 커널은 {{Path|/boot/vmlinuz-{version}}}에 설치합니다. {{Path|/boot/vmlinuz}} 심볼릭 링크가 이미 있다면, 새 커널에 대해 만든{{Path|/boot/vmlinuz}} 링크를 만들고 바꾸며, 이전에 설치한 커널은 {{Path|/boot/vmlinuz.old}}로 둡니다.''(''installkernel'' [[man page]]). {{Path|config}}와 {{Path|System.map}}파일과 같습니다. 이 심볼릭 링크는 파일 경로를 바꾸지 않고 새로운 커널을 가리키기 때문에 단순합니다(예: 부트로더 설정에서 쓸 수 있습니다).

== 부트로더 ==

[[bootloader|부트 로더]] 설정을 바꾸어 새 커널로 부팅하도록 고르십시오.

마지막으로 새 커널로 시스템을 다시 부팅하십시오.

== Comparing current kernel configuration with default configuration ==

Use the following procedure to get an overview over the kernel configurations that deviate from the default. Keep in mind that the modification of configuration setting may entail additional configuration settings.

{{RootCmd
|cd /usr/src/linux
|cp .config ../.config.working
|make defconfig
|mv .config ../.config.default
|cp ../.config.working .config
|cd ..
|diff .config.working .config.default {{!}} sed --quiet '/^\([<{{!}}>] CONFIG\)/ p' > .config.diff
}}

The search function in <tt>make menuconfig</tt> can be used to look up the flags and their interpretation.
When you're done, clean up:

{{RootCmd
|cd /usr/src/
|rm .config.working .config.default .config.diff
}}

== See also ==
* [[Genkernel]]
* [[Kernel/Configuration/Kernel_Seeds|Kernel Seeds]]

== External resources ==

[[Category:Kernel]]
