{{Path|/etc/portage/repos.conf}} can be a file or directory of files that specifies site-specific repository configuration information.

== Format ==

{{Note| While Portage can handle {{Path|repos.conf}} as either a file or a directory of files. The preferred method is to be used as a '''''directory'''''. Other tools like <tt>layman</tt> and <tt>mirrorselect</tt> require and expect it to be a directory. Layman creates and manages it's own {{Path|layman.conf}} file to register installed overlays with Portage. <tt>mirrorselect</tt> looks for {{Path|repos.conf/gentoo.conf}} file in order to modify the <code>sync-uri</code> parameter for the gentoo repo.
}}

* Comments begin with <code>#</code> (no inline comments)
* Configuration of each repository is specified in a section starting with <code>[repository_name]</code>
* Attributes are specified in <code>attribute = value</code> format

== Attributes supported in the default section ==

{| class="wikitable"
|-
! Attribute !! Description
|-
| <code>main-repo</code> || Specifies main repository.
|-
| <code>eclass-overrides</code> || Makes all repositories inherit eclasses from specified repositories. Setting this attribute is generally not recommended since resulting changes in eclass inheritance may trigger performance issues due to invalidation of metadata cache. When <code>force = eclass-overrides</code> attribute is not set, <tt>egencache</tt>, <tt>emirrordist</tt>, and <tt>repoman</tt> ignore this attribute, since operations performed by these tools are inherently not site-specific.
|-
| <code>force</code> || Specifies names of attributes, which should be forcefully respected by <tt>egencache</tt>, <tt>emirrordist</tt>, and <tt>repoman</tt>. Valid values: <code>aliases</code>, <code>eclass-overrides</code>, and <code>masters</code>.
|}

== Attributes supported in sections of repositories ==

{| class="wikitable"
|-
! Attribute !! Description
|-
| <code>aliases</code> ||  Specifies aliases of given repository. Setting this attribute is generally not recommended since resulting changes in eclass inheritance may trigger performance issues due to invalidation of metadata cache. When <code>force = eclass-overrides</code> attribute is not set, <tt>egencache</tt>, <tt>emirrordist</tt>, and <tt>repoman</tt> ignore this attribute, since operations performed by these tools are inherently not site-specific.
|-
| <code>auto-sync</code> || This setting determines if the repo will be synced during <tt>emerge --sync</tt> or <tt>emaint sync --auto</tt> runs. This allows for repositories to be synced only when desired via <tt>emaint sync --repo foo</tt>. Valid values: <code>yes</code>, <code>no</code>, <code>true</code>, <code>false</code>. If unset, the repo will be treated as set <code>yes</code>, <code>true</code>.
|-
| <code>eclass-overrides</code> || Makes all repositories inherit eclasses from specified repositories. Setting this attribute is generally not recommended since resulting changes in eclass inheritance may trigger performance issues due to invalidation of metadata cache. When <code>force = eclass-overrides</code> attribute is not set, <tt>egencache</tt>, <tt>emirrordist</tt>, and <tt>repoman</tt> ignore this attribute, since operations performed by these tools are inherently not site-specific.
|-
| <code>force</code> || Specifies names of attributes, which should be forcefully respected by <tt>egencache</tt>, <tt>emirrordist</tt>, and <tt>repoman</tt>. Valid values: <code>aliases</code>, <code>eclass-overrides</code>, and <code>masters</code>.
|-
| <code>location</code> ||  Specifies location of given repository.
|-
| <code>masters</code> || Specifies master repositories of given repository. Setting this attribute is generally not recommended since resulting changes in eclass inheritance may trigger performance issues due to invalidation of metadata cache. When <code>force = eclass-overrides</code> attribute is not set, <tt>egencache</tt>, <tt>emirrordist</tt>, and <tt>repoman</tt> ignore this attribute, since operations performed by these tools are inherently not site-specific.
|-
| <code>priority</code> || Specifies priority of given repository.
|-
| <code>sync-cvs-repo</code> || Specifies CVS repository.
|-
| <code>sync-depth</code> || Specifies  clone  depth to use for DVCS repositories. Defaults to <code>1</code> (only the newest commit). If set to <code>0</code>, the depth is unlimited.
|-
| <code>sync-type</code> || Specifies type of synchronization performed by <tt>emerge --sync</tt>. Valid non-empty values: <code>cvs</code>, <code>git</code>, <code>rsync</code>, <code>svn</code> and <code>websync</code> / <code>webrsync</code> (renamed in portage-2.2.19). This attribute can be set to empty value to disable synchronization of given repository. Empty value is default.
|-
| <code>sync-umask</code> || Specifies umask used to synchronize the repository. Takes an octal permission mask, e.g. <code>022</code>.
|-
| <code>sync-uri</code> || Specifies URI of repository used for synchronization performed by <tt>emerge --sync</tt>. This attribute can be set to empty value to disable synchronization of given repository. Empty value is default.
<pre>Syntax:
cvs: [cvs://]:access_method:[username@]hostname[:port]:/path
git: (git|git+ssh|http|https)://[username@]hostname[:port]/path
rsync: (rsync|ssh)://[username@]hostname[:port]/(module|path)
</pre>
|-
| <code>sync-user</code> || Specifies the credentials used to perform the synchronization. If only user is provided, the primary group of the user will be used.  If only group is  provided, the current user will be preserved and only group id will be changed. This key takes precedence over <code>FEATURES=userpriv</code>. If user or group id is provided, Portage no longer uses owner of the directory.
<pre>Syntax: [user][:group]</pre>
|}

== Example ==

{{FileBox|filename=/etc/portage/repos.conf|title=Example repos.conf|1=
[DEFAULT]
# Make gentoo the main repository, which makes it the default master
# repository for repositories that do not specify masters:
main-repo = gentoo
# Make all repositories inherit eclasses from the java-overlay and
# java-experimental repositories, with eclasses from java-experimental
# taking precedence over those from java-overlay:
eclass-overrides = java-overlay java-experimental

[gentoo]
# Repos with higher priorities are preferred when ebuilds with equal versions
# are found in multiple repos
priority = 9999
# Disable all eclass overrides for ebuilds from the gentoo repository:
eclass-overrides =
# When processing metadata/layout.conf from other repositories, substitute
# 'gentoo' in place of references to repositories named 'foo' and 'bar',
# and discard the 'baz' alias contained in gentoo's layout.conf
aliases = foo bar -baz

[kde-testing]
# override the metadata/layout.conf masters setting from the kde-testing repo
masters = gentoo kde

[python]
# Override the metadata/layout.conf masters setting from the python repo,
# so that settings won't be inherited from those masters, and so that
# those master repos won't be required as dependencies (the user must
# ensure that any required dependencies such as eclasses are satisfied):
masters =

# Repository 'gentoo' synchronized using CVS
[gentoo]
location = /usr/portage
sync-type = cvs
sync-uri = :pserver:anonymous@anoncvs.gentoo.org:/var/cvsroot
sync-cvs-repo = gentoo-x86
auto-sync = yes

# Overlay 'voip' syncronized with layman's plug-in sync module
[voip]
location = /var/lib/layman/voip
sync-type = laymanator
sync-uri = git://git.overlays.gentoo.org/proj/voip.git
auto-sync = yes
}}

== Listing repositories ==
To see a compact list of repositories, formatted for easy reading:

{{Cmd|emerge --info --verbose {{!}} sed -n '/^Repo/,/^ABI/p' {{!}} head -n -1}}

To see a detailed list of repositories, without any formatting:

{{Cmd|portageq envvar PORTAGE_REPOSITORIES}}

== Tips ==
=== Managing repositories from make.conf ===
{{Note|This method may be preferred by people who used the <code>PORTDIR_OVERLAY</code> variable to manage overlays. It is not recommended by the Portage developers.}}

The <code>PORTAGE_REPOSITORIES</code> environment variable has the same format as {{Path|repos.conf}}. Like the old <code>PORTDIR_OVERLAY</code> variable, it can be used to manage repositories from your {{Path|make.conf}} file.

First, create a basic {{Path|repos.conf}} file. This assumes your overlays are installed in {{Path|/usr/portage/overlays}}.

{{RootCmd|cp /usr/share/portage/config/repos.conf /etc/portage/repos.conf}}

{{RootCmd|for dir in /usr/portage/overlays/*/; do <pre>
let i++
printf "\n[%s]\nLocation = %s\npriority = %d\n" "$(cat ${dir%*/}/profiles/repo_name)" "$dir" $i >> /etc/portage/repos.conf
tail -n 3 /usr/share/portage/config/repos.conf >> /etc/portage/repos.conf
done</pre>}}

Query the environment variable and redirect output to {{Path|make.conf}}:

{{RootCmd|portageq envvar -v PORTAGE_REPOSITORIES >> /etc/portage/make.conf}}

Delete the unwanted {{Path|repos.conf}} file:

{{RootCmd|rm /etc/portage/repos.conf}}

The final step is to edit {{Path|make.conf}}, setting the <code>priority</code>, <code>sync-type</code> and <code>sync-uri</code> variables as required. For local repositories that don't require syncing, set the sync- variables to empty, rather than commenting them out.

{{RootCmd|nano /etc/portage/make.conf}}

=== Adding squashfs support as a plug-in ===

Squashfs support was [https://github.com/gentoo/portage/commit/090c8c91dad9af397f10118cf988ce95b9af2d7b removed] in portage-2.2.20. However, you can use the [[Project:Portage/Sync|plug-in sync system]] to add squashfs support back in, as a plug-in:

{{RootCmd|command goes here}}

== See also ==
* [[Project:Portage/Sync]]
* [[Layman#Using_.27repos.conf.27_method_.28default_method_for_app-portage.2Flayman-2.1.0_or_later_.29|Layman - Using 'repos.conf' method]]
* [[Project:Overlays/User_Guide]]
* [[Repository_format|Repository format]]

== External resources ==
* [https://www.gentoo.org/support/news-items/2015-02-04-portage-sync-changes.html news-items 2015-02-04 portage-sync-changes]

[[Category:Portage]]
