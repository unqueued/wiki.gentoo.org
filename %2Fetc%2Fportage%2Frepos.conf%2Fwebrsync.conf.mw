<noinclude>The example below shows how the main Gentoo repository is set up using the webrsync method via the {{Path|webrsync.conf}} file in the {{Path|[[:/etc/portage/repos.conf]]/}} directory. For more information visit the [[Project:Portage/Sync#Portage_configuration|Portage Sync article]].</noinclude>
{{FileBox|filename=[[:/etc/portage/repos.conf/webrsync.conf]]|title=webrsync example|lang=ini|1=
[DEFAULT]
main-repo = gentoo

[gentoo]
location = /usr/portage
sync-type = webrsync (or websync, depending on portage version)
auto-sync = yes
}}

<noinclude>
== Optional: Install app-arch/tarsync ==

The {{Package|app-arch/tarsync}} utility enables webrsync to sync direcltly from tarball, skips extraction, speeds up the process.

{{RootCmd|emerge app-arch/tarsync}}

== Optional: Verify releng Signature ==

Until git migration, the only method to securely sync portage is to check releng signatures of portage snapshot.

Create gnupg home with releng keys:

{{RootCmd|mkdir /etc/portage/gnupg}}
{{RootCmd|chmod 0700 /etc/portage/gnupg}}
{{RootCmd|chown portage:portage /etc/portage/gnupg}}
{{RootCmd|GNUPGHOME{{=}}/etc/portage/gnupg gpg --keyserver subkeys.pgp.net --recv-keys 0x96D8BF6D}}

Trust the key:

{{RootCmd|GNUPGHOME{{=}}/etc/portage/gnupg gpg --edit-key --fingerprint 0x96D8BF6D|output=<pre>
gpg: WARNING: unsafe ownership on homedir `/etc/portage/gnupg'
gpg (GnuPG) 2.0.26; Copyright (C) 2013 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.


gpg: checking the trustdb
gpg: no ultimately trusted keys found
pub  4096R/96D8BF6D  created: 2011-11-25  expires: 2015-11-24  usage: C   
                     trust: undefined     validity: unknown
sub  4096R/C9189250  created: 2011-11-25  expires: 2015-11-24  usage: S   
[ unknown] (1). Gentoo Portage Snapshot Signing Key (Automated Signing Key)

gpg> trust
pub  4096R/96D8BF6D  created: 2011-11-25  expires: 2015-11-24  usage: C   
                     trust: undefined     validity: unknown
sub  4096R/C9189250  created: 2011-11-25  expires: 2015-11-24  usage: S   
[ unknown] (1). Gentoo Portage Snapshot Signing Key (Automated Signing Key)

Please decide how far you trust this user to correctly verify other users' keys
(by looking at passports, checking fingerprints from different sources, etc.)

  1 = I don't know or won't say
  2 = I do NOT trust
  3 = I trust marginally
  4 = I trust fully
  5 = I trust ultimately
  m = back to the main menu

Your decision? 5
Do you really want to set this key to ultimate trust? (y/N) y

pub  4096R/96D8BF6D  created: 2011-11-25  expires: 2015-11-24  usage: C   
                     trust: ultimate      validity: unknown
sub  4096R/C9189250  created: 2011-11-25  expires: 2015-11-24  usage: S   
[ unknown] (1). Gentoo Portage Snapshot Signing Key (Automated Signing Key)
Please note that the shown key validity is not necessarily correct
unless you restart the program.

gpg> q
</pre>}}

Append webrsync-gpg to FEATURES in {{Path|/etc/portage/make.conf}} and set location of gnupg home:

{{FileBox|filename=/etc/portage/make.conf|title=webrsync gpg|lang=bash|1=
FEATURES="${FEATURES} webrsync-gpg"
PORTAGE_GPG_DIR="/etc/portage/gnupg"
}}

== See also ==

* [[Handbook:Parts/Working/Features#Pulling_validated_Gentoo_ebuild_tree_snapshots|Handbook:Parts/Working/Features#Pulling validated Gentoo ebuild tree snapshots]]
</noinclude>
