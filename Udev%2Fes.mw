<languages />
{{Metadata|abstract=udev es el gestor de dispositivos para el núcleo Linux. Gestiona los nodos de dispositivo en /dev y también todos las acciones en espacio de usuario cuando se añaden o eliminan dispositivos.}}

{{Lowercase title}}
{{InfoBox stack
|{{InfoBox homepage|https://www.freedesktop.org/wiki/Software/systemd/|header=true}}
|{{InfoBox wikipedia}}
|{{InfoBox gitweb|https://cgit.freedesktop.org/systemd/systemd/tree/src/udev|raw=true}}
|{{InfoBox project|Udev}}
}}

'''udev''' es el gestor de dispositivos para el núcleo Linux. Gestiona los nodos de dispositivo en {{Path|/dev}} y también todos las acciones en espacio de usuario cuando se añaden o eliminan dispositivos. El lector debería también echar un vistazo a [Project:Eudev|eudev] una bifurcación de udev.

== ¿Qué es udev? ==

=== El directorio /dev ===

{{:/dev/en}}

== Instalación ==

{{Important|Cuando actualice udev, eche un vistazo a [[Udev/Upgrade Guide|guía de actualización de udev]] para obtener información sobre cómo evitar que los sistemas no inicien.}}

=== Núcleo ===

{{c|udev}} necesita las siguientes opciones del núcleo:

<!-- Mirar en https://git.kernel.org/?p=linux/hotplug/udev.git;a=blob_plain;f=README -->
{{KernelBox|1=
General setup --->
  [*] Configure standard kernel features (expert users) --->
     [ ] Enable deprecated sysfs features to support old userspace tools
     [*] Enable signalfd() system call
Enable the block layer --->
  [*] Block layer SG support v4
Networking support --->
  Networking options --->
     <*> Unix domain sockets
Device Drivers --->
  Generic Driver Options --->
     () path to uevent helper
     [*] Maintain a devtmpfs filesystem to mount at /dev
  < > ATA/ATAPI/MFM/RLL support (DEPRECATED) --->
File systems --->
  [*] Inotify support for userspace
  Pseudo filesystems --->
     [*] /proc file system support
     [*] sysfs file system support
}}

=== Ajustes USE ===

Portage reconoce el ajuste USE global <code>udev</code> para habilitar el soporte de udev en otros paquetes. Al añadir este ajuste USE a la lista de ajustes (se realiza por defecto en todos los [[Profile (Portage)|perfiles]]) se instalará automáticamente el paquete {{Package|sys-fs/udev}}:

{{FileBox|filename=/etc/portage/make.conf|lang=bash|1=
USE="udev"
}}

{{USEflag|package=sys-fs/udev}}

=== Emerge ===

Después de definir los ajustes USE, seguramente se desee actualizar el sistema para que los cambios tengan efecto:

{{Emerge|params+=--changed-use --deep|@world}}

== Configuración ==

=== Servicio ===

Para arrancar udev en el inicio del sistema, añádalo al nivel de ejecución sysinit. Esto se puede hacer lanzando la siguiente orden con privilegios de root:

{{RootCmd|rc-update add udev sysinit}}

== Configuración avanzada ==

=== Reglas ===

Udev ofrece un conjunto de reglas que concuerdan con los valores exportados de los uevents (eventos enviados por el núcleo) y las propiedades del dispositivo que se ha descubierto. Una regla que concuerda posiblemente creará y nombrará un nodo de dispositivo y lanzará los programas definidos para poner en marcha y configurar el dispositivo.

Las definiciones de las reglas se almacenan en dos localizaciones:

# '''{{Path|/lib/udev/rules.d/}}'''. Las reglas en este directorio son instaladas por determinados paquetes, normalmente los usuarios no deberían cambiarlas.
# '''{{Path|/etc/udev/rules.d/}}'''. Este directorio es para las reglas especificadas por los usuarios finales. Cualquier nueva regla se debe añadir en este directorio.

En estos directorios se recorren en orden alfabético múltiples ficheros de reglas (con el sufijo {{Path|.rules}}), udev buscará expresiones que concuerden con un uevent y con el estado definido (es el uevent debido que se ha añadido o retirado un dispositivo) y la orden a ejecutar.

La concordancia del evento se basa en información como:

* El ''SUBSYSTEM'' del uevent (para qué tipo de dispositivo se dispara el uevent).
* La ''ACTION'' que se realiza (añadir, cambiar o eliminar).
* Uno o más atributos (a través de ''ATTR'' o ''ATTRS''), tales como la clase del dispositivo, el fabricante u otra información del dispositivo.
* El nombre que ofrece el núcleo (a través de ''KERNEL''), como sd* (para los discos SCSI/SATA) o input* (para dispositivos de entrada como ratones y teclados)
* Uno o más ajustes de entorno (a través de ''ENV''), utilizados para enviar información entre múltiples reglas.

Basándose en esta información, la regla puede entonces comprobar sí:

# Se necesita compartir alguna información con eventos posteriores (a través de variables de entorno)
# Se necesita crear enlaces en {{Path|/dev}}
# Se necesita lanzar alguna orden

Udev realiza esto para cada regla que concuerda (por lo que no se detiene en la primera concordancia) para permitir un enfoque flexible de gestión de los dispositivos.

=== Nombres persistentes de dispositivos ===

El núcleo detecta los dispositivos de forma asíncrona. Udev crea un reflejo del sistema de ficheros del núcleo [[sysfs]] y por lo tanto los dispositivos se nombran y numeran en el orden de su detección. Así, por defecto udev no ofrece nombres persistentes de los dispositivos. Sin embargo, existen mecanismos de algunas clases de dispositivo para ofrecerlos:

* Udev crea enlaces simbólicos adicionales para los dispositivos de almacenamiento basándose en el identificador (ID), [[Removable_media#UUIDs_and_labels|la etiqeta, el UUID]] y la ruta del dispositivo. Eche un vistazo al directorio {{Path|/dev/disk/by-*}}. Por lo que, por ejemplo, en lugar de utilizar el archivo de dispositivo {{Path|/dev/sda}} utiliza el fichero {{Path|/dev/disk/by-label/ALGUNA_ETIQUETA}}.

* Lo mismo aplica para los dispositivos de entrada en el directorio {{Path|/dev/input}}.

* Usando reglas propias los usuarios pueden crear sus propios ficheros de dispositivo.

== Utilización ==

Algunas órdenes útiles son las siguientes:

* Mostrar todos los mensajes sobre un determinado archivo de dispositivo: : {{RootCmd|udevadm info --query{{=}}all --name{{=}}/dev/FICHERO_DE_DISPOSITIVO}}

* Monitorizar las actividades de udev: {{RootCmd|udevadm monitor}}

* Asignar un nombre persistente a un dispositivo ethernet:
: {{FileBox|filename=/etc/udev/rules.d/ethernet.rules|lang=bash|1=
SUBSYSTEM=="net", ACTION=="add", ATTR{address}=="01:23:45:67:89:ab", NAME="eth6789ab"
}}

Lea la [[man page|página del manual]] de ''udevadm'' para más información.

== Resolución de problemas ==

* {{Bug|udev|search=package}}

=== Registrar mensajes del monitor ===

Para registrar todos los mensajes cuando se lanza {{c|udevadm monitor}}, se debe modificar el siguiente fichero de configuración:

{{FileBox|filename=/etc/conf.d/udev|lang=bash|1=
udev_monitor="YES"
}}

Se creará un el nuevo fichero de registro localizado en {{Path|/run/udev/udevmonitor.log}}.

=== Modo depuración ===

Habilitar el modo depuración permitirá mostrar más mensajes de registro:

{{FileBox|filename=/etc/conf.d/udev|lang=bash|1=
udev_debug="YES"
}}

Defina la prioridad del registro:

{{FileBox|filename=/etc/udev/udev.conf|lang=bash|1=
udev_log="debug"
}}

Se creará el fichero de registro {{Path|/run/udevdebug.log}} pero no se mostrarán mensajes en él. Las versiones más recientes de udev mostrarán todos los mensajes en {{c|dmesg}}.

=== Faltan los ficheros de dispositivo {{Path|/dev/null}} y {{Path|/dev/console}} ===

Algunas versiones de udev necesitan los ficheros {{Path|/dev/null}} y {{Path|/dev/console}} para funcionar correctamente pero no pueden crearlos ellos mismos. Para crear manualmente estos ficheros por udev, lance las siguientes ordenes con privilegios de root:

{{RootCmd
|mkdir test
|mount --bind / test
|cd test/dev
|mknod -m 660 console c 5 1
|mknod -m 660 null c 1 3
|cd ../..
|umount test
|rmdir test
}}

=== NIC asignada a eth0 pero se mueve a eth1 ===

En las placas base con dos tarjetas de red puede suceder que {{c|ifconfig}} no muestre ni eth0 ni eth1. La orden {{c|dmesg}} puede mostrar las NIC detectadas como eth0 y luego cambiar a eth1. Al realizar un {{c|ifconfig -a}} también se mostrar la NIC como eth1. Esto es debido a que el núcleo asigna estos nombres en primer lugar. Los usuarios deben escribir sus propias reglas personalizadas como {{Path|/etc/udev/rules.d/70-my-network.rules}} para usar los nombres que elija como lan0 o wireless0 o utilizar los nombres predecibles para las interfaces (que se han habilitado por defecto a partir de la versión 197 de udev).

Recuerde también eliminar los ficheros antiguos de las versiones anteriores de udev:

{{RootCmd|rm /etc/udev/rules.d/70-persistent-net.rules}}

Also make sure not to pass <code>net.ifnames=0</code> on the kernel commandline. This setting would disable the predictable devname feature of udev altogether.

== Ver también ==.

== Recursos externos ==
* [http://cgit.freedesktop.org/systemd/systemd/tree/src/udev Código fuente de udev]

== Recursos externos ==

{{Bug|575718|text=Bug 575718 - Petición para que el consejo decida en relación al proveedor por defecto de virtual/udev}} - Proveedor por defecto de virtual/udev  ha cambiado a sys-fs/eudev


[[Category:Core system]]
[[Category:Daemons]]
