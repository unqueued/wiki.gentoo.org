<languages />

{{Metadata|abstract=Esta guía debería ayudar a los usuarios a realizar una correcta localización de su distribución Gentoo Linux en cualquier localización conocida. Se ha utilizado España como caso ejemplo. Incluye la configuración para utilizar el símbolo del Euro.}}

== Zona horaria ==

Para mantener la hora del sistema de forma adecuada a la localización actual, se necesita ajustar la zona horaria. Se pueden encontrar instrucciones para hacerlo en  [[System_time#OpenRC|sistemas basados en OpenRC]] y [[System_time#systemd|sistemas basados en systemd]] dentro del artículo sobre [[System_time|la hora del sistema]].

== Sistema de localizaciones ==

=== ¿Qué son las localizaciones? ===

Una localización es un conjunto de información que muchos programas utilizan para determinar los ajustes específicos de país e idioma. Las localizaciones y sus datos forman parte de la biblioteca del sistema y se encuentran en {{Path|/usr/share/i18n/locales/}} en la mayoría de los sistemas. Una localización, generalmente tiene el nombre de la forma <code>ab_CD</code> donde <code>ab</code> representa las dos (o tres) letras del código del idioma (según [[wikipedia:ISO_639|ISO-639]]) y <code>CD</code> representa las dos letras del código del país (según [[wikipedia:ISO_3166|ISO-3166]]). Las variantes como <code>@euro</code> o <code>@latin</code> se suelen agregar a menudo a los nombres de las localizaciones, por ejemplo <code>es_ES@euro</code> o <code>nan_TW@latin</code>. Por favor, explore la  [[wikipedia:Locale_(computer_software)|Wikipedia]] para obtener más información acerca de las localizaciones y otros artículos relacionados.

=== Variables de entorno para localizaciones ===

Las variables que controlan diferentes aspectos de las configuraciones de las localizaciones se muestran abajo. Todas ellas toman un nombre de localización en el formato <code>ab_CD</code> usado arriba. 

{| class="table table-stripe" style="text-align: left;"
|-
!scope=col width=25% | Nombre de la variable
!scope=col width=75% | Explicación
|-
| <var>LANG</var>
| Define todos los ajustes de localización de una sola vez mientras que permite personalizaciones individuales utilizando los ajustes LC_* de abajo.
|-
| <var>LC_COLLATE</var>
| Define la ordenación alfabética de las cadenas de caracteres. Este afecta, por ejemplo, a la salida de los listados de los directorios mostrados en orden.
|-
| <var>LC_CTYPE</var>
| Define las propiedades de gestión de caracteres para el sistema. Esto determina qué caracteres son alfabéticos, numéricos, etc. También determina qué conjunto de caracteres se utiliza, si esto es aplicable.
|-
| <var>LC_MESSAGES</var>
| Localizaciones de los programas almacenados en {{Path|/usr/share/locale/}} para aplicaciones que utilicen un esquema de mensajes basado en localizaciones (la mayoría de los programas GNU, leer los siguientes capítulos para obtener información más detallada de cualés son y cómo hacer que estos programas funcionen).
|-
| <var>LC_MONETARY</var>
| Define la unidad monetaria y el formato de los números que representan moneda.
|-
| <var>LC_NUMERIC</var>
| Define el formato de valores numéricos que no son moneda. Afecta a cosas como el separador de millares y el separador decimal.
|-
| <var>LC_TIME</var>
| Define el formato de fecha y hora.
|-
| <var>LC_PAPER</var>
| Define el tamaño del papel por defecto.
|-
| <var>LC_ALL</var>
| Redefine los demás ajustes.
|-
|}

{{Note|Algunos programas se escriben de una forma en la que esperan la ordenación tradicional del alfabeto del idioma inglés, pero algunas localizaciones, mayoritariamente la estonia, utiliza una ordenación diferente. Por lo tanto se recomienda definir explicitamente <var>LC_COLLATE</var> a C cuando se trate de ajustes al nivel de todo el sistema.}}

{{Warning|No se recomienda el uso de <var>LC_ALL</var> ya que sobrescribe de forma automática las demás variables <var>LC_*</var> (<var>LANG</var> no se ve afectada). Esto significa que los cambios realizados de otra forma se ocultarán hasta que <var>LC_ALL</var> se defina como cadena vacía. Seguramente la mejor opción es no definirla en un fichero de inicio.}}

La mayoría de los usuarios definirán la variable <var>LANG</var> al nivel global.

=== Generar localizaciones específicas ===

La mayoría de los usuarios probablemente solo utilizarán dos localizaciones en su sistema. En el fichero {{Path|/etc/locale.gen}} se indica cómo se pueden especificar localizaciones adicionales. 

{{CodeBox|title=Añadir localizaciones a /etc/locale.gen|1=
en_GB ISO-8859-1
en_GB.UTF-8 UTF-8
de_DE ISO-8859-1
de_DE@euro ISO-8859-15
}}

{{Note|Utilizar un valor <code>@euro</code> de {{Path|/usr/share/i18n/SUPPORTED/}} como localización cuando se utilice el símbolo monetario del Euro (€) en localizaciones que no estén basadas en UTF-8.}}

El siguiente paso es lanzar {{c|locale-gen}} que generará todas las localizaciones especificadas en el archivo {{Path|/etc/locale.gen}} y escribirlas al archivo de localizaciones ({{Path|/usr/lib/locale/locale-archive}}). 

{{RootCmd|locale-gen|output=<pre>
 * Generating 4 locales (this might take a while) with 1 jobs
 *  (1/4) Generating en_GB.ISO-8859-1 ...                       [ ok ]
 *  (2/4) Generating en_GB.UTF-8 ...                            [ ok ]
 *  (3/4) Generating de_DE.ISO-8859-1 ...                       [ ok ]
 *  (4/4) Generating de_DE.ISO-8859-15@euro ...                 [ ok ]
 * Generation complete
</pre>}}

Verificar que las localizaciones seleccionadas están disponibles con la orden {{c|locale -a}}.

{{Cmd|locale -a|output=<pre>
C
POSIX
es_ES
es_ES.iso88591
es_ES.iso885915@euro
es_ES@euro
spanish
en_GB
en_GB.iso88591
en_GB.utf8
german
</pre>}}

Se puede mostar el fichero {{Path|/usr/lib/locale/locale-archive}} usando la orden {{c|localedef}}.

{{Cmd|localedef --list-archive}}

Su contenido en crudo se puede mostrar mediante la orden {{c|strings}}.

{{Cmd|strings /usr/lib/locale/locale-archive {{!}} less}}

=== Configurar una localización ===

==== OpenRC ==== 

Cuando se utiliza OpenRC, los ajustes de la localización se almacenan en variables de entorno. Estas se definen normalmente en el fichero {{Path|/etc/env.d/02locale}} (para ajustes que afectan a todo el sistema) y en el fichero {{Path|~/.bashrc}} (para ajustes específicos del usuario). Se pueden encontrar más detalles en el articulo sobre [[UTF-8/es#Configurar_la_localizaci.C3.B3n|UTF-8]]. Los ajustes para todo el sistema ({{Path|/etc/env.d/02locale}}) se pueden gestionar mediante {{c|eselect locale}}. Por ejemplo, para definir la variable <var>LANG</var> al valor <code>C</code>:

{{RootCmd|eselect locale list|output=<pre>
Available targets for the LANG variable:
[1] C
[2] POSIX
[3] en_ES
[4] en_ES.iso885915
[5] en_ES.utf8
[ ] (free form)
</pre>}}

{{RootCmd|eselect locale set 1}}

Por supuesto también se puede editar el fichero de forma manual para diversificar las variables de localización.

{{FileBox|filename=/etc/env.d/02locale|title=Definir la localización por defecto del sistemaen /etc/env.d/02locale|lang=bash|1=
LANG="es_ES.UTF-8"
LC_COLLATE="C"
}}

También es posible y muy común especialmente en entornos UNIX más tradicionales dejar sin cambiar los ajustes globales, esto es, definiendo la localización global a <code>C</code>. Los usuarios pueden definir sus localizaciones preferidas en su propio fichero RC del intérprete de comandos. 

{{FileBox|filename=~/.bashrc|title=Definir la localización del usuario|lang=bash|1=
export LANG="es_ES.UTF-8"
export LC_COLLATE="C"
}}

Otra forma de configurar el sistema es dejarlo en una localización <code>C</code> por defecto y habilitar a la vez la representación de caracteres UTF-8. Esto se puede realizar utilizando los siguientes ajustes en {{Path|/etc/env.d/02locale}}: 

{{CodeBox|title=Usar una localización C tradicional a la vez que se especifica UTF-8|lang=bash|1=
LC_CTYPE=de_DE.UTF-8
}}

Al usar el fragmento de código de arriba, los usuarios puede ver los nombres de los ficheros de localización de forma correcta sin necesidad de forzarlos a utilizar siempre el idioma seleccionado. 

Una vez definida la localización correcta, asegurarse de actualizar las variables de entorno para avisar al sistema del cambio realizado.

Para una localización por defecto para todo el sistema:

{{RootCmd|env-update && source /etc/profile}}

Para una localización específica del usuario:

{{Cmd|source ~/.bashrc}}

Después de esto, se debe reiniciar el servidor X pulsando {{Key|Ctrl}} + {{Key|Alt}} + {{Key|Retroceso}}, salir y volver a entrar con el mismo usuario. 

Ahora, verifique que los cambios han surtido efecto: 

{{Cmd|locale}}

==== systemd ====

En systemd se define la localización con la orden {{c|localectl}}. Comprobar la lista de localizaciones disponibles con:

{{RootCmd|localectl list-locales}}

A continuación defina la localización deseada:

{{RootCmd|<nowiki>localectl set-locale
LANG=es_ES.utf8</nowiki>}}

Para terminar, compruebe si el resultado es correcto:

{{RootCmd|<nowiki>localectl | grep "System Locale"
</nowiki>|output=<pre>
  System Locale: LANG=es_ES.utf8
</pre>}}

== Distribución del teclado para la consola ==

=== OpenRC ===

La distribución del teclado usada por la consola se define en {{Path|/etc/conf.d/keymaps}} con la variable <var>keymap</var>. Los valores válidos para esta variable se pueden encontrar en  {{Path|/usr/share/keymaps/SU_ARQUITECTURA/}}. La arquitectura {{Path|i386}} tiene subdivisiones de disposiciones de teclado ({{Path|qwerty/}}, {{Path|azerty/}}, etc.). Algunos idiomas tienen mútiples opciones, experimentar con estas opciones para decidir cuál se adapta mejor a las necesidades. 

{{FileBox|filename=/etc/conf.d/keymaps|title=Definir el mapa de teclado de la consola|lang=bash|1=
keymap="es"
#keymap="es-cp850"
}}

=== systemd ===

En systemd se puede definir el mapa de teclado de la consola con la orden {{c|localectl}}. En primer lugar, comprueba los mapas de teclado disponibles:

{{RootCmd|localectl list-keymaps}}

A continuación configurar la disposición del mapa del teclado solicitada:

{{RootCmd|localectl set-keymap es}}

Para terminar, compruebe si el mapa de teclado de la consola se definió correctamente:

{{RootCmd|<nowiki>localectl | grep "VC Keymap"</nowiki>|output=<pre>
     VC Keymap: es
</pre>}}

== Mapa de teclado para el servidor X ==

=== OpenRC ===

El mapa de teclado que utiliza el servidor X se especifica en {{Path|/etc/X11/xorg.conf.d/30-keyboard.conf}} mediante la opción <var>XkbLayout</var>. Para obtener más detalles, visite la [[Xorg/Guide/es#Configurar_el_teclado|guía de Xorg]] y el artículo sobre [[Keyboard_layout_switching#X11|conmutación de la disposición del teclado]].

=== systemd ===

En systemd el mapa de teclado para el servidor X11 se puede definir mediante la orden {{c|localectl}}. En primer lugar compruebe los mapas de teclado disponibles:

{{RootCmd|localectl list-x11-keymap-layouts}}

A continuación configurar el mapa de teclado solicitado para X11:

{{RootCmd|localectl set-x11-keymap es}}

Para terminar, compruebe si el mapa de teclado para X11 se definió correctamente:

{{RootCmd|<nowiki>localectl | grep "X11 Layout"</nowiki>|output=<pre>
    X11 Layout: es
</pre>}}

== NLS ==

Para que la localización basada en mensajes funcione en programas que ofrecen soporte para ello y disponen del [https://packages.gentoo.org/useflags/nls ajuste USE <code>nls</code> (Native Language Support)], compilar los programas con este ajuste definido. Las cadenas con los mensajes se instalan en los ficheros {{Path|/usr/share/locale/<localización>/LC_MESSAGES/<paquete>.mo}}. La mayoría de los programas que utilizan NLS también necesitan la librería gettext para extraer y utilizar los mensajes apropiados de cada localización. Desde luego, Portage la instalará cuando sea necesaria.

Después de habilitar el ajustes USE <code>nls</code> probablemente se deba hacer emerge de nuevo de algunos paquetes:

{{Emerge|params+=--changed-use --deep --with-bdeps=y|@world}}

== LINGUAS ==

También existe un ajuste <var>USE_EXPAND</var> adicional llamado <var>[https://packages.gentoo.org/useflags/linguas_en LINGUAS]</var> <ref>[https://devmanual.gentoo.org/general-concepts/linguas/ LINGUAS] en la guía de desarrollo de Gentoo</ref>, que afecta a qué ficheros de localización se instalan para los programas basados en gettext. Esta variable toma la forma de códigos de idioma separados por un ''espacio'' y un lugar sugerido para definirla es {{Path|[[:/etc/portage/make.conf|/etc/portage/make.conf]]}}: 

{{RootCmd|nano -w /etc/portage/make.conf|output=<pre>
## (Añadir la variable LINGUAS. Por ejemplo para español, alemán e inglés:)
LINGUAS="es de en"
</pre>
}}

Con <code>LINGUAS=""</code> la mayoría de ebuilds deberían instalar únicamente el idioma por defecto del paquete pero ningún fichero <code>LC_MESSAGES</code>. Tampoco deberían instalar ningún otro paquete de idioma.

Se puede mostrar una lista de los programas instalados que hacen uso del ajuste <var>USE_EXPAND</var>  <var>[https://packages.gentoo.org/useflags/linguas_en LINGUAS]</var> y los idiomas soportados de las siguiente forma:

{{Cmd|eix -I -U linguas}}

Se puede encontrar una lista de valores para <var>LINGUAS</var> en {{Path|/usr/portage/profiles/desc/linguas.desc}}: 

{{Cmd|grep -i spanish /usr/portage/profiles/desc/linguas.desc|output=<pre>
es - Spanish locale
es_AR - Spanish locale for Argentina
es_CL - Spanish locale for Chile
es_CO - Spanish locale for Columbia
es_CR - Spanish locale for Costa Rica
es_ES - Spanish locale for Spain
es_LA - Spanish locale for Latin America
es_MX - Spanish locale for Mexico
es_VE - Spanish locale for Venezuela
</pre> }}

Después de definir el ajuste <var>USE_EXPAND</var><var>[https://packages.gentoo.org/useflags/linguas_en LINGUAS]</var> puede que se necesite volver a hacer emerge de algunos paquetes:

{{Emerge|params+=--changed-use --deep --with-bdeps=y|@world}}

{{Note|Se está reemplazando <var>LINGUAS</var> como variable <var>USE_EXPAND</var>ida por la variable <var>L10N</var> (ver abajo). Esto evita un conflicto conceptual con el comportamiento estándar de gettext. Una ve haya transcurrido el periodo de transición en el que se convertirán los paquetes. La variable <var>LINGUAS</var> volverá a ser una variable más del entorno.}}

== L10N ==

Otra variable <var>USE_EXPAND</var> llamada <var>L10N</var> decide qué soporte de localizaciones extra se va a instalar. Esto se utiliza normalmente para la descarga de paquetes de idiomas adicionales necesitados por los paquetes. Similar a <var>LINGUAS</var>, la variable admite una lista de etiquetas de idioma separadas por espacio y se puede definir en {{Path|/etc/portage/make.conf}}:

{{RootCmd|nano -w /etc/portage/make.conf|output=<pre>
## (Anadir la variable L10N variable. Por ejemplo para el español y el portugués de Brasil:)
L10N="es pt-BR"
</pre>}}

Para configurarlo por paquete, editar {{Path|[[:/etc/portage/package.use]]}} y prefijar los paquetes de idioma solicitados con "l10n_" tal y como se muestra en el siguiente ejemplo:

{{FileBox|filename=/etc/portage/package.use|lang=bash|1=
app-text/aspell l10n_de l10n_pt_BR
}}

Observe que los códigos de idioma de dos letras comunes (como <code>es</code> o <code>fr</code>) son idénticos en <var>LINGUAS</var> y en <var>L10N</var>, las entradas más complejas tienen una sintaxis diferente ya que <var>L10N</var> utiliza [https://www.w3.org/International/articles/language-tags/ etiquetas de idioma IETF] (también conocido como BCP 47). Por ejemplo, <code>pt_BR</code> y <code>sr@latin</code> en <var>LINGUAS</var> se convierten respectivamente en <code>pt-BR</code> y <code>sr-Latn</code> en <var>L10N</var>.

Una lista de valores <var>L10N</var> que se pueden utilizar se ofrece como {{Path|/usr/portage/profiles/desc/l10n.desc}}:

{{Cmd|grep -i spanish /usr/portage/profiles/desc/l10n.desc|output=<pre>
es - Spanish
es-419 - Spanish (Latin America)
es-AR - Spanish (Argentina)
es-CL - Spanish (Chile)
es-ES - Spanish (Spain)
es-MX - Spanish (Mexico)
</pre>}}

Una vez definida la variable <var>USE_EXPAND</var> <var>L10N</var> puede que sea necesario volver a hacer emerge de algunos paquetes:

{{Emerge|params+=--changed-use --deep --with-bdeps=y|@world}}

== Ver también ==


* [[Handbook:AMD64/Installation/Base/es#Configurar_localizaciones|Configurar localizaciones]] (Manuales de Gentoo)
* [[Evdev#Keyboard_layout|Disposición del teclado]] dentro del artículo sobre Evdev
* [[X resources|Recursos para X]]
* [[Localization/Guide/The_Euro_symbol|El símbolo del euro]] ([http://unicode-table.com/en/20AC/ €]) para la consola y en X

== Recursos externos == 

* [https://www.gnu.org/software/libc/manual/html_node/Locales.html Locales and Internationalization] (gnu.org)
* [https://gentoo.org/support/news-items/2016-06-23-l10n-use_expand.html L10N USE_EXPAND variable replacing LINGUAS]
* [https://blogs.gentoo.org/mgorny/2016/05/16/how-linguas-are-thrice-wrong/ Michał Górny:How LINGUAS are thrice wrong!]
* [https://archives.gentoo.org/gentoo-dev/message/a08ea09c2c8e534fd9bc1146703c66ff <nowiki>[gentoo-dev] [RFC] How to deal with LINGUAS mess?</nowiki>]
* [https://archives.gentoo.org/gentoo-dev/message/41e09d1ddc8b30abb9f9d21d205b7b82 <nowiki>[gentoo-dev] [RFC] Masterplan for solving LINGUAS problems</nowiki>]

== Referencias ==

{{reflist}}


[[Category:Localization]] {{Migrated|originalauthors=Alexander Holler, Steven Lucy, Benny Chuang, Lars Weiler, Tobias Scherbaum, Flammie Pirinen, nightmorph, klondike}}
