<languages />


{{Metadata|abstract=Данный ЧаВо — это набор вопросов и ответов, составленный по материалам списка рассылки gentoo-dev и канала Gentoo на Freenode Internet Relay Chat (IRC).}}

Данный ЧаВо — это набор вопросов и ответов, составленный по материалам списка рассылки gentoo-dev и канала Gentoo на Freenode Internet Relay Chat (IRC).

__TOC__

=== Введение ===

Обратите внимание, что многие из этих вопросов объясняются в официальных документах и руководствах Gentoo. Это просто список часто задаваемых вопросов. Для изучения работы Gentoo и GNU/Linux вообще, а также поиска ответов на вопросы, не освещенные в данной статье, можно обратиться к документации и man-страницам. 

== Приступаем к настройке ==

=== Как произносится слово Gentoo, и что оно означает? ===

''Gentoo'' произносится как “gen-too” (джен-ту), буква “g” в слове “Gentoo” — мягкая, как в слове “gentle” (джентл). (Информация о произношении актуальна для английского языка. Распространенные русские варианты: Гéнту и Гентý. — Прим. пер.) Научное имя [https://en.wikipedia.org/wiki/Gentoo_penguin пингвина Gentoo] — ''Pygoscelis papua''. Имя ''Gentoo'' было дано пингвину населением [https://en.wikipedia.org/wiki/Falkland_Islands Фолклендских островов].

=== Что делает Gentoo особенным? ===

Gentoo использует систему, похожую на порты BSD, называемую [[Project:Portage|Portage]]. Portage — это система управления пакетами, которая позволяет достичь большой гибкости при установке и управлении программным обеспечением в системе Gentoo. В ней есть поддержка параметров времени компиляции (с помощью [[Handbook:AMD64/Working/USE| USE-флагов]]), условные зависимости, информация об устанавливаемых пакетах, безопасная установка (с помощью песочницы) и удаление программ, системные профили, [[Handbook:AMD64/Portage/Variables#Configuration_file_protection| защита файлов конфигурации]], а также многие другие [[Handbook:AMD64/Working/Features| возможности]].

По умолчанию в Gentoo вся система собирается из исходных кодов, используя выбранные пользователем параметры оптимизации. Пользователь имеет полный контроль над тем, какие пакеты устанавливать, а какие нет. В Gentoo многое можно выбрать самому, собрав систему в соответствии со своими предпочтениями. Поэтому Gentoo называют ''метадистрибутивом''. 

Gentoo активно развивается. Весь дистрибутив разрабатывается в быстром темпе: патчи к пакетам быстро интегрируются в основное дерево, документация обновляется ежедневно, новые возможности часто добавляются в Portage, а официальные релизы происходят дважды в год.

== Установка ==

=== Все реально нестабильно, если использовать оптимизации -O9 -ffast-math -fomit-frame-pointer. Что происходит? ===

Не пытайтесь использовать уровни оптимизации выше <code>-O3</code>, это все равно не поддерживается актуальными версиями gcc. Очень агрессивные оптимизации иногда заставляют компилятор ускорять ассемлерный код так, что программа делает уже не совсем то же, что без оптимизаций. 

Попробуйте компиляцию с CFLAGS <code>-O2 -march=<архитектура_системы></code> перед тем, как отправлять нам отчет об ошибке. 

=== Как изменить пароль root (или любого другого пользователя)? ===

Для изменения пароля пользователя, под учетной записью которого вы вошли в систему, можно использовать <code>passwd</code>. Пользователь root может изменять пароль любого пользователя командой <code>passwd имя_пользователя</code>. Для получения списка дополнительных опций и настроек выполните команду <code>man passwd</code>.

=== Как добавить обычного пользователя? ===

Команда <code>useradd larry</code> добавляет пользователя “larry”. Однако при использовании данного метода созданный пользователь не получит многих прав, которые необходимы для нормальной работы, так что следующая команда предпочтительней:

{{RootCmd|useradd -m -G users,audio,wheel larry}}

Данная команда создаст пользователя с именем “larry”. Параметр <code>-G</code> приведет к включению пользователя в группы:
* <code>users</code> стандартную группу интерактивных пользователей системы
* <code>audio</code> позволит ему получать доступ к аудиоустройствам
* <code>wheel</code> даст возможность выполнять команду <code>su</code>, для получения привилегии пользователя <code>root</code> (если известен пароль root).

=== Не выходит получить права root’а с помощью команды su. Из-за чего это может происходить? ===

По причинам, связанным с безопасностью, пользователи могут использовать команду <code>su</code> для повышения прав только, если они состоят в группе wheel. Чтобы добавить пользователя username к группе wheel, выполните следующую команду от пользователя root: 

{{RootCmd|gpasswd -a <username> wheel}}

=== Можно ли обновить Gentoo с одного выпуска до другого без переустановки? ===

После установки между разными выпусками нет, в сущности, никаких различий. Система Gentoo версии 1.4 или более поздней основана на <code>glibc-2.3.x</code> (или выше). Поэтому после выполнения команды <code>emerge --sync && emerge -uDN @world</code> ваша система станет «самой новой системой Gentoo». Разница между отдельными выпусками заключается только в различных установочных носителях и заранее скомпилированных пакетах. Более детальная информация о профилях и их роли в обновлении системы находится в [[Upgrading Gentoo|руководстве по обновлению Gentoo]]. 

Обратите внимание, что команда <code>emerge -uDN world</code> обновит установленные пакеты и их зависимости, но не обновит зависимости времени сборки (пакеты, которые нужны только при сборке, и не нужны для работы установленного приложения). Для их обновления добавьте параметр <code>--with-bdeps=y</code>.

=== Ядро не загружается, что делать? ===

Не обязательно повторять все установку целиком. Однако необходимо изучить ядро и все связанные с ним шаги. Предположим, что Gentoo установлена на {{Path|/dev/sda1}} ({{Path|/boot}}) и {{Path|/dev/sda3}} ({{Path|/}}), а с {{Path|/dev/sda2}} начинается  пространство swap.

Загрузиться с установочного и CD, и дождаться появления приглашения командной строки.

Сначала смонтировать все разделы:

{{RootCmd|mount /dev/sda3 /mnt/gentoo
|mount /dev/sda1 /mnt/gentoo/boot
|swapon /dev/sda2
|mount -t proc none /mnt/gentoo/proc}}

Войдите в режим <tt>chroot</tt> окружения Gentoo и настроите ядро:

{{RootCmd|chroot /mnt/gentoo /bin/bash
|env-update && source /etc/profile
|cd /usr/src/linux
|make menuconfig}}

Снимите или установите те настройки, которые были неправильно выбраны в предыдущую попытку, выйдите и скомпилируйте ядро:

{{RootCmd|make && make modules_install}}

Скопируйте файл bzImage, переписав предыдущий:

{{RootCmd|cp arch/i386/boot/bzImage /boot/<kernel_name>}}

Если используется загрузчик LILO, запустите повторно <tt>lilo</tt> - пользователи GRUB могут пропустить этот шаг:

{{RootCmd|/sbin/lilo}}

Выйдите из режима chroot и перезагрузите систему.

{{RootCmd|exit
|umount /mnt/gentoo/proc /mnt/gentoo/boot /mnt/gentoo
|reboot}}

С другой стороны, если проблема заключается в настройке загрузчика, то выполните те же действия, но вместо настройки и компиляции ядра измените настройку загрузчика (перекомпиляция загрузчика, как правило, не нужна).

=== Мой прокси требует аутентификацию, что делать? ===

Чтобы Portage автоматически использовал эту схему, запишите её в {{Path|/etc/portage/make.conf}}: 

{{FileBox|filename=/etc/portage/make.conf|title=Setting up proxy|1=
http_proxy="http://username:password@yourproxybox.org:portnumber"
ftp_proxy="ftp://username:password@yourproxybox.org:portnumber"
RSYNC_PROXY="rsync://username:password@yourproxybox.server:portnumber"
}}

Помните, что прокси-сервер должен поддерживать метод <tt>CONNECT</tt> для портов rsync.

=== Как записать файл ISO? ===

ISO-файлы должны записываться в бинарном режиме. Это значит, что файл _не_должен_ просто быть записан на файловую систему CD-диска, а должен сам интерпретироваться как файловая система диска. 

Существует много приложений для записи CD; попытка описать их все будет Сизифовым трудом. Но описание некоторых наиболее популярных из них не навредит: 

* В EasyCD Creator выберите {{Path|Файл}}, {{Path|Записать CD из образа}}. Далее замените {{Path|Все файлы}} на {{Path|Файлы ISO-образов}}. После этого найдите ISO-файл на диске и кликните {{Path|Открыть}}. После выбора {{Path|Начать запись}} ISO-файл будет корректно записан на CD/DVD.

* With Nero Burning ROM, cancel the wizard which automatically pops up and select {{Path|Burn Image}} from the {{Path|File}} menu. Select the image to burn and click {{Path|Open}}. Now click the {{Path|Burn}} button and watch the brand new Gentoo Live CD being burnt.

* With <tt>cdrecord</tt>, simply type <tt>cdrecord dev=/dev/cdrom</tt> (replace {{Path|/dev/cdrom}} with the CDROM drive's device path) followed by the path to the ISO file.

* With K3B, select {{Path|Tools}} → {{Path|CD}} → {{Path|Burn CD Image}}. Then locate the ISO file within the 'Image to Burn' area. Click {{Path|Start}} to begin the burn process.

* With Mac OS X Panther, launch <tt>Disk Utility</tt> from {{Path|Applications/Utilities}}, select {{Path|Open}} from the {{Path|Images}} menu, select the mounted disk image in the main window and select {{Path|Burn}} in the {{Path|Images}} menu.

* With Mac OS X Jaguar, launch <tt>Disk Copy</tt> from {{Path|Applications/Utilities}}, select {{Path|Burn Image}} from the {{Path|File}} menu, select the ISO and click the {{Path|Burn}} button.

===Какой CD-диск/stage-архив стоит выбрать для моего процессора?===

Для начала, определите, какой процессор у компьютера, на который будет установлена Gentoo (например, Pentium-M). После этого определите, с какой архитектурой он совместим (на уровне инструкций процессора), чтобы найти подходящий устаовочный диск и stage-архив. Обычно вся необходимая информация присутствует на официальном сайте производителя, хотя запрос в поисковой системе бывает более эффективен.

Когда информация не очень понятна, выбирайте более 'низкую версию' установочного диска/архива stage: к примеру, i686 или даже общую x86 (или эквивалент для системной архитектуры). Это даст некоторую уверенность, что система будет работать, пусть и не будет включать некоторые оптимизации. 

Обратите внимание, что существует гораздо больше вариантов архитектур, чем в бинарном виде поставляется Gentoo. См. [http://gcc.gnu.org/onlinedocs/gcc-4.7.3/gcc/i386-and-x86_002d64-Options.html#i386-and-x86_002d64-Options Руководство по GCC] для выставления флага <code>-march</code>.

===Интернет не работает после перезагрузки. Что я делаю не так?===

Для начала, проверьте, что сетевая плата првильно определяется ядром. Выполните <tt>ifconfig -a</tt> и просмотрите интернет-интерфейсы. В выводе команды должно присутствовать что-то типа eth0, eno1, enp2s0, enp0s8, wlan0 (для некоторых wifi-сетевых плат). Определённые модули ядра могут быть необходимы, чтоб ядро правильно определяло сетевую плату. В этом случае, проверьте, что необходимые модули перечислены в файле  {{Path|/etc/conf.d/modules}}.

Если поддержка установленной сетевой платы не была включена в .config используемого ядра, нужно будет изменять конфигурационный файл и, в некоторых случаях, пересобирать ядро. 

Если сетевая плата "определяется" ядром, но интерфейс был настроен на использование DHCP, есть вероятность, что DHCP-клиент не был установлен. В Gentoo доступно много много DHCP-клиентов, чаще всего используется <tt>dhcpcd</tt>. Если необходимо получить работающий доступ в интернет, перезагрузитесь с установочного CD и выполните  <tt>emerge -a dhcpcd</tt>.

Информация по восстановлению системы с установочного диска также доступна [[#.D0.AF.D0.B4.D1.80.D0.BE_.D0.BD.D0.B5_.D0.B7.D0.B0.D0.B3.D1.80.D1.83.D0.B6.D0.B0.D0.B5.D1.82.D1.81.D1.8F.2C_.D1.87.D1.82.D0.BE_.D0.B4.D0.B5.D0.BB.D0.B0.D1.82.D1.8C.3F|здесь]].

=== Attempting to boot Windows from GRUB or LILO only shows a black screen. What should I do? ===

This is a known problem. Windows refuses to boot when it is not installed on the first hard drive and shows a black/blank screen. To handle this, it is necessary to "fool" Windows into believing that it is installed on the first hard drive with a little tweak in the boot loader configuration. Please note that in the below example, Gentoo is installed on {{Path|/dev/sda}} (first disk) and Windows on {{Path|/dev/sdb}} (second disk). Adjust the configuration as needed:

{{FileBox|filename=/boot/grub/grub.conf|title=Example dual boot entry for Windows in grub.conf|1=
title Windows XP
     map (hd1) (hd0)
     map (hd0) (hd1)
     rootnoverify (hd1,0)
     chainloader +1
}}

{{Note|The above example is for [[GRUB|GRUB Legacy]] bootloader, not GRUB2. For information on how to dual boot Windows with GRUB2 see the [[GRUB2|GRUB2 article]].}}

{{FileBox|filename=/etc/lilo.conf|title=Example dual boot entry for Windows in lilo.conf|1=
other=/dev/sdb1
     label=WindowsXP
     table=/dev/sdb
     map-drive = 0x80
     to = 0x81
     map-drive = 0x81
     to = 0x80
}}

This will make Windows believe it is installed on the first hard drive and boot without problems. More information can be found in official [http://www.gnu.org/software/grub/ GRUB documentation] and in <tt>man lilo.conf</tt>.

===Как установть Gentoo с использованием архива stage1 или stage2?===

Настольная книга Gentoo описывает установку с использованием только stage3-архива. Однако, Gentoo всё ещё поддерживает установку из архивов stage1 и stage2. Это используется в процессе разработки (команда разработки релизов начинает со stage1 для получения stage3), но не должно использоваться обычыми пользователями: архив stage3 может быть очень хорошо использован для бутстрапа системы. Необходимо рабочее интернет-соединение. 

Бустраппинг (Bootstrapping) означает установку тулчейна (библиотеки С и компилятора) на систему, после чего устанавливаются все системные пакеты. Для бутстрапа системы производите обычную установку из stage3. Перед частью "Настройка ядра" может быть необходимо изменить скрипт {{Path|bootstrap.sh}} под себя:

{{RootCmd|cd /usr/portage/scripts
|vi bootstrap.sh}}

После изменения выполните скрпит:

{{RootCmd|./bootstrap.sh}}

После этого переустановите все системные пакеты с использованием свежеустановленного тулчейна. Их переустановка требуется из-за того, что архив stage3 уже предоставлял их: 

{{RootCmd|emerge -e system}}

Теперь продолжайте установку системы с шага "Настройка ядра".

==Работа с пакетами==

===В каком виде распространяются пакеты?===

Пакеты не "хранятся". Вместо этого Gentoo предоставляет набор скриптов, которые могут разрешать зависимости, скачивать исходный код и компилировать версию пакета с учётом требований пользователя. В общем случае, Gentoo поставляет бинарные файлы только для релизов и снапшотов.[http://devmanual.gentoo.org/ebuild-writing/index.html Gentoo Developer Manual] детально описывает содержимое ebuild-скриптов. 

For full ISO releases, a full suite of binary packages will be created using an enhanced <code>.tbz2</code> format, which is {{Path|.tar.bz2}} compatible with meta-information attached to the end of the file. These can be used to install a working (though not fully optimized) version of the package quickly and efficiently.

It is possible to create RPMs (Red Hat package manager files) using Gentoo's Portage, but it is not currently possible to use already existing RPMs to install packages.

===Могу ли я, при желании, самостоятельно выполнять шаг ./configure установки пакета?===

Да, но это непросто и не рекомендуется. Так как метод воплощения этой задумки в жизнь требует хорошего понимания 'внутренностей' Portage, рекомендуется делать нужный патч для ебилда, который требуется изменить,и располагать его в оверлее Portage (из-за этого те и существуют). Это гораздо лучшее решение для последующей поддержки, и обычно его проще воплотить в жизнь. Смотри  [http://devmanual.gentoo.org/ebuild-writing/index.html Gentoo Developer Manual] для получения большей информации.

===Что если rsync не работает у меня?===

При использовании файрволла, который не разрешает проходить трафику rsync через порт 873, команда  <tt>emerge-webrsync</tt> может быть использована для обновления снапшота Portage по протоколу HTTP. См. [[#.D0.9C.D0.BE.D0.B9_.D0.BF.D1.80.D0.BE.D0.BA.D1.81.D0.B8_.D1.82.D1.80.D0.B5.D0.B1.D1.83.D0.B5.D1.82_.D0.B0.D1.83.D1.82.D0.B5.D0.BD.D1.82.D0.B8.D1.84.D0.B8.D0.BA.D0.B0.D1.86.D0.B8.D1.8E.2C_.D1.87.D1.82.D0.BE_.D0.B4.D0.B5.D0.BB.D0.B0.D1.82.D1.8C.3F |этот раздел]] для получения информации о том, как загружать исходный код приложений и снапшоты дерева портежей через прокси.

===У меня дома медленное (или отсутствует) интернет-соединение. Могу ли я скачать исходники где-то ещё и потом поместить их в систему?===

Определённо. Выполните <tt>emerge --pretend package/atom</tt> чтобы посмотреть, какие программы будут установлены. Чтоб найти исходники для этих пакетов и информацию, откуда их скачать, выполните <tt>emerge -fp package/atom</tt>. Загрузите их и принесите домой на каком-нибудь носителе. Поместите их в папку, указанную в переменной $DISTDIR (по умолчанию {{Path|/usr/portage/distfiles/}}) и просто запустите <tt>emerge package/atom</tt>. Будьте осторожны: это может быть ''очен'' утомительный процесс.

=== Source tarballs are collecting in /usr/portage/distfiles/. Is it safe to delete these files? ===

Deleting these files will have no negative impact on day-to-day performance. However, it might be wise to keep the most recent version of the files; often several ebuilds will be released for the same version of a specific piece of software. If the archive is deleted and the software is upgraded or rebuilt it will be necessary to download them from the Internet again. 

Use the <tt>[[eclean]]</tt> script from {{Package|app-portage/gentoolkit}} to manage the contents of {{Path|/usr/portage/distfiles/}} and a few other locations. Please read <tt>man eclean</tt> to learn more about its usage, as well as the [[Gentoolkit|Gentoolkit article]].

=== What is in /var/tmp/portage? Is it safe to delete the files and directories in /var/tmp/portage? ===

During compilation, Gentoo saves the sources of the package in {{Path|/var/tmp/portage}}. These files and folder are usually deleted upon a successful merge, but this sometimes fails. It is safe to clean out all contents of this directory ''if'' the <tt>emerge</tt> command is not running. Be sure to always <tt>pgrep emerge</tt> before cleaning out this directory.

== Usage ==

=== How do I set up an International Keyboard Layout? ===

Edit the <code>keymap</code> variable in {{Path|/etc/conf.d/keymaps}}. To have console working correctly with extended characters in the keymap, it might be necessary to set up the variables <code>consolefont</code> and <code>consoletransation</code> in the {{Path|/etc/conf.d/consolefont}} file (for further information on localizing the environment, refer to the [[Localization/Guide|localization guide]]). Then, issue a <tt>reboot</tt>, or restart the keymaps and consolefont scripts: 

{{RootCmd|/etc/init.d/keymaps restart
|/etc/init.d/consolefont restart}}

=== DNS name resolution works for root only ===

{{Path|/etc/resolv.conf}} has the wrong permissions; <tt>chmod</tt> it as follows: 

{{RootCmd|chmod 0644 /etc/resolv.conf}}

=== Why can't my user use their own crontab? ===

Add that user to the cron group:

{{RootCmd|gpasswd -a <username> cron}}

=== How do I get numlock to start on boot? ===

The following command will add the numlock service to the default runlevel, enabling numlock at boot:

{{RootCmd|rc-update add numlock default
|/etc/init.d/numlock start}}

Each GUI provides different tools for this sort of thing; please check the help section or online manuals for the GUI of choice for further assistance.

=== How do I have my terminal cleared when I log out? ===

To have the terminal cleared, add the <tt>clear</tt> command to the user's {{Path|~/.bash_logout}} script: 

{{Cmd|echo clear >> ~/.bash_logout}}

To have this happen automatically when adding a new user, do the same for the {{Path|/etc/skel/.bash_logout}} file: 

{{RootCmd|echo clear >> /etc/skel/.bash_logout}}

==Техобслуживание==

===Проблемы с ReiserFS и повреждением файловой системы - как исправить их и т.д.===

Если ReiserFS раздел повреждён, попробуйте загрузиться с установочного диска Gentoo и выполнить <tt>reiserfsck --rebuild-tree</tt> на повреждённой файловой системе. Это должно исправить её состояние, хотя могут исчезнуть некоторые сильно повреждённые файлы. 

==Разработка==

===Куда сообщать о багах?===

Используйте сайт [https://bugs.gentoo.org Bugzills] для сообщения об ошибках. Спрашивайте на канале #gentoo Freenode IRC, если не уверены, действительно ли проблема является багом, или вы что-то сделали не так.

===Как часто выпускаются новые релизы?===

Пакеты Gentoo обычно обновляются через небольшое время после того, как их авторы выпускают новое обновление. Чтоб узнать, когда Gentoo выпустит новое обновление архива stage/профиля/установочного ISO-образа, смотрите страницу [http://www.gentoo.org/proj/en/releng Release Engineering Project]. О новых релизах сообщается в  списке рассылки [http://www.gentoo.org/main/en/lists.xml gentoo-announce] . См. [[#Can I upgrade Gentoo from one release to another without reinstalling?|этот раздел]] для получения большего количества информации.

===В консоли мой pc-спикер орёт как сумасшедший. Как его отключить?===

'Бипы' при попытке неправильного ввода (нажатие backspace при пустой строке терминала) могут быть отключены с помощью setterm, например: 

{{RootCmd|setterm -blength 0}}

Чтоб отключать бипы при каждой загрузке, поместите данную команду в файл {{Path|/etc/conf.d/local.start}}. Правда, это отключит бипы только для текущего терминала. Для отключения бипов для остальных терминалов используйте перенаправление вывода в нужный терминал. Например, так: 

{{RootCmd|setterm -blength 0 > /dev/vc/1}}

Замените {{Path|/dev/vc/1}} на терминал, для которого нужно отключить спикер.

== Источники ==

=== Где я могу найти больше информации о Gentoo Linux? ===

Большая часть официальной документации Gentoo может быть найдена в этой Вики. Некоторая старая документация всё ещё доступна на  [http://wwwold.gentoo.org/doc/en/ http://wwwold.gentoo.org/doc/en/].

=== Могу ли я купить установочный диск Gentoo Linux? ===

Пользователи, которые не могут скачать и записать установочный диск самостоятельно, могут найти его в одном из наших официальных магазинов. Но большая часть магазинов перестала предлагать установочные CD и DVD так как они очень быстро устаревают. 

Официальные магазины перечислены на [https://www.gentoo.org/inside-gentoo/stores/ странице магазинов].

=== Этот FAQ не смог ответить на мой вопрос. Что делать? ===

Полезным будет просмотреть относящуюся к теме  [http://www.gentoo.org/doc/en/index.xml документацию]. Если и это не помогло, разнообразные списки рассылки Gentoo Linux можно найти в [https://www.google.com/ Google]. Чтоб просмотреть списки рассылки Gentoo, введите запрос "site:lists.gentoo.org foo", чтоб найти "foo". Если всё это не помогает, или просто если хочется поболтать с опытными в использовании Gentoo людьми, заходите на канал #gentoo на Freenode IRC.

[[Category:Core]] {{Migrated|originalauthors=Daniel Robbins, Colin Morey, John P. Davis, Eric Stockbridge, Stoyan Zhekov, Carl Anderson, Jorge Paulo, Sven Vermeulen, Benny Chuang, Jonathan Smith, nightmorph}}
