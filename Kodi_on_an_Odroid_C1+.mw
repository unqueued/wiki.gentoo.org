'''This wiki is describing how to get a working kodi on the framebuffer with video acceleration to work on an Odroid C1+'''

== Installation of the ground system==

=== Prepare the SD card an boot the system ===

At first you must install a linux image to sdcard to boot the odroid.
I'm recommending the [http://archlinuxarm.org/platforms/armv7/amlogic/odroid-c1 ARM Image]. Follow the instructions on this site.
I'm descriping how to install Gentoo on an USB hard disc.

=== Installing Gentoo Linux ===

For this follow the steps in the [[Handbook:X86|Handbook]].

As stage 3 archive use this one: http://distfiles.gentoo.org/releases/arm/autobuilds/current-stage3-armv7a_hardfp/

Follow the Handbook until you must install the kernel.

==== Add the overlays ====

The [https://github.com/tbe/odroidc1-overlay.git odroidc1 overlay] and the [https://github.com/dsiggi/dsiggis-gentoo-overlay.git dsiggi' Gentoo overlay] containing the necessary files.

To add the overlays edit {{Path|/etc/portage/repos.conf/overlays}}.
{{FileBox|filename=/etc/portage/repos.conf/overlays|title=Overlay configuration|lang=bash|1=<pre>
[dsiggis-gentoo-overlay]
location = /usr/local/portage/dsiggis-gentoo-overlay
sync-type = git
sync-uri = git://github.com/dsiggi/dsiggis-gentoo-overlay
auto-sync = yes

[odroidc1-overlay]
location = /usr/local/portage/odroidc1
sync-type = git
sync-uri = git://github.com/tbe/odroidc1-overlay
auto-sync = yes
</pre>}}

Now create the directories for the overlays and sync them
{{RootCmd
|mkdir /usr/local/portage
|emaint sync -a
}}

==== Installing the kernel sources and necessary packages ====

Now you can install the kernel, u-boot-tools and dracut.
{{Emerge|odroidc1-sources::odroidc1-overlay}}
{{Emerge|u-boot-tools-odroidc1}}
{{Emerge|dracut}}

==== Build the kernel ====

Now you can configure the kernel as described in the Handbook.
To build the kernel do the following:
{{RootCmd
|make uImage
|make modules
|make dtbs
|make modules_install
}}

==== Install the kernel ====

To install the kernel you must do the following.
{{RootCmd
|mount /dev/mmcblk0p1 /boot/
|dracut --kver 3.10.75-odroidc1
|mkimage -A arm -O linux -T ramdisk -C none -a 0 -e 0 -n "uInitrd 3.10.75-odroidc1" -d /boot/initramfs-3.10.75-odroidc1.img /boot/uInitrd-gentoo
|cp /usr/src/linux/arch/arm/boot/uImage /boot/uImage-gentoo
|cp /usr/src/linux/arch/arm/boot/dts/meson8b_odroidc.dtb /boot/
}}

No edit {{Path|/boot/boot.ini}} and change the variable "bootargs" to match to your root device.
Then also change the 2 lines unter "# Booting" to match to your uImage and uImagerd.

==== Finish installation ====

At first you must install a small script to get and output on your screen.
{{RootCmd
|wget https://github.com/mdrjr/c1_bootini/blob/master/c1_init.sh -o /etc/local.d/c1_init.start
|chmod +x /etc/local.d/c1_init.start
}}
To get the script to work you must install fbset:
{{Emerge|fbset}}

Now do all the remaining steps from the Handbook, eg install an cron daemon an editing the config files.
Then you can reboot your system.

==Configuring something==

== Example Files ==
{{FileBox|filename=/etc/portage/make.conf|title=Example of my make.conf|lang=bash|1=<pre>
# These settings were set by the catalyst build script that automatically
# built this stage.
# Please consult /usr/share/portage/config/make.conf.example for a more
# detailed example.
CFLAGS="-O3 -pipe -march=armv7-a -mtune=cortex-a5 -mfpu=vfpv3-d16 -mfloat-abi=hard"
CXXFLAGS="${CFLAGS}"
# WARNING: Changing your CHOST is not something that should be done lightly.
# Please consult http://www.gentoo.org/doc/en/change-chost.xml before changing.
CHOST="armv7a-hardfloat-linux-gnueabi"
# These are the USE flags that were used in addition to what is provided by the
# profile used for building.
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j9 -l4"
FEATURES="distcc distcc-pump"

USE="bindist -X nls unicode -gles -gles1 -gles2 -egl -opengl"
LINGUAS="de"

INPUT_DEVICES="evdev"
VIDEO_CARDS=""

PORTDIR="/usr/portage"
DISTDIR="${PORTDIR}/distfiles"
PKGDIR="${PORTDIR}/packages"
PORTDIR_OVERLAY="/usr/local/portage/odroidc1 /usr/local/portage/dsiggis-gentoo-overlay"

GENTOO_MIRRORS="http://ftp.uni-erlangen.de/pub/mirrors/gentoo"
</pre>}}
