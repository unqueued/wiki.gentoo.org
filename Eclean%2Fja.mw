<languages />

{{Lowercase title}}
{{InfoBox stack
|{{InfoBox project|Portage-Tools|header=true}}
|{{InfoBox wikipedia|Gentoolkit}}
|{{InfoBox gitweb|gentoolkit.git}}
}}

{{c|eclean}} is a tool for cleaning repository source files and binary packages. It is part of the {{Package|app-portage/gentoolkit}} package and managed by the [[Project:Portage-Tools|Portage-Tools project]].

== インストール ==

=== Emerge ===

{{c|eclean}} をインストールするには:

{{Emerge|app-portage/gentoolkit}}

{{Note/ja|[[Gentoolkit|Gentoolkit の記事]]に、{{Package|app-portage/gentoolkit}} パッケージ内の他のユーティリティーも含んだ情報が記載されています。}}

== 使い方 ==

Portage は、ソースファイルを {{Path|/usr/portage/distfiles}} 、バイナリパッケージを {{Path|/usr/portage/packages}} に保存するのがデフォルトです。この保存場所は、{{Path|/etc/portage/make.conf}} 内の <var>DISTDIR</var> や <var>PKGDIR</var> の環境変数を変更することで、変更可能です。どちらの保存場所も、定期的に掃除しなければ非常に巨大になります。そのため、 {{c|eclean}} が作られました。

=== Invocation ===

{{c|eclean --help}} を実行すれば、全ての処理に関する概要と、オプションのリストと、使い方の説明が表示されます。

{{Cmd|eclean --help|output=<pre>
Usage:
 eclean [global-option] ... <action> [action-option] ...
 eclean-dist [global-option, distfiles-option] ...
 eclean-pkg [global-option, packages-option] ...
 eclean(-dist,-pkg) [--help, --version]
 
Available global options:
 -C, --nocolor             - turn off colors on output
 -d, --deep                - only keep the minimum for a reinstallation
 -e, --exclude-file=<path> - path to the exclusion file
 -i, --interactive         - ask confirmation before deletions
 -n, --package-names       - protect all versions (when --deep
 -p, --pretend             - only display what would be cleaned
 -q, --quiet               - be as quiet as possible
 -t, --time-limit=<time>   - don't delete files modified since <time>
   <time> is a duration: "1y" is "one year", "2w" is "two weeks", etc.
   Units are: y (years), m (months), w (weeks), d (days) and h (hours).
 -h, --help                - display the help screen
 -V, --version             - display version info
 
Available actions:
 packages     - clean outdated binary packages from PKGDIR
 distfiles    - clean outdated packages sources files from DISTDIR
 
Available options for the packages action:
 NONE  :)
 
Available options for the distfiles action:
 -f, --fetch-restricted   - protect fetch-restricted files (when --deep)
 -s, --size-limit=<size>  - don't delete distfiles bigger than <size>
   <size> is a size specification: "10M" is "ten megabytes", "200K" is
   "two hundreds kilobytes", etc.  Units are: G, M, K and B.
 
More detailed instruction can be found in `man eclean`
</pre>}}

=== distfiles の削除 ===

コマンドに <code>distfiles</code> を与えると、ソースファイルのディレクトリに処理が行われます:

{{RootCmd|eclean distfiles}}

より短くは、以下のコマンドでも同じです:

{{RootCmd|eclean-dist}}

=== バイナリパッケージの削除 ===

バイナリパッケージを含むディレクトリに対しては、代わりに、以下を実行:

{{RootCmd|eclean packages}}

より短くは、以下のコマンドでも同じです:

{{RootCmd|eclean-pkg}}

== Options ==

By default, source files and binary packages corresponding to any ebuild in the current repository will '''not''' be deleted. This way, system administrators can easily downgrade a package or install a previously removed package, provided the package is still in the current repository tree.

As an example, suppose packages foo-1.0 and foo-1.1 are both in the repository. After updating from foo-1.0 to foo-1.1, run {{c|eclean distfiles}}: source files for both versions will be kept, so if a problem occurs with foo-1.1 then the user can easily re-install foo-1.0 without re-downloading anything.

以前にアンインストールしたパッケージについても同様のことがいえます。（バージョンが何であれ） foo というパッケージがインストールされていたとします。このパッケージを（あやまって）アンインストールしてしまい、しかも {{c|eclean distfiles}} も実行していても、foo のソースファイルが残っていれば、再ダウンロードすることなく再インストール可能ですね。

上記の例は、バイナリパッケージを処理する際にも当てはまります。

To save more disk space, add the <code>--deep</code> option: every source file or binary package that does not correspond to some ''currently installed'' package (version does matter) will be deleted. Please notice that this way users will not be protected in case they need to downgrade a package or re-install a previously removed package.

As an alternative, use both the <code>--deep</code> and the <code>--package-names</code> options: every source file or binary package that does not correspond to some currently installed package (version does not matter) will be deleted. This still will not protect in case a re-install of a previously removed package is needed, but it will protect the sources if the package needs to be downgraded later.

詳しくは eclean(1) のマニュアルページを読んでください:

{{Cmd|man 1 eclean}}

== 参考 ==

* [[Gentoolkit]]
* [[Knowledge Base:Remove obsoleted distfiles|Knowledge Base: Remove obsoleted distfiles]]


[[Category:Portage tools]]
