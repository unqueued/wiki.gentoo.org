{{InfoBox stack
|{{InfoBox homepage|http://www.nagios.org|header=true}}
|{{InfoBox wikipedia}}
}}

'''Nagios''' offers complete monitoring and alerting for servers, switches, applications, and services.

== Installation ==

=== Web server ===

Decide which web server will be to used and set it up:

* [[Apache]] with PHP
* [[Lighttpd]] with [[PHP]]

Once finished return here to and continue reading.

=== USE flags ===

Set the proper USE flags for Nagios before it is emerged.
{{USEflag|package=net-analyzer/nagios-core|desc=Optional USE flags for {{Package|net-analyzer/nagios-core}}:
|apache2
|classicui+++Use the classic web theme
|lighttpd
|perl
|vim-syntax
|web+yes
}}

Do not forget to enable the right USE flags for Nagios plugins ({{Package|net-analyzer/nagios-plugins}}).

=== Emerge ===

Finally install {{Package|net-analyzer/nagios}}:

{{Emerge|net-analyzer/nagios}}

== Configuration ==

=== Apache ===

Enable the Nagios module for Apache:

{{FileBox|filename=/etc/conf.d/apache2|lang=bash|1=<pre>
APACHE2_OPTS="... -D NAGIOS"
</pre>}}

Since Nagios requires [[PHP]] for its web interface, it may needed to be enabled as well if it has not been previously. One way is to simply add <code>-D PHP5</code> to <code>APACHE2_OPTS</code> and edit {{Path|/etc/php/apache2-php<YOUR_PHP_VERSION>/php.ini}} This should be fine unless PHP is needed for purposes other than hosting Nagios.

If using Apache 2.4 (which is still marked unstable as of April 2015) the {{Path|/etc/apache2/modules.d/99_nagios3.conf}} file may need to be modified to fit the new authorization directives of Apache 2.4.

Remember to add the <code>apache</code> user to group <code>nagios</code>:

{{RootCmd|usermod -a -G nagios apache}}

Restart the Apache service to have it recognize the group change:

{{RootCmd|rc-service apache2 restart}}

=== Lighttpd ===

Enable the Nagios configuration for Lighttpd:

{{FileBox|filename=/etc/lighttpd/lighttpd.conf|1=<pre>
include "nagios.conf"
</pre>}}

Configure authentication. More information on how to set this up can be found in the Lighttpd documentation.

{{FileBox|filename=/etc/lighttpd/nagios.conf|1=
$HTTP["url"] =~ "nagios" {
    auth.backend ="plain"    # The password is stored as plain text as user:password in...
    auth.backend.plain.userfile = "/etc/nagios/passwd"  # this file
    auth.require = ( "" => (
        "method" => "digest",
        "realm" => "nagios",
        "require" => "user=nagiosadmin"
        )
    )
    setenv.add-environment = ( "REMOTE_USER" => "user" )
}
}}

Restart the Lighttpd service:

{{RootCmd|rc-service lighttpd restart}}

=== Permissions ===

Add the user name(s) to the <code>nagios</code> group, whom are allowed access to the Nagios service:

{{RootCmd|gpasswd -a <USER_NAME> nagios}}

Once done, completely sign out from all shells and re-login for the update to apply.

=== Boot service ===

Start Nagios:

{{RootCmd|rc-service nagios start}}

To start Nagios at boot time, add it the default runlevel:

{{RootCmd|rc-update add nagios default}}

== Testing ==

Open a browser and navigate to http://localhost/nagios

== Troubleshooting  ==

* {{Bug|net-analyzer/nagios|search=package}}

== See also ==

* [[Nagios/Guide|The Gentoo Nagios system monitoring guide]].

[[Category:Monitoring]]
