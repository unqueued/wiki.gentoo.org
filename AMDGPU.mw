{{Lowercase title}}
{{InfoBox stack
|{{InfoBox wikipedia|Radeon#FOSS_drivers|header=true}}
}}
'''amdgpu''' is a family of open source graphics drivers for AMD/ATI Radeon graphics cards.

== Hardware detection ==

To choose the right driver, first detect the graphics card. Use {{c|[[Hardware detection#lspci|lspci]]}} for this task:

{{RootCmd|lspci {{!}} grep -i VGA}}

== Feature support ==

{| class="table table-condensed table-striped"
|-
! Family
! Chipset name
! Product name
! OpenGL
! OpenGL ES
! VIDEO_CARDS
|-
| Sea Islands<sup>1</sup>
| BONAIRE, KABINI, KAVERI, HAWAII, MULLINS
| HD7790, R7 260, R9 290, R7 360, R9 390
| {{Yes|4.3}}
| {{Yes|3.0}}
| ''amdgpu radeonsi''
|-
| Volcanic Islands
| CARRIZO, FIJI, STONEY, TONGA, TOPAZ
| R9 285, R9 380, R9 380X, R9 Fury
| {{Yes|4.3}}
| {{Yes|3.0}}
| ''amdgpu radeonsi''
|-
| Arctic Islands<sup>2</sup>
| POLARIS10, POLARIS11
| RX 460, RX 470, RX 480
| {{Yes|4.3}}
| {{Yes|3.0}}
| ''amdgpu radeonsi''
|}

: <sup>1</sup> Support is optional in the kernel.
: <sup>2</sup> Since kernel 4.7-rc6

== Installation ==

=== Firmware ===

Microcode is required. To get the firmware install one of two separate packages. Either the {{Package|sys-firmware/amdgpu-ucode}} package:

{{Emerge|sys-firmware/amdgpu-ucode}}

Or the {{Package|sys-kernel/linux-firmware}} package (this package contains also other firmware).

{{Emerge|sys-kernel/linux-firmware}}

When compiling amdgpu directly into the kernel (instead of as a module), make sure the firmware for each model (check available ones in {{Path|/lib/firmware/amdgpu}} or {{Path|/lib/firmware/radeon}}) is included in the kernel:

{{KernelBox|title=Including firmware in the kernel|
Device Drivers  --->
    Generic Driver Options  --->
        -*- Userspace firmware loading support
        [*] Include in-kernel firmware blobs in kernel binary
            (amdgpu/<YOUR-MODEL>.bin radeon/<YOUR-MODEL>.bin)
            (/lib/firmware) Firmware blobs root directory
}}

Save the kernel configuration and exit without compiling. More kernel configuration options will be set below.

{{Note|''amdgpu/<YOUR-MODEL>.bin'' should be replaced with the full list (space separated) appearing in front of the chipset's name in the table below (e.g. for Volcanic Islands/TONGA: ({{Path|amdgpu/tonga_ce.bin amdgpu/tonga_mec2.bin amdgpu/tonga_rlc.bin amdgpu/tonga_smc.bin amdgpu/tonga_mc.bin amdgpu/tonga_mec.bin amdgpu/tonga_sdma1.bin amdgpu/tonga_uvd.bin amdgpu/tonga_me.bin amdgpu/tonga_pfp.bin amdgpu/tonga_sdma.bin amdgpu/tonga_vce.bin}}) }}

Below is a list of the firmware files needed for each family/chipset of cards:

{| class="table table-condensed table-striped"
|-
! Family
! Chipset name
! Product name
! Firmware
|-
| rowspan="5" | Sea Islands
| BONAIRE
| HD7790, R7 260, R7 260X, R7 360
| radeon/bonaire_ce.bin radeon/bonaire_mc.bin radeon/bonaire_me.bin radeon/bonaire_mec.bin radeon/bonaire_pfp.bin radeon/bonaire_rlc.bin radeon/bonaire_sdma1.bin radeon/bonaire_sdma.bin radeon/bonaire_smc.bin radeon/bonaire_uvd.bin radeon/bonaire_vce.bin
|-
| KABINI
| HD8180-HD8400
| radeon/kabini_ce.bin radeon/kabini_me.bin radeon/kabini_mec.bin radeon/kabini_pfp.bin radeon/kabini_rlc.bin radeon/kabini_sdma1.bin radeon/kabini_sdma.bin radeon/kabini_uvd.bin radeon/kabini_vce.bin
|-
| KAVERI
| 
| radeon/kaveri_ce.bin radeon/kaveri_me.bin radeon/kaveri_mec2.bin radeon/kaveri_mec.bin radeon/kaveri_pfp.bin radeon/kaveri_rlc.bin radeon/kaveri_sdma1.bin radeon/kaveri_sdma.bin radeon/kaveri_uvd.bin radeon/kaveri_vce.bin
|-
| HAWAII
| R9 290, R9 290X, R9 390, R9 390X
| radeon/hawaii_ce.bin radeon/hawaii_mc.bin radeon/hawaii_me.bin radeon/hawaii_mec.bin radeon/hawaii_pfp.bin radeon/hawaii_rlc.bin radeon/hawaii_sdma1.bin radeon/hawaii_sdma.bin radeon/hawaii_smc.bin radeon/hawaii_uvd.bin radeon/hawaii_vce.bin
|-
| MULLINS
| 
| radeon/mullins_ce.bin radeon/mullins_me.bin radeon/mullins_mec.bin radeon/mullins_pfp.bin radeon/mullins_rlc.bin radeon/mullins_sdma1.bin radeon/mullins_sdma.bin radeon/mullins_uvd.bin radeon/mullins_vce.bin
|-
| rowspan="5" | Volcanic Islands
| CARRIZO
| 
| amdgpu/carrizo_ce.bin amdgpu/carrizo_me.bin amdgpu/carrizo_mec2.bin amdgpu/carrizo_mec.bin amdgpu/carrizo_pfp.bin amdgpu/carrizo_rlc.bin amdgpu/carrizo_sdma1.bin amdgpu/carrizo_sdma.bin amdgpu/carrizo_uvd.bin amdgpu/carrizo_vce.bin
|-
| FIJI
| R9 Fury, R9 Fury X, R9 Nano, Pro Duo
| amdgpu/fiji_ce.bin amdgpu/fiji_mc.bin amdgpu/fiji_me.bin amdgpu/fiji_mec2.bin amdgpu/fiji_mec.bin amdgpu/fiji_pfp.bin amdgpu/fiji_rlc.bin amdgpu/fiji_sdma1.bin amdgpu/fiji_sdma.bin amdgpu/fiji_smc.bin amdgpu/fiji_uvd.bin amdgpu/fiji_vce.bin
|-
| TONGA
| R9 285, R9 380, R9 380X
| amdgpu/tonga_ce.bin amdgpu/tonga_mc.bin amdgpu/tonga_me.bin amdgpu/tonga_mec2.bin amdgpu/tonga_mec.bin amdgpu/tonga_pfp.bin amdgpu/tonga_rlc.bin amdgpu/tonga_sdma1.bin amdgpu/tonga_sdma.bin amdgpu/tonga_smc.bin amdgpu/tonga_uvd.bin amdgpu/tonga_vce.bin
|-
| TOPAZ
| R7 M260, R7 M265, R7 M340, R7 M360, R7 M360, R7 M370, R7 M440, R7 M445, R7 M460, R7 M465
| amdgpu/topaz_ce.bin amdgpu/topaz_mc.bin amdgpu/topaz_me.bin amdgpu/topaz_mec2.bin amdgpu/topaz_mec.bin amdgpu/topaz_pfp.bin amdgpu/topaz_rlc.bin amdgpu/topaz_sdma1.bin amdgpu/topaz_sdma.bin amdgpu/topaz_smc.bin
|-
| STONEY
|
| amdgpu/stoney_ce.bin amdgpu/stoney_me.bin amdgpu/stoney_mec.bin amdgpu/stoney_pfp.bin amdgpu/stoney_rlc.bin amdgpu/stoney_sdma.bin amdgpu/stoney_uvd.bin amdgpu/stoney_vce.bin
|-
| rowspan="2" | Arctic Islands
| POLARIS10
| RX 470, RX 480
| amdgpu/polaris10_ce.bin amdgpu/polaris10_mc.bin amdgpu/polaris10_me.bin amdgpu/polaris10_mec2.bin amdgpu/polaris10_mec.bin amdgpu/polaris10_pfp.bin amdgpu/polaris10_rlc.bin amdgpu/polaris10_sdma1.bin amdgpu/polaris10_sdma.bin amdgpu/polaris10_smc.bin amdgpu/polaris10_smc_sk.bin amdgpu/polaris10_uvd.bin amdgpu/polaris10_vce.bin
|-
| POLARIS11
| RX 460
| amdgpu/polaris11_ce.bin amdgpu/polaris11_mc.bin amdgpu/polaris11_me.bin amdgpu/polaris11_mec2.bin amdgpu/polaris11_mec.bin amdgpu/polaris11_pfp.bin amdgpu/polaris11_rlc.bin amdgpu/polaris11_sdma1.bin amdgpu/polaris11_sdma.bin amdgpu/polaris11_smc.bin amdgpu/polaris11_smc_sk.bin amdgpu/polaris11_uvd.bin amdgpu/polaris11_vce.bin
|}

=== Kernel ===

You need to set the following kernel options:

{{KernelBox|
Processor type and features  --->
    [*] MTRR (Memory Type Range Register) support
Device Drivers  --->
    Graphics support  --->
        <*/M> Direct Rendering Manager (XFree86 4.1.0 and higher DRI support)
        <*/M> AMD GPU
              [ /*] Enable amdgpu support for CIK parts 
                 (only needed if you want to use Sea Islands GPUs with the amdgpu driver)
              [*]   Enable AMD powerplay component  
         ACP (Audio CoProcessor) Configuration  ---> 
              [*] Enable AMD Audio CoProcessor IP support (CONFIG_DRM_AMD_ACP)
    <*/M> Sound card support  --->
        <*/M> Advanced Linux Sound Architecture  --->
            [*]   PCI sound devices --->
                  HD-Audio  --->
                      <*> HD Audio PCI
                      [*] Support initialization patch loading for HD-audio
                      <*> whatever audio codec your soundcard needs
                      <*> Build HDMI/DisplayPort HD-audio codec support
                  (2048) Pre-allocated buffer size for HD-audio driver
}}

The options from the Sound card support menu need only to be set if the card supports HDMI or DisplayPort audio and you want to use it. On newer kernels, you also want to additionally set CONFIG_DRM_AMD_ACP=y.

See the [[Radeon]] article for more details about using HDMI/DisplayPort audio.

=== make.conf ===

Portage uses the <var>VIDEO_CARDS</var> variable for enabling support for various graphics cards in packages. Setting <var>VIDEO_CARDS</var> to <code>amdgpu radeonsi</code> (see the [[#Feature support|feature matrix]]) will pull in the correct driver:

{{FileBox|filename=/etc/portage/make.conf|lang=bash|1=
VIDEO_CARDS="amdgpu radeonsi"
}}

=== USE flags ===

{{USEflag|package=x11-drivers/xf86-video-amdgpu}}

{{USEflag|package=sys-firmware/amdgpu-ucode}}

== Troubleshooting ==

=== Kernel ===
Older kernels may not provide the <code>AMD GPU</code> option. Try emerging an unstable kernel.

=== amdgpu/radeonsi drivers don't work ===
If your graphics card isn't supported by <code>amdgpu</code> and <code>radeonsi</code> alone, try adding <code>radeon</code> to your <var>VIDEO_CARDS</var> variable.

{{FileBox|filename=/etc/portage/make.conf|lang=bash|1=
VIDEO_CARDS="amdgpu radeonsi radeon"
}}

After the values have been set update the system so the changes take effect:

{{Emerge|params+=--changed-use --deep|@world}}

=== Full-screen windows perform poorly ===
The installed version of {{Package|sys-devel/llvm}} may be too old. Try emerging an unstable version.

[[Category:Graphics Adapters]]
