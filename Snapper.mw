{{stub}}
{{InfoBox stack
|{{InfoBox homepage|http://snapper.io/|header=true}}
|{{InfoBox github|openSUSE/snapper}}
|{{InfoBox odoc|http://snapper.io/documentation.html}}
}}

Snapper is a command-line program capable of managing filesystem snapshots. It has provisions for root and non-root users to review older versions of files and restore them. It also has the ability to create, delete, compare, and undo changes between snapshots. Snapper never modifies the content of snapshots. Thus it will create read-only snapshots (if supported by the system's kernel). Supported filesystems are [[btrfs]] and [[ext4]] as well as snapshots of [[LVM]] volumes with thin-provisioning. Some filesystems might not be supported depending on the installation.<ref>http://snapper.io/manpages/snapper.html</ref> Snapper was initially developed by SUSE Linux but is now in use across many Linux distributions.

== Installation ==

=== USE flags ===

{{USEflag|package=app-backup/snapper|desc=Optional USE flags for {{Package|app-backup/snapper}}:
|btrfs+yes++Include Btrfs support sys-fs/btrfs-progs
|ext4+++Include Ext4 support sys-fs/e2fsprogs
|lvm+++Enable LVM thinprovisioned snapshots support sys-fs/lvm2
|pam+yes
|xattr
}}

=== Emerge ===

After USE flags have been set, <tt>emerge</tt> snapper:

{{Emerge|{{Package|app-backup/snapper}} }}

== Configuration ==

Configuration files for <tt>snapper</tt> are found in the {{Path|/etc/snapper/}} directory. According to snapper's man page, each filesystem or subvolume that should be snapshotted by snapper requires a configuration file.

A <tt>create-config</tt> exists to aid in configuration file generation:

{{RootCmd|snapper create-config <subvolume>}}

To create a configuration for the root filesystem, run:

{{RootCmd|snapper create-config /}}

This presumes the root filesystem has been formatted with [[btrfs]] or some other snapper compatible filesystem. The <tt>create-config</tt> command will attempt to guess the underlying filesystem type. If the filesystem type is known (in this case btrfs), then it can be specified using the <code>--fstype <fstype></code> optoin. See the <tt>snapper</tt> man page for more information.

== Usage ==

{{GenericCmd|snapper [--global-opts] command [--command-opts] [command-arguments]}}

=== Rollback ===

Snapper has function called 'rollback' to switch the current mounted btrfs subvolume to an older subvolume. This feature requires a btrfs file system.

To work properly the rollback feature needs an entry in the [[fstab]] to mount the subvolume {{Path|.snapshots}} to the directory {{Path|/.snapshots}}. For this example, presume that {{Path|/dev/sda1}} contains the btrfs filesystem snapper will manage. Add the following to {{Path|/etc/fstab}}:

{{FileBox|filename=/etc/fstab|title=Snapper fstab example|1=
/dev/sda1            /.snapshots     btrfs           subvol=.snapshots       0 0
}}

When snapper is initialized, this fstab entry is not needed, because the {{Path|/.snapshots}} subvolume is created at the root subvolume and from there accessible. After the first rollback to a snapshot subvolume (e.g. {{Path|/.snapshots/432}}), and upon a reboot into the snapshot subvolume the root subvolume will be left. In the snapshot subvolume, the {{Path|/.snapshots}} directory is empty (e.g. {{Path|/.snapshots/432/.snapshots}}).

If the {{Path|.snapshots}} subvolume is not mounted, <tt>snapper</tt> will fail to create further subvolumes and give an input/output error.

== See also ==

* [[btrfs]] - A B-tree file system fully capable of running underneath <tt>snapper</tt>.
* [[ext4]] - The most commonly used filesystem in Linux.
* [[LVM]] - A utility that virtualizes storage.

== References ==

{{reflist}}

[[Category:Software]]
