<languages />
{{InfoBox stack
|{{InfoBox gdoc|Hardened|header=true}}
}}
Gehärtetes Gentoo (Hardened Gentoo) ist ein Gentoo Projekt, das mehrere zusätzliche Sicherheitsdienste zusätzlich zur gut bekannten Gentoo Linux Installation bietet. Obwohl jeder Dienst separat ausgewählt werden kann. ermöglicht Gentoo Hardened mehrere Risikominderungs-Optionen in der Toolchain. Unterstützt werden PaX, grSecurity, SELinux, TPE und weitere.

Ob Sie einen mit dem Internet verbundenen Server oder eine flexible Workstation betreiben, wenn Sie mit unterschiedlichen Bedrohungen umgehen, wollen Sie vermutlich Ihr System weiter härten als nur automatisch die letzten Sicherheitspatches anwenden. Ein System ''härten'' bedeutet dass Sie zusätzliche Gegenmassnahmen gegen Angriffe oder andere Risiken ergreifen und das ist normalerweise eine Kombination von Aktivitäten die Sie am System durchführen.

<div class="mw-translate-fuzzy">
In Gentoo Hardened sind mehrere Projekte aktiv, die Ihnen helfen Ihr Gentoo System noch härter zu machen durch ...
* Aktivierung bestimmter Optionen in der Toolchain (Compiler, Linker, ...) wie zum Beispiel der Zwang nach positionsunabhängigem Code (eng.: position-independent executables (PIE)), Stack Smashing Protection und Kompilierzeit-Pufferüberprüfungen.
* Aktivierung der PaX Erweiterung im Linux Kernel, das zusätzliche Schutzmassnamen wie Adressplatz Layout Randomisierung und nicht ausführbaren Speicher bietet.
* Aktivierung der grSecurity Erweiterung im Linux Kernel, einschliesslich zusätzlicher chroot Beschränkungen, zusätzlicher Prüfungen, Prozessbeschränkungen, usw.
* Aktivierung der [[Hardened Gentoo/SELinux|SELinux]] Erweiterungen im Linux Kernel, die eine verbindliche Zugriffskontrollsystem-Erweiterung der Standard Linux-Berechtigungseinschränkungen bieten.
* Aktivierung der [[Integrity|integritätsbezogenen Technologien]], wie die Integrity Measurement Architecture, um Systeme belastbar gegen Sabotage zu machen.
</div>

* Aktivierung bestimmter Optionen in der Toolchain (Compiler, Linker, ...) wie zum Beispiel der Zwang nach positionsunabhängigem Code (eng.: position-independent executables (PIE)), Stack Smashing Protection und Kompilierzeit-Pufferüberprüfungen.
* Aktivierung der PaX Erweiterung im Linux Kernel, das zusätzliche Schutzmassnamen wie Adressplatz Layout Randomisierung und nicht ausführbaren Speicher bietet.
* Aktivierung der grSecurity Erweiterung im Linux Kernel, einschliesslich zusätzlicher chroot Beschränkungen, zusätzlicher Prüfungen, Prozessbeschränkungen, usw.
* Aktivierung der [[Hardened Gentoo/SELinux|SELinux]] Erweiterungen im Linux Kernel, die eine verbindliche Zugriffskontrollsystem-Erweiterung der Standard Linux-Berechtigungseinschränkungen bieten.
* Aktivierung der [[Integrity|integritätsbezogenen Technologien]], wie die Integrity Measurement Architecture, um Systeme belastbar gegen Sabotage zu machen.

Selbstverständlich schliesst das die notwendigen Userspace-Dienstprogramme mit ein, um diese Erweiterungen handzuhaben.

<div class="mw-translate-fuzzy">
== Zu einem gehärteten Profil (Hardened Profile) wechseln ==
</div>

<div class="mw-translate-fuzzy">
Wählen Sie ein gehärtetes [[profile|Profil]], so dass das ''Paket Management'' auf härte Weise gehandhabt wird.
</div>

{{RootCmd|eselect profile list}}
{{RootCmd|eselect profile set [Nummer des gehärteten Profils]}}
{{RootCmd|source /etc/profile}}

Durch die Wahl des gehärteten Profils werden bestimmte Paketmanagement-Einstellungen (masks, USE-Flags, etc.) zum Standard für Ihr System. Dies betrifft viele Pakete, eingeschlossen die Toolchain. Die Toolchain wird zum Bau/ zur Kompilierung Ihrer Programme verwendet und schliesst folgendes ein: Die GNU Compiler Collection (GCC), binutils (linker, etc.) und die GNU C library (glibc). Durch einen re-emerge der Toolchain treten diese neuen Standard-Einstellung für die Toolchain in Kraft. Dies gestattet es alle zukünftigen ''Paket-Kompilierungen'' auf gehärtete Weise durchzuführen.

{{emerge|params=--oneshot|gcc}}
{{emerge|params=--oneshot|binutils virtual/libc}}

Die oben stehenden Befehle bauen GCC erneut, es kann nun dazu verwendet werden gehärtete Software zu kompilieren. Stellen Sie sicher, dass die gehärtete Option für GCC ausgewählt ist.

{{RootCmd|gcc-config -l
|output=<pre>
[1] i686-pc-linux-gnu-4.5.3 *
[2] i686-pc-linux-gnu-4.5.3-hardenednopie
[3] i686-pc-linux-gnu-4.5.3-hardenednopiessp
[4] i686-pc-linux-gnu-4.5.3-hardenednossp
[5] i686-pc-linux-gnu-4.5.3-vanilla
</pre>}}

In der Beispielausgabe oben ist das gehärtete GCC Profil jenes ohne Suffix. Wenn Sie PIE oder SSP deaktivieren möchten, wählen Sie entsprechend '''hardenedno'''('''pie'''|'''ssp''') oder beides, '''hardenednopiessp'''. Das Profil '''vanilla''' ist natürlich das eine mit deaktivierter Härtung. Abschliessend lassen Sie Ihre neuen Profileinstellungen neu einlesen:

{{RootCmd|source /etc/profile}}

Wenn sie das "prelink" Paket verwenden entfernen Sie es, weil es mit dem gehärteten Profil nicht kompatibel ist:

{{emerge|params=--depclean|prelink}}

Nun können Sie alle Pakete mit Ihrer neuen, gehärteten Toolchain erneut installieren:

{{emerge|params=--emptytree --verbose|@world}}

Installieren Sie die gehärteten Kernel Quellen, so dass der Kernel Ihr laufendes System auf gehärtete Weise verwaltet (und im Besonderen PaX verwendet):

{{emerge|hardened-sources}}

Konfigurieren und kompilieren Sie nun die Quellen und fügen Die den neuen Kernel Ihrem Bootmanager hinzu (z.B. GRUB).

<div class="mw-translate-fuzzy">
== Tipps & Tricks ==
</div>

=== Gehärtetes Gentoo/ Grsecurity Chroot ===

If you want to chroot to a copied environment where the <var>CONFIG_GRKERNSEC_CHROOT</var> is enabled you must use the cd grub and change the root(cd) kernel(cd) initrd(cd) setting to from (cd) to (hdx,y).

Now you can install the grub environment.

<div class="mw-translate-fuzzy">
=== Paketweise Härtungs-Einstellungen ===
</div>

{{Warning|Diese Methode wird von Gentoo nicht unterstützt.}}

Changing the GCC profile to deal with specific packages can be a pain. A way to avoid this is to set per-package C(XX)FLAGS using [[:/etc/portage/env|package.env]]. Create the file {{Path|/etc/portage/env/nossp}} and add to that:

{{FileBox|filename=/etc/portage/env/nossp|title=Disable SSP|lang=bash|1=
CFLAGS="${CFLAGS} -fno-stack-protector"
CXXFLAGS="${CXXFLAGS} -fno-stack-protector"
}}

To allow for disabling PIE, create and add to {{Path|/etc/portage/env/nopie}}:

{{FileBox|filename=/etc/portage/env/nopie|title=Disable PIE|lang=bash|1=
CFLAGS="${CFLAGS} -no-pie"
CXXFLAGS="${CXXFLAGS} -no-pie"
LDFLAGS="${LDFLAGS} -no-pie"
}}

{{Note|GCC version 4.x uses {{c|-nopie}} instead of {{c|-no-pie}}.}} 

Finally add the package you want to disable either PIE or SSP for to {{Path|/etc/portage/package.env}} and the relevant {{Path|/etc/portage/env/<filename>}}, for this example {{Package|sys-libs/zlib}} is used here:

{{FileBox|filename=/etc/portage/package.env|title=Disable PIE for sys-libs/zlib|1=
sys-libs/zlib nopie
}}

== Siehe auch ==

<div class="mw-translate-fuzzy">
Für weitere Informationen sehen Sie sich die folgenden Ressourcen an:
* [[Project:Hardened|Gentoo Hardened Project]]
* [[Project:SELinux|Gentoo Hardened SELinux Project]]
* [[Project:Hardened/Grsecurity2_Quickstart]]
* [[Project:Hardened/PaX_Quickstart]]
</div>

* [[Project:SELinux|Gentoo Hardened SELinux Project]]
* [[Project:Hardened/Grsecurity2_Quickstart]]
* [[Project:Hardened/PaX_Quickstart]]

== Externe Ressourcen ==

* http://www.rockfloat.com/howto/gentoo-hardened.html#kernel


[[Category:Security]]
