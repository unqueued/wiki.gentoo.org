== Introduction ==
Even though postfix provides logs, having them graphically displayed and analyzed can give much more insight. {{Package|www-misc/awstats}} is a popular log analyzer that can parse logs and setup proper results.


== Installation ==
AWStats is a web-application but no longer relies on webapp-config. If it hasn't emerged already, it needs to be emerged.
{{Emerge|www-misc/awstats}}

Once installed, a config file needs to be created, either per domain, or one that handles all domains.

{{RootCmd|cp /etc/awstats/awstats.model.conf /etc/awstats/awstats.example.com.conf}}

== Configuration ==
=== AWStats ===
AWStats comes with reasonable defaults, but some need to be changed nevertheless.

For one, awstats assumes that vhosts aren't used. When using apache's default combined vhost logs for example, awstats will fail to run.

Assuming apache's combined LogFormat is setup as follows.
{{Code|Apache's LogFormat|<pre>LogFormat "%v %h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\" VLOG=%{VLOG}e" vhost</pre>}}

The following changes needs to be made.
{{File|/etc/awstats/awstats.example.com.conf|Match Logformat to apache's.|<pre>
LogFormat = "%virtualname %host %other %logname %time1 %methodurl %code %bytesd %refererquot %uaquot"
</pre>}}

Next awstats needs to know about the domains and aliases to filter from the log file.
{{File|/etc/awstats/awstats.example.com.conf|Make awstats listen to the domains|<pre>
SiteDomain="example.com"

HostAliases="localhost 127.0.0.1 REGEX[example\.com)$] REGEX[example\.(org|net)$]
</pre>}}

Also, awstats needs to store its database somewhere. Gentoo has created ''/var/lib/awstats'' for this use, but can be stored anywhere.
{{File|/etc/awstats/awstats.example.com.conf|AWStats database storage|<pre>
DirData="/var/lib/awstats"
</pre>}}

Any other changes to the configuration file are optional, but interesting to look into.

=== Apache ===


=== Logrotate ===


AWStats is normally used as an analyzer of web server logs, mostly Apache.
