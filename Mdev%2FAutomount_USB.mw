'''This page is still "under construction". This line will be removed when it's ready for use.'''

This page describes how to implement automounting of USB devices on a machine using mdev as the device manager. There are many links on the web describing how to implement automounting on embedded devices, running busybox with mdev. They all seem to assume only one user, namely root. It's more of a challenge to allow regular users to automount and unmount, without compromising overall system security. Unless otherwise specified, all steps below are to be done by root.

== Preliminary Setup ==
* This page assumes a Gentoo machine using busybox's mdev device manager as described in [[Mdev|the mdev page]]
* Install the programs "pmount" and "sudo", if they have not been installed yet.
* Create the directory "/media"
* Regular user accounts that need to access FAT-formatted USB keys must be added to group "plugdev".
* create a file "/usr/local/bin/ux" containing the following lines
 <nowiki>
#!/bin/busybox ash
case "${1}" in
#
# Guard against user trying to umount directory outside of /media
   *..*) echo "Naughty Naughty.  Going updir.  Mustn't do that".;;
   *) umount /media/${1}
esac</nowiki>

* This step will be done as local user for each user that needs to unmount USB devices that have been automounted. Create an executable script "um" in the user's ~/bin directory containg the lines
 <nowiki>
#! /bin/busybox ash
sudo /usr/local/bin/ux ${1}</nowiki>
